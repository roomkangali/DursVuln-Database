[
  {"id":"CVE-1999-0225","product":"smb","summary":"Windows NT 4.0 allows remote attackers to cause a denial of service via a malformed SMB logon request in which the actual data size does not match the specified size.","details":"Windows NT 4.0 allows remote attackers to cause a denial of service via a malformed SMB logon request in which the actual data size does not match the specified size.","references":["http://www.microsoft.com/technet/support/kb.asp?ID=180963","http://www.nai.com/nai_labs/asp_set/advisory/25_windows_nt_dos_adv.asp","http://www.microsoft.com/technet/support/kb.asp?ID=180963"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-1999-0391","product":"smb","summary":"The cryptographic challenge of SMB authentication in Windows 95 and Windows 98 can be reused, allowing an attacker to replay the response and impersonate a user.","details":"The cryptographic challenge of SMB authentication in Windows 95 and Windows 98 can be reused, allowing an attacker to replay the response and impersonate a user.","references":["https://marc.info/?l=bugtraq&m=91552769809542&w=2","https://marc.info/?l=bugtraq&m=91552769809542&w=2"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-1999-0495","product":"smb","summary":"A remote attacker can gain access to a file system using ..  (dot dot) when accessing SMB shares.","details":"A remote attacker can gain access to a file system using ..  (dot dot) when accessing SMB shares.","references":["https://exchange.xforce.ibmcloud.com/vulnerabilities/837","https://exchange.xforce.ibmcloud.com/vulnerabilities/837"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-1999-0811","product":"smb","summary":"Buffer overflow in Samba smbd program via a malformed message command.","details":"Buffer overflow in Samba smbd program via a malformed message command.","references":["http://www.securityfocus.com/bid/536","http://www.securityfocus.com/bid/536"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-1999-0812","product":"smb","summary":"Race condition in Samba smbmnt allows local users to mount file systems in arbitrary locations.","details":"Race condition in Samba smbmnt allows local users to mount file systems in arbitrary locations.","references":["https://exchange.xforce.ibmcloud.com/vulnerabilities/CVE-1999-0812","https://exchange.xforce.ibmcloud.com/vulnerabilities/CVE-1999-0812"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-1999-1237","product":"smb","summary":"Multiple buffer overflows in smbvalid/smbval SMB authentication library, as used in Apache::AuthenSmb and possibly other modules, allows remote attackers to execute arbitrary commands via (1) a long username, (2) a long password, and (3) other unspecified methods.","details":"Multiple buffer overflows in smbvalid/smbval SMB authentication library, as used in Apache::AuthenSmb and possibly other modules, allows remote attackers to execute arbitrary commands via (1) a long username, (2) a long password, and (3) other unspecified methods.","references":["http://www.securityfocus.com/archive/1/14384","https://exchange.xforce.ibmcloud.com/vulnerabilities/2272","http://www.securityfocus.com/archive/1/14384"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-1999-1387","product":"smb","summary":"Windows NT 4.0 SP2 allows remote attackers to cause a denial of service (crash), possibly via malformed inputs or packets, such as those generated by a Linux smbmount command that was compiled on the Linux 2.0.29 kernel but executed on Linux 2.0.25.","details":"Windows NT 4.0 SP2 allows remote attackers to cause a denial of service (crash), possibly via malformed inputs or packets, such as those generated by a Linux smbmount command that was compiled on the Linux 2.0.29 kernel but executed on Linux 2.0.25.","references":["http://marc.info/?l=bugtraq&m=87602167420731&w=2","http://marc.info/?l=bugtraq&m=87602167420732&w=2","http://marc.info/?l=bugtraq&m=87602167420741&w=2"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2000-0544","product":"smb","summary":"Windows NT and Windows 2000 hosts allow a remote attacker to cause a denial of service via malformed DCE/RPC SMBwriteX requests that contain an invalid data length.","details":"Windows NT and Windows 2000 hosts allow a remote attacker to cause a denial of service via malformed DCE/RPC SMBwriteX requests that contain an invalid data length.","references":["http://archives.neohapsis.com/archives/ntbugtraq/2000-q2/0231.html","http://www.securityfocus.com/bid/1304","http://archives.neohapsis.com/archives/ntbugtraq/2000-q2/0231.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2000-0885","product":"smb","summary":"Buffer overflows in Microsoft Network Monitor (Netmon) allow remote attackers to execute arbitrary commands via a long Browser Name in a CIFS Browse Frame, a long SNMP community name, or a long username or filename in an SMB session, aka the \"Netmon Protocol Parsing\" vulnerability.  NOTE: It is highly likely that this candidate will be split into multiple candidates.","details":"Buffer overflows in Microsoft Network Monitor (Netmon) allow remote attackers to execute arbitrary commands via a long Browser Name in a CIFS Browse Frame, a long SNMP community name, or a long username or filename in an SMB session, aka the \"Netmon Protocol Parsing\" vulnerability.  NOTE: It is highly likely that this candidate will be split into multiple candidates.","references":["https://docs.microsoft.com/en-us/security-updates/securitybulletins/2000/ms00-083","https://exchange.xforce.ibmcloud.com/vulnerabilities/5399","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2000/ms00-083"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2000-1227","product":"smb","summary":"Windows NT 4.0 and Windows 2000 hosts allow remote attackers to cause a denial of service (unavailable connections) by sending multiple SMB SMBnegprots requests but not reading the response that is sent back.","details":"Windows NT 4.0 and Windows 2000 hosts allow remote attackers to cause a denial of service (unavailable connections) by sending multiple SMB SMBnegprots requests but not reading the response that is sent back.","references":["http://www.securityfocus.com/archive/1/63322","http://www.securityfocus.com/bid/1301","http://www.securityfocus.com/archive/1/63322"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2001-0406","product":"smb","summary":"Samba before 2.2.0 allows local attackers to overwrite arbitrary files via a symlink attack using (1) a printer queue query, (2) the more command in smbclient, or (3) the mput command in smbclient.","details":"Samba before 2.2.0 allows local attackers to overwrite arbitrary files via a symlink attack using (1) a printer queue query, (2) the more command in smbclient, or (3) the mput command in smbclient.","references":["http://archives.neohapsis.com/archives/bugtraq/2001-04/0305.html","http://archives.neohapsis.com/archives/bugtraq/2001-04/0319.html","http://archives.neohapsis.com/archives/bugtraq/2001-04/0326.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=2.0.7"},
  {"id":"CVE-2001-1162","product":"smb","summary":"Directory traversal vulnerability in the %m macro in the smb.conf configuration file in Samba before 2.2.0a allows remote attackers to overwrite certain files via a .. in a NETBIOS name, which is used as the name for a .log file.","details":"Directory traversal vulnerability in the %m macro in the smb.conf configuration file in Samba before 2.2.0a allows remote attackers to overwrite certain files via a .. in a NETBIOS name, which is used as the name for a .log file.","references":["ftp://patches.sgi.com/support/free/security/advisories/20011002-01-P","http://ciac.llnl.gov/ciac/bulletins/l-105.shtml","http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000405"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2002-0401","product":"smb","summary":"SMB dissector in Ethereal 0.9.3 and earlier allows remote attackers to cause a denial of service (crash) or execute arbitrary code via malformed packets that cause Ethereal to dereference a NULL pointer.","details":"SMB dissector in Ethereal 0.9.3 and earlier allows remote attackers to cause a denial of service (crash) or execute arbitrary code via malformed packets that cause Ethereal to dereference a NULL pointer.","references":["ftp://ftp.caldera.com/pub/security/OpenLinux/CSSA-2002-037.0.txt","http://distro.conectiva.com/atualizacoes/?id=a&anuncio=000505","http://marc.info/?l=bugtraq&m=102268626526119&w=2"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<=0.9.3"},
  {"id":"CVE-2002-0724","product":"smb","summary":"Buffer overflow in SMB (Server Message Block) protocol in Microsoft Windows NT, Windows 2000, and Windows XP allows attackers to cause a denial of service (crash) via a SMB_COM_TRANSACTION packet with a request for the (1) NetShareEnum, (2) NetServerEnum2, or (3) NetServerEnum3, aka \"Unchecked Buffer in Network Share Provider Can Lead to Denial of Service\".","details":"Buffer overflow in SMB (Server Message Block) protocol in Microsoft Windows NT, Windows 2000, and Windows XP allows attackers to cause a denial of service (crash) via a SMB_COM_TRANSACTION packet with a request for the (1) NetShareEnum, (2) NetServerEnum2, or (3) NetServerEnum3, aka \"Unchecked Buffer in Network Share Provider Can Lead to Denial of Service\".","references":["http://marc.info/?l=bugtraq&m=103011556323184&w=2","http://www.kb.cert.org/vuls/id/250635","http://www.kb.cert.org/vuls/id/311619"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2002-1256","product":"smb","summary":"The SMB signing capability in the Server Message Block (SMB) protocol in Microsoft Windows 2000 and Windows XP allows attackers to disable the digital signing settings in an SMB session to force the data to be sent unsigned, then inject data into the session without detection, e.g. by modifying group policy information sent from a domain controller.","details":"The SMB signing capability in the Server Message Block (SMB) protocol in Microsoft Windows 2000 and Windows XP allows attackers to disable the digital signing settings in an SMB session to force the data to be sent unsigned, then inject data into the session without detection, e.g. by modifying group policy information sent from a domain controller.","references":["http://www.securityfocus.com/bid/6367","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2002/ms02-070","https://exchange.xforce.ibmcloud.com/vulnerabilities/10843"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2002-1342","product":"smb","summary":"Unknown vulnerability in smb2www 980804-16 and earlier allows remote attackers to execute arbitrary commands.","details":"Unknown vulnerability in smb2www 980804-16 and earlier allows remote attackers to execute arbitrary commands.","references":["http://www.debian.org/security/2002/dsa-203","http://www.iss.net/security_center/static/10768.php","http://www.securityfocus.com/bid/6313"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2002-1534","product":"smb","summary":"Macromedia Flash Player allows remote attackers to read arbitrary files via XML script in a .swf file that is hosted on a remote SMB share.","details":"Macromedia Flash Player allows remote attackers to read arbitrary files via XML script in a .swf file that is hosted on a remote SMB share.","references":["http://archives.neohapsis.com/archives/bugtraq/2002-10/0083.html","http://www.iss.net/security_center/static/10297.php","http://www.securityfocus.com/bid/5904"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2003-0085","product":"smb","summary":"Buffer overflow in the SMB/CIFS packet fragment re-assembly code for SMB daemon (smbd) in Samba before 2.2.8, and Samba-TNG before 0.3.1, allows remote attackers to execute arbitrary code.","details":"Buffer overflow in the SMB/CIFS packet fragment re-assembly code for SMB daemon (smbd) in Samba before 2.2.8, and Samba-TNG before 0.3.1, allows remote attackers to execute arbitrary code.","references":["ftp://patches.sgi.com/support/free/security/advisories/20030302-01-I","http://marc.info/?l=bugtraq&m=104792646416629&w=2","http://marc.info/?l=bugtraq&m=104792723017768&w=2"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2003-0345","product":"smb","summary":"Buffer overflow in the SMB capability for Microsoft Windows XP, 2000, and NT allows remote attackers to cause a denial of service and possibly execute arbitrary code via an SMB packet that specifies a smaller buffer length than is required.","details":"Buffer overflow in the SMB capability for Microsoft Windows XP, 2000, and NT allows remote attackers to cause a denial of service and possibly execute arbitrary code via an SMB packet that specifies a smaller buffer length than is required.","references":["http://secunia.com/advisories/9225","http://securitytracker.com/id?1007154","http://www.kb.cert.org/vuls/id/337764"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2003-0356","product":"smb","summary":"Multiple off-by-one vulnerabilities in Ethereal 0.9.11 and earlier allow remote attackers to cause a denial of service and possibly execute arbitrary code via the (1) AIM, (2) GIOP Gryphon, (3) OSPF, (4) PPTP, (5) Quake, (6) Quake2, (7) Quake3, (8) Rsync, (9) SMB, (10) SMPP, and (11) TSP dissectors, which do not properly use the tvb_get_nstringz and tvb_get_nstringz0 functions.","details":"Multiple off-by-one vulnerabilities in Ethereal 0.9.11 and earlier allow remote attackers to cause a denial of service and possibly execute arbitrary code via the (1) AIM, (2) GIOP Gryphon, (3) OSPF, (4) PPTP, (5) Quake, (6) Quake2, (7) Quake3, (8) Rsync, (9) SMB, (10) SMPP, and (11) TSP dissectors, which do not properly use the tvb_get_nstringz and tvb_get_nstringz0 functions.","references":["http://www.debian.org/security/2003/dsa-313","http://www.ethereal.com/appnotes/enpa-sa-00009.html","http://www.kb.cert.org/vuls/id/641013"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<0.9.12"},
  {"id":"CVE-2003-0686","product":"smb","summary":"Buffer overflow in PAM SMB module (pam_smb) 1.1.6 and earlier, when authenticating to a remote service, allows remote attackers to execute arbitrary code.","details":"Buffer overflow in PAM SMB module (pam_smb) 1.1.6 and earlier, when authenticating to a remote service, allows remote attackers to execute arbitrary code.","references":["http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000734","http://marc.info/?l=bugtraq&m=106252769930090&w=2","http://secunia.com/advisories/9611"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2003-0968","product":"smb","summary":"Stack-based buffer overflow in SMB_Logon_Server of the rlm_smb experimental module for FreeRADIUS 0.9.3 and earlier allows remote attackers to execute arbitrary code via a long User-Password attribute.","details":"Stack-based buffer overflow in SMB_Logon_Server of the rlm_smb experimental module for FreeRADIUS 0.9.3 and earlier allows remote attackers to execute arbitrary code via a long User-Password attribute.","references":["http://marc.info/?l=bugtraq&m=106986437621130&w=2","http://marc.info/?l=bugtraq&m=106986437621130&w=2"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2003-1012","product":"smb","summary":"The SMB dissector in Ethereal before 0.10.0 allows remote attackers to cause a denial of service via a malformed SMB packet that triggers a segmentation fault during processing of Selected packets.","details":"The SMB dissector in Ethereal before 0.10.0 allows remote attackers to cause a denial of service via a malformed SMB packet that triggers a segmentation fault during processing of Selected packets.","references":["ftp://patches.sgi.com/support/free/security/advisories/20040103-01-U.asc","ftp://patches.sgi.com/support/free/security/advisories/20040202-01-U.asc","http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000801"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2003-1452","product":"smb","summary":"Untrusted search path vulnerability in Qualcomm qpopper 4.0 through 4.05 allows local users to execute arbitrary code by modifying the PATH environment variable to reference a malicious smbpasswd program.","details":"Untrusted search path vulnerability in Qualcomm qpopper 4.0 through 4.05 allows local users to execute arbitrary code by modifying the PATH environment variable to reference a malicious smbpasswd program.","references":["http://archives.neohapsis.com/archives/vulnwatch/2003-q2/0047.html","http://securityreason.com/securityalert/3268","http://www.securityfocus.com/archive/1/319811"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2004-0186","product":"smb","summary":"smbmnt in Samba 2.x and 3.x on Linux 2.6, when installed setuid, allows local users to gain root privileges by mounting a Samba share that contains a setuid root program, whose setuid attributes are not cleared when the share is mounted.","details":"smbmnt in Samba 2.x and 3.x on Linux 2.6, when installed setuid, allows local users to gain root privileges by mounting a Samba share that contains a setuid root program, whose setuid attributes are not cleared when the share is mounted.","references":["http://marc.info/?l=bugtraq&m=107636290906296&w=2","http://marc.info/?l=bugtraq&m=107657505718743&w=2","http://www.debian.org/security/2004/dsa-463"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2004-0193","product":"smb","summary":"Heap-based buffer overflow in the ISS Protocol Analysis Module (PAM), as used in certain versions of RealSecure Network 7.0 and Server Sensor 7.0, Proventia A, G, and M Series, RealSecure Desktop 7.0 and 3.6, RealSecure Guard 3.6, RealSecure Sentry 3.6, BlackICE PC Protection 3.6, and BlackICE Server Protection 3.6, allows remote attackers to execute arbitrary code via an SMB packet containing an authentication request with a long username.","details":"Heap-based buffer overflow in the ISS Protocol Analysis Module (PAM), as used in certain versions of RealSecure Network 7.0 and Server Sensor 7.0, Proventia A, G, and M Series, RealSecure Desktop 7.0 and 3.6, RealSecure Guard 3.6, RealSecure Sentry 3.6, BlackICE PC Protection 3.6, and BlackICE Server Protection 3.6, allows remote attackers to execute arbitrary code via an SMB packet containing an authentication request with a long username.","references":["http://marc.info/?l=bugtraq&m=107789851117176&w=2","http://secunia.com/advisories/10988","http://www.eeye.com/html/Research/Advisories/AD20040226.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2004-0634","product":"smb","summary":"The SMB SID snooping capability in Ethereal 0.9.15 to 0.10.4 allows remote attackers to cause a denial of service (process crash) via a handle without a policy name, which causes a null dereference.","details":"The SMB SID snooping capability in Ethereal 0.9.15 to 0.10.4 allows remote attackers to cause a denial of service (process crash) via a handle without a policy name, which causes a null dereference.","references":["http://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=127381","http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000916","http://secunia.com/advisories/12024"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2004-0686","product":"smb","summary":"Buffer overflow in Samba 2.2.x to 2.2.9, and 3.0.0 to 3.0.4, when the \"mangling method = hash\" option is enabled in smb.conf, has unknown impact and attack vectors.","details":"Buffer overflow in Samba 2.2.x to 2.2.9, and 3.0.0 to 3.0.4, when the \"mangling method = hash\" option is enabled in smb.conf, has unknown impact and attack vectors.","references":["http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000851","http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000854","http://marc.info/?l=bugtraq&m=109051340810458&w=2"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":[["<3.0.5",">=3.0.0"],[">=2.2.0","<2.2.10"]]},
  {"id":"CVE-2004-0829","product":"smb","summary":"smbd in Samba before 2.2.11 allows remote attackers to cause a denial of service (daemon crash) by sending a FindNextPrintChangeNotify request without a previous FindFirstPrintChangeNotify, as demonstrated by the SMB client in Windows XP SP2.","details":"smbd in Samba before 2.2.11 allows remote attackers to cause a denial of service (daemon crash) by sending a FindNextPrintChangeNotify request without a previous FindFirstPrintChangeNotify, as demonstrated by the SMB client in Windows XP SP2.","references":["http://samba.org/samba/history/samba-2.2.11.html","http://seclists.org/lists/bugtraq/2004/Sep/0003.html","http://www.gentoo.org/security/en/glsa/glsa-200409-14.xml"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2004-0883","product":"smb","summary":"Multiple vulnerabilities in the samba filesystem (smbfs) in Linux kernel 2.4 and 2.6 allow remote samba servers to cause a denial of service (crash) or gain sensitive information from kernel memory via a samba server (1) returning more data than requested to the smb_proc_read function, (2) returning a data offset from outside the samba packet to the smb_proc_readX function, (3) sending a certain TRANS2 fragmented packet to the smb_receive_trans2 function, (4) sending a samba packet with a certain header size to the smb_proc_readX_data function, or (5) sending a certain packet based offset for the data in a packet to the smb_receive_trans2 function.","details":"Multiple vulnerabilities in the samba filesystem (smbfs) in Linux kernel 2.4 and 2.6 allow remote samba servers to cause a denial of service (crash) or gain sensitive information from kernel memory via a samba server (1) returning more data than requested to the smb_proc_read function, (2) returning a data offset from outside the samba packet to the smb_proc_readX function, (3) sending a certain TRANS2 fragmented packet to the smb_receive_trans2 function, (4) sending a samba packet with a certain header size to the smb_proc_readX_data function, or (5) sending a certain packet based offset for the data in a packet to the smb_receive_trans2 function.","references":["http://marc.info/?l=bugtraq&m=110072140811965&w=2","http://marc.info/?l=bugtraq&m=110082989725345&w=2","http://secunia.com/advisories/13232/"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2004-0949","product":"smb","summary":"The smb_recv_trans2 function call in the samba filesystem (smbfs) in Linux kernel 2.4 and 2.6 does not properly handle the re-assembly of fragmented packets correctly, which could allow remote samba servers to (1) read arbitrary kernel information or (2) raise a counter value to an arbitrary number by sending the first part of the fragmented packet multiple times.","details":"The smb_recv_trans2 function call in the samba filesystem (smbfs) in Linux kernel 2.4 and 2.6 does not properly handle the re-assembly of fragmented packets correctly, which could allow remote samba servers to (1) read arbitrary kernel information or (2) raise a counter value to an arbitrary number by sending the first part of the fragmented packet multiple times.","references":["http://marc.info/?l=bugtraq&m=110072140811965&w=2","http://secunia.com/advisories/13232/","http://secunia.com/advisories/20162"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2004-1142","product":"smb","summary":"Ethereal 0.9.0 through 0.10.7 allows remote attackers to cause a denial of service (CPU consumption) via a certain malformed SMB packet.","details":"Ethereal 0.9.0 through 0.10.7 allows remote attackers to cause a denial of service (CPU consumption) via a certain malformed SMB packet.","references":["http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000916","http://secunia.com/advisories/13468/","http://www.ciac.org/ciac/bulletins/p-061.shtml"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2004-1171","product":"smb","summary":"KDE 3.2.x and 3.3.0 through 3.3.2, when saving credentials that are (1) manually entered by the user or (2) created by the SMB protocol handler, stores those credentials for plaintext in the user's .desktop file, which may be created with world-readable permissions, which could allow local users to obtain usernames and passwords for remote resources such as SMB shares.","details":"KDE 3.2.x and 3.3.0 through 3.3.2, when saving credentials that are (1) manually entered by the user or (2) created by the SMB protocol handler, stores those credentials for plaintext in the user's .desktop file, which may be created with world-readable permissions, which could allow local users to obtain usernames and passwords for remote resources such as SMB shares.","references":["http://archives.neohapsis.com/archives/fulldisclosure/2004-11/1292.html","http://marc.info/?l=bugtraq&m=110178786809694&w=2","http://marc.info/?l=bugtraq&m=110261063201488&w=2"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2004-2365","product":"smb","summary":"Memory leak in Microsoft Windows XP and Windows Server 2003 allows local users to cause a denial of service (memory exhaustion) by repeatedly creating and deleting directories using a non-standard tool such as smbmount.","details":"Memory leak in Microsoft Windows XP and Windows Server 2003 allows local users to cause a denial of service (memory exhaustion) by repeatedly creating and deleting directories using a non-standard tool such as smbmount.","references":["http://archives.neohapsis.com/archives/bugtraq/2004-02/0119.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/15057","http://archives.neohapsis.com/archives/bugtraq/2004-02/0119.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2005-0045","product":"smb","summary":"The Server Message Block (SMB) implementation for Windows NT 4.0, 2000, XP, and Server 2003 does not properly validate certain SMB packets, which allows remote attackers to execute arbitrary code via Transaction responses containing (1) Trans or (2) Trans2 commands, aka the \"Server Message Block Vulnerability,\" and as demonstrated using Trans2 FIND_FIRST2 responses with large file name length fields.","details":"The Server Message Block (SMB) implementation for Windows NT 4.0, 2000, XP, and Server 2003 does not properly validate certain SMB packets, which allows remote attackers to execute arbitrary code via Transaction responses containing (1) Trans or (2) Trans2 commands, aka the \"Server Message Block Vulnerability,\" and as demonstrated using Trans2 FIND_FIRST2 responses with large file name length fields.","references":["http://marc.info/?l=bugtraq&m=110792638401852&w=2","http://marc.info/?l=bugtraq&m=111040962600205&w=2","http://marc.info/?l=ntbugtraq&m=110795643831169&w=2"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2005-1459","product":"smb","summary":"Multiple unknown vulnerabilities in the (1) WSP, (2) BER, (3) SMB, (4) NDPS, (5) IAX2, (6) RADIUS, (7) TCAP, (8) MRDISC, (9) 802.3 Slow, (10) SMBMailslot, or (11) SMB PIPE dissectors in Ethereal before 0.10.11 allow remote attackers to cause a denial of service (assert error).","details":"Multiple unknown vulnerabilities in the (1) WSP, (2) BER, (3) SMB, (4) NDPS, (5) IAX2, (6) RADIUS, (7) TCAP, (8) MRDISC, (9) 802.3 Slow, (10) SMBMailslot, or (11) SMB PIPE dissectors in Ethereal before 0.10.11 allow remote attackers to cause a denial of service (assert error).","references":["http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000963","http://www.ethereal.com/appnotes/enpa-sa-00019.html","http://www.ethereal.com/news/item_20050504_01.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2005-1468","product":"smb","summary":"Multiple unknown vulnerabilities in the (1) WSP, (2) Q.931, (3) H.245, (4) KINK, (5) MGCP, (6) RPC, (7) SMBMailslot, and (8) SMB NETLOGON dissectors in Ethereal before 0.10.11 allow remote attackers to cause a denial of service (crash) via unknown vectors that lead to a null dereference.","details":"Multiple unknown vulnerabilities in the (1) WSP, (2) Q.931, (3) H.245, (4) KINK, (5) MGCP, (6) RPC, (7) SMBMailslot, and (8) SMB NETLOGON dissectors in Ethereal before 0.10.11 allow remote attackers to cause a denial of service (crash) via unknown vectors that lead to a null dereference.","references":["http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000963","http://www.ethereal.com/appnotes/enpa-sa-00019.html","http://www.ethereal.com/news/item_20050504_01.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2005-1470","product":"smb","summary":"Multiple unknown vulnerabilities in the (1) TZSP, (2) MGCP, (3) ISUP, (4) SMB, or (5) Bittorrent dissectors in Ethereal before 0.10.11 allow remote attackers to cause a denial of service (segmentation fault) via unknown vectors.","details":"Multiple unknown vulnerabilities in the (1) TZSP, (2) MGCP, (3) ISUP, (4) SMB, or (5) Bittorrent dissectors in Ethereal before 0.10.11 allow remote attackers to cause a denial of service (segmentation fault) via unknown vectors.","references":["http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000963","http://www.ethereal.com/appnotes/enpa-sa-00019.html","http://www.ethereal.com/news/item_20050504_01.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2005-2365","product":"smb","summary":"Unknown vulnerability in the SMB dissector in Ethereal 0.9.0 through 0.10.11 allows remote attackers to cause a buffer overflow or a denial of service (memory consumption) via unknown attack vectors.","details":"Unknown vulnerability in the SMB dissector in Ethereal 0.9.0 through 0.10.11 allows remote attackers to cause a buffer overflow or a denial of service (memory consumption) via unknown attack vectors.","references":["http://secunia.com/advisories/16225/","http://secunia.com/advisories/17102","http://www.debian.org/security/2005/dsa-853"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2005-2851","product":"smb","summary":"smb4k 0.4 and other versions before 0.6.3 allows local users to read sensitive files via a symlink attack on the (1) smb4k.tmp or (2) sudoers temporary files.","details":"smb4k 0.4 and other versions before 0.6.3 allows local users to read sensitive files via a symlink attack on the (1) smb4k.tmp or (2) sudoers temporary files.","references":["http://secunia.com/advisories/16724","http://secunia.com/advisories/17636","http://smb4k.berlios.de/"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2005-3242","product":"smb","summary":"Ethereal 0.10.12 and earlier allows remote attackers to cause a denial of service (crash) via unknown vectors in (1) the IrDA dissector and (2) the SMB dissector when SMB transaction payload reassembly is enabled.","details":"Ethereal 0.10.12 and earlier allows remote attackers to cause a denial of service (crash) via unknown vectors in (1) the IrDA dissector and (2) the SMB dissector when SMB transaction payload reassembly is enabled.","references":["http://secunia.com/advisories/17254","http://secunia.com/advisories/17286","http://secunia.com/advisories/17327"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2005-4629","product":"smb","summary":"SQL injection vulnerability in SMBCMS 2.1 allows remote attackers to execute arbitrary SQL commands via unspecified search parameters.","details":"SQL injection vulnerability in SMBCMS 2.1 allows remote attackers to execute arbitrary SQL commands via unspecified search parameters.","references":["http://pridels0.blogspot.com/2005/11/smbcms-v21-sql-injection.html","http://www.osvdb.org/21314","http://pridels0.blogspot.com/2005/11/smbcms-v21-sql-injection.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-0243","product":"smb","summary":"Cross-site scripting (XSS) vulnerability in SMBCMS 2.1 allows remote attackers to inject arbitrary web script or HTML via the text parameter, which is used by the \"Search Site\" field.  NOTE: the provenance of this information is unknown; the details are obtained solely from third party information.","details":"Cross-site scripting (XSS) vulnerability in SMBCMS 2.1 allows remote attackers to inject arbitrary web script or HTML via the text parameter, which is used by the \"Search Site\" field.  NOTE: the provenance of this information is unknown; the details are obtained solely from third party information.","references":["http://secunia.com/advisories/18454","http://www.osvdb.org/22494","http://www.securityfocus.com/bid/16281"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-1013","product":"smb","summary":"PHP remote file include vulnerability in index.php in SMartBlog (aka SMBlog) 1.2 allows remote attackers to include and execute arbitrary PHP files via (1) the pg parameter and (2) a query string without a parameter.","details":"PHP remote file include vulnerability in index.php in SMartBlog (aka SMBlog) 1.2 allows remote attackers to include and execute arbitrary PHP files via (1) the pg parameter and (2) a query string without a parameter.","references":["http://www.securityfocus.com/archive/1/426498/100/0/threaded","http://www.securityfocus.com/bid/16905","https://exchange.xforce.ibmcloud.com/vulnerabilities/25220"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-1315","product":"smb","summary":"The Server Service (SRV.SYS driver) in Microsoft Windows 2000 SP4, XP SP1 and SP2, Server 2003 up to SP1, and other products, allows remote attackers to obtain sensitive information via crafted requests that leak information in SMB buffers, which are not properly initialized, aka \"SMB Information Disclosure Vulnerability.\"","details":"The Server Service (SRV.SYS driver) in Microsoft Windows 2000 SP4, XP SP1 and SP2, Server 2003 up to SP1, and other products, allows remote attackers to obtain sensitive information via crafted requests that leak information in SMB buffers, which are not properly initialized, aka \"SMB Information Disclosure Vulnerability.\"","references":["http://secunia.com/advisories/21007","http://securitytracker.com/id?1016467","http://www.kb.cert.org/vuls/id/333636"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-1819","product":"smb","summary":"Directory traversal vulnerability in the loadConfig function in index.php in phpWebSite 0.10.2 and earlier allows remote attackers to include arbitrary local files and execute arbitrary PHP code via the hub_dir parameter, as demonstrated by including access_log.  NOTE: in some cases, arbitrary remote file inclusion could be performed under PHP 5 using an SMB share argument such as \"\\\\systemname\\sharename\".","details":"Directory traversal vulnerability in the loadConfig function in index.php in phpWebSite 0.10.2 and earlier allows remote attackers to include arbitrary local files and execute arbitrary PHP code via the hub_dir parameter, as demonstrated by including access_log.  NOTE: in some cases, arbitrary remote file inclusion could be performed under PHP 5 using an SMB share argument such as \"\\\\systemname\\sharename\".","references":["http://downloads.securityfocus.com/vulnerabilities/exploits/PHPWebSite_fi_poc","http://secunia.com/advisories/19647","http://secunia.com/advisories/19914"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=0.10.2"},
  {"id":"CVE-2006-1863","product":"smb","summary":"Directory traversal vulnerability in CIFS in Linux 2.6.16 and earlier allows local users to escape chroot restrictions for an SMB-mounted filesystem via \"..\\\\\" sequences, a similar vulnerability to CVE-2006-1864.","details":"Directory traversal vulnerability in CIFS in Linux 2.6.16 and earlier allows local users to escape chroot restrictions for an SMB-mounted filesystem via \"..\\\\\" sequences, a similar vulnerability to CVE-2006-1864.","references":["http://rhn.redhat.com/errata/RHBA-2007-0304.html","http://secunia.com/advisories/19868","http://secunia.com/advisories/20398"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=2.6.17"},
  {"id":"CVE-2006-1864","product":"smb","summary":"Directory traversal vulnerability in smbfs in Linux 2.6.16 and earlier allows local users to escape chroot restrictions for an SMB-mounted filesystem via \"..\\\\\" sequences, a similar vulnerability to CVE-2006-1863.","details":"Directory traversal vulnerability in smbfs in Linux 2.6.16 and earlier allows local users to escape chroot restrictions for an SMB-mounted filesystem via \"..\\\\\" sequences, a similar vulnerability to CVE-2006-1863.","references":["http://secunia.com/advisories/19869","http://secunia.com/advisories/20237","http://secunia.com/advisories/20398"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-1938","product":"smb","summary":"Multiple unspecified vulnerabilities in Ethereal 0.8.x up to 0.10.14 allow remote attackers to cause a denial of service (crash from null dereference) via the (1) Sniffer capture or (2) SMB PIPE dissector.","details":"Multiple unspecified vulnerabilities in Ethereal 0.8.x up to 0.10.14 allow remote attackers to cause a denial of service (crash from null dereference) via the (1) Sniffer capture or (2) SMB PIPE dissector.","references":["ftp://patches.sgi.com/support/free/security/advisories/20060501-01-U.asc","http://lists.suse.com/archive/suse-security-announce/2006-May/0004.html","http://secunia.com/advisories/19769"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-2654","product":"smb","summary":"Directory traversal vulnerability in smbfs smbfs on FreeBSD 4.10 up to 6.1 allows local users to escape chroot restrictions for an SMB-mounted filesystem via \"..\\\\\" sequences.  NOTE: this is similar to CVE-2006-1864, but this is a different implementation of smbfs, so it has a different CVE identifier.","details":"Directory traversal vulnerability in smbfs smbfs on FreeBSD 4.10 up to 6.1 allows local users to escape chroot restrictions for an SMB-mounted filesystem via \"..\\\\\" sequences.  NOTE: this is similar to CVE-2006-1864, but this is a different implementation of smbfs, so it has a different CVE identifier.","references":["http://secunia.com/advisories/20390","http://security.freebsd.org/advisories/FreeBSD-SA-06:16.smbfs.asc","http://securitytracker.com/id?1016194"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-3281","product":"smb","summary":"Microsoft Internet Explorer 6.0 does not properly handle Drag and Drop events, which allows remote user-assisted attackers to execute arbitrary code via a link to an SMB file share with a filename that contains encoded ..\\ (%2e%2e%5c) sequences and whose extension contains the CLSID Key identifier for HTML Applications (HTA), aka \"Folder GUID Code Execution Vulnerability.\"  NOTE: directory traversal sequences were used in the original exploit, although their role is not clear.","details":"Microsoft Internet Explorer 6.0 does not properly handle Drag and Drop events, which allows remote user-assisted attackers to execute arbitrary code via a link to an SMB file share with a filename that contains encoded ..\\ (%2e%2e%5c) sequences and whose extension contains the CLSID Key identifier for HTML Applications (HTA), aka \"Folder GUID Code Execution Vulnerability.\"  NOTE: directory traversal sequences were used in the original exploit, although their role is not clear.","references":["http://lists.grok.org.uk/pipermail/full-disclosure/2006-June/047398.html","http://lists.grok.org.uk/pipermail/full-disclosure/attachments/20060627/3d930eda/PLEBO-2006.06.16-IE_ONE_MINOR_ONE_MAJOR.obj","http://secunia.com/advisories/20825"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-3840","product":"smb","summary":"The SMB Mailslot parsing functionality in PAM in multiple ISS products with XPU (24.39/1.78/epj/x.x.x.1780), including Proventia A, G, M, Server, and Desktop, BlackICE PC and Server Protection 3.6, and RealSecure 7.0, allows remote attackers to cause a denial of service (infinite loop) via a crafted SMB packet that is not properly handled by the SMB_Mailslot_Heap_Overflow decode.","details":"The SMB Mailslot parsing functionality in PAM in multiple ISS products with XPU (24.39/1.78/epj/x.x.x.1780), including Proventia A, G, M, Server, and Desktop, BlackICE PC and Server Protection 3.6, and RealSecure 7.0, allows remote attackers to cause a denial of service (infinite loop) via a crafted SMB packet that is not properly handled by the SMB_Mailslot_Heap_Overflow decode.","references":["http://secunia.com/advisories/21219","http://securitytracker.com/id?1016590","http://securitytracker.com/id?1016591"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-3942","product":"smb","summary":"The server driver (srv.sys) in Microsoft Windows NT 4.0, 2000, XP, and Server 2003 allows remote attackers to cause a denial of service (system crash) via an SMB_COM_TRANSACTION SMB message that contains a string without null character termination, which leads to a NULL dereference in the ExecuteTransaction function, possibly related to an \"SMB PIPE,\" aka the \"Mailslot DOS\" vulnerability.  NOTE: the name \"Mailslot DOS\" was derived from incomplete initial research; the vulnerability is not associated with a mailslot.","details":"The server driver (srv.sys) in Microsoft Windows NT 4.0, 2000, XP, and Server 2003 allows remote attackers to cause a denial of service (system crash) via an SMB_COM_TRANSACTION SMB message that contains a string without null character termination, which leads to a NULL dereference in the ExecuteTransaction function, possibly related to an \"SMB PIPE,\" aka the \"Mailslot DOS\" vulnerability.  NOTE: the name \"Mailslot DOS\" was derived from incomplete initial research; the vulnerability is not associated with a mailslot.","references":["http://blogs.technet.com/msrc/archive/2006/07/28/443837.aspx","http://secunia.com/advisories/21276","http://securitytracker.com/id?1016606"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-5211","product":"smb","summary":"Trend Micro OfficeScan 6.0 in Client/Server/Messaging (CSM) Suite for SMB 2.0 before 6.0.0.1385, and OfficeScan Corporate Edition (OSCE) 6.5 before 6.5.0.1418, 7.0 before 7.0.0.1257, and 7.3 before 7.3.0.1053 allow remote attackers to remove OfficeScan clients via a certain HTTP request that invokes the OfficeScan CGI program.","details":"Trend Micro OfficeScan 6.0 in Client/Server/Messaging (CSM) Suite for SMB 2.0 before 6.0.0.1385, and OfficeScan Corporate Edition (OSCE) 6.5 before 6.5.0.1418, 7.0 before 7.0.0.1257, and 7.3 before 7.3.0.1053 allow remote attackers to remove OfficeScan clients via a certain HTTP request that invokes the OfficeScan CGI program.","references":["http://secunia.com/advisories/22156","http://www.securityfocus.com/bid/20330","http://www.trendmicro.com/download/product.asp?productid=5"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-5212","product":"smb","summary":"Trend Micro OfficeScan 6.0 in Client/Server/Messaging (CSM) Suite for SMB 2.0 before 6.0.0.1385, and OfficeScan Corporate Edition (OSCE) 6.5 before 6.5.0.1418, 7.0 before 7.0.0.1257, and 7.3 before 7.3.0.1053 allow remote attackers to delete files via a modified filename parameter in a certain HTTP request that invokes the OfficeScan CGI program.","details":"Trend Micro OfficeScan 6.0 in Client/Server/Messaging (CSM) Suite for SMB 2.0 before 6.0.0.1385, and OfficeScan Corporate Edition (OSCE) 6.5 before 6.5.0.1418, 7.0 before 7.0.0.1257, and 7.3 before 7.3.0.1053 allow remote attackers to delete files via a modified filename parameter in a certain HTTP request that invokes the OfficeScan CGI program.","references":["http://secunia.com/advisories/22156","http://www.securityfocus.com/bid/20330","http://www.trendmicro.com/download/product.asp?productid=5"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-5276","product":"smb","summary":"Stack-based buffer overflow in the DCE/RPC preprocessor in Snort before 2.6.1.3, and 2.7 before beta 2; and Sourcefire Intrusion Sensor; allows remote attackers to execute arbitrary code via crafted SMB traffic.","details":"Stack-based buffer overflow in the DCE/RPC preprocessor in Snort before 2.6.1.3, and 2.7 before beta 2; and Sourcefire Intrusion Sensor; allows remote attackers to execute arbitrary code via crafted SMB traffic.","references":["http://fedoranews.org/updates/FEDORA-2007-206.shtml","http://iss.net/threats/257.html","http://secunia.com/advisories/24190"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=2.6.1.2"},
  {"id":"CVE-2006-5871","product":"smb","summary":"smbfs in Linux kernel 2.6.8 and other versions, and 2.4.x before 2.4.34, when UNIX extensions are enabled, ignores certain mount options, which could cause clients to use server-specified uid, gid and mode settings.","details":"smbfs in Linux kernel 2.6.8 and other versions, and 2.4.x before 2.4.34, when UNIX extensions are enabled, ignores certain mount options, which could cause clients to use server-specified uid, gid and mode settings.","references":["http://secunia.com/advisories/23361","http://secunia.com/advisories/23370","http://secunia.com/advisories/23395"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-5925","product":"smb","summary":"Links web browser 1.00pre12 and Elinks 0.9.2 with smbclient installed allows remote attackers to execute arbitrary code via shell metacharacters in an smb:// URI, as demonstrated by using PUT and GET statements.","details":"Links web browser 1.00pre12 and Elinks 0.9.2 with smbclient installed allows remote attackers to execute arbitrary code via shell metacharacters in an smb:// URI, as demonstrated by using PUT and GET statements.","references":["http://bugzilla.elinks.cz/show_bug.cgi?id=841","http://marc.info/?l=full-disclosure&m=116355556512780&w=2","http://secunia.com/advisories/22905"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-6405","product":"smb","summary":"BitDefender Mail Protection for SMB 2.0 allows remote attackers to bypass virus detection by inserting invalid characters into base64 encoded content in a multipart/mixed MIME file, as demonstrated with the EICAR test file.","details":"BitDefender Mail Protection for SMB 2.0 allows remote attackers to bypass virus detection by inserting invalid characters into base64 encoded content in a multipart/mixed MIME file, as demonstrated with the EICAR test file.","references":["http://www.quantenblog.net/security/virus-scanner-bypass","http://www.securityfocus.com/archive/1/453654/100/0/threaded","http://www.securityfocus.com/bid/21461"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2006-6467","product":"smb","summary":"Xerox WorkCentre and WorkCentre Pro before 12.050.03.000, 13.x before 13.050.03.000, and 14.x before 14.050.03.000 do not properly restrict access to SMB file resources, which allows remote attackers to gain unspecified file or directory access via vectors related to (1) visibility of the SMB \"Homes\" share and (2) SMB file system browsing.","details":"Xerox WorkCentre and WorkCentre Pro before 12.050.03.000, 13.x before 13.050.03.000, and 14.x before 14.050.03.000 do not properly restrict access to SMB file resources, which allows remote attackers to gain unspecified file or directory access via vectors related to (1) visibility of the SMB \"Homes\" share and (2) SMB file system browsing.","references":["http://secunia.com/advisories/23265","http://www.xerox.com/downloads/usa/en/c/cert_XRX06_004_v11.pdf","http://secunia.com/advisories/23265"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":[["<=14.050.02.000"],["<=13.050.02.000"]]},
  {"id":"CVE-2006-7203","product":"smb","summary":"The compat_sys_mount function in fs/compat.c in Linux kernel 2.6.20 and earlier allows local users to cause a denial of service (NULL pointer dereference and oops) by mounting a smbfs file system in compatibility mode (\"mount -t smbfs\").","details":"The compat_sys_mount function in fs/compat.c in Linux kernel 2.6.20 and earlier allows local users to cause a denial of service (NULL pointer dereference and oops) by mounting a smbfs file system in compatibility mode (\"mount -t smbfs\").","references":["http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commitdiff_plain%3Bh=822191a2fa1584a29c3224ab328507adcaeac1ab","http://rhn.redhat.com/errata/RHSA-2007-0488.html","http://secunia.com/advisories/25682"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=2.6.20"},
  {"id":"CVE-2007-0080","product":"smb","summary":"Buffer overflow in the SMB_Connect_Server function in FreeRadius 1.1.3 and earlier allows attackers to execute arbitrary code related to the server desthost field of an SMB_Handle_Type instance.  NOTE: the impact of this issue has been disputed by a reliable third party and the vendor, who states that exploitation is limited \"only to local administrators who have write access to the server configuration files.\"  CVE concurs with the dispute","details":"Buffer overflow in the SMB_Connect_Server function in FreeRadius 1.1.3 and earlier allows attackers to execute arbitrary code related to the server desthost field of an SMB_Handle_Type instance.  NOTE: the impact of this issue has been disputed by a reliable third party and the vendor, who states that exploitation is limited \"only to local administrators who have write access to the server configuration files.\"  CVE concurs with the dispute","references":["http://osvdb.org/32082","http://securitytracker.com/id?1017463","http://www.attrition.org/pipermail/vim/2007-February/001304.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=1.1.3"},
  {"id":"CVE-2007-0452","product":"smb","summary":"smbd in Samba 3.0.6 through 3.0.23d allows remote authenticated users to cause a denial of service (memory and CPU exhaustion) by renaming a file in a way that prevents a request from being removed from the deferred open queue, which triggers an infinite loop.","details":"smbd in Samba 3.0.6 through 3.0.23d allows remote authenticated users to cause a denial of service (memory and CPU exhaustion) by renaming a file in a way that prevents a request from being removed from the deferred open queue, which triggers an infinite loop.","references":["ftp://patches.sgi.com/support/free/security/advisories/20070201-01-P.asc","http://fedoranews.org/cms/node/2579","http://fedoranews.org/cms/node/2580"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-0472","product":"smb","summary":"Multiple race conditions in Smb4K before 0.8.0 allow local users to (1) modify arbitrary files via unspecified manipulations of Smb4K's lock file, which is not properly handled by the remove_lock_file function in core/smb4kfileio.cpp, and (2) add lines to the sudoers file via a symlink attack on temporary files, which isn't properly handled by the writeFile function in core/smb4kfileio.cpp.","details":"Multiple race conditions in Smb4K before 0.8.0 allow local users to (1) modify arbitrary files via unspecified manipulations of Smb4K's lock file, which is not properly handled by the remove_lock_file function in core/smb4kfileio.cpp, and (2) add lines to the sudoers file via a symlink attack on temporary files, which isn't properly handled by the writeFile function in core/smb4kfileio.cpp.","references":["http://developer.berlios.de/bugs/?func=detailbug&bug_id=9630&group_id=769","http://developer.berlios.de/project/shownotes.php?release_id=11706","http://developer.berlios.de/project/shownotes.php?release_id=11902"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-0473","product":"smb","summary":"The writeFile function in core/smb4kfileio.cpp in Smb4K before 0.8.0 does not preserve /etc/sudoers permissions across modifications, which allows local users to obtain sensitive information (/etc/sudoers contents) by reading this file.","details":"The writeFile function in core/smb4kfileio.cpp in Smb4K before 0.8.0 does not preserve /etc/sudoers permissions across modifications, which allows local users to obtain sensitive information (/etc/sudoers contents) by reading this file.","references":["http://developer.berlios.de/bugs/?func=detailbug&bug_id=9630&group_id=769","http://developer.berlios.de/project/shownotes.php?release_id=11706","http://developer.berlios.de/project/shownotes.php?release_id=11902"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-0474","product":"smb","summary":"Smb4K before 0.8.0 allow local users, when present on the Smb4K sudoers list, to kill arbitrary processes, related to a \"design issue with smb4k_kill.\"","details":"Smb4K before 0.8.0 allow local users, when present on the Smb4K sudoers list, to kill arbitrary processes, related to a \"design issue with smb4k_kill.\"","references":["http://developer.berlios.de/bugs/?func=detailbug&bug_id=9631&group_id=769","http://developer.berlios.de/project/shownotes.php?release_id=11706","http://developer.berlios.de/project/shownotes.php?release_id=11902"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-0475","product":"smb","summary":"Multiple stack-based buffer overflows in utilities/smb4k_*.cpp in Smb4K before 0.8.0 allow local users, when present on the Smb4K sudoers list, to gain privileges via unspecified vectors related to the args variable and unspecified other variables, in conjunction with the sudo configuration.","details":"Multiple stack-based buffer overflows in utilities/smb4k_*.cpp in Smb4K before 0.8.0 allow local users, when present on the Smb4K sudoers list, to gain privileges via unspecified vectors related to the args variable and unspecified other variables, in conjunction with the sudo configuration.","references":["http://developer.berlios.de/bugs/?func=detailbug&bug_id=9631&group_id=769","http://developer.berlios.de/project/shownotes.php?release_id=11706","http://developer.berlios.de/project/shownotes.php?release_id=11902"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-0743","product":"smb","summary":"URLMount in Apple Mac OS X 10.3.9 through 10.4.9 passes the username and password credentials for mounting filesystems on SMB servers as command line arguments to the mount_sub command, which may allow local users to obtain sensitive information by listing the process.","details":"URLMount in Apple Mac OS X 10.3.9 through 10.4.9 passes the username and password credentials for mounting filesystems on SMB servers as command line arguments to the mount_sub command, which may allow local users to obtain sensitive information by listing the process.","references":["http://docs.info.apple.com/article.html?artnum=305391","http://lists.apple.com/archives/Security-announce/2007/Apr/msg00001.html","http://secunia.com/advisories/24966"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-0744","product":"smb","summary":"SMB in Apple Mac OS X 10.3.9 through 10.4.9 does not properly clean the environment when executing commands, which allows local users to gain privileges by setting unspecified environment variables.","details":"SMB in Apple Mac OS X 10.3.9 through 10.4.9 does not properly clean the environment when executing commands, which allows local users to gain privileges by setting unspecified environment variables.","references":["http://docs.info.apple.com/article.html?artnum=305391","http://lists.apple.com/archives/Security-announce/2007/Apr/msg00001.html","http://secunia.com/advisories/24966"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-0856","product":"smb","summary":"TmComm.sys 1.5.0.1052 in the Trend Micro Anti-Rootkit Common Module (RCM), with the VsapiNI.sys 3.320.0.1003 scan engine, as used in Trend Micro PC-cillin Internet Security 2007, Antivirus 2007, Anti-Spyware for SMB 3.2 SP1, Anti-Spyware for Consumer 3.5, Anti-Spyware for Enterprise 3.0 SP2, Client / Server / Messaging Security for SMB 3.5, Damage Cleanup Services 3.2, and possibly other products, assigns Everyone write permission for the \\\\.\\TmComm DOS device interface, which allows local users to access privileged IOCTLs and execute arbitrary code or overwrite arbitrary memory in the kernel context.","details":"TmComm.sys 1.5.0.1052 in the Trend Micro Anti-Rootkit Common Module (RCM), with the VsapiNI.sys 3.320.0.1003 scan engine, as used in Trend Micro PC-cillin Internet Security 2007, Antivirus 2007, Anti-Spyware for SMB 3.2 SP1, Anti-Spyware for Consumer 3.5, Anti-Spyware for Enterprise 3.0 SP2, Client / Server / Messaging Security for SMB 3.5, Damage Cleanup Services 3.2, and possibly other products, assigns Everyone write permission for the \\\\.\\TmComm DOS device interface, which allows local users to access privileged IOCTLs and execute arbitrary code or overwrite arbitrary memory in the kernel context.","references":["http://esupport.trendmicro.com/support/viewxml.do?ContentID=EN-1034432&id=EN-1034432","http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=469","http://osvdb.org/33039"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-1586","product":"smb","summary":"ZynOS 3.40 allows remote attackers to cause a denial of service (link restart) by sending a request for the name \\M via the SMB Mail Slot Protocol.","details":"ZynOS 3.40 allows remote attackers to cause a denial of service (link restart) by sending a request for the name \\M via the SMB Mail Slot Protocol.","references":["http://osvdb.org/34522","http://securitytracker.com/id?1017795","http://www.securityfocus.com/archive/1/463238/100/0/threaded"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-2444","product":"smb","summary":"Logic error in the SID/Name translation functionality in smbd in Samba 3.0.23d through 3.0.25pre2 allows local users to gain temporary privileges and execute SMB/CIFS protocol operations via unspecified vectors that cause the daemon to transition to the root user.","details":"Logic error in the SID/Name translation functionality in smbd in Samba 3.0.23d through 3.0.25pre2 allows local users to gain temporary privileges and execute SMB/CIFS protocol operations via unspecified vectors that cause the daemon to transition to the root user.","references":["http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?lang=en&cc=us&objectID=c01078980","http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?lang=en&cc=us&objectID=c01078980","http://lists.suse.com/archive/suse-security-announce/2007-May/0006.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-2446","product":"smb","summary":"Multiple heap-based buffer overflows in the NDR parsing in smbd in Samba 3.0.0 through 3.0.25rc3 allow remote attackers to execute arbitrary code via crafted MS-RPC requests involving (1) DFSEnum (netdfs_io_dfs_EnumInfo_d), (2) RFNPCNEX (smb_io_notify_option_type_data), (3) LsarAddPrivilegesToAccount (lsa_io_privilege_set), (4) NetSetFileSecurity (sec_io_acl), or (5) LsarLookupSids/LsarLookupSids2 (lsa_io_trans_names).","details":"Multiple heap-based buffer overflows in the NDR parsing in smbd in Samba 3.0.0 through 3.0.25rc3 allow remote attackers to execute arbitrary code via crafted MS-RPC requests involving (1) DFSEnum (netdfs_io_dfs_EnumInfo_d), (2) RFNPCNEX (smb_io_notify_option_type_data), (3) LsarAddPrivilegesToAccount (lsa_io_privilege_set), (4) NetSetFileSecurity (sec_io_acl), or (5) LsarLookupSids/LsarLookupSids2 (lsa_io_trans_names).","references":["http://docs.info.apple.com/article.html?artnum=306172","http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?lang=en&cc=us&objectID=c01067768","http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?lang=en&cc=us&objectID=c01067768"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-2447","product":"smb","summary":"The MS-RPC functionality in smbd in Samba 3.0.0 through 3.0.25rc3 allows remote attackers to execute arbitrary commands via shell metacharacters involving the (1) SamrChangePassword function, when the \"username map script\" smb.conf option is enabled, and allows remote authenticated users to execute commands via shell metacharacters involving other MS-RPC functions in the (2) remote printer and (3) file share management.","details":"The MS-RPC functionality in smbd in Samba 3.0.0 through 3.0.25rc3 allows remote attackers to execute arbitrary commands via shell metacharacters involving the (1) SamrChangePassword function, when the \"username map script\" smb.conf option is enabled, and allows remote authenticated users to execute commands via shell metacharacters involving other MS-RPC functions in the (2) remote printer and (3) file share management.","references":["http://docs.info.apple.com/article.html?artnum=306172","http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?lang=en&cc=us&objectID=c01067768","http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?lang=en&cc=us&objectID=c01067768"],"severity":"UNKNOWN","match_type":"active_check","confidence":"high","required_script":"samba-vuln-cve-2007-2447"},
  {"id":"CVE-2007-3876","product":"smb","summary":"Stack-based buffer overflow in SMB in Apple Mac OS X 10.4.11 allows local users to execute arbitrary code via (1) a long workgroup (-W) option to mount_smbfs or (2) an unspecified manipulation of the command line to smbutil.","details":"Stack-based buffer overflow in SMB in Apple Mac OS X 10.4.11 allows local users to execute arbitrary code via (1) a long workgroup (-W) option to mount_smbfs or (2) an unspecified manipulation of the command line to smbutil.","references":["http://docs.info.apple.com/article.html?artnum=307179","http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=633","http://lists.apple.com/archives/security-announce/2007/Dec/msg00002.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-4044","product":"smb","summary":"Rejected reason: The MS-RPC functionality in smbd in Samba 3 on SUSE Linux before 20070720 does not include \"one character in the shell escape handling.\"  NOTE: this issue was originally characterized as a shell metacharacter issue due to an incomplete fix for CVE-2007-2447, which was interpreted by CVE to be security relevant.  However, SUSE and Red Hat have disputed the problem, stating that the only impact is that scripts will not be executed if they have a \"c\" in their name, but even this limitation might not exist.  This does not have security implications, so should not be included in CVE","details":"Rejected reason: The MS-RPC functionality in smbd in Samba 3 on SUSE Linux before 20070720 does not include \"one character in the shell escape handling.\"  NOTE: this issue was originally characterized as a shell metacharacter issue due to an incomplete fix for CVE-2007-2447, which was interpreted by CVE to be security relevant.  However, SUSE and Red Hat have disputed the problem, stating that the only impact is that scripts will not be executed if they have a \"c\" in their name, but even this limitation might not exist.  This does not have security implications, so should not be included in CVE","references":[],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-5184","product":"smb","summary":"Format string vulnerability in the SMBDirList function in dirlist.c in SmbFTPD 0.96 allows remote attackers to execute arbitrary code via format string specifiers in a directory name.","details":"Format string vulnerability in the SMBDirList function in dirlist.c in SmbFTPD 0.96 allows remote attackers to execute arbitrary code via format string specifiers in a directory name.","references":["http://debork.se/poc/001_smbftpd.c","http://osvdb.org/41385","http://secunia.com/advisories/27014"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-5337","product":"smb","summary":"Mozilla Firefox before 2.0.0.8 and SeaMonkey before 1.1.5, when running on Linux systems with gnome-vfs support, might allow remote attackers to read arbitrary files on SSH/sftp servers that accept key authentication by creating a web page on the target server, in which the web page contains URIs with (1) smb: or (2) sftp: schemes that access other files from the server.","details":"Mozilla Firefox before 2.0.0.8 and SeaMonkey before 1.1.5, when running on Linux systems with gnome-vfs support, might allow remote attackers to read arbitrary files on SSH/sftp servers that accept key authentication by creating a web page on the target server, in which the web page contains URIs with (1) smb: or (2) sftp: schemes that access other files from the server.","references":["http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c00771742","http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c00771742","http://secunia.com/advisories/27276"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":[["<=2.0.0.7"],["<=1.1.4"]]},
  {"id":"CVE-2007-5351","product":"smb","summary":"Unspecified vulnerability in Server Message Block Version 2 (SMBv2) signing support in Microsoft Windows Vista allows remote attackers to force signature re-computation and execute arbitrary code via a crafted SMBv2 packet, aka \"SMBv2 Signing Vulnerability.\"","details":"Unspecified vulnerability in Server Message Block Version 2 (SMBv2) signing support in Microsoft Windows Vista allows remote attackers to force signature re-computation and execute arbitrary code via a crafted SMBv2 packet, aka \"SMBv2 Signing Vulnerability.\"","references":["http://secunia.com/advisories/27997","http://www.kb.cert.org/vuls/id/520465","http://www.securityfocus.com/archive/1/485268/100/0/threaded"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-5580","product":"smb","summary":"Buffer overflow in a certain driver in Cisco Security Agent 4.5.1 before 4.5.1.672, 5.0 before 5.0.0.225, 5.1 before 5.1.0.106, and 5.2 before 5.2.0.238 on Windows allows remote attackers to execute arbitrary code via a crafted SMB packet in a TCP session on port (1) 139 or (2) 445.","details":"Buffer overflow in a certain driver in Cisco Security Agent 4.5.1 before 4.5.1.672, 5.0 before 5.0.0.225, 5.1 before 5.1.0.106, and 5.2 before 5.2.0.238 on Windows allows remote attackers to execute arbitrary code via a crafted SMB packet in a TCP session on port (1) 139 or (2) 445.","references":["http://osvdb.org/39521","http://secunia.com/advisories/27947","http://securityreason.com/securityalert/3425"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-5904","product":"smb","summary":"Multiple buffer overflows in CIFS VFS in Linux kernel 2.6.23 and earlier allows remote attackers to cause a denial of service (crash) and possibly execute arbitrary code via long SMB responses that trigger the overflows in the SendReceive function.","details":"Multiple buffer overflows in CIFS VFS in Linux kernel 2.6.23 and earlier allows remote attackers to cause a denial of service (crash) and possibly execute arbitrary code via long SMB responses that trigger the overflows in the SendReceive function.","references":["http://git.kernel.org/?p=linux/kernel/git/sfrench/cifs-2.6.git%3Ba=commitdiff%3Bh=133672efbc1085f9af990bdc145e1822ea93bcf3","http://lists.opensuse.org/opensuse-security-announce/2007-12/msg00001.html","http://lists.opensuse.org/opensuse-security-announce/2008-03/msg00002.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=2.6.23"},
  {"id":"CVE-2007-6438","product":"smb","summary":"Unspecified vulnerability in the SMB dissector in Wireshark (formerly Ethereal) 0.99.6 allows remote attackers to cause a denial of service via unknown vectors.  NOTE: this identifier originally included MP3 and NCP, but those issues are already covered by CVE-2007-6111.","details":"Unspecified vulnerability in the SMB dissector in Wireshark (formerly Ethereal) 0.99.6 allows remote attackers to cause a denial of service via unknown vectors.  NOTE: this identifier originally included MP3 and NCP, but those issues are already covered by CVE-2007-6111.","references":["http://bugs.gentoo.org/show_bug.cgi?id=199958","http://lists.opensuse.org/opensuse-security-announce/2008-02/msg00008.html","http://secunia.com/advisories/27777"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2007-6514","product":"smb","summary":"Apache HTTP Server, when running on Linux with a document root on a Windows share mounted using smbfs, allows remote attackers to obtain unprocessed content such as source files for .php programs via a trailing \"\\\" (backslash), which is not handled by the intended AddType directive.","details":"Apache HTTP Server, when running on Linux with a document root on a Windows share mounted using smbfs, allows remote attackers to obtain unprocessed content such as source files for .php programs via a trailing \"\\\" (backslash), which is not handled by the intended AddType directive.","references":["http://securityreason.com/securityalert/3479","http://www.securityfocus.com/archive/1/485316/100/0/threaded","http://www.securityfocus.com/bid/26939"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2008-0107","product":"smb","summary":"Integer underflow in SQL Server 7.0 SP4, 2000 SP4, 2005 SP1 and SP2, 2000 Desktop Engine (MSDE 2000) SP4, 2005 Express Edition SP1 and SP2, and 2000 Desktop Engine (WMSDE); Microsoft Data Engine (MSDE) 1.0 SP4; and Internal Database (WYukon) SP2 allows remote authenticated users to execute arbitrary code via a (1) SMB or (2) WebDAV pathname for an on-disk file (aka stored backup file) with a crafted record size value, which triggers a heap-based buffer overflow, aka \"SQL Server Memory Corruption Vulnerability.\"","details":"Integer underflow in SQL Server 7.0 SP4, 2000 SP4, 2005 SP1 and SP2, 2000 Desktop Engine (MSDE 2000) SP4, 2005 Express Edition SP1 and SP2, and 2000 Desktop Engine (WMSDE); Microsoft Data Engine (MSDE) 1.0 SP4; and Internal Database (WYukon) SP2 allows remote authenticated users to execute arbitrary code via a (1) SMB or (2) WebDAV pathname for an on-disk file (aka stored backup file) with a crafted record size value, which triggers a heap-based buffer overflow, aka \"SQL Server Memory Corruption Vulnerability.\"","references":["http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=723","http://secunia.com/advisories/30970","http://www.insomniasec.com/advisories/ISVA-080709.1.htm"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2008-0313","product":"smb","summary":"The ActiveDataInfo.LaunchProcess method in the SymAData.ActiveDataInfo.1 ActiveX control 2.7.0.1 in SYMADATA.DLL in multiple Symantec Norton products including Norton 360 1.0, AntiVirus 2006 through 2008, Internet Security 2006 through 2008, and System Works 2006 through 2008, does not properly determine the location of the AutoFix Tool, which allows remote attackers to execute arbitrary code via a remote (1) WebDAV or (2) SMB share.","details":"The ActiveDataInfo.LaunchProcess method in the SymAData.ActiveDataInfo.1 ActiveX control 2.7.0.1 in SYMADATA.DLL in multiple Symantec Norton products including Norton 360 1.0, AntiVirus 2006 through 2008, Internet Security 2006 through 2008, and System Works 2006 through 2008, does not properly determine the location of the AutoFix Tool, which allows remote attackers to execute arbitrary code via a remote (1) WebDAV or (2) SMB share.","references":["http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=678","http://secunia.com/advisories/29660","http://securityresponse.symantec.com/avcenter/security/Content/2008.04.02a.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2008-0964","product":"smb","summary":"Multiple stack-based buffer overflows in snoop on Sun Solaris 8 through 10 and OpenSolaris before snv_96, when the -o option is omitted, allow remote attackers to execute arbitrary code via a crafted SMB packet.","details":"Multiple stack-based buffer overflows in snoop on Sun Solaris 8 through 10 and OpenSolaris before snv_96, when the -o option is omitted, allow remote attackers to execute arbitrary code via a crafted SMB packet.","references":["http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=734","http://secunia.com/advisories/31386","http://secunia.com/advisories/31535"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=build_snv_95"},
  {"id":"CVE-2008-0965","product":"smb","summary":"Multiple format string vulnerabilities in snoop on Sun Solaris 8 through 10 and OpenSolaris before snv_96, when the -o option is omitted, allow remote attackers to execute arbitrary code via format string specifiers in an SMB packet.","details":"Multiple format string vulnerabilities in snoop on Sun Solaris 8 through 10 and OpenSolaris before snv_96, when the -o option is omitted, allow remote attackers to execute arbitrary code via format string specifiers in an SMB packet.","references":["http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=735","http://secunia.com/advisories/31386","http://secunia.com/advisories/31535"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=build_snv_95"},
  {"id":"CVE-2008-1105","product":"smb","summary":"Heap-based buffer overflow in the receive_smb_raw function in util/sock.c in Samba 3.0.0 through 3.0.29 allows remote attackers to execute arbitrary code via a crafted SMB response.","details":"Heap-based buffer overflow in the receive_smb_raw function in util/sock.c in Samba 3.0.0 through 3.0.29 allows remote attackers to execute arbitrary code via a crafted SMB response.","references":["http://lists.apple.com/archives/security-announce/2008//Jun/msg00002.html","http://lists.opensuse.org/opensuse-security-announce/2008-06/msg00000.html","http://lists.vmware.com/pipermail/security-announce/2008/000023.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":["<=3.0.29",">=3.0.0"]},
  {"id":"CVE-2008-2183","product":"smb","summary":"SQL injection vulnerability in index.php in SMartBlog (aka SMBlog) 1.3 allows remote attackers to execute arbitrary SQL commands via the idt parameter.","details":"SQL injection vulnerability in index.php in SMartBlog (aka SMBlog) 1.3 allows remote attackers to execute arbitrary SQL commands via the idt parameter.","references":["http://secunia.com/advisories/30057","http://www.securityfocus.com/bid/29033","https://exchange.xforce.ibmcloud.com/vulnerabilities/42190"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2008-2184","product":"smb","summary":"Multiple SQL injection vulnerabilities in SMartBlog (aka SMBlog) 1.3 allow remote attackers to execute arbitrary SQL commands via the (1) mois, (2) an, (3) jour, and (4) id parameters to index.php, and the (5) login parameter to gestion/logon.php, different vectors than CVE-2008-2183.  NOTE: the provenance of this information is unknown; the details are obtained solely from third party information.","details":"Multiple SQL injection vulnerabilities in SMartBlog (aka SMBlog) 1.3 allow remote attackers to execute arbitrary SQL commands via the (1) mois, (2) an, (3) jour, and (4) id parameters to index.php, and the (5) login parameter to gestion/logon.php, different vectors than CVE-2008-2183.  NOTE: the provenance of this information is unknown; the details are obtained solely from third party information.","references":["http://secunia.com/advisories/30057","http://www.securityfocus.com/bid/29043","https://exchange.xforce.ibmcloud.com/vulnerabilities/42190"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2008-2185","product":"smb","summary":"Directory traversal vulnerability in index.php in SMartBlog (aka SMBlog) 1.3 allows remote attackers to include arbitrary local files via directory traversal sequences in the page parameter.  NOTE: the provenance of this information is unknown; the details are obtained solely from third party information.","details":"Directory traversal vulnerability in index.php in SMartBlog (aka SMBlog) 1.3 allows remote attackers to include arbitrary local files via directory traversal sequences in the page parameter.  NOTE: the provenance of this information is unknown; the details are obtained solely from third party information.","references":["http://secunia.com/advisories/30057","http://www.securityfocus.com/bid/29043","https://exchange.xforce.ibmcloud.com/vulnerabilities/42192"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2008-3285","product":"smb","summary":"The Filesys::SmbClientParser module 2.7 and earlier for Perl allows remote SMB servers to execute arbitrary code via a folder name containing shell metacharacters.","details":"The Filesys::SmbClientParser module 2.7 and earlier for Perl allows remote SMB servers to execute arbitrary code via a folder name containing shell metacharacters.","references":["http://secunia.com/advisories/31175","http://securityreason.com/securityalert/4027","http://www.securityfocus.com/archive/1/494536/100/0/threaded"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2008-4037","product":"smb","summary":"Microsoft Windows 2000 Gold through SP4, XP Gold through SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, and Server 2008 allows remote SMB servers to execute arbitrary code on a client machine by replaying the NTLM credentials of a client user, as demonstrated by backrush, aka \"SMB Credential Reflection Vulnerability.\"  NOTE: some reliable sources report that this vulnerability exists because of an insufficient fix for CVE-2000-0834.","details":"Microsoft Windows 2000 Gold through SP4, XP Gold through SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, and Server 2008 allows remote SMB servers to execute arbitrary code on a client machine by replaying the NTLM credentials of a client user, as demonstrated by backrush, aka \"SMB Credential Reflection Vulnerability.\"  NOTE: some reliable sources report that this vulnerability exists because of an insufficient fix for CVE-2000-0834.","references":["http://marc.info/?l=bugtraq&m=122703006921213&w=2","http://marc.info/?l=bugtraq&m=122703006921213&w=2","http://osvdb.org/49736"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2008-4114","product":"smb","summary":"srv.sys in the Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, and Server 2008 allows remote attackers to cause a denial of service (system crash) or possibly have unspecified other impact via an SMB WRITE_ANDX packet with an offset that is inconsistent with the packet size, related to \"insufficiently validating the buffer size,\" as demonstrated by a request to the \\PIPE\\lsarpc named pipe, aka \"SMB Validation Denial of Service Vulnerability.\"","details":"srv.sys in the Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, and Server 2008 allows remote attackers to cause a denial of service (system crash) or possibly have unspecified other impact via an SMB WRITE_ANDX packet with an offset that is inconsistent with the packet size, related to \"insufficiently validating the buffer size,\" as demonstrated by a request to the \\PIPE\\lsarpc named pipe, aka \"SMB Validation Denial of Service Vulnerability.\"","references":["http://secunia.com/advisories/31883","http://www.reversemode.com/index.php?option=com_content&task=view&id=54&Itemid=1","http://www.securityfocus.com/archive/1/496354/100/0/threaded"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2008-4314","product":"smb","summary":"smbd in Samba 3.0.29 through 3.2.4 might allow remote attackers to read arbitrary memory and cause a denial of service via crafted (1) trans, (2) trans2, and (3) nttrans requests, related to a \"cut&paste error\" that causes an improper bounds check to be performed.","details":"smbd in Samba 3.0.29 through 3.2.4 might allow remote attackers to read arbitrary memory and cause a denial of service via crafted (1) trans, (2) trans2, and (3) nttrans requests, related to a \"cut&paste error\" that causes an improper bounds check to be performed.","references":["http://lists.opensuse.org/opensuse-security-announce/2008-12/msg00002.html","http://marc.info/?l=bugtraq&m=125003356619515&w=2","http://marc.info/?l=bugtraq&m=125003356619515&w=2"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2008-4834","product":"smb","summary":"Buffer overflow in SMB in the Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, and Server 2003 SP1 and SP2 allows remote attackers to execute arbitrary code via malformed values of unspecified \"fields inside the SMB packets\" in an NT Trans request, aka \"SMB Buffer Overflow Remote Code Execution Vulnerability.\"","details":"Buffer overflow in SMB in the Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, and Server 2003 SP1 and SP2 allows remote attackers to execute arbitrary code via malformed values of unspecified \"fields inside the SMB packets\" in an NT Trans request, aka \"SMB Buffer Overflow Remote Code Execution Vulnerability.\"","references":["http://www.securityfocus.com/archive/1/500012/100/0/threaded","http://www.securityfocus.com/bid/33121","http://www.securitytracker.com/id?1021560"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2008-4835","product":"smb","summary":"SMB in the Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, and Server 2008 allows remote attackers to execute arbitrary code via malformed values of unspecified \"fields inside the SMB packets\" in an NT Trans2 request, related to \"insufficiently validating the buffer size,\" aka \"SMB Validation Remote Code Execution Vulnerability.\"","details":"SMB in the Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, and Server 2008 allows remote attackers to execute arbitrary code via malformed values of unspecified \"fields inside the SMB packets\" in an NT Trans2 request, related to \"insufficiently validating the buffer size,\" aka \"SMB Validation Remote Code Execution Vulnerability.\"","references":["http://www.securityfocus.com/archive/1/500013/100/0/threaded","http://www.securityfocus.com/bid/33122","http://www.securitytracker.com/id?1021560"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2009-0139","product":"smb","summary":"Integer overflow in the SMB component in Apple Mac OS X 10.5.6 allows remote SMB servers to cause a denial of service (system shutdown) or execute arbitrary code via a crafted SMB file system that triggers a heap-based buffer overflow.","details":"Integer overflow in the SMB component in Apple Mac OS X 10.5.6 allows remote SMB servers to cause a denial of service (system shutdown) or execute arbitrary code via a crafted SMB file system that triggers a heap-based buffer overflow.","references":["http://lists.apple.com/archives/security-announce/2009/Feb/msg00000.html","http://secunia.com/advisories/33937","http://support.apple.com/kb/HT3438"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2009-0140","product":"smb","summary":"Unspecified vulnerability in the SMB component in Apple Mac OS X 10.4.11 and 10.5.6 allows remote SMB servers to cause a denial of service (memory exhaustion and system shutdown) via a crafted file system name.","details":"Unspecified vulnerability in the SMB component in Apple Mac OS X 10.4.11 and 10.5.6 allows remote SMB servers to cause a denial of service (memory exhaustion and system shutdown) via a crafted file system name.","references":["http://lists.apple.com/archives/security-announce/2009/Feb/msg00000.html","http://secunia.com/advisories/33937","http://support.apple.com/kb/HT3438"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2009-1439","product":"smb","summary":"Buffer overflow in fs/cifs/connect.c in CIFS in the Linux kernel 2.6.29 and earlier allows remote attackers to cause a denial of service (crash) via a long nativeFileSystem field in a Tree Connect response to an SMB mount request.","details":"Buffer overflow in fs/cifs/connect.c in CIFS in the Linux kernel 2.6.29 and earlier allows remote attackers to cause a denial of service (crash) via a long nativeFileSystem field in a Tree Connect response to an SMB mount request.","references":["http://blog.fefe.de/?ts=b72905a8","http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=b363b3304bcf68c4541683b2eff70b29f0446a5b","http://lists.opensuse.org/opensuse-security-announce/2009-05/msg00002.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=2.6.29"},
  {"id":"CVE-2009-1886","product":"smb","summary":"Multiple format string vulnerabilities in client/client.c in smbclient in Samba 3.2.0 through 3.2.12 might allow context-dependent attackers to execute arbitrary code via format string specifiers in a filename.","details":"Multiple format string vulnerabilities in client/client.c in smbclient in Samba 3.2.0 through 3.2.12 might allow context-dependent attackers to execute arbitrary code via format string specifiers in a filename.","references":["http://secunia.com/advisories/35539","http://secunia.com/advisories/35573","http://secunia.com/advisories/35606"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2009-1888","product":"smb","summary":"The acl_group_override function in smbd/posix_acls.c in smbd in Samba 3.0.x before 3.0.35, 3.1.x and 3.2.x before 3.2.13, and 3.3.x before 3.3.6, when dos filemode is enabled, allows remote attackers to modify access control lists for files via vectors related to read access to uninitialized memory.","details":"The acl_group_override function in smbd/posix_acls.c in smbd in Samba 3.0.x before 3.0.35, 3.1.x and 3.2.x before 3.2.13, and 3.3.x before 3.3.6, when dos filemode is enabled, allows remote attackers to modify access control lists for files via vectors related to read access to uninitialized memory.","references":["http://secunia.com/advisories/35539","http://secunia.com/advisories/35573","http://secunia.com/advisories/35606"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":[">=3.2.0","<=3.0.35",">=3.3.0","<3.2.13",">=3.0.31","<3.3.6"]},
  {"id":"CVE-2009-2031","product":"smb","summary":"smbfs in Sun OpenSolaris snv_84 through snv_110, when default mount permissions are used, allows local users to read arbitrary files, and list arbitrary directories, on CIFS volumes.","details":"smbfs in Sun OpenSolaris snv_84 through snv_110, when default mount permissions are used, allows local users to read arbitrary files, and list arbitrary directories, on CIFS volumes.","references":["http://sunsolve.sun.com/search/document.do?assetkey=1-66-257548-1","http://www.securityfocus.com/bid/35306","http://www.vupen.com/english/advisories/2009/1569"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2009-2484","product":"smb","summary":"Stack-based buffer overflow in the Win32AddConnection function in modules/access/smb.c in VideoLAN VLC media player 0.9.9, when running on Microsoft Windows, allows remote attackers to cause a denial of service (application crash) and possibly execute arbitrary code via a long smb URI in a playlist file.","details":"Stack-based buffer overflow in the Win32AddConnection function in modules/access/smb.c in VideoLAN VLC media player 0.9.9, when running on Microsoft Windows, allows remote attackers to cause a denial of service (application crash) and possibly execute arbitrary code via a long smb URI in a playlist file.","references":["http://git.videolan.org/?p=vlc.git%3Ba=commit%3Bh=e60a9038b13b5eb805a76755efc5c6d5e080180f","http://secunia.com/advisories/35558","http://www.exploit-db.com/exploits/9029"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2009-2526","product":"smb","summary":"Microsoft Windows Vista Gold, SP1, and SP2 and Server 2008 Gold and SP2 do not properly validate fields in SMBv2 packets, which allows remote attackers to cause a denial of service (infinite loop and system hang) via a crafted packet to the Server service, aka \"SMBv2 Infinite Loop Vulnerability.\"","details":"Microsoft Windows Vista Gold, SP1, and SP2 and Server 2008 Gold and SP2 do not properly validate fields in SMBv2 packets, which allows remote attackers to cause a denial of service (infinite loop and system hang) via a crafted packet to the Server service, aka \"SMBv2 Infinite Loop Vulnerability.\"","references":["http://www.us-cert.gov/cas/techalerts/TA09-286A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-050","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A5595"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2009-2532","product":"smb","summary":"Microsoft Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold and SP2, and Windows 7 RC do not properly process the command value in an SMB Multi-Protocol Negotiate Request packet, which allows remote attackers to execute arbitrary code via a crafted SMBv2 packet to the Server service, aka \"SMBv2 Command Value Vulnerability.\"","details":"Microsoft Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold and SP2, and Windows 7 RC do not properly process the command value in an SMB Multi-Protocol Negotiate Request packet, which allows remote attackers to execute arbitrary code via a crafted SMBv2 packet to the Server service, aka \"SMBv2 Command Value Vulnerability.\"","references":["http://www.us-cert.gov/cas/techalerts/TA09-286A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-050","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6336"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2009-2813","product":"smb","summary":"Samba 3.4 before 3.4.2, 3.3 before 3.3.8, 3.2 before 3.2.15, and 3.0.12 through 3.0.36, as used in the SMB subsystem in Apple Mac OS X 10.5.8 when Windows File Sharing is enabled, Fedora 11, and other operating systems, does not properly handle errors in resolving pathnames, which allows remote authenticated users to bypass intended sharing restrictions, and read, create, or modify files, in certain circumstances involving user accounts that lack home directories.","details":"Samba 3.4 before 3.4.2, 3.3 before 3.3.8, 3.2 before 3.2.15, and 3.0.12 through 3.0.36, as used in the SMB subsystem in Apple Mac OS X 10.5.8 when Windows File Sharing is enabled, Fedora 11, and other operating systems, does not properly handle errors in resolving pathnames, which allows remote authenticated users to bypass intended sharing restrictions, and read, create, or modify files, in certain circumstances involving user accounts that lack home directories.","references":["http://lists.apple.com/archives/security-announce/2009/Sep/msg00004.html","http://lists.opensuse.org/opensuse-security-announce/2009-10/msg00004.html","http://marc.info/?l=bugtraq&m=126514298313071&w=2"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2009-2906","product":"smb","summary":"smbd in Samba 3.0 before 3.0.37, 3.2 before 3.2.15, 3.3 before 3.3.8, and 3.4 before 3.4.2 allows remote authenticated users to cause a denial of service (infinite loop) via an unanticipated oplock break notification reply packet.","details":"smbd in Samba 3.0 before 3.0.37, 3.2 before 3.2.15, 3.3 before 3.3.8, and 3.4 before 3.4.2 allows remote authenticated users to cause a denial of service (infinite loop) via an unanticipated oplock break notification reply packet.","references":["http://lists.apple.com/archives/security-announce/2010//Mar/msg00001.html","http://lists.opensuse.org/opensuse-security-announce/2009-10/msg00004.html","http://news.samba.org/releases/3.0.37/"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":["<3.0.37",">=3.2.0","<3.3.8","<3.2.15",">=3.3.0"]},
  {"id":"CVE-2009-3103","product":"smb","summary":"Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a denial of service (system crash) via an & (ampersand) character in a Process ID High header field in a NEGOTIATE PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location, aka \"SMBv2 Negotiation Vulnerability.\" NOTE: some of these details are obtained from third party information.","details":"Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a denial of service (system crash) via an & (ampersand) character in a Process ID High header field in a NEGOTIATE PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location, aka \"SMBv2 Negotiation Vulnerability.\" NOTE: some of these details are obtained from third party information.","references":["http://archives.neohapsis.com/archives/fulldisclosure/2009-09/0090.html","http://blog.48bits.com/?p=510","http://g-laurent.blogspot.com/2009/09/windows-vista7-smb20-negotiate-protocol.html"],"severity":"UNKNOWN","match_type":"active_check","confidence":"high","required_script":"smb-vuln-ms09-050"},
  {"id":"CVE-2009-3551","product":"smb","summary":"Off-by-one error in the dissect_negprot_response function in packet-smb.c in the SMB dissector in Wireshark 1.2.0 through 1.2.2 allows remote attackers to cause a denial of service (application crash) via a file that records a malformed packet trace.  NOTE: some of these details are obtained from third party information.","details":"Off-by-one error in the dissect_negprot_response function in packet-smb.c in the SMB dissector in Wireshark 1.2.0 through 1.2.2 allows remote attackers to cause a denial of service (application crash) via a file that records a malformed packet trace.  NOTE: some of these details are obtained from third party information.","references":["http://secunia.com/advisories/37175","http://secunia.com/advisories/37409","http://www.securityfocus.com/bid/36846"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2009-3676","product":"smb","summary":"The SMB client in the kernel in Microsoft Windows Server 2008 R2 and Windows 7 allows remote SMB servers and man-in-the-middle attackers to cause a denial of service (infinite loop and system hang) via a (1) SMBv1 or (2) SMBv2 response packet that contains (a) an incorrect length value in a NetBIOS header or (b) an additional length field at the end of this response packet, aka \"SMB Client Incomplete Response Vulnerability.\"","details":"The SMB client in the kernel in Microsoft Windows Server 2008 R2 and Windows 7 allows remote SMB servers and man-in-the-middle attackers to cause a denial of service (infinite loop and system hang) via a (1) SMBv1 or (2) SMBv2 response packet that contains (a) an incorrect length value in a NetBIOS header or (b) an additional length field at the end of this response packet, aka \"SMB Client Incomplete Response Vulnerability.\"","references":["http://blogs.technet.com/msrc/archive/2009/11/13/microsoft-security-advisory-977544-released.aspx","http://g-laurent.blogspot.com/2009/11/windows-7-server-2008r2-remote-kernel.html","http://news.cnet.com/8301-27080_3-10395891-245.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2009-4377","product":"smb","summary":"The (1) SMB and (2) SMB2 dissectors in Wireshark 0.9.0 through 1.2.4 allow remote attackers to cause a denial of service (crash) via a crafted packet that triggers a NULL pointer dereference, as demonstrated by fuzz-2009-12-07-11141.pcap.","details":"The (1) SMB and (2) SMB2 dissectors in Wireshark 0.9.0 through 1.2.4 allow remote attackers to cause a denial of service (crash) via a crafted packet that triggers a NULL pointer dereference, as demonstrated by fuzz-2009-12-07-11141.pcap.","references":["http://osvdb.org/61178","http://secunia.com/advisories/37842","http://secunia.com/advisories/37916"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0016","product":"smb","summary":"The SMB client implementation in Microsoft Windows 2000 SP4, XP SP2 and SP3, and Server 2003 SP2 does not properly validate response fields, which allows remote SMB servers and man-in-the-middle attackers to execute arbitrary code via a crafted response, aka \"SMB Client Pool Corruption Vulnerability.\"","details":"The SMB client implementation in Microsoft Windows 2000 SP4, XP SP2 and SP3, and Server 2003 SP2 does not properly validate response fields, which allows remote SMB servers and man-in-the-middle attackers to execute arbitrary code via a crafted response, aka \"SMB Client Pool Corruption Vulnerability.\"","references":["http://www.us-cert.gov/cas/techalerts/TA10-040A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-006","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A8278"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0017","product":"smb","summary":"Race condition in the SMB client implementation in Microsoft Windows Server 2008 R2 and Windows 7 allows remote SMB servers and man-in-the-middle attackers to execute arbitrary code, and in the SMB client implementation in Windows Vista Gold, SP1, and SP2 and Server 2008 Gold and SP2 allows local users to gain privileges, via a crafted SMB Negotiate response, aka \"SMB Client Race Condition Vulnerability.\"","details":"Race condition in the SMB client implementation in Microsoft Windows Server 2008 R2 and Windows 7 allows remote SMB servers and man-in-the-middle attackers to execute arbitrary code, and in the SMB client implementation in Windows Vista Gold, SP1, and SP2 and Server 2008 Gold and SP2 allows local users to gain privileges, via a crafted SMB Negotiate response, aka \"SMB Client Race Condition Vulnerability.\"","references":["http://www.us-cert.gov/cas/techalerts/TA10-040A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-006","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A8298"],"severity":"UNKNOWN","match_type":"active_check","confidence":"high","required_script":"smb-vuln-ms10-012"},
  {"id":"CVE-2010-0020","product":"smb","summary":"The SMB implementation in the Server service in Microsoft Windows 2000 SP4, Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 does not properly validate request fields, which allows remote authenticated users to execute arbitrary code via a malformed request, aka \"SMB Pathname Overflow Vulnerability.\"","details":"The SMB implementation in the Server service in Microsoft Windows 2000 SP4, Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 does not properly validate request fields, which allows remote authenticated users to execute arbitrary code via a malformed request, aka \"SMB Pathname Overflow Vulnerability.\"","references":["http://www.us-cert.gov/cas/techalerts/TA10-040A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-012","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A8438"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0021","product":"smb","summary":"Multiple race conditions in the SMB implementation in the Server service in Microsoft Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 allow remote attackers to cause a denial of service (system hang) via a crafted (1) SMBv1 or (2) SMBv2 Negotiate packet, aka \"SMB Memory Corruption Vulnerability.\"","details":"Multiple race conditions in the SMB implementation in the Server service in Microsoft Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 allow remote attackers to cause a denial of service (system hang) via a crafted (1) SMBv1 or (2) SMBv2 Negotiate packet, aka \"SMB Memory Corruption Vulnerability.\"","references":["http://www.us-cert.gov/cas/techalerts/TA10-040A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-012","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A8524"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0022","product":"smb","summary":"The SMB implementation in the Server service in Microsoft Windows 2000 SP4, Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 does not properly validate the share and servername fields in SMB packets, which allows remote attackers to cause a denial of service (system hang) via a crafted packet, aka \"SMB Null Pointer Vulnerability.\"","details":"The SMB implementation in the Server service in Microsoft Windows 2000 SP4, Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 does not properly validate the share and servername fields in SMB packets, which allows remote attackers to cause a denial of service (system hang) via a crafted packet, aka \"SMB Null Pointer Vulnerability.\"","references":["http://www.us-cert.gov/cas/techalerts/TA10-040A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-012","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A8314"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0231","product":"smb","summary":"The SMB implementation in the Server service in Microsoft Windows 2000 SP4, Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 does not use a sufficient source of entropy, which allows remote attackers to obtain access to files and other SMB resources via a large number of authentication requests, related to server-generated challenges, certain \"duplicate values,\" and spoofing of an authentication token, aka \"SMB NTLM Authentication Lack of Entropy Vulnerability.\"","details":"The SMB implementation in the Server service in Microsoft Windows 2000 SP4, Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 does not use a sufficient source of entropy, which allows remote attackers to obtain access to files and other SMB resources via a large number of authentication requests, related to server-generated challenges, certain \"duplicate values,\" and spoofing of an authentication token, aka \"SMB NTLM Authentication Lack of Entropy Vulnerability.\"","references":["http://www.us-cert.gov/cas/techalerts/TA10-040A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-012","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A7751"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0266","product":"smb","summary":"Microsoft Office Outlook 2002 SP3, 2003 SP3, and 2007 SP1 and SP2 does not properly verify e-mail attachments with a PR_ATTACH_METHOD property value of ATTACH_BY_REFERENCE, which allows user-assisted remote attackers to execute arbitrary code via a crafted message, aka \"Microsoft Outlook SMB Attachment Vulnerability.\"","details":"Microsoft Office Outlook 2002 SP3, 2003 SP3, and 2007 SP1 and SP2 does not properly verify e-mail attachments with a PR_ATTACH_METHOD property value of ATTACH_BY_REFERENCE, which allows user-assisted remote attackers to execute arbitrary code via a crafted message, aka \"Microsoft Outlook SMB Attachment Vulnerability.\"","references":["http://www.us-cert.gov/cas/techalerts/TA10-194A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-045","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A11623"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0269","product":"smb","summary":"The SMB client in Microsoft Windows 2000 SP4, Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 does not properly allocate memory for SMB responses, which allows remote SMB servers and man-in-the-middle attackers to execute arbitrary code via a crafted (1) SMBv1 or (2) SMBv2 response, aka \"SMB Client Memory Allocation Vulnerability.\"","details":"The SMB client in Microsoft Windows 2000 SP4, Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 does not properly allocate memory for SMB responses, which allows remote SMB servers and man-in-the-middle attackers to execute arbitrary code via a crafted (1) SMBv1 or (2) SMBv2 response, aka \"SMB Client Memory Allocation Vulnerability.\"","references":["http://secunia.com/advisories/39372","http://www.us-cert.gov/cas/techalerts/TA10-103A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-020"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0270","product":"smb","summary":"The SMB client in Microsoft Windows Server 2008 R2 and Windows 7 does not properly validate fields in SMB transaction responses, which allows remote SMB servers and man-in-the-middle attackers to execute arbitrary code or cause a denial of service (memory corruption and reboot) via a crafted (1) SMBv1 or (2) SMBv2 response, aka \"SMB Client Transaction Vulnerability.\"","details":"The SMB client in Microsoft Windows Server 2008 R2 and Windows 7 does not properly validate fields in SMB transaction responses, which allows remote SMB servers and man-in-the-middle attackers to execute arbitrary code or cause a denial of service (memory corruption and reboot) via a crafted (1) SMBv1 or (2) SMBv2 response, aka \"SMB Client Transaction Vulnerability.\"","references":["http://secunia.com/advisories/39372","http://www.us-cert.gov/cas/techalerts/TA10-103A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-020"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0476","product":"smb","summary":"The SMB client in Microsoft Windows Server 2003 SP2, Vista Gold, SP1, and SP2, and Windows Server 2008 Gold and SP2 allows remote SMB servers and man-in-the-middle attackers to execute arbitrary code or cause a denial of service (memory corruption and reboot) via a crafted SMB transaction response that uses (1) SMBv1 or (2) SMBv2, aka \"SMB Client Response Parsing Vulnerability.\"","details":"The SMB client in Microsoft Windows Server 2003 SP2, Vista Gold, SP1, and SP2, and Windows Server 2008 Gold and SP2 allows remote SMB servers and man-in-the-middle attackers to execute arbitrary code or cause a denial of service (memory corruption and reboot) via a crafted SMB transaction response that uses (1) SMBv1 or (2) SMBv2, aka \"SMB Client Response Parsing Vulnerability.\"","references":["http://secunia.com/advisories/39372","http://www.securityfocus.com/bid/39336","http://www.us-cert.gov/cas/techalerts/TA10-103A.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0477","product":"smb","summary":"The SMB client in Microsoft Windows Server 2008 R2 and Windows 7 does not properly handle (1) SMBv1 and (2) SMBv2 response packets, which allows remote SMB servers and man-in-the-middle attackers to execute arbitrary code via a crafted packet that causes the client to read the entirety of the response, and then improperly interact with the Winsock Kernel (WSK), aka \"SMB Client Message Size Vulnerability.\"","details":"The SMB client in Microsoft Windows Server 2008 R2 and Windows 7 does not properly handle (1) SMBv1 and (2) SMBv2 response packets, which allows remote SMB servers and man-in-the-middle attackers to execute arbitrary code via a crafted packet that causes the client to read the entirety of the response, and then improperly interact with the Winsock Kernel (WSK), aka \"SMB Client Message Size Vulnerability.\"","references":["http://secunia.com/advisories/39372","http://www.us-cert.gov/cas/techalerts/TA10-103A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-020"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0547","product":"smb","summary":"client/mount.cifs.c in mount.cifs in smbfs in Samba 3.4.5 and earlier does not verify that the (1) device name and (2) mountpoint strings are composed of valid characters, which allows local users to cause a denial of service (mtab corruption) via a crafted string.","details":"client/mount.cifs.c in mount.cifs in smbfs in Samba 3.4.5 and earlier does not verify that the (1) device name and (2) mountpoint strings are composed of valid characters, which allows local users to cause a denial of service (mtab corruption) via a crafted string.","references":["http://git.samba.org/?p=samba.git%3Ba=commit%3Bh=a065c177dfc8f968775593ba00dffafeebb2e054","http://lists.opensuse.org/opensuse-security-announce/2010-04/msg00001.html","http://lists.opensuse.org/opensuse-security-announce/2010-08/msg00001.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=3.4.5"},
  {"id":"CVE-2010-0558","product":"smb","summary":"The default configuration of Oracle OpenSolaris snv_77 through snv_131 allows attackers to have an unspecified impact via vectors related to using smbadm to join a Windows Active Directory domain.","details":"The default configuration of Oracle OpenSolaris snv_77 through snv_131 allows attackers to have an unspecified impact via vectors related to using smbadm to join a Windows Active Directory domain.","references":["http://sunsolve.sun.com/search/document.do?assetkey=1-66-275790-1","http://www.securitytracker.com/id?1023545","https://exchange.xforce.ibmcloud.com/vulnerabilities/56521"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0728","product":"smb","summary":"smbd in Samba 3.3.11, 3.4.6, and 3.5.0, when libcap support is enabled, runs with the CAP_DAC_OVERRIDE capability, which allows remote authenticated users to bypass intended file permissions via standard filesystem operations with any client.","details":"smbd in Samba 3.3.11, 3.4.6, and 3.5.0, when libcap support is enabled, runs with the CAP_DAC_OVERRIDE capability, which allows remote authenticated users to bypass intended file permissions via standard filesystem operations with any client.","references":["http://lists.samba.org/archive/samba-announce/2010/000211.html","http://www.samba.org/samba/history/samba-3.3.12.html","http://www.samba.org/samba/history/samba-3.4.7.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0787","product":"smb","summary":"client/mount.cifs.c in mount.cifs in smbfs in Samba 3.0.22, 3.0.28a, 3.2.3, 3.3.2, 3.4.0, and 3.4.5 allows local users to mount a CIFS share on an arbitrary mountpoint, and gain privileges, via a symlink attack on the mountpoint directory file.","details":"client/mount.cifs.c in mount.cifs in smbfs in Samba 3.0.22, 3.0.28a, 3.2.3, 3.3.2, 3.4.0, and 3.4.5 allows local users to mount a CIFS share on an arbitrary mountpoint, and gain privileges, via a symlink attack on the mountpoint directory file.","references":["http://git.samba.org/?p=samba.git%3Ba=commit%3Bh=3ae5dac462c4ed0fb2cd94553583c56fce2f9d80","http://git.samba.org/?p=samba.git%3Ba=commit%3Bh=a0c31ec1c8d1220a5884e40d9ba6b191a04a24d5","http://lists.fedoraproject.org/pipermail/package-announce/2010-January/034444.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-0926","product":"smb","summary":"The default configuration of smbd in Samba before 3.3.11, 3.4.x before 3.4.6, and 3.5.x before 3.5.0rc3, when a writable share exists, allows remote authenticated users to leverage a directory traversal vulnerability, and access arbitrary files, by using the symlink command in smbclient to create a symlink containing .. (dot dot) sequences, related to the combination of the unix extensions and wide links options.","details":"The default configuration of smbd in Samba before 3.3.11, 3.4.x before 3.4.6, and 3.5.x before 3.5.0rc3, when a writable share exists, allows remote authenticated users to leverage a directory traversal vulnerability, and access arbitrary files, by using the symlink command in smbclient to create a symlink containing .. (dot dot) sequences, related to the combination of the unix extensions and wide links options.","references":["http://archives.neohapsis.com/archives/fulldisclosure/2010-02/0083.html","http://archives.neohapsis.com/archives/fulldisclosure/2010-02/0107.html","http://archives.neohapsis.com/archives/fulldisclosure/2010-02/0108.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-1376","product":"smb","summary":"Multiple format string vulnerabilities in Network Authorization in Apple Mac OS X 10.6 before 10.6.4 allow remote attackers to execute arbitrary code or cause a denial of service (application crash) via format string specifiers in a (1) afp, (2) cifs, or (3) smb URL.","details":"Multiple format string vulnerabilities in Network Authorization in Apple Mac OS X 10.6 before 10.6.4 allow remote attackers to execute arbitrary code or cause a denial of service (application crash) via format string specifiers in a (1) afp, (2) cifs, or (3) smb URL.","references":["http://lists.apple.com/archives/security-announce/2010//Jun/msg00001.html","http://secunia.com/advisories/40220","http://securitytracker.com/id?1024103"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-1381","product":"smb","summary":"The default configuration of SMB File Server in Apple Mac OS X 10.5.8, and 10.6 before 10.6.4, enables support for wide links, which allows remote authenticated users to access arbitrary files via vectors involving symbolic links.  NOTE: this might overlap CVE-2010-0926.","details":"The default configuration of SMB File Server in Apple Mac OS X 10.5.8, and 10.6 before 10.6.4, enables support for wide links, which allows remote authenticated users to access arbitrary files via vectors involving symbolic links.  NOTE: this might overlap CVE-2010-0926.","references":["http://lists.apple.com/archives/security-announce/2010//Jun/msg00001.html","http://secunia.com/advisories/40220","http://securitytracker.com/id?1024103"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-1635","product":"smb","summary":"The chain_reply function in process.c in smbd in Samba before 3.4.8 and 3.5.x before 3.5.2 allows remote attackers to cause a denial of service (NULL pointer dereference and process crash) via a Negotiate Protocol request with a certain 0x0003 field value followed by a Session Setup AndX request with a certain 0x8003 field value.","details":"The chain_reply function in process.c in smbd in Samba before 3.4.8 and 3.5.x before 3.5.2 allows remote attackers to cause a denial of service (NULL pointer dereference and process crash) via a Negotiate Protocol request with a certain 0x0003 field value followed by a Session Setup AndX request with a certain 0x8003 field value.","references":["http://git.samba.org/?p=samba.git%3Ba=commit%3Bh=25452a2268ac7013da28125f3df22085139af12d","http://samba.org/samba/history/samba-3.4.8.html","http://samba.org/samba/history/samba-3.5.2.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=3.4.7"},
  {"id":"CVE-2010-1642","product":"smb","summary":"The reply_sesssetup_and_X_spnego function in sesssetup.c in smbd in Samba before 3.4.8 and 3.5.x before 3.5.2 allows remote attackers to trigger an out-of-bounds read, and cause a denial of service (process crash), via a \\xff\\xff security blob length in a Session Setup AndX request.","details":"The reply_sesssetup_and_X_spnego function in sesssetup.c in smbd in Samba before 3.4.8 and 3.5.x before 3.5.2 allows remote attackers to trigger an out-of-bounds read, and cause a denial of service (process crash), via a \\xff\\xff security blob length in a Session Setup AndX request.","references":["http://git.samba.org/?p=samba.git%3Ba=commit%3Bh=9280051bfba337458722fb157f3082f93cbd9f2b","http://samba.org/samba/history/samba-3.4.8.html","http://samba.org/samba/history/samba-3.5.2.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=3.4.7"},
  {"id":"CVE-2010-1906","product":"smb","summary":"tgsrv.exe in the Repair Service in Consona Dynamic Agent, Repair Manager, Subscriber Activation, and Subscriber Agent relies on a predictable timestamp field to validate input to the \\\\.\\pipe\\__RepairService_pipe__company named pipe, which allows remote authenticated users to execute arbitrary code by obtaining the current time from (1) tcpip.sys or (2) an SMB2 service.","details":"tgsrv.exe in the Repair Service in Consona Dynamic Agent, Repair Manager, Subscriber Activation, and Subscriber Agent relies on a predictable timestamp field to validate input to the \\\\.\\pipe\\__RepairService_pipe__company named pipe, which allows remote authenticated users to execute arbitrary code by obtaining the current time from (1) tcpip.sys or (2) an SMB2 service.","references":["http://secunia.com/advisories/39752","http://wintercore.com/en/component/content/article/7-media/18-wintercore-releases-an-advisory-for-consona-products.html","http://www.consona.com/Content/CRM/Support/SecurityBulletin_April2010.pdf"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-2063","product":"smb","summary":"Buffer overflow in the SMB1 packet chaining implementation in the chain_reply function in process.c in smbd in Samba 3.0.x before 3.3.13 allows remote attackers to cause a denial of service (memory corruption and daemon crash) or possibly execute arbitrary code via a crafted field in a packet.","details":"Buffer overflow in the SMB1 packet chaining implementation in the chain_reply function in process.c in smbd in Samba 3.0.x before 3.3.13 allows remote attackers to cause a denial of service (memory corruption and daemon crash) or possibly execute arbitrary code via a crafted field in a packet.","references":["http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=873","http://lists.apple.com/archives/security-announce/2010//Aug/msg00003.html","http://lists.opensuse.org/opensuse-security-announce/2010-08/msg00001.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":["<=3.3.12",">=3.0.0"]},
  {"id":"CVE-2010-2248","product":"smb","summary":"fs/cifs/cifssmb.c in the CIFS implementation in the Linux kernel before 2.6.34-rc4 allows remote attackers to cause a denial of service (panic) via an SMB response packet with an invalid CountHigh value, as demonstrated by a response from an OS/2 server, related to the CIFSSMBWrite and CIFSSMBWrite2 functions.","details":"fs/cifs/cifssmb.c in the CIFS implementation in the Linux kernel before 2.6.34-rc4 allows remote attackers to cause a denial of service (panic) via an SMB response packet with an invalid CountHigh value, as demonstrated by a response from an OS/2 server, related to the CIFSSMBWrite and CIFSSMBWrite2 functions.","references":["http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=6513a81e9325d712f1bfb9a1d7b750134e49ff18","http://lists.opensuse.org/opensuse-security-announce/2010-12/msg00004.html","http://secunia.com/advisories/43315"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=2.6.34"},
  {"id":"CVE-2010-2283","product":"smb","summary":"The SMB dissector in Wireshark 0.99.6 through 1.0.13, and 1.2.0 through 1.2.8 allows remote attackers to cause a denial of service (NULL pointer dereference) via unknown vectors.","details":"The SMB dissector in Wireshark 0.99.6 through 1.0.13, and 1.2.0 through 1.2.8 allows remote attackers to cause a denial of service (NULL pointer dereference) via unknown vectors.","references":["http://lists.opensuse.org/opensuse-security-announce/2011-01/msg00003.html","http://lists.opensuse.org/opensuse-security-announce/2011-01/msg00006.html","http://secunia.com/advisories/40112"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-2285","product":"smb","summary":"The SMB PIPE dissector in Wireshark 0.8.20 through 1.0.13 and 1.2.0 through 1.2.8 allows remote attackers to cause a denial of service (NULL pointer dereference) via unknown vectors.","details":"The SMB PIPE dissector in Wireshark 0.8.20 through 1.0.13 and 1.2.0 through 1.2.8 allows remote attackers to cause a denial of service (NULL pointer dereference) via unknown vectors.","references":["http://lists.opensuse.org/opensuse-security-announce/2011-01/msg00003.html","http://lists.opensuse.org/opensuse-security-announce/2011-01/msg00006.html","http://secunia.com/advisories/40112"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-2347","product":"smb","summary":"The Telnet interface in the SAP J2EE Engine Core (SAP-JEECOR) 6.40 through 7.02, and Server Core (SERVERCORE) 7.10 through 7.30 allows remote authenticated users to bypass a security check and conduct SMB relay attacks via unspecified vectors.","details":"The Telnet interface in the SAP J2EE Engine Core (SAP-JEECOR) 6.40 through 7.02, and Server Core (SERVERCORE) 7.10 through 7.30 allows remote authenticated users to bypass a security check and conduct SMB relay attacks via unspecified vectors.","references":["http://archives.neohapsis.com/archives/fulldisclosure/2010-06/0371.html","http://secunia.com/advisories/40223","http://www.onapsis.com/resources/get.php?resid=adv_onapsis-2010-005"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-2351","product":"smb","summary":"Stack-based buffer overflow in the CIFS.NLM driver in Netware SMB 1.0 for Novell Netware 6.5 SP8 and earlier allows remote attackers to execute arbitrary code via a Sessions Setup AndX packet with a long AccountName.","details":"Stack-based buffer overflow in the CIFS.NLM driver in Netware SMB 1.0 for Novell Netware 6.5 SP8 and earlier allows remote attackers to execute arbitrary code via a Sessions Setup AndX packet with a long AccountName.","references":["http://download.novell.com/Download?buildid=tMWCI1cdI7s~","http://secunia.com/advisories/40199","http://www.exploit-db.com/exploits/13906"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=6.5"},
  {"id":"CVE-2010-2530","product":"smb","summary":"Multiple integer signedness errors in smb_subr.c in the netsmb module in the kernel in NetBSD 5.0.2 and earlier, FreeBSD, and Apple Mac OS X allow local users to cause a denial of service (panic) via a negative size value in a /dev/nsmb ioctl operation, as demonstrated by a (1) SMBIOC_LOOKUP or (2) SMBIOC_OPENSESSION ioctl call.","details":"Multiple integer signedness errors in smb_subr.c in the netsmb module in the kernel in NetBSD 5.0.2 and earlier, FreeBSD, and Apple Mac OS X allow local users to cause a denial of service (panic) via a negative size value in a /dev/nsmb ioctl operation, as demonstrated by a (1) SMBIOC_LOOKUP or (2) SMBIOC_OPENSESSION ioctl call.","references":["http://cvsweb.netbsd.org/bsdweb.cgi/src/sys/netsmb/smb_subr.c.diff?r1=1.34&r2=1.35&only_with_tag=MAIN&f=h","http://www.openwall.com/lists/oss-security/2010/07/12/6","http://www.openwall.com/lists/oss-security/2010/07/16/2"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=5.0.2"},
  {"id":"CVE-2010-2550","product":"smb","summary":"The SMB Server in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 does not properly validate fields in an SMB request, which allows remote attackers to execute arbitrary code via a crafted SMB packet, aka \"SMB Pool Overflow Vulnerability.\"","details":"The SMB Server in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 does not properly validate fields in an SMB request, which allows remote attackers to execute arbitrary code via a crafted SMB packet, aka \"SMB Pool Overflow Vulnerability.\"","references":["http://www.us-cert.gov/cas/techalerts/TA10-222A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-054","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A11106"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-2551","product":"smb","summary":"The SMB Server in Microsoft Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 does not properly validate an internal variable in an SMB packet, which allows remote attackers to cause a denial of service (system hang) via a crafted (1) SMBv1 or (2) SMBv2 packet, aka \"SMB Variable Validation Vulnerability.\"","details":"The SMB Server in Microsoft Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 does not properly validate an internal variable in an SMB packet, which allows remote attackers to cause a denial of service (system hang) via a crafted (1) SMBv1 or (2) SMBv2 packet, aka \"SMB Variable Validation Vulnerability.\"","references":["http://www.us-cert.gov/cas/techalerts/TA10-222A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-054","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A12015"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-2552","product":"smb","summary":"Stack consumption vulnerability in the SMB Server in Microsoft Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 allows remote attackers to cause a denial of service (system hang) via a malformed SMBv2 compounded request, aka \"SMB Stack Exhaustion Vulnerability.\"","details":"Stack consumption vulnerability in the SMB Server in Microsoft Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 allows remote attackers to cause a denial of service (system hang) via a malformed SMBv2 compounded request, aka \"SMB Stack Exhaustion Vulnerability.\"","references":["http://www.us-cert.gov/cas/techalerts/TA10-222A.html","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-054","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A12072"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2010-3076","product":"smb","summary":"The filter function in php/src/include.php in Simple Management for BIND (aka smbind) before 0.4.8 does not anchor a certain regular expression, which allows remote attackers to conduct SQL injection attacks and execute arbitrary SQL commands via the username parameter to the admin login page.","details":"The filter function in php/src/include.php in Simple Management for BIND (aka smbind) before 0.4.8 does not anchor a certain regular expression, which allows remote attackers to conduct SQL injection attacks and execute arbitrary SQL commands via the username parameter to the admin login page.","references":["http://packetstormsecurity.org/1009-exploits/smbind-sql.txt","http://sourceforge.net/projects/smbind/files/smbind/0.4.8/smbind-0.4.8.tar.bz2/download","http://www.debian.org/security/2010/dsa-2103"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=0.4.7"},
  {"id":"CVE-2010-4457","product":"smb","summary":"Unspecified vulnerability in Oracle Solaris 11 Express allows remote attackers to affect availability, related to SMB and CIFS.","details":"Unspecified vulnerability in Oracle Solaris 11 Express allows remote attackers to affect availability, related to SMB and CIFS.","references":["http://osvdb.org/70587","http://www.oracle.com/technetwork/topics/security/cpujan2011-194091.html","http://www.securityfocus.com/bid/45864"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-0660","product":"smb","summary":"The SMB client in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, R2, and R2 SP1, and Windows 7 Gold and SP1 allows remote SMB servers to execute arbitrary code via a crafted (1) SMBv1 or (2) SMBv2 response, aka \"SMB Client Response Parsing Vulnerability.\"","details":"The SMB client in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, R2, and R2 SP1, and Windows 7 Gold and SP1 allows remote SMB servers to execute arbitrary code via a crafted (1) SMBv1 or (2) SMBv2 response, aka \"SMB Client Response Parsing Vulnerability.\"","references":["http://osvdb.org/71772","http://www.securityfocus.com/bid/47239","http://www.securitytracker.com/id?1025328"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-0661","product":"smb","summary":"The SMB Server service in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, R2, and R2 SP1, and Windows 7 Gold and SP1 does not properly validate fields in SMB requests, which allows remote attackers to execute arbitrary code via a malformed request in a (1) SMBv1 or (2) SMBv2 packet, aka \"SMB Transaction Parsing Vulnerability.\"","details":"The SMB Server service in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, R2, and R2 SP1, and Windows 7 Gold and SP1 does not properly validate fields in SMB requests, which allows remote attackers to execute arbitrary code via a malformed request in a (1) SMBv1 or (2) SMBv2 packet, aka \"SMB Transaction Parsing Vulnerability.\"","references":["http://osvdb.org/71781","http://secunia.com/advisories/44072","http://www.securityfocus.com/bid/47198"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-0719","product":"smb","summary":"Samba 3.x before 3.3.15, 3.4.x before 3.4.12, and 3.5.x before 3.5.7 does not perform range checks for file descriptors before use of the FD_SET macro, which allows remote attackers to cause a denial of service (stack memory corruption, and infinite loop or daemon crash) by opening a large number of files, related to (1) Winbind or (2) smbd.","details":"Samba 3.x before 3.3.15, 3.4.x before 3.4.12, and 3.5.x before 3.5.7 does not perform range checks for file descriptors before use of the FD_SET macro, which allows remote attackers to cause a denial of service (stack memory corruption, and infinite loop or daemon crash) by opening a large number of files, related to (1) Winbind or (2) smbd.","references":["http://lists.apple.com/archives/security-announce/2011//Jun/msg00000.html","http://lists.fedoraproject.org/pipermail/package-announce/2011-March/056229.html","http://lists.fedoraproject.org/pipermail/package-announce/2011-March/056241.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-1140","product":"smb","summary":"Multiple stack consumption vulnerabilities in the dissect_ms_compressed_string and dissect_mscldap_string functions in Wireshark 1.0.x, 1.2.0 through 1.2.14, and 1.4.0 through 1.4.3 allow remote attackers to cause a denial of service (infinite recursion) via a crafted (1) SMB or (2) Connection-less LDAP (CLDAP) packet.","details":"Multiple stack consumption vulnerabilities in the dissect_ms_compressed_string and dissect_mscldap_string functions in Wireshark 1.0.x, 1.2.0 through 1.2.14, and 1.4.0 through 1.4.3 allow remote attackers to cause a denial of service (infinite recursion) via a crafted (1) SMB or (2) Connection-less LDAP (CLDAP) packet.","references":["http://anonsvn.wireshark.org/viewvc?view=rev&revision=36029","http://lists.fedoraproject.org/pipermail/package-announce/2011-March/055364.html","http://lists.fedoraproject.org/pipermail/package-announce/2011-March/055650.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-1267","product":"smb","summary":"The SMB server in Microsoft Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, R2, and R2 SP1, and Windows 7 Gold and SP1 allows remote attackers to cause a denial of service (system hang) via a crafted (1) SMBv1 or (2) SMBv2 request, aka \"SMB Request Parsing Vulnerability.\"","details":"The SMB server in Microsoft Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, R2, and R2 SP1, and Windows 7 Gold and SP1 allows remote attackers to cause a denial of service (system hang) via a crafted (1) SMBv1 or (2) SMBv2 request, aka \"SMB Request Parsing Vulnerability.\"","references":["https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-048","https://exchange.xforce.ibmcloud.com/vulnerabilities/67724","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A12654"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-1268","product":"smb","summary":"The SMB client in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, R2, and R2 SP1, and Windows 7 Gold and SP1 allows remote SMB servers to execute arbitrary code via a crafted (1) SMBv1 or (2) SMBv2 response, aka \"SMB Response Parsing Vulnerability.\"","details":"The SMB client in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, R2, and R2 SP1, and Windows 7 Gold and SP1 allows remote SMB servers to execute arbitrary code via a crafted (1) SMBv1 or (2) SMBv2 response, aka \"SMB Response Parsing Vulnerability.\"","references":["https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-043","https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A12746","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-043"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-1678","product":"smb","summary":"smbfs in Samba 3.5.8 and earlier attempts to use (1) mount.cifs to append to the /etc/mtab file and (2) umount.cifs to append to the /etc/mtab.tmp file without first checking whether resource limits would interfere, which allows local users to trigger corruption of the /etc/mtab file via a process with a small RLIMIT_FSIZE value, a related issue to CVE-2011-1089.","details":"smbfs in Samba 3.5.8 and earlier attempts to use (1) mount.cifs to append to the /etc/mtab file and (2) umount.cifs to append to the /etc/mtab.tmp file without first checking whether resource limits would interfere, which allows local users to trigger corruption of the /etc/mtab file via a process with a small RLIMIT_FSIZE value, a related issue to CVE-2011-1089.","references":["http://openwall.com/lists/oss-security/2011/03/04/10","http://openwall.com/lists/oss-security/2011/03/04/11","http://openwall.com/lists/oss-security/2011/03/04/12"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=3.5.8"},
  {"id":"CVE-2011-2724","product":"smb","summary":"The check_mtab function in client/mount.cifs.c in mount.cifs in smbfs in Samba 3.5.10 and earlier does not properly verify that the (1) device name and (2) mountpoint strings are composed of valid characters, which allows local users to cause a denial of service (mtab corruption) via a crafted string.  NOTE: this vulnerability exists because of an incorrect fix for CVE-2010-0547.","details":"The check_mtab function in client/mount.cifs.c in mount.cifs in smbfs in Samba 3.5.10 and earlier does not properly verify that the (1) device name and (2) mountpoint strings are composed of valid characters, which allows local users to cause a denial of service (mtab corruption) via a crafted string.  NOTE: this vulnerability exists because of an incorrect fix for CVE-2010-0547.","references":["http://comments.gmane.org/gmane.linux.kernel.cifs/3827","http://git.samba.org/?p=cifs-utils.git%3Ba=commit%3Bh=1e7a32924b22d1f786b6f490ce8590656f578f91","http://openwall.com/lists/oss-security/2011/07/29/9"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=3.5.10"},
  {"id":"CVE-2011-2899","product":"smb","summary":"pysmb.py in system-config-printer 0.6.x and 0.7.x, as used in foomatic-gui and possibly other products, allows remote SMB servers to execute arbitrary commands via shell metacharacters in the (1) NetBIOS or (2) workgroup name, which are not properly handled when searching for network printers.","details":"pysmb.py in system-config-printer 0.6.x and 0.7.x, as used in foomatic-gui and possibly other products, allows remote SMB servers to execute arbitrary commands via shell metacharacters in the (1) NetBIOS or (2) workgroup name, which are not properly handled when searching for network printers.","references":["http://cvs.savannah.gnu.org/viewvc/foomatic-gui/foomatic/pysmb.py?root=foomatic-gui&r1=1.2&r2=1.3&view=patch","http://secunia.com/advisories/45744","http://www.redhat.com/support/errata/RHSA-2011-1196.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-3225","product":"smb","summary":"The SMB File Server component in Apple Mac OS X 10.7 before 10.7.2 does not prevent all guest users from accessing the share point record of a guest-restricted folder, which allows remote attackers to bypass intended browsing restrictions by leveraging access to the nobody account.","details":"The SMB File Server component in Apple Mac OS X 10.7 before 10.7.2 does not prevent all guest users from accessing the share point record of a guest-restricted folder, which allows remote attackers to bypass intended browsing restrictions by leveraging access to the nobody account.","references":["http://lists.apple.com/archives/Security-announce/2011//Oct/msg00003.html","http://osvdb.org/76376","http://support.apple.com/kb/HT5002"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4733","product":"smb","summary":"The Server Administration Panel in Parallels Plesk Panel 10.2.0_build1011110331.18 sends incorrect Content-Type headers for certain resources, which might allow remote attackers to have an unspecified impact by leveraging an interpretation conflict involving smb/admin-home/disable-featured-applications-promo and certain other files.  NOTE: it is possible that only clients, not the Plesk product, could be affected by this issue.","details":"The Server Administration Panel in Parallels Plesk Panel 10.2.0_build1011110331.18 sends incorrect Content-Type headers for certain resources, which might allow remote attackers to have an unspecified impact by leveraging an interpretation conflict involving smb/admin-home/disable-featured-applications-promo and certain other files.  NOTE: it is possible that only clients, not the Plesk product, could be affected by this issue.","references":["http://xss.cx/examples/plesk-reports/plesk-redhat-el6-psa-10.2.0-build-1011110331.18-xss-sqli-cwe79-cwe89-javascript-injection-exception-example-poc-report-paros-burp-suite-pro-1.4.1.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72326","http://xss.cx/examples/plesk-reports/plesk-redhat-el6-psa-10.2.0-build-1011110331.18-xss-sqli-cwe79-cwe89-javascript-injection-exception-example-poc-report-paros-burp-suite-pro-1.4.1.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4735","product":"smb","summary":"Multiple cross-site scripting (XSS) vulnerabilities in the Control Panel in Parallels Plesk Panel 10.2.0 build 20110407.20 allow remote attackers to inject arbitrary web script or HTML via crafted input to a PHP script, as demonstrated by smb/user/create and certain other files.","details":"Multiple cross-site scripting (XSS) vulnerabilities in the Control Panel in Parallels Plesk Panel 10.2.0 build 20110407.20 allow remote attackers to inject arbitrary web script or HTML via crafted input to a PHP script, as demonstrated by smb/user/create and certain other files.","references":["http://www.kb.cert.org/vuls/id/541814","http://xss.cx/examples/plesk-reports/xss-reflected-cross-site-scripting-cwe79-capec86-plesk-parallels-control-panel-version-20110407.20.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72324"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4739","product":"smb","summary":"The Control Panel in Parallels Plesk Panel 10.2.0 build 20110407.20 generates a password form field without disabling the autocomplete feature, which makes it easier for remote attackers to bypass authentication by leveraging an unattended workstation, as demonstrated by forms in smb/my-profile and certain other files.","details":"The Control Panel in Parallels Plesk Panel 10.2.0 build 20110407.20 generates a password form field without disabling the autocomplete feature, which makes it easier for remote attackers to bypass authentication by leveraging an unattended workstation, as demonstrated by forms in smb/my-profile and certain other files.","references":["http://xss.cx/examples/plesk-reports/xss-reflected-cross-site-scripting-cwe79-capec86-plesk-parallels-control-panel-version-20110407.20.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72320","http://xss.cx/examples/plesk-reports/xss-reflected-cross-site-scripting-cwe79-capec86-plesk-parallels-control-panel-version-20110407.20.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4740","product":"smb","summary":"The Control Panel in Parallels Plesk Panel 10.2.0 build 20110407.20 generates web pages containing external links in response to GET requests with query strings for smb/app/search-data/catalogId/marketplace and certain other files, which makes it easier for remote attackers to obtain sensitive information by reading (1) web-server access logs or (2) web-server Referer logs, related to a \"cross-domain Referer leakage\" issue.","details":"The Control Panel in Parallels Plesk Panel 10.2.0 build 20110407.20 generates web pages containing external links in response to GET requests with query strings for smb/app/search-data/catalogId/marketplace and certain other files, which makes it easier for remote attackers to obtain sensitive information by reading (1) web-server access logs or (2) web-server Referer logs, related to a \"cross-domain Referer leakage\" issue.","references":["http://xss.cx/examples/plesk-reports/xss-reflected-cross-site-scripting-cwe79-capec86-plesk-parallels-control-panel-version-20110407.20.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72319","http://xss.cx/examples/plesk-reports/xss-reflected-cross-site-scripting-cwe79-capec86-plesk-parallels-control-panel-version-20110407.20.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4742","product":"smb","summary":"The Control Panel in Parallels Plesk Panel 10.2.0 build 20110407.20 has web pages containing e-mail addresses that are not intended for correspondence about the local application deployment, which allows remote attackers to obtain potentially sensitive information by reading a page, as demonstrated by smb/user/list and certain other files.","details":"The Control Panel in Parallels Plesk Panel 10.2.0 build 20110407.20 has web pages containing e-mail addresses that are not intended for correspondence about the local application deployment, which allows remote attackers to obtain potentially sensitive information by reading a page, as demonstrated by smb/user/list and certain other files.","references":["http://xss.cx/examples/plesk-reports/xss-reflected-cross-site-scripting-cwe79-capec86-plesk-parallels-control-panel-version-20110407.20.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72317","http://xss.cx/examples/plesk-reports/xss-reflected-cross-site-scripting-cwe79-capec86-plesk-parallels-control-panel-version-20110407.20.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4743","product":"smb","summary":"The Control Panel in Parallels Plesk Panel 10.2.0 build 20110407.20 omits the Content-Type header's charset parameter for certain resources, which might allow remote attackers to have an unspecified impact by leveraging an interpretation conflict involving smb/user/create and certain other files.  NOTE: it is possible that only clients, not the Plesk product, could be affected by this issue.","details":"The Control Panel in Parallels Plesk Panel 10.2.0 build 20110407.20 omits the Content-Type header's charset parameter for certain resources, which might allow remote attackers to have an unspecified impact by leveraging an interpretation conflict involving smb/user/create and certain other files.  NOTE: it is possible that only clients, not the Plesk product, could be affected by this issue.","references":["http://xss.cx/examples/plesk-reports/xss-reflected-cross-site-scripting-cwe79-capec86-plesk-parallels-control-panel-version-20110407.20.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72316","http://xss.cx/examples/plesk-reports/xss-reflected-cross-site-scripting-cwe79-capec86-plesk-parallels-control-panel-version-20110407.20.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4744","product":"smb","summary":"The Control Panel in Parallels Plesk Panel 10.2.0 build 20110407.20 sends incorrect Content-Type headers for certain resources, which might allow remote attackers to have an unspecified impact by leveraging an interpretation conflict involving smb/admin-home/featured-applications/ and certain other files.  NOTE: it is possible that only clients, not the Plesk product, could be affected by this issue.","details":"The Control Panel in Parallels Plesk Panel 10.2.0 build 20110407.20 sends incorrect Content-Type headers for certain resources, which might allow remote attackers to have an unspecified impact by leveraging an interpretation conflict involving smb/admin-home/featured-applications/ and certain other files.  NOTE: it is possible that only clients, not the Plesk product, could be affected by this issue.","references":["http://xss.cx/examples/plesk-reports/xss-reflected-cross-site-scripting-cwe79-capec86-plesk-parallels-control-panel-version-20110407.20.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72315","http://xss.cx/examples/plesk-reports/xss-reflected-cross-site-scripting-cwe79-capec86-plesk-parallels-control-panel-version-20110407.20.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4754","product":"smb","summary":"Multiple cross-site scripting (XSS) vulnerabilities in Parallels Plesk Small Business Panel 10.2.0 allow remote attackers to inject arbitrary web script or HTML via crafted input to a PHP script, as demonstrated by smb/app/available/id/apscatalog/ and certain other files.","details":"Multiple cross-site scripting (XSS) vulnerabilities in Parallels Plesk Small Business Panel 10.2.0 allow remote attackers to inject arbitrary web script or HTML via crafted input to a PHP script, as demonstrated by smb/app/available/id/apscatalog/ and certain other files.","references":["http://xss.cx/examples/plesk-reports/plesk-10.2.0.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72206","http://xss.cx/examples/plesk-reports/plesk-10.2.0.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4757","product":"smb","summary":"Parallels Plesk Small Business Panel 10.2.0 generates a password form field without disabling the autocomplete feature, which makes it easier for remote attackers to bypass authentication by leveraging an unattended workstation, as demonstrated by forms in smb/auth and certain other files.","details":"Parallels Plesk Small Business Panel 10.2.0 generates a password form field without disabling the autocomplete feature, which makes it easier for remote attackers to bypass authentication by leveraging an unattended workstation, as demonstrated by forms in smb/auth and certain other files.","references":["http://xss.cx/examples/plesk-reports/plesk-10.2.0.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72209","http://xss.cx/examples/plesk-reports/plesk-10.2.0.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4758","product":"smb","summary":"Parallels Plesk Small Business Panel 10.2.0 receives cleartext password input over HTTP, which allows remote attackers to obtain sensitive information by sniffing the network, as demonstrated by forms in smb/auth and certain other files.","details":"Parallels Plesk Small Business Panel 10.2.0 receives cleartext password input over HTTP, which allows remote attackers to obtain sensitive information by sniffing the network, as demonstrated by forms in smb/auth and certain other files.","references":["http://xss.cx/examples/plesk-reports/plesk-10.2.0.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72210","http://xss.cx/examples/plesk-reports/plesk-10.2.0.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4760","product":"smb","summary":"Parallels Plesk Small Business Panel 10.2.0 has web pages containing e-mail addresses that are not intended for correspondence about the local application deployment, which allows remote attackers to obtain potentially sensitive information by reading a page, as demonstrated by smb/email-address/list and certain other files.","details":"Parallels Plesk Small Business Panel 10.2.0 has web pages containing e-mail addresses that are not intended for correspondence about the local application deployment, which allows remote attackers to obtain potentially sensitive information by reading a page, as demonstrated by smb/email-address/list and certain other files.","references":["http://xss.cx/examples/plesk-reports/plesk-10.2.0.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72212","http://xss.cx/examples/plesk-reports/plesk-10.2.0.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4762","product":"smb","summary":"Parallels Plesk Small Business Panel 10.2.0 sends incorrect Content-Type headers for certain resources, which might allow remote attackers to have an unspecified impact by leveraging an interpretation conflict involving smb/app/top-categories-data/ and certain other files.  NOTE: it is possible that only clients, not the SmarterStats product, could be affected by this issue.","details":"Parallels Plesk Small Business Panel 10.2.0 sends incorrect Content-Type headers for certain resources, which might allow remote attackers to have an unspecified impact by leveraging an interpretation conflict involving smb/app/top-categories-data/ and certain other files.  NOTE: it is possible that only clients, not the SmarterStats product, could be affected by this issue.","references":["http://xss.cx/examples/plesk-reports/plesk-10.2.0.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72214","http://xss.cx/examples/plesk-reports/plesk-10.2.0.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2011-4853","product":"smb","summary":"The Control Panel in Parallels Plesk Panel 10.4.4_build20111103.18 includes an RFC 1918 IP address within a web page, which allows remote attackers to obtain potentially sensitive information by reading this page, as demonstrated by smb/user/list-data/items-per-page/ and certain other files.","details":"The Control Panel in Parallels Plesk Panel 10.4.4_build20111103.18 includes an RFC 1918 IP address within a web page, which allows remote attackers to obtain potentially sensitive information by reading this page, as demonstrated by smb/user/list-data/items-per-page/ and certain other files.","references":["http://xss.cx/kb/parallels/xss-parallelspleskpanel.v10.4.4_build20111103.18-os_windows-2003-2008-reflected-cross-site-scripting-cwe79-capec86-javascript-injection-example-poc-report.html","https://exchange.xforce.ibmcloud.com/vulnerabilities/72094","http://xss.cx/kb/parallels/xss-parallelspleskpanel.v10.4.4_build20111103.18-os_windows-2003-2008-reflected-cross-site-scripting-cwe79-capec86-javascript-injection-example-poc-report.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2012-0817","product":"smb","summary":"Memory leak in smbd in Samba 3.6.x before 3.6.3 allows remote attackers to cause a denial of service (memory and CPU consumption) by making many connection requests.","details":"Memory leak in smbd in Samba 3.6.x before 3.6.3 allows remote attackers to cause a denial of service (memory and CPU consumption) by making many connection requests.","references":["http://lists.fedoraproject.org/pipermail/package-announce/2012-February/072930.html","http://lists.opensuse.org/opensuse-security-announce/2012-04/msg00008.html","http://lists.opensuse.org/opensuse-security-announce/2012-04/msg00014.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2012-0870","product":"smb","summary":"Heap-based buffer overflow in process.c in smbd in Samba 3.0, as used in the file-sharing service on the BlackBerry PlayBook tablet before 2.0.0.7971 and other products, allows remote attackers to cause a denial of service (daemon crash) or possibly execute arbitrary code via a Batched (aka AndX) request that triggers infinite recursion.","details":"Heap-based buffer overflow in process.c in smbd in Samba 3.0, as used in the file-sharing service on the BlackBerry PlayBook tablet before 2.0.0.7971 and other products, allows remote attackers to cause a denial of service (daemon crash) or possibly execute arbitrary code via a Batched (aka AndX) request that triggers infinite recursion.","references":["http://btsc.webapps.blackberry.com/btsc/search.do?cmd=displayKC&docType=kc&externalId=KB29565","http://lists.apple.com/archives/security-announce/2012/May/msg00001.html","http://lists.opensuse.org/opensuse-security-announce/2012-03/msg00008.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=2.0"},
  {"id":"CVE-2012-2111","product":"smb","summary":"The (1) CreateAccount, (2) OpenAccount, (3) AddAccountRights, and (4) RemoveAccountRights LSA RPC procedures in smbd in Samba 3.4.x before 3.4.17, 3.5.x before 3.5.15, and 3.6.x before 3.6.5 do not properly restrict modifications to the privileges database, which allows remote authenticated users to obtain the \"take ownership\" privilege via an LSA connection.","details":"The (1) CreateAccount, (2) OpenAccount, (3) AddAccountRights, and (4) RemoveAccountRights LSA RPC procedures in smbd in Samba 3.4.x before 3.4.17, 3.5.x before 3.5.15, and 3.6.x before 3.6.5 do not properly restrict modifications to the privileges database, which allows remote authenticated users to obtain the \"take ownership\" privilege via an LSA connection.","references":["http://lists.fedoraproject.org/pipermail/package-announce/2012-May/079662.html","http://lists.fedoraproject.org/pipermail/package-announce/2012-May/079670.html","http://lists.fedoraproject.org/pipermail/package-announce/2012-May/079677.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2012-4603","product":"smb","summary":"Citrix XenApp Online Plug-in for Windows 12.1 and earlier, and Citrix Receiver for Windows 3.2 and earlier could allow remote attackers to execute arbitrary code by convincing a target to open a specially crafted file from an SMB or WebDAV fileserver.","details":"Citrix XenApp Online Plug-in for Windows 12.1 and earlier, and Citrix Receiver for Windows 3.2 and earlier could allow remote attackers to execute arbitrary code by convincing a target to open a specially crafted file from an SMB or WebDAV fileserver.","references":["http://www.securityfocus.com/bid/55518","http://www.securitytracker.com/id?1027521","http://www.securitytracker.com/id?1027522"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<=3.2"],["<=12.1"]]},
  {"id":"CVE-2013-0454","product":"smb","summary":"The SMB2 implementation in Samba 3.6.x before 3.6.6, as used on the IBM Storwize V7000 Unified 1.3 before 1.3.2.3 and 1.4 before 1.4.0.1 and possibly other products, does not properly enforce CIFS share attributes, which allows remote authenticated users to (1) write to a read-only share; (2) trigger data-integrity problems related to the oplock, locking, coherency, or leases attribute; or (3) have an unspecified impact by leveraging incorrect handling of the browseable or \"hide unreadable\" parameter.","details":"The SMB2 implementation in Samba 3.6.x before 3.6.6, as used on the IBM Storwize V7000 Unified 1.3 before 1.3.2.3 and 1.4 before 1.4.0.1 and possibly other products, does not properly enforce CIFS share attributes, which allows remote authenticated users to (1) write to a read-only share; (2) trigger data-integrity problems related to the oplock, locking, coherency, or leases attribute; or (3) have an unspecified impact by leveraging incorrect handling of the browseable or \"hide unreadable\" parameter.","references":["http://www.ibm.com/support/docview.wss?uid=ssg1S1004289","http://www.ubuntu.com/usn/USN-1802-1","https://bugzilla.redhat.com/show_bug.cgi?id=928419"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=3.6.5"},
  {"id":"CVE-2013-0990","product":"smb","summary":"SMB in Apple Mac OS X before 10.8.4, when file sharing is enabled, allows remote authenticated users to create or modify files outside of a shared directory via unspecified vectors.","details":"SMB in Apple Mac OS X before 10.8.4, when file sharing is enabled, allows remote authenticated users to create or modify files outside of a shared directory via unspecified vectors.","references":["http://lists.apple.com/archives/security-announce/2013/Jun/msg00000.html","http://support.apple.com/kb/HT5784","http://lists.apple.com/archives/security-announce/2013/Jun/msg00000.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=10.8.3"},
  {"id":"CVE-2013-3302","product":"smb","summary":"Race condition in the smb_send_rqst function in fs/cifs/transport.c in the Linux kernel before 3.7.2 allows local users to cause a denial of service (NULL pointer dereference and OOPS) or possibly have unspecified other impact via vectors involving a reconnection event.","details":"Race condition in the smb_send_rqst function in fs/cifs/transport.c in the Linux kernel before 3.7.2 allows local users to cause a denial of service (NULL pointer dereference and OOPS) or possibly have unspecified other impact via vectors involving a reconnection event.","references":["http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=ea702b80e0bbb2448e201472127288beb82ca2fe","http://www.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.7.2","http://www.openwall.com/lists/oss-security/2013/04/15/2"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=3.7.1"},
  {"id":"CVE-2013-4124","product":"smb","summary":"Integer overflow in the read_nttrans_ea_list function in nttrans.c in smbd in Samba 3.x before 3.5.22, 3.6.x before 3.6.17, and 4.x before 4.0.8 allows remote attackers to cause a denial of service (memory consumption) via a malformed packet.","details":"Integer overflow in the read_nttrans_ea_list function in nttrans.c in smbd in Samba 3.x before 3.5.22, 3.6.x before 3.6.17, and 4.x before 4.0.8 allows remote attackers to cause a denial of service (memory consumption) via a malformed packet.","references":["http://archives.neohapsis.com/archives/bugtraq/2013-08/0028.html","http://ftp.samba.org/pub/samba/patches/security/samba-4.0.7-CVE-2013-4124.patch","http://lists.fedoraproject.org/pipermail/package-announce/2013-August/113591.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2013-4655","product":"smb","summary":"Symlink Traversal vulnerability in Belkin N900 due to misconfiguration in the SMB service.","details":"Symlink Traversal vulnerability in Belkin N900 due to misconfiguration in the SMB service.","references":["https://www.ise.io/casestudies/exploiting-soho-routers/","https://www.ise.io/soho_service_hacks/","https://www.ise.io/wp-content/uploads/2017/07/soho_techreport.pdf"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2013-4656","product":"smb","summary":"Symlink Traversal vulnerability in ASUS RT-AC66U and RT-N56U due to misconfiguration in the SMB service.","details":"Symlink Traversal vulnerability in ASUS RT-AC66U and RT-N56U due to misconfiguration in the SMB service.","references":["https://www.ise.io/casestudies/exploiting-soho-routers/","https://www.ise.io/soho_service_hacks/","https://www.ise.io/wp-content/uploads/2017/07/soho_techreport.pdf"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2013-4657","product":"smb","summary":"Symlink Traversal vulnerability in NETGEAR WNR3500U and WNR3500L due to misconfiguration in the SMB service.","details":"Symlink Traversal vulnerability in NETGEAR WNR3500U and WNR3500L due to misconfiguration in the SMB service.","references":["https://www.ise.io/soho_service_hacks/","https://www.ise.io/soho_service_hacks/"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2013-4658","product":"smb","summary":"Linksys EA6500 has SMB Symlink Traversal allowing symbolic links to be created to locations outside of the Samba share.","details":"Linksys EA6500 has SMB Symlink Traversal allowing symbolic links to be created to locations outside of the Samba share.","references":["https://www.ise.io/casestudies/exploiting-soho-routers/","https://www.ise.io/soho_service_hacks/","https://www.ise.io/wp-content/uploads/2017/06/soho_defcon21.pdf"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2013-4855","product":"smb","summary":"D-Link DIR-865L has SMB Symlink Traversal due to misconfiguration in the SMB service allowing symbolic links to be created to locations outside of the Samba share.","details":"D-Link DIR-865L has SMB Symlink Traversal due to misconfiguration in the SMB service allowing symbolic links to be created to locations outside of the Samba share.","references":["https://www.ise.io/casestudies/exploiting-soho-routers/","https://www.ise.io/soho_service_hacks/","https://www.ise.io/wp-content/uploads/2017/06/soho_defcon21.pdf"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2013-5223","product":"smb","summary":"Multiple cross-site scripting (XSS) vulnerabilities in D-Link DSL-2760U Gateway (Rev. E1) allow remote authenticated users to inject arbitrary web script or HTML via the (1) ntpServer1 parameter to sntpcfg.cgi, username parameter to (2) ddnsmngr.cmd or (3) todmngr.tod, (4) TodUrlAdd parameter to urlfilter.cmd, (5) appName parameter to scprttrg.cmd, (6) fltName in an add action or (7) rmLst parameter in a remove action to scoutflt.cmd, (8) groupName parameter to portmapcfg.cmd, (9) snmpRoCommunity parameter to snmpconfig.cgi, (10) fltName parameter to scinflt.cmd, (11) PolicyName in an add action or (12) rmLst parameter in a remove action to prmngr.cmd, (13) ippName parameter to ippcfg.cmd, (14) smbNetBiosName or (15) smbDirName parameter to samba.cgi, or (16) wlSsid parameter to wlcfg.wl.","details":"Multiple cross-site scripting (XSS) vulnerabilities in D-Link DSL-2760U Gateway (Rev. E1) allow remote authenticated users to inject arbitrary web script or HTML via the (1) ntpServer1 parameter to sntpcfg.cgi, username parameter to (2) ddnsmngr.cmd or (3) todmngr.tod, (4) TodUrlAdd parameter to urlfilter.cmd, (5) appName parameter to scprttrg.cmd, (6) fltName in an add action or (7) rmLst parameter in a remove action to scoutflt.cmd, (8) groupName parameter to portmapcfg.cmd, (9) snmpRoCommunity parameter to snmpconfig.cgi, (10) fltName parameter to scinflt.cmd, (11) PolicyName in an add action or (12) rmLst parameter in a remove action to prmngr.cmd, (13) ippName parameter to ippcfg.cmd, (14) smbNetBiosName or (15) smbDirName parameter to samba.cgi, or (16) wlSsid parameter to wlcfg.wl.","references":["http://osvdb.org/99603","http://osvdb.org/99604","http://osvdb.org/99605"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<1.12"},
  {"id":"CVE-2013-6442","product":"smb","summary":"The owner_set function in smbcacls.c in smbcacls in Samba 4.0.x before 4.0.16 and 4.1.x before 4.1.6 removes an ACL during use of a --chown or --chgrp option, which allows remote attackers to bypass intended access restrictions in opportunistic circumstances by leveraging an unintended administrative change.","details":"The owner_set function in smbcacls.c in smbcacls in Samba 4.0.x before 4.0.16 and 4.1.x before 4.1.6 removes an ACL during use of a --chown or --chgrp option, which allows remote attackers to bypass intended access restrictions in opportunistic circumstances by leveraging an unintended administrative change.","references":["http://lists.fedoraproject.org/pipermail/package-announce/2014-August/136864.html","http://lists.fedoraproject.org/pipermail/package-announce/2014-June/134717.html","http://lists.opensuse.org/opensuse-updates/2014-03/msg00062.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2014-2388","product":"smb","summary":"The Storage and Access service in BlackBerry OS 10.x before 10.2.1.1925 on Q5, Q10, Z10, and Z30 devices does not enforce the password requirement for SMB filesystem access, which allows context-dependent attackers to read arbitrary files via (1) a session over a Wi-Fi network or (2) a session over a USB connection in Development Mode.","details":"The Storage and Access service in BlackBerry OS 10.x before 10.2.1.1925 on Q5, Q10, Z10, and Z30 devices does not enforce the password requirement for SMB filesystem access, which allows context-dependent attackers to read arbitrary files via (1) a session over a Wi-Fi network or (2) a session over a USB connection in Development Mode.","references":["http://packetstormsecurity.com/files/127850","http://packetstormsecurity.com/files/127850/BlackBerry-Z10-Authentication-Bypass.html","http://secunia.com/advisories/60156"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=10.1.0.2354"},
  {"id":"CVE-2014-2581","product":"smb","summary":"Smb4K before 1.1.1 allows remote attackers to obtain credentials via vectors related to the cuid option in the \"Additional options\" line edit.","details":"Smb4K before 1.1.1 allows remote attackers to obtain credentials via vectors related to the cuid option in the \"Additional options\" line edit.","references":["http://lists.fedoraproject.org/pipermail/package-announce/2014-June/133898.html","http://lists.fedoraproject.org/pipermail/package-announce/2014-June/133901.html","http://sourceforge.net/projects/smb4k/files/1.1.1/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<1.1.1"},
  {"id":"CVE-2014-3493","product":"smb","summary":"The push_ascii function in smbd in Samba 3.6.x before 3.6.24, 4.0.x before 4.0.19, and 4.1.x before 4.1.9 allows remote authenticated users to cause a denial of service (memory corruption and daemon crash) via an attempt to read a Unicode pathname without specifying use of Unicode, leading to a character-set conversion failure that triggers an invalid pointer dereference.","details":"The push_ascii function in smbd in Samba 3.6.x before 3.6.24, 4.0.x before 4.0.19, and 4.1.x before 4.1.9 allows remote authenticated users to cause a denial of service (memory corruption and daemon crash) via an attempt to read a Unicode pathname without specifying use of Unicode, leading to a character-set conversion failure that triggers an invalid pointer dereference.","references":["http://advisories.mageia.org/MGASA-2014-0279.html","http://linux.oracle.com/errata/ELSA-2014-0866.html","http://lists.fedoraproject.org/pipermail/package-announce/2014-August/136864.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2014-3641","product":"smb","summary":"The (1) GlusterFS and (2) Linux Smbfs drivers in OpenStack Cinder before 2014.1.3 allows remote authenticated users to obtain file data from the Cinder-volume host by cloning and attaching a volume with a crafted qcow2 header.","details":"The (1) GlusterFS and (2) Linux Smbfs drivers in OpenStack Cinder before 2014.1.3 allows remote authenticated users to obtain file data from the Cinder-volume host by cloning and attaching a volume with a crafted qcow2 header.","references":["http://rhn.redhat.com/errata/RHSA-2014-1787.html","http://rhn.redhat.com/errata/RHSA-2014-1788.html","http://seclists.org/oss-sec/2014/q4/78"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=2014.1.2"},
  {"id":"CVE-2014-4275","product":"smb","summary":"Unspecified vulnerability in Oracle Sun Solaris 11 allows local users to affect availability via vectors related to SMB server kernel module.","details":"Unspecified vulnerability in Oracle Sun Solaris 11 allows local users to affect availability via vectors related to SMB server kernel module.","references":["http://secunia.com/advisories/61593","http://www.oracle.com/technetwork/topics/security/cpuoct2014-1972960.html","http://www.securityfocus.com/bid/70559"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2014-6490","product":"smb","summary":"Unspecified vulnerability in Oracle Sun Solaris 11 allows remote attackers to affect availability via vectors related to SMB server user component.","details":"Unspecified vulnerability in Oracle Sun Solaris 11 allows remote attackers to affect availability via vectors related to SMB server user component.","references":["http://secunia.com/advisories/61593","http://www.oracle.com/technetwork/topics/security/cpuoct2014-1972960.html","http://www.securityfocus.com/bid/70503"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2014-7145","product":"smb","summary":"The SMB2_tcon function in fs/cifs/smb2pdu.c in the Linux kernel before 3.16.3 allows remote CIFS servers to cause a denial of service (NULL pointer dereference and client system crash) or possibly have unspecified other impact by deleting the IPC$ share during resolution of DFS referrals.","details":"The SMB2_tcon function in fs/cifs/smb2pdu.c in the Linux kernel before 3.16.3 allows remote CIFS servers to cause a denial of service (NULL pointer dereference and client system crash) or possibly have unspecified other impact by deleting the IPC$ share during resolution of DFS referrals.","references":["http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=18f39e7be0121317550d03e267e3ebd4dbfbb3ce","http://rhn.redhat.com/errata/RHSA-2015-0102.html","http://www.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.16.3"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":["<3.14.19","<3.12.29",">=3.13",">=3.6",">=3.11","<3.10.55","<3.16.3",">=3.15"]},
  {"id":"CVE-2014-8600","product":"smb","summary":"Multiple cross-site scripting (XSS) vulnerabilities in KDE-Runtime 4.14.3 and earlier, kwebkitpart 1.3.4 and earlier, and kio-extras 5.1.1 and earlier allow remote attackers to inject arbitrary web script or HTML via a crafted URI using the (1) zip, (2) trash, (3) tar, (4) thumbnail, (5) smtps, (6) smtp, (7) smb, (8) remote, (9) recentdocuments, (10) nntps, (11) nntp, (12) network, (13) mbox, (14) ldaps, (15) ldap, (16) fonts, (17) file, (18) desktop, (19) cgi, (20) bookmarks, or (21) ar scheme, which is not properly handled in an error message.","details":"Multiple cross-site scripting (XSS) vulnerabilities in KDE-Runtime 4.14.3 and earlier, kwebkitpart 1.3.4 and earlier, and kio-extras 5.1.1 and earlier allow remote attackers to inject arbitrary web script or HTML via a crafted URI using the (1) zip, (2) trash, (3) tar, (4) thumbnail, (5) smtps, (6) smtp, (7) smb, (8) remote, (9) recentdocuments, (10) nntps, (11) nntp, (12) network, (13) mbox, (14) ldaps, (15) ldap, (16) fonts, (17) file, (18) desktop, (19) cgi, (20) bookmarks, or (21) ar scheme, which is not properly handled in an error message.","references":["http://lists.opensuse.org/opensuse-updates/2015-03/msg00068.html","http://seclists.org/fulldisclosure/2014/Nov/54","http://ubuntu.com/usn/usn-2414-1"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":[["<=4.14.2"],["<=1.3.3"],["<=5.1.1"]]},
  {"id":"CVE-2015-0240","product":"smb","summary":"The Netlogon server implementation in smbd in Samba 3.5.x and 3.6.x before 3.6.25, 4.0.x before 4.0.25, 4.1.x before 4.1.17, and 4.2.x before 4.2.0rc5 performs a free operation on an uninitialized stack pointer, which allows remote attackers to execute arbitrary code via crafted Netlogon packets that use the ServerPasswordSet RPC API, as demonstrated by packets reaching the _netr_ServerPasswordSet function in rpc_server/netlogon/srv_netlog_nt.c.","details":"The Netlogon server implementation in smbd in Samba 3.5.x and 3.6.x before 3.6.25, 4.0.x before 4.0.25, 4.1.x before 4.1.17, and 4.2.x before 4.2.0rc5 performs a free operation on an uninitialized stack pointer, which allows remote attackers to execute arbitrary code via crafted Netlogon packets that use the ServerPasswordSet RPC API, as demonstrated by packets reaching the _netr_ServerPasswordSet function in rpc_server/netlogon/srv_netlog_nt.c.","references":["http://advisories.mageia.org/MGASA-2015-0084.html","http://lists.opensuse.org/opensuse-security-announce/2015-02/msg00028.html","http://lists.opensuse.org/opensuse-security-announce/2015-02/msg00030.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2015-0730","product":"smb","summary":"The SMB module in Cisco Wide Area Application Services (WAAS) 6.0(1) allows remote attackers to cause a denial of service (module reload) via an invalid field in a Negotiate Protocol request, aka Bug ID CSCuo75645.","details":"The SMB module in Cisco Wide Area Application Services (WAAS) 6.0(1) allows remote attackers to cause a denial of service (module reload) via an invalid field in a Negotiate Protocol request, aka Bug ID CSCuo75645.","references":["http://tools.cisco.com/security/center/viewAlert.x?alertId=38865","http://www.securitytracker.com/id/1032339","http://tools.cisco.com/security/center/viewAlert.x?alertId=38865"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2015-2704","product":"smb","summary":"realmd allows remote attackers to inject arbitrary configurations in to sssd.conf and smb.conf via a newline character in an LDAP response.","details":"realmd allows remote attackers to inject arbitrary configurations in to sssd.conf and smb.conf via a newline character in an LDAP response.","references":["http://lists.fedoraproject.org/pipermail/package-announce/2015-April/155862.html","http://lists.fedoraproject.org/pipermail/package-announce/2015-May/157358.html","http://www.oracle.com/technetwork/topics/security/linuxbulletinoct2015-2719645.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=15.2"},
  {"id":"CVE-2015-3237","product":"smb","summary":"The smb_request_state function in cURL and libcurl 7.40.0 through 7.42.1 allows remote SMB servers to obtain sensitive information from memory or cause a denial of service (out-of-bounds read and crash) via crafted length and offset values.","details":"The smb_request_state function in cURL and libcurl 7.40.0 through 7.42.1 allows remote SMB servers to obtain sensitive information from memory or cause a denial of service (out-of-bounds read and crash) via crafted length and offset values.","references":["http://curl.haxx.se/docs/adv_20150617B.html","http://lists.fedoraproject.org/pipermail/package-announce/2015-June/160660.html","http://www.oracle.com/technetwork/security-advisory/cpujul2016-2881720.html"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=7.5.3.1"},
  {"id":"CVE-2015-3773","product":"smb","summary":"The SMB client in Apple OS X before 10.10.5 allows remote attackers to execute arbitrary code or cause a denial of service (memory corruption and application crash) via unspecified vectors.","details":"The SMB client in Apple OS X before 10.10.5 allows remote attackers to execute arbitrary code or cause a denial of service (memory corruption and application crash) via unspecified vectors.","references":["http://lists.apple.com/archives/security-announce/2015/Aug/msg00001.html","http://www.securityfocus.com/bid/76340","http://www.securitytracker.com/id/1033276"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=10.10.4"},
  {"id":"CVE-2015-4718","product":"smb","summary":"The external SMB storage driver in ownCloud Server before 6.0.8, 7.0.x before 7.0.6, and 8.0.x before 8.0.4 allows remote authenticated users to execute arbitrary SMB commands via a ; (semicolon) character in a file.","details":"The external SMB storage driver in ownCloud Server before 6.0.8, 7.0.x before 7.0.6, and 8.0.x before 8.0.4 allows remote authenticated users to execute arbitrary SMB commands via a ; (semicolon) character in a file.","references":["http://www.debian.org/security/2015/dsa-3373","http://www.securityfocus.com/bid/76162","https://owncloud.org/security/advisory/?id=oc-sa-2015-008"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=6.0.7"},
  {"id":"CVE-2015-4849","product":"smb","summary":"Unspecified vulnerability in the Oracle Payments component in Oracle E-Business Suite 11.5.10.2, 12.0.6, 12.1.3, 12.2.3, and 12.2.4 allows remote attackers to affect confidentiality, integrity, and availability via unknown vectors related to Punch-in. NOTE: the previous information is from the October 2015 CPU. Oracle has not commented on third-party claims that this issue is an XML External Entity (XXE) vulnerability, which allows remote attackers to cause a denial of service or conduct SMB Relay attacks via a crafted DTD in an XML request to OA_HTML/IspPunchInServlet.","details":"Unspecified vulnerability in the Oracle Payments component in Oracle E-Business Suite 11.5.10.2, 12.0.6, 12.1.3, 12.2.3, and 12.2.4 allows remote attackers to affect confidentiality, integrity, and availability via unknown vectors related to Punch-in. NOTE: the previous information is from the October 2015 CPU. Oracle has not commented on third-party claims that this issue is an XML External Entity (XXE) vulnerability, which allows remote attackers to cause a denial of service or conduct SMB Relay attacks via a crafted DTD in an XML request to OA_HTML/IspPunchInServlet.","references":["http://packetstormsecurity.com/files/134118/Oracle-E-Business-Suite-12.1.3-XXE-Injection.html","http://seclists.org/fulldisclosure/2015/Oct/112","http://www.oracle.com/technetwork/topics/security/cpuoct2015-2367953.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2015-4851","product":"smb","summary":"Unspecified vulnerability in the Oracle iSupplier Portal component in Oracle E-Business Suite 12.0.6, 12.1.3, 12.2.3, and 12.2.4 allows remote attackers to affect confidentiality, integrity, and availability via vectors related to XML input.  NOTE: the previous information is from the October 2015 CPU. Oracle has not commented on third-party claims that this issue is an XML External Entity (XXE) vulnerability, which allows remote attackers to read arbitrary files, cause a denial of service, or conduct SMB Relay attacks via a crafted DTD in an XML request to OA_HTML/oramipp_lpr.","details":"Unspecified vulnerability in the Oracle iSupplier Portal component in Oracle E-Business Suite 12.0.6, 12.1.3, 12.2.3, and 12.2.4 allows remote attackers to affect confidentiality, integrity, and availability via vectors related to XML input.  NOTE: the previous information is from the October 2015 CPU. Oracle has not commented on third-party claims that this issue is an XML External Entity (XXE) vulnerability, which allows remote attackers to read arbitrary files, cause a denial of service, or conduct SMB Relay attacks via a crafted DTD in an XML request to OA_HTML/oramipp_lpr.","references":["http://packetstormsecurity.com/files/134119/Oracle-E-Business-Suite-12.1.3-XXE-Injection.html","http://seclists.org/fulldisclosure/2015/Oct/113","http://www.oracle.com/technetwork/topics/security/cpuoct2015-2367953.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2015-4886","product":"smb","summary":"Unspecified vulnerability in the Oracle Report Manager component in Oracle E-Business Suite 11.5.10.2, 12.0.6, 12.1.3, 12.2.3, and 12.2.4 allows remote attackers to affect confidentiality and integrity via unknown vectors related to Reports Security.  NOTE: the previous information is from the October 2015 CPU. Oracle has not commented on third-party claims that this issue is an XML External Entity (XXE) vulnerability, which allows remote attackers to read arbitrary files, cause a denial of service, or conduct SMB Relay attacks via a crafted DTD in an XML request involving the OA_HTML/copxml servlet.","details":"Unspecified vulnerability in the Oracle Report Manager component in Oracle E-Business Suite 11.5.10.2, 12.0.6, 12.1.3, 12.2.3, and 12.2.4 allows remote attackers to affect confidentiality and integrity via unknown vectors related to Reports Security.  NOTE: the previous information is from the October 2015 CPU. Oracle has not commented on third-party claims that this issue is an XML External Entity (XXE) vulnerability, which allows remote attackers to read arbitrary files, cause a denial of service, or conduct SMB Relay attacks via a crafted DTD in an XML request involving the OA_HTML/copxml servlet.","references":["http://packetstormsecurity.com/files/134117/Oracle-E-Business-Suite-12.1.3-XXE-Injection.html","http://seclists.org/fulldisclosure/2015/Oct/111","http://www.oracle.com/technetwork/topics/security/cpuoct2015-2367953.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2015-5252","product":"smb","summary":"vfs.c in smbd in Samba 3.x and 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3, when share names with certain substring relationships exist, allows remote attackers to bypass intended file-access restrictions via a symlink that points outside of a share.","details":"vfs.c in smbd in Samba 3.x and 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3, when share names with certain substring relationships exist, allows remote attackers to bypass intended file-access restrictions via a symlink that points outside of a share.","references":["http://lists.fedoraproject.org/pipermail/package-announce/2015-December/174076.html","http://lists.fedoraproject.org/pipermail/package-announce/2015-December/174391.html","http://lists.opensuse.org/opensuse-security-announce/2015-12/msg00019.html"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<4.1.22",">=4.2.0","<4.3.3",">=4.3.0","<4.2.7"],[">=3.0.0"]]},
  {"id":"CVE-2015-5296","product":"smb","summary":"Samba 3.x and 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3 supports connections that are encrypted but unsigned, which allows man-in-the-middle attackers to conduct encrypted-to-unencrypted downgrade attacks by modifying the client-server data stream, related to clidfs.c, libsmb_server.c, and smbXcli_base.c.","details":"Samba 3.x and 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3 supports connections that are encrypted but unsigned, which allows man-in-the-middle attackers to conduct encrypted-to-unencrypted downgrade attacks by modifying the client-server data stream, related to clidfs.c, libsmb_server.c, and smbXcli_base.c.","references":["http://lists.fedoraproject.org/pipermail/package-announce/2015-December/174076.html","http://lists.fedoraproject.org/pipermail/package-announce/2015-December/174391.html","http://lists.opensuse.org/opensuse-security-announce/2015-12/msg00019.html"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[[">=3.2.0"],["<4.1.22",">=4.2.0","<4.3.3",">=4.3.0","<4.2.7"]]},
  {"id":"CVE-2015-5891","product":"smb","summary":"The SMB implementation in the kernel in Apple OS X before 10.11 allows local users to gain privileges or cause a denial of service (memory corruption) via unspecified vectors.","details":"The SMB implementation in the kernel in Apple OS X before 10.11 allows local users to gain privileges or cause a denial of service (memory corruption) via unspecified vectors.","references":["http://lists.apple.com/archives/security-announce/2015/Sep/msg00008.html","http://www.securityfocus.com/bid/76908","http://www.securitytracker.com/id/1033703"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=10.10.5"},
  {"id":"CVE-2015-5893","product":"smb","summary":"SMBClient in SMB in Apple OS X before 10.11 allows local users to obtain sensitive kernel memory-layout information via unspecified vectors.","details":"SMBClient in SMB in Apple OS X before 10.11 allows local users to obtain sensitive kernel memory-layout information via unspecified vectors.","references":["http://lists.apple.com/archives/security-announce/2015/Sep/msg00008.html","http://www.securityfocus.com/bid/76908","http://www.securitytracker.com/id/1033703"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=10.10.5"},
  {"id":"CVE-2015-5913","product":"smb","summary":"Heimdal, as used in Apple OS X before 10.11, allows remote attackers to conduct replay attacks against the SMB server via packet data that represents a Kerberos authenticated request.","details":"Heimdal, as used in Apple OS X before 10.11, allows remote attackers to conduct replay attacks against the SMB server via packet data that represents a Kerberos authenticated request.","references":["http://lists.apple.com/archives/security-announce/2015/Sep/msg00008.html","http://www.securitytracker.com/id/1033703","https://support.apple.com/HT205267"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=10.10.5"},
  {"id":"CVE-2015-5920","product":"smb","summary":"The Software Update component in Apple iTunes before 12.3 does not properly handle redirection, which allows man-in-the-middle attackers to discover encrypted SMB credentials via unspecified vectors.","details":"The Software Update component in Apple iTunes before 12.3 does not properly handle redirection, which allows man-in-the-middle attackers to discover encrypted SMB credentials via unspecified vectors.","references":["http://lists.apple.com/archives/security-announce/2015/Sep/msg00003.html","http://www.securitytracker.com/id/1033617","https://support.apple.com/HT205221"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":"<=12.2"},
  {"id":"CVE-2015-7560","product":"smb","summary":"The SMB1 implementation in smbd in Samba 3.x and 4.x before 4.1.23, 4.2.x before 4.2.9, 4.3.x before 4.3.6, and 4.4.x before 4.4.0rc4 allows remote authenticated users to modify arbitrary ACLs by using a UNIX SMB1 call to create a symlink, and then using a non-UNIX SMB1 call to write to the ACL content.","details":"The SMB1 implementation in smbd in Samba 3.x and 4.x before 4.1.23, 4.2.x before 4.2.9, 4.3.x before 4.3.6, and 4.4.x before 4.4.0rc4 allows remote authenticated users to modify arbitrary ACLs by using a UNIX SMB1 call to create a symlink, and then using a non-UNIX SMB1 call to write to the ACL content.","references":["http://lists.fedoraproject.org/pipermail/package-announce/2016-March/178730.html","http://lists.fedoraproject.org/pipermail/package-announce/2016-March/178764.html","http://lists.fedoraproject.org/pipermail/package-announce/2016-March/180000.html"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[[">=3.2.0"],["<4.3.6","<4.2.9",">=4.2.0",">=4.3.0","<4.1.23"]]},
  {"id":"CVE-2015-7698","product":"smb","summary":"icewind1991 SMB before 1.0.3 allows remote authenticated users to execute arbitrary SMB commands via shell metacharacters in the user argument in the (1) listShares function in Server.php or the (2) connect or (3) read function in Share.php.","details":"icewind1991 SMB before 1.0.3 allows remote authenticated users to execute arbitrary SMB commands via shell metacharacters in the user argument in the (1) listShares function in Server.php or the (2) connect or (3) read function in Share.php.","references":["https://github.com/icewind1991/SMB/commit/33ab10cc4d5c3e48cba3a074b5f9fc67590cd032","https://owncloud.org/security/advisory/?id=oc-sa-2015-017","https://github.com/icewind1991/SMB/commit/33ab10cc4d5c3e48cba3a074b5f9fc67590cd032"],"severity":"UNKNOWN","match_type":"version_range","confidence":"high","version_match":[["<=1.0.2"],["<=8.1.1"]]},
  {"id":"CVE-2016-0403","product":"smb","summary":"Unspecified vulnerability in Oracle Sun Solaris 11 allows remote attackers to affect availability via vectors related to SMB Utilities.","details":"Unspecified vulnerability in Oracle Sun Solaris 11 allows remote attackers to affect availability via vectors related to SMB Utilities.","references":["http://www.oracle.com/technetwork/topics/security/cpujan2016-2367955.html","http://www.securitytracker.com/id/1034735","http://www.oracle.com/technetwork/topics/security/cpujan2016-2367955.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-0456","product":"smb","summary":"Unspecified vulnerability in the Application Mgmt Pack for E-Business Suite component in Oracle E-Business Suite 12.1 and 12.2 allows remote attackers to affect confidentiality via vectors related to REST Framework, a different vulnerability than CVE-2016-0457. NOTE: the previous information is from the January 2016 CPU. Oracle has not commented on third-party claims that this issue is an XML External Entity (XXE) vulnerability, which allows remote attackers to read arbitrary files, cause a denial of service, conduct server-side request forgery (SSRF) attacks, or conduct SMB Relay attacks via a crafted DTD in an XML request to OA_HTML/copxmllcmservicecontroller.js.","details":"Unspecified vulnerability in the Application Mgmt Pack for E-Business Suite component in Oracle E-Business Suite 12.1 and 12.2 allows remote attackers to affect confidentiality via vectors related to REST Framework, a different vulnerability than CVE-2016-0457. NOTE: the previous information is from the January 2016 CPU. Oracle has not commented on third-party claims that this issue is an XML External Entity (XXE) vulnerability, which allows remote attackers to read arbitrary files, cause a denial of service, conduct server-side request forgery (SSRF) attacks, or conduct SMB Relay attacks via a crafted DTD in an XML request to OA_HTML/copxmllcmservicecontroller.js.","references":["http://www.oracle.com/technetwork/topics/security/cpujan2016-2367955.html","http://www.securitytracker.com/id/1034726","https://erpscan.io/advisories/erpscan-16-006-oracle-e-business-suite-xxe-injection-vulnerability/"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-0457","product":"smb","summary":"Unspecified vulnerability in the Application Mgmt Pack for E-Business Suite component in Oracle E-Business Suite 12.1 and 12.2 allows remote attackers to affect confidentiality via vectors related to REST Framework, a different vulnerability than CVE-2016-0456.  NOTE: the previous information is from the January 2016 CPU. Oracle has not commented on third-party claims that this issue is an XML External Entity (XXE) vulnerability, which allows remote attackers to read arbitrary files, cause a denial of service, conduct server-side request forgery (SSRF) attacks, or conduct SMB Relay attacks via a crafted DTD in an XML request to OA_HTML/lcmServiceController.jsp.","details":"Unspecified vulnerability in the Application Mgmt Pack for E-Business Suite component in Oracle E-Business Suite 12.1 and 12.2 allows remote attackers to affect confidentiality via vectors related to REST Framework, a different vulnerability than CVE-2016-0456.  NOTE: the previous information is from the January 2016 CPU. Oracle has not commented on third-party claims that this issue is an XML External Entity (XXE) vulnerability, which allows remote attackers to read arbitrary files, cause a denial of service, conduct server-side request forgery (SSRF) attacks, or conduct SMB Relay attacks via a crafted DTD in an XML request to OA_HTML/lcmServiceController.jsp.","references":["http://www.oracle.com/technetwork/topics/security/cpujan2016-2367955.html","http://www.securitytracker.com/id/1034726","https://erpscan.io/advisories/erpscan-16-007-oracle-e-business-suite-xxe-injection-vulnerability/"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-0907","product":"smb","summary":"EMC Isilon OneFS 7.1.x and 7.2.x before 7.2.1.3 and 8.0.x before 8.0.0.1, and IsilonSD Edge OneFS 8.0.x before 8.0.0.1, does not require SMB signing within a DCERPC session over ncacn_np, which allows man-in-the-middle attackers to spoof SMB clients by modifying the client-server data stream, a similar issue to CVE-2016-2115.","details":"EMC Isilon OneFS 7.1.x and 7.2.x before 7.2.1.3 and 8.0.x before 8.0.0.1, and IsilonSD Edge OneFS 8.0.x before 8.0.0.1, does not require SMB signing within a DCERPC session over ncacn_np, which allows man-in-the-middle attackers to spoof SMB clients by modifying the client-server data stream, a similar issue to CVE-2016-2115.","references":["http://seclists.org/bugtraq/2016/May/117","http://seclists.org/bugtraq/2016/May/117"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-0913","product":"smb","summary":"The client in EMC Replication Manager (RM) before 5.5.3.0_01-PatchHotfix, EMC Network Module for Microsoft 3.x, and EMC Networker Module for Microsoft 8.2.x before 8.2.3.6 allows remote RM servers to execute arbitrary commands by placing a crafted script in an SMB share.","details":"The client in EMC Replication Manager (RM) before 5.5.3.0_01-PatchHotfix, EMC Network Module for Microsoft 3.x, and EMC Networker Module for Microsoft 8.2.x before 8.2.3.6 allows remote RM servers to execute arbitrary commands by placing a crafted script in an SMB share.","references":["http://seclists.org/bugtraq/2016/Oct/6","http://www.securityfocus.com/bid/93348","http://www.securitytracker.com/id/1036940"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[["<=8.2.3.6"],["<=5.5.3"]]},
  {"id":"CVE-2016-0917","product":"smb","summary":"The SMB service in EMC VNXe (VNXe3200 Operating Environment prior to 3.1.5.8711957 and VNXe3100/3150/3300 Operating Environment prior to 2.4.4.22638), VNX1 File OE before 7.1.80.3, VNX2 File OE before 8.1.9.155, and Celerra (all supported versions) does not prevent duplicate NTLM challenge-response nonces, which makes it easier for remote attackers to execute arbitrary code, or read or write to files, via a series of authentication requests, a related issue to CVE-2010-0231.","details":"The SMB service in EMC VNXe (VNXe3200 Operating Environment prior to 3.1.5.8711957 and VNXe3100/3150/3300 Operating Environment prior to 2.4.4.22638), VNX1 File OE before 7.1.80.3, VNX2 File OE before 8.1.9.155, and Celerra (all supported versions) does not prevent duplicate NTLM challenge-response nonces, which makes it easier for remote attackers to execute arbitrary code, or read or write to files, via a series of authentication requests, a related issue to CVE-2010-0231.","references":["http://seclists.org/bugtraq/2016/Sep/32","http://www.securityfocus.com/archive/1/539993/30/0/threaded","http://www.securityfocus.com/bid/93023"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-10154","product":"smb","summary":"The smbhash function in fs/cifs/smbencrypt.c in the Linux kernel 4.9.x before 4.9.1 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a scatterlist.","details":"The smbhash function in fs/cifs/smbencrypt.c in the Linux kernel 4.9.x before 4.9.1 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a scatterlist.","references":["http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=06deeec77a5a689cc94b21a8a91a76e42176685d","http://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.9.1","http://www.openwall.com/lists/oss-security/2017/01/21/3"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-2114","product":"smb","summary":"The SMB1 protocol implementation in Samba 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2 does not recognize the \"server signing = mandatory\" setting, which allows man-in-the-middle attackers to spoof SMB servers by modifying the client-server data stream.","details":"The SMB1 protocol implementation in Samba 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2 does not recognize the \"server signing = mandatory\" setting, which allows man-in-the-middle attackers to spoof SMB servers by modifying the client-server data stream.","references":["http://badlock.org/","http://lists.fedoraproject.org/pipermail/package-announce/2016-April/182185.html","http://lists.fedoraproject.org/pipermail/package-announce/2016-April/182272.html"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-2115","product":"smb","summary":"Samba 3.x and 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2 does not require SMB signing within a DCERPC session over ncacn_np, which allows man-in-the-middle attackers to spoof SMB clients by modifying the client-server data stream.","details":"Samba 3.x and 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2 does not require SMB signing within a DCERPC session over ncacn_np, which allows man-in-the-middle attackers to spoof SMB clients by modifying the client-server data stream.","references":["http://badlock.org/","http://lists.fedoraproject.org/pipermail/package-announce/2016-April/182185.html","http://lists.fedoraproject.org/pipermail/package-announce/2016-April/182272.html"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-2119","product":"smb","summary":"libcli/smb/smbXcli_base.c in Samba 4.x before 4.2.14, 4.3.x before 4.3.11, and 4.4.x before 4.4.5 allows man-in-the-middle attackers to bypass a client-signing protection mechanism, and consequently spoof SMB2 and SMB3 servers, via the (1) SMB2_SESSION_FLAG_IS_GUEST or (2) SMB2_SESSION_FLAG_IS_NULL flag.","details":"libcli/smb/smbXcli_base.c in Samba 4.x before 4.2.14, 4.3.x before 4.3.11, and 4.4.x before 4.4.5 allows man-in-the-middle attackers to bypass a client-signing protection mechanism, and consequently spoof SMB2 and SMB3 servers, via the (1) SMB2_SESSION_FLAG_IS_GUEST or (2) SMB2_SESSION_FLAG_IS_NULL flag.","references":["http://lists.opensuse.org/opensuse-updates/2016-07/msg00060.html","http://rhn.redhat.com/errata/RHSA-2016-1486.html","http://rhn.redhat.com/errata/RHSA-2016-1487.html"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[">=4.3.0",">=4.4.0",">=4.0.0","<4.2.14","<4.3.11","<4.4.5"]},
  {"id":"CVE-2016-2124","product":"smb","summary":"A flaw was found in the way samba implemented SMB1 authentication. An attacker could use this flaw to retrieve the plaintext password sent over the wire even if Kerberos authentication was required.","details":"A flaw was found in the way samba implemented SMB1 authentication. An attacker could use this flaw to retrieve the plaintext password sent over the wire even if Kerberos authentication was required.","references":["https://bugzilla.redhat.com/show_bug.cgi?id=2019660","https://lists.debian.org/debian-lts-announce/2023/09/msg00013.html","https://security.gentoo.org/glsa/202309-06"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<4.15.2","<4.14.10",">=4.15.0",">=4.14.0","<4.13.14"],[">=3.0.0"]]},
  {"id":"CVE-2016-3225","product":"smb","summary":"The SMB server component in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold and 1511 allows local users to gain privileges via a crafted application that forwards an authentication request to an unintended service, aka \"Windows SMB Server Elevation of Privilege Vulnerability.\"","details":"The SMB server component in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold and 1511 allows local users to gain privileges via a crafted application that forwards an authentication request to an unintended service, aka \"Windows SMB Server Elevation of Privilege Vulnerability.\"","references":["http://www.securitytracker.com/id/1036110","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2016/ms16-075","https://www.exploit-db.com/exploits/45562/"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-3345","product":"smb","summary":"The SMBv1 server in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold, 1511, and 1607 allows remote attackers to execute arbitrary code via crafted packets, aka \"Windows SMB Authenticated Remote Code Execution Vulnerability.\"","details":"The SMBv1 server in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold, 1511, and 1607 allows remote attackers to execute arbitrary code via crafted packets, aka \"Windows SMB Authenticated Remote Code Execution Vulnerability.\"","references":["http://www.securityfocus.com/bid/92859","http://www.securitytracker.com/id/1036803","https://docs.microsoft.com/en-us/security-updates/securitybulletins/2016/ms16-114"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-3400","product":"smb","summary":"NetApp Data ONTAP 8.1 and 8.2, when operating in 7-Mode, allows man-in-the-middle attackers to obtain sensitive information, gain privileges, or cause a denial of service via vectors related to the SMB protocol.","details":"NetApp Data ONTAP 8.1 and 8.2, when operating in 7-Mode, allows man-in-the-middle attackers to obtain sensitive information, gain privileges, or cause a denial of service via vectors related to the SMB protocol.","references":["http://www-01.ibm.com/support/docview.wss?uid=ssg1S1006063","http://www.securityfocus.com/bid/99101","https://exchange.xforce.ibmcloud.com/vulnerabilities/113589"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-3974","product":"smb","summary":"XML external entity (XXE) vulnerability in the Configuration Wizard in SAP NetWeaver Java AS 7.1 through 7.5 allows remote attackers to cause a denial of service, conduct SMB Relay attacks, or access arbitrary files via a crafted XML request to _tc~monitoring~webservice~web/ServerNodesWSService, aka SAP Security Note 2235994.","details":"XML external entity (XXE) vulnerability in the Configuration Wizard in SAP NetWeaver Java AS 7.1 through 7.5 allows remote attackers to cause a denial of service, conduct SMB Relay attacks, or access arbitrary files via a crafted XML request to _tc~monitoring~webservice~web/ServerNodesWSService, aka SAP Security Note 2235994.","references":["http://packetstormsecurity.com/files/137527/SAP-NetWeaver-AS-JAVA-7.5-XXE-Injection.html","http://seclists.org/fulldisclosure/2016/Jun/41","https://erpscan.io/advisories/erpscan-16-013-sap-netweaver-7-4-ctcprotocol-servlet-xxe/"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[">=7.10","<=7.50"]},
  {"id":"CVE-2016-3997","product":"smb","summary":"NetApp Clustered Data ONTAP allows man-in-the-middle attackers to obtain sensitive information, gain privileges, or cause a denial of service by leveraging failure to enable SMB signing enforcement in its default state.","details":"NetApp Clustered Data ONTAP allows man-in-the-middle attackers to obtain sensitive information, gain privileges, or cause a denial of service by leveraging failure to enable SMB signing enforcement in its default state.","references":["http://www-01.ibm.com/support/docview.wss?uid=ssg1S1006063","https://kb.netapp.com/support/s/article/ka51A0000008SXzQAM/smb-vulnerabilities-in-multiple-netapp-products","http://www-01.ibm.com/support/docview.wss?uid=ssg1S1006063"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-3998","product":"smb","summary":"NetApp AltaVault 4.1 and earlier allows man-in-the-middle attackers to obtain sensitive information, gain privileges, or cause a denial of service via vectors related to the SMB protocol.","details":"NetApp AltaVault 4.1 and earlier allows man-in-the-middle attackers to obtain sensitive information, gain privileges, or cause a denial of service via vectors related to the SMB protocol.","references":["https://kb.netapp.com/support/s/article/ka51A0000008SXzQAM/smb-vulnerabilities-in-multiple-netapp-products","https://kb.netapp.com/support/s/article/ka51A0000008SXzQAM/smb-vulnerabilities-in-multiple-netapp-products"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<=4.1"},
  {"id":"CVE-2016-4341","product":"smb","summary":"NetApp Clustered Data ONTAP before 8.3.2P7 allows remote attackers to obtain SMB share information via unspecified vectors.","details":"NetApp Clustered Data ONTAP before 8.3.2P7 allows remote attackers to obtain SMB share information via unspecified vectors.","references":["https://kb.netapp.com/support/s/article/NTAP-20161028-0001","https://kb.netapp.com/support/s/article/NTAP-20161028-0001"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<=8.3.2"},
  {"id":"CVE-2016-5166","product":"smb","summary":"The download implementation in Google Chrome before 53.0.2785.89 on Windows and OS X and before 53.0.2785.92 on Linux does not properly restrict saving a file:// URL that is referenced by an http:// URL, which makes it easier for user-assisted remote attackers to discover NetNTLM hashes and conduct SMB relay attacks via a crafted web page that is accessed with the \"Save page as\" menu choice.","details":"The download implementation in Google Chrome before 53.0.2785.89 on Windows and OS X and before 53.0.2785.92 on Linux does not properly restrict saving a file:// URL that is referenced by an http:// URL, which makes it easier for user-assisted remote attackers to discover NetNTLM hashes and conduct SMB relay attacks via a crafted web page that is accessed with the \"Save page as\" menu choice.","references":["http://lists.opensuse.org/opensuse-security-announce/2016-09/msg00003.html","http://lists.opensuse.org/opensuse-security-announce/2016-09/msg00004.html","http://lists.opensuse.org/opensuse-security-announce/2016-09/msg00008.html"],"severity":"LOW","match_type":"version_range","confidence":"high","version_match":"<=52.0.2743.116"},
  {"id":"CVE-2016-5374","product":"smb","summary":"NetApp Data ONTAP 9.0 and 9.1 before 9.1P1 allows remote authenticated users that own SMB-hosted data to bypass intended sharing restrictions by leveraging improper handling of the owner_rights ACL entry.","details":"NetApp Data ONTAP 9.0 and 9.1 before 9.1P1 allows remote authenticated users that own SMB-hosted data to bypass intended sharing restrictions by leveraging improper handling of the owner_rights ACL entry.","references":["http://www.securityfocus.com/bid/96524","https://kb.netapp.com/support/s/article/ka51A00000007IBQAY/NTAP-20170228-0002?language=en_US","http://www.securityfocus.com/bid/96524"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-5492","product":"smb","summary":"Unspecified vulnerability in the Sun ZFS Storage Appliance Kit (AK) component in Oracle Sun Systems Products Suite AK 2013 allows local users to affect confidentiality and integrity via vectors related to SMB Users.","details":"Unspecified vulnerability in the Sun ZFS Storage Appliance Kit (AK) component in Oracle Sun Systems Products Suite AK 2013 allows local users to affect confidentiality and integrity via vectors related to SMB Users.","references":["http://www.oracle.com/technetwork/security-advisory/cpuoct2016-2881722.html","http://www.securityfocus.com/bid/93701","http://www.oracle.com/technetwork/security-advisory/cpuoct2016-2881722.html"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-6561","product":"smb","summary":"illumos smbsrv NULL pointer dereference allows system crash.","details":"illumos smbsrv NULL pointer dereference allows system crash.","references":["http://www.securityfocus.com/bid/98079","https://github.com/illumos/illumos-gate/commit/6d1c73b5858fefc6161c7d686345f0dc887ea799","https://www.illumos.org/issues/7483"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2016-9463","product":"smb","summary":"Nextcloud Server before 9.0.54 and 10.0.1 & ownCloud Server before 9.1.2, 9.0.6, and 8.2.9 suffer from SMB User Authentication Bypass. Nextcloud/ownCloud include an optional and not by default enabled SMB authentication component that allows authenticating users against an SMB server. This backend is implemented in a way that tries to connect to a SMB server and if that succeeded consider the user logged-in. The backend did not properly take into account SMB servers that have any kind of anonymous auth configured. This is the default on SMB servers nowadays and allows an unauthenticated attacker to gain access to an account without valid credentials. Note: The SMB backend is disabled by default and requires manual configuration in the Nextcloud/ownCloud config file. If you have not configured the SMB backend then you're not affected by this vulnerability.","details":"Nextcloud Server before 9.0.54 and 10.0.1 & ownCloud Server before 9.1.2, 9.0.6, and 8.2.9 suffer from SMB User Authentication Bypass. Nextcloud/ownCloud include an optional and not by default enabled SMB authentication component that allows authenticating users against an SMB server. This backend is implemented in a way that tries to connect to a SMB server and if that succeeded consider the user logged-in. The backend did not properly take into account SMB servers that have any kind of anonymous auth configured. This is the default on SMB servers nowadays and allows an unauthenticated attacker to gain access to an account without valid credentials. Note: The SMB backend is disabled by default and requires manual configuration in the Nextcloud/ownCloud config file. If you have not configured the SMB backend then you're not affected by this vulnerability.","references":["https://github.com/nextcloud/apps/commit/b85ace6840b8a6704641086bc3b8eb8e81cb2274","https://github.com/nextcloud/apps/commit/decb91fd31f4ffab191cbf09ce4e5c55c67a4087","https://github.com/owncloud/apps/commit/16cbccfc946c8711721fa684d78135ca1fb64791"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<9.0.54","<9.0.4",">=9.1.0","<9.1.2",">=9.0.0"],["<10.0.1",">=10.0.0"],["<8.2.9",">=8.2.0"]]},
  {"id":"CVE-2017-0016","product":"smb","summary":"Microsoft Windows 10 Gold, 1511, and 1607; Windows 8.1; Windows RT 8.1; Windows Server 2012 R2, and Windows Server 2016 do not properly handle certain requests in SMBv2 and SMBv3 packets, which allows remote attackers to execute arbitrary code via a crafted SMBv2 or SMBv3 packet to the Server service, aka \"SMBv2/SMBv3 Null Dereference Denial of Service Vulnerability.\"","details":"Microsoft Windows 10 Gold, 1511, and 1607; Windows 8.1; Windows RT 8.1; Windows Server 2012 R2, and Windows Server 2016 do not properly handle certain requests in SMBv2 and SMBv3 packets, which allows remote attackers to execute arbitrary code via a crafted SMBv2 or SMBv3 packet to the Server service, aka \"SMBv2/SMBv3 Null Dereference Denial of Service Vulnerability.\"","references":["http://www.securityfocus.com/bid/95969","http://www.securitytracker.com/id/1037767","http://www.securitytracker.com/id/1038001"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0143","product":"microsoft-ds","summary":"The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka \"Windows SMB Remote Code Execution Vulnerability.\" This vulnerability is different from those described in CVE-2017-0144, CVE-2017-0145, CVE-2017-0146, and CVE-2017-0148.","details":"The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka \"Windows SMB Remote Code Execution Vulnerability.\" This vulnerability is different from those described in CVE-2017-0144, CVE-2017-0145, CVE-2017-0146, and CVE-2017-0148.","references":["http://packetstormsecurity.com/files/154690/DOUBLEPULSAR-Payload-Execution-Neutralization.html","http://packetstormsecurity.com/files/156196/SMB-DOUBLEPULSAR-Remote-Code-Execution.html","http://www.securityfocus.com/bid/96703"],"severity":"HIGH","match_type":"active_check","confidence":"high","required_script":"smb-vuln-ms17-010"},
  {"id":"CVE-2017-0144","product":"microsoft-ds","summary":"The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka \"Windows SMB Remote Code Execution Vulnerability.\" This vulnerability is different from those described in CVE-2017-0143, CVE-2017-0145, CVE-2017-0146, and CVE-2017-0148.","details":"The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka \"Windows SMB Remote Code Execution Vulnerability.\" This vulnerability is different from those described in CVE-2017-0143, CVE-2017-0145, CVE-2017-0146, and CVE-2017-0148.","references":["http://packetstormsecurity.com/files/154690/DOUBLEPULSAR-Payload-Execution-Neutralization.html","http://packetstormsecurity.com/files/156196/SMB-DOUBLEPULSAR-Remote-Code-Execution.html","http://www.securityfocus.com/bid/96704"],"severity":"HIGH","match_type":"active_check","confidence":"high","required_script":"smb-vuln-ms17-010"},
  {"id":"CVE-2017-0145","product":"microsoft-ds","summary":"The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka \"Windows SMB Remote Code Execution Vulnerability.\" This vulnerability is different from those described in CVE-2017-0143, CVE-2017-0144, CVE-2017-0146, and CVE-2017-0148.","details":"The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka \"Windows SMB Remote Code Execution Vulnerability.\" This vulnerability is different from those described in CVE-2017-0143, CVE-2017-0144, CVE-2017-0146, and CVE-2017-0148.","references":["http://packetstormsecurity.com/files/154690/DOUBLEPULSAR-Payload-Execution-Neutralization.html","http://packetstormsecurity.com/files/156196/SMB-DOUBLEPULSAR-Remote-Code-Execution.html","http://www.securityfocus.com/bid/96705"],"severity":"HIGH","match_type":"active_check","confidence":"high","required_script":"smb-vuln-ms17-010"},
  {"id":"CVE-2017-0146","product":"microsoft-ds","summary":"The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka \"Windows SMB Remote Code Execution Vulnerability.\" This vulnerability is different from those described in CVE-2017-0143, CVE-2017-0144, CVE-2017-0145, and CVE-2017-0148.","details":"The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka \"Windows SMB Remote Code Execution Vulnerability.\" This vulnerability is different from those described in CVE-2017-0143, CVE-2017-0144, CVE-2017-0145, and CVE-2017-0148.","references":["http://packetstormsecurity.com/files/154690/DOUBLEPULSAR-Payload-Execution-Neutralization.html","http://packetstormsecurity.com/files/156196/SMB-DOUBLEPULSAR-Remote-Code-Execution.html","http://www.securityfocus.com/bid/96707"],"severity":"HIGH","match_type":"active_check","confidence":"high","required_script":"smb-vuln-ms17-010"},
  {"id":"CVE-2017-0147","product":"smb","summary":"The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to obtain sensitive information from process memory via a crafted packets, aka \"Windows SMB Information Disclosure Vulnerability.\"","details":"The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to obtain sensitive information from process memory via a crafted packets, aka \"Windows SMB Information Disclosure Vulnerability.\"","references":["http://packetstormsecurity.com/files/154690/DOUBLEPULSAR-Payload-Execution-Neutralization.html","http://packetstormsecurity.com/files/156196/SMB-DOUBLEPULSAR-Remote-Code-Execution.html","http://www.securityfocus.com/bid/96709"],"severity":"HIGH","match_type":"active_check","confidence":"high","required_script":"smb-vuln-ms17-010"},
  {"id":"CVE-2017-0148","product":"microsoft-ds","summary":"The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka \"Windows SMB Remote Code Execution Vulnerability.\" This vulnerability is different from those described in CVE-2017-0143, CVE-2017-0144, CVE-2017-0145, and CVE-2017-0146.","details":"The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka \"Windows SMB Remote Code Execution Vulnerability.\" This vulnerability is different from those described in CVE-2017-0143, CVE-2017-0144, CVE-2017-0145, and CVE-2017-0146.","references":["http://packetstormsecurity.com/files/154690/DOUBLEPULSAR-Payload-Execution-Neutralization.html","http://packetstormsecurity.com/files/156196/SMB-DOUBLEPULSAR-Remote-Code-Execution.html","http://www.securityfocus.com/bid/96706"],"severity":"HIGH","match_type":"active_check","confidence":"high","required_script":"smb-vuln-ms17-010"},
  {"id":"CVE-2017-0267","product":"smb","summary":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0268, CVE-2017-0270, CVE-2017-0271, CVE-2017-0274, CVE-2017-0275, and CVE-2017-0276.","details":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0268, CVE-2017-0270, CVE-2017-0271, CVE-2017-0274, CVE-2017-0275, and CVE-2017-0276.","references":["http://www.securityfocus.com/bid/98259","http://www.securitytracker.com/id/1038432","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0268","product":"smb","summary":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0267, CVE-2017-0270, CVE-2017-0271, CVE-2017-0274, CVE-2017-0275, and CVE-2017-0276.","details":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0267, CVE-2017-0270, CVE-2017-0271, CVE-2017-0274, CVE-2017-0275, and CVE-2017-0276.","references":["http://www.securityfocus.com/bid/98261","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0268"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0269","product":"smb","summary":"The Microsoft Server Message Block 1.0 (SMBv1) allows denial of service when an attacker sends specially crafted requests to the server, aka \"Windows SMB Denial of Service Vulnerability\". This CVE ID is unique from CVE-2017-0273 and CVE-2017-0280.","details":"The Microsoft Server Message Block 1.0 (SMBv1) allows denial of service when an attacker sends specially crafted requests to the server, aka \"Windows SMB Denial of Service Vulnerability\". This CVE ID is unique from CVE-2017-0273 and CVE-2017-0280.","references":["http://www.securityfocus.com/bid/98263","http://www.securitytracker.com/id/1038433","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0270","product":"smb","summary":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0267, CVE-2017-0268, CVE-2017-0271, CVE-2017-0274, CVE-2017-0275, and CVE-2017-0276.","details":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0267, CVE-2017-0268, CVE-2017-0271, CVE-2017-0274, CVE-2017-0275, and CVE-2017-0276.","references":["http://www.securityfocus.com/bid/98264","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0270"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0271","product":"smb","summary":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0267, CVE-2017-0268, CVE-2017-0270, CVE-2017-0274, CVE-2017-0275, and CVE-2017-0276.","details":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0267, CVE-2017-0268, CVE-2017-0270, CVE-2017-0274, CVE-2017-0275, and CVE-2017-0276.","references":["http://www.securityfocus.com/bid/98265","http://www.securitytracker.com/id/1038432","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0272","product":"smb","summary":"The Microsoft Server Message Block 1.0 (SMBv1) server on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 allows an attacker to execute remote code by the way it handles certain requests, aka \"Windows SMB Remote Code Execution Vulnerability\". This CVE ID is unique from CVE-2017-0277, CVE-2017-0278, and CVE-2017-0279.","details":"The Microsoft Server Message Block 1.0 (SMBv1) server on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 allows an attacker to execute remote code by the way it handles certain requests, aka \"Windows SMB Remote Code Execution Vulnerability\". This CVE ID is unique from CVE-2017-0277, CVE-2017-0278, and CVE-2017-0279.","references":["http://www.securityfocus.com/bid/98260","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0272"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0273","product":"smb","summary":"The Microsoft Server Message Block 1.0 (SMBv1) allows denial of service when an attacker sends specially crafted requests to the server, aka \"Windows SMB Denial of Service Vulnerability\". This CVE ID is unique from CVE-2017-0269 and CVE-2017-0280.","details":"The Microsoft Server Message Block 1.0 (SMBv1) allows denial of service when an attacker sends specially crafted requests to the server, aka \"Windows SMB Denial of Service Vulnerability\". This CVE ID is unique from CVE-2017-0269 and CVE-2017-0280.","references":["http://www.securityfocus.com/bid/98274","http://www.securitytracker.com/id/1038433","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0274","product":"smb","summary":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0267, CVE-2017-0268, CVE-2017-0270, CVE-2017-0271, CVE-2017-0275, and CVE-2017-0276.","details":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0267, CVE-2017-0268, CVE-2017-0270, CVE-2017-0271, CVE-2017-0275, and CVE-2017-0276.","references":["http://www.securityfocus.com/bid/98266","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0274"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0275","product":"smb","summary":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0267, CVE-2017-0268, CVE-2017-0270, CVE-2017-0271, CVE-2017-0274, and CVE-2017-0276.","details":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0267, CVE-2017-0268, CVE-2017-0270, CVE-2017-0271, CVE-2017-0274, and CVE-2017-0276.","references":["http://www.securityfocus.com/bid/98267","http://www.securitytracker.com/id/1038432","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0276","product":"smb","summary":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0267, CVE-2017-0268, CVE-2017-0270, CVE-2017-0271, CVE-2017-0274, and CVE-2017-0275.","details":"Microsoft Server Message Block 1.0 (SMBv1) allows an information disclosure vulnerability in the way that Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\". This CVE ID is unique from CVE-2017-0267, CVE-2017-0268, CVE-2017-0270, CVE-2017-0271, CVE-2017-0274, and CVE-2017-0275.","references":["http://www.securityfocus.com/bid/98268","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0276"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0277","product":"smb","summary":"The Microsoft Server Message Block 1.0 (SMBv1) server on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 allows an attacker to execute remote code by the way it handles certain requests, aka \"Windows SMB Remote Code Execution Vulnerability\". This CVE ID is unique from CVE-2017-0272, CVE-2017-0278, and CVE-2017-0279.","details":"The Microsoft Server Message Block 1.0 (SMBv1) server on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 allows an attacker to execute remote code by the way it handles certain requests, aka \"Windows SMB Remote Code Execution Vulnerability\". This CVE ID is unique from CVE-2017-0272, CVE-2017-0278, and CVE-2017-0279.","references":["http://www.securityfocus.com/bid/98270","http://www.securitytracker.com/id/1038430","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0278","product":"smb","summary":"The Microsoft Server Message Block 1.0 (SMBv1) server on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 allows an attacker to execute remote code by the way it handles certain requests, aka \"Windows SMB Remote Code Execution Vulnerability\". This CVE ID is unique from CVE-2017-0272, CVE-2017-0277, and CVE-2017-0279.","details":"The Microsoft Server Message Block 1.0 (SMBv1) server on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 allows an attacker to execute remote code by the way it handles certain requests, aka \"Windows SMB Remote Code Execution Vulnerability\". This CVE ID is unique from CVE-2017-0272, CVE-2017-0277, and CVE-2017-0279.","references":["http://www.securityfocus.com/bid/98271","http://www.securitytracker.com/id/1038430","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0279","product":"smb","summary":"The Microsoft Server Message Block 1.0 (SMBv1) server on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 allows an attacker to execute remote code by the way it handles certain requests, aka \"Windows SMB Remote Code Execution Vulnerability\". This CVE ID is unique from CVE-2017-0272, CVE-2017-0277, and CVE-2017-0278.","details":"The Microsoft Server Message Block 1.0 (SMBv1) server on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016 allows an attacker to execute remote code by the way it handles certain requests, aka \"Windows SMB Remote Code Execution Vulnerability\". This CVE ID is unique from CVE-2017-0272, CVE-2017-0277, and CVE-2017-0278.","references":["http://www.securityfocus.com/bid/98272","http://www.securitytracker.com/id/1038430","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-0280","product":"smb","summary":"The Microsoft Server Message Block 1.0 (SMBv1) allows denial of service when an attacker sends specially crafted requests to the server, aka \"Windows SMB Denial of Service Vulnerability\". This CVE ID is unique from CVE-2017-0269 and CVE-2017-0273.","details":"The Microsoft Server Message Block 1.0 (SMBv1) allows denial of service when an attacker sends specially crafted requests to the server, aka \"Windows SMB Denial of Service Vulnerability\". This CVE ID is unique from CVE-2017-0269 and CVE-2017-0273.","references":["http://www.securityfocus.com/bid/98273","https://ics-cert.us-cert.gov/advisories/ICSMA-18-058-02","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0280"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-11780","product":"smb","summary":"The Server Message Block 1.0 (SMBv1) on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016, allows a remote code execution vulnerability when it fails to properly handle certain requests, aka \"Windows SMB Remote Code Execution Vulnerability\".","details":"The Server Message Block 1.0 (SMBv1) on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016, allows a remote code execution vulnerability when it fails to properly handle certain requests, aka \"Windows SMB Remote Code Execution Vulnerability\".","references":["http://www.securityfocus.com/bid/101110","http://www.securitytracker.com/id/1039528","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11780"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-11781","product":"smb","summary":"The Microsoft Server Block Message (SMB) on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016, allows a denial of service vulnerability when an attacker sends specially crafted requests to the server, aka \"Windows SMB Denial of Service Vulnerability\".","details":"The Microsoft Server Block Message (SMB) on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016, allows a denial of service vulnerability when an attacker sends specially crafted requests to the server, aka \"Windows SMB Denial of Service Vulnerability\".","references":["http://www.securityfocus.com/bid/101140","http://www.securitytracker.com/id/1039528","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11781"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-11782","product":"smb","summary":"The Microsoft Server Block Message (SMB) on Microsoft Windows 10 1607 and Windows Server 2016, allows an elevation of privilege vulnerability when an attacker sends specially crafted requests to the server, aka \"Windows SMB Elevation of Privilege Vulnerability\".","details":"The Microsoft Server Block Message (SMB) on Microsoft Windows 10 1607 and Windows Server 2016, allows an elevation of privilege vulnerability when an attacker sends specially crafted requests to the server, aka \"Windows SMB Elevation of Privilege Vulnerability\".","references":["http://www.securityfocus.com/bid/101143","http://www.securitytracker.com/id/1039528","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11782"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-11815","product":"smb","summary":"The Microsoft Server Block Message (SMB) on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016, allows an information disclosure vulnerability in the way that it handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\".","details":"The Microsoft Server Block Message (SMB) on Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and 1703, and Windows Server 2016, allows an information disclosure vulnerability in the way that it handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability\".","references":["http://www.securityfocus.com/bid/101136","http://www.securitytracker.com/id/1039528","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11815"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-12151","product":"smb","summary":"A flaw was found in the way samba client before samba 4.4.16, samba 4.5.14 and samba 4.6.8 used encryption with the max protocol set as SMB3. The connection could lose the requirement for signing and encrypting to any DFS redirects, allowing an attacker to read or alter the contents of the connection via a man-in-the-middle attack.","details":"A flaw was found in the way samba client before samba 4.4.16, samba 4.5.14 and samba 4.6.8 used encryption with the max protocol set as SMB3. The connection could lose the requirement for signing and encrypting to any DFS redirects, allowing an attacker to read or alter the contents of the connection via a man-in-the-middle attack.","references":["http://www.securityfocus.com/bid/100917","http://www.securitytracker.com/id/1039401","https://access.redhat.com/errata/RHSA-2017:2790"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<4.6.8","<4.5.14",">=4.6.0","<4.4.16",">=4.5.0"]},
  {"id":"CVE-2017-12163","product":"smb","summary":"An information leak flaw was found in the way SMB1 protocol was implemented by Samba before 4.4.16, 4.5.x before 4.5.14, and 4.6.x before 4.6.8. A malicious client could use this flaw to dump server memory contents to a file on the samba share or to a shared printer, though the exact area of server memory cannot be controlled by the attacker.","details":"An information leak flaw was found in the way SMB1 protocol was implemented by Samba before 4.4.16, 4.5.x before 4.5.14, and 4.6.x before 4.6.8. A malicious client could use this flaw to dump server memory contents to a file on the samba share or to a shared printer, though the exact area of server memory cannot be controlled by the attacker.","references":["http://www.securityfocus.com/bid/100925","http://www.securitytracker.com/id/1039401","https://access.redhat.com/errata/RHSA-2017:2789"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<4.6.8","<4.5.14",">=4.6.0","<4.4.16",">=4.5.0"]},
  {"id":"CVE-2017-12300","product":"smb","summary":"A vulnerability in the SNORT detection engine of Cisco Firepower System Software could allow an unauthenticated, remote attacker to bypass a file policy that is configured to block the Server Message Block Version 2 (SMB2) protocol. The vulnerability is due to the incorrect detection of an SMB2 file when the detection is based on the length of the file. An attacker could exploit this vulnerability by sending a crafted SMB2 transfer request through the targeted device. A successful exploit could allow the attacker to bypass filters that are configured to block SMB2 traffic. Cisco Bug IDs: CSCve58398.","details":"A vulnerability in the SNORT detection engine of Cisco Firepower System Software could allow an unauthenticated, remote attacker to bypass a file policy that is configured to block the Server Message Block Version 2 (SMB2) protocol. The vulnerability is due to the incorrect detection of an SMB2 file when the detection is based on the length of the file. An attacker could exploit this vulnerability by sending a crafted SMB2 transfer request through the targeted device. A successful exploit could allow the attacker to bypass filters that are configured to block SMB2 traffic. Cisco Bug IDs: CSCve58398.","references":["http://www.securityfocus.com/bid/101862","https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20171115-firepower2","http://www.securityfocus.com/bid/101862"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-12420","product":"smb","summary":"Heap-based buffer overflow in the SMB implementation in NetApp Clustered Data ONTAP before 8.3.2P8 and 9.0 before P2 allows remote authenticated users to cause a denial of service or execute arbitrary code.","details":"Heap-based buffer overflow in the SMB implementation in NetApp Clustered Data ONTAP before 8.3.2P8 and 9.0 before P2 allows remote authenticated users to cause a denial of service or execute arbitrary code.","references":["http://www.securityfocus.com/bid/100429","https://kb.netapp.com/support/s/article/NTAP-20170814-0001","http://www.securityfocus.com/bid/100429"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<=8.3.2"],["<=9.0"]]},
  {"id":"CVE-2017-12893","product":"smb","summary":"The SMB/CIFS parser in tcpdump before 4.9.2 has a buffer over-read in smbutil.c:name_len().","details":"The SMB/CIFS parser in tcpdump before 4.9.2 has a buffer over-read in smbutil.c:name_len().","references":["http://www.debian.org/security/2017/dsa-3971","http://www.securitytracker.com/id/1039307","http://www.tcpdump.org/tcpdump-changes.txt"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<=4.9.1"},
  {"id":"CVE-2017-13908","product":"smb","summary":"An issue in handling file permissions was addressed with improved validation. This issue is fixed in macOS High Sierra 10.13.1, Security Update 2017-001 Sierra, and Security Update 2017-004 El Capitan, macOS High Sierra 10.13. A local attacker may be able to execute non-executable text files via an SMB share.","details":"An issue in handling file permissions was addressed with improved validation. This issue is fixed in macOS High Sierra 10.13.1, Security Update 2017-001 Sierra, and Security Update 2017-004 El Capitan, macOS High Sierra 10.13. A local attacker may be able to execute non-executable text files via an SMB share.","references":["https://support.apple.com/en-us/HT208144","https://support.apple.com/en-us/HT208221","https://support.apple.com/en-us/HT208144"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<10.11.6",">=10.11",">=10.12","<=10.12.5"]},
  {"id":"CVE-2017-14385","product":"smb","summary":"An issue was discovered in EMC Data Domain DD OS 5.7 family, versions prior to 5.7.5.6; EMC Data Domain DD OS 6.0 family, versions prior to 6.0.2.9; EMC Data Domain DD OS 6.1 family, versions prior to 6.1.0.21; EMC Data Domain Virtual Edition 2.0 family, all versions; EMC Data Domain Virtual Edition 3.0 family, versions prior to 3.0 SP2 Update 1; and EMC Data Domain Virtual Edition 3.1 family, versions prior to 3.1 Update 2. EMC Data Domain DD OS contains a memory overflow vulnerability in SMBv1 which may potentially be exploited by an unauthenticated remote attacker. An attacker may completely shut down both the SMB service and active directory authentication. This may also allow remote code injection and execution.","details":"An issue was discovered in EMC Data Domain DD OS 5.7 family, versions prior to 5.7.5.6; EMC Data Domain DD OS 6.0 family, versions prior to 6.0.2.9; EMC Data Domain DD OS 6.1 family, versions prior to 6.1.0.21; EMC Data Domain Virtual Edition 2.0 family, all versions; EMC Data Domain Virtual Edition 3.0 family, versions prior to 3.0 SP2 Update 1; and EMC Data Domain Virtual Edition 3.1 family, versions prior to 3.1 Update 2. EMC Data Domain DD OS contains a memory overflow vulnerability in SMBv1 which may potentially be exploited by an unauthenticated remote attacker. An attacker may completely shut down both the SMB service and active directory authentication. This may also allow remote code injection and execution.","references":["http://seclists.org/fulldisclosure/2017/Dec/79","http://www.securityfocus.com/bid/102289","http://www.securitytracker.com/id/1040027"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=6.0",">=6.1","<6.1.0.21","<6.0.2.9"],[">=5.7","<5.7.5.6"]]},
  {"id":"CVE-2017-14583","product":"smb","summary":"NetApp Clustered Data ONTAP versions 9.x prior to 9.1P10 and 9.2P2 are susceptible to a vulnerability which allows an attacker to cause a Denial of Service (DoS) in SMB environments.","details":"NetApp Clustered Data ONTAP versions 9.x prior to 9.1P10 and 9.2P2 are susceptible to a vulnerability which allows an attacker to cause a Denial of Service (DoS) in SMB environments.","references":["https://security.netapp.com/advisory/ntap-20171215-0001/","https://security.netapp.com/advisory/ntap-20171215-0001/"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[">=9.0","<=9.1"]},
  {"id":"CVE-2017-14746","product":"smb","summary":"Use-after-free vulnerability in Samba 4.x before 4.7.3 allows remote attackers to execute arbitrary code via a crafted SMB1 request.","details":"Use-after-free vulnerability in Samba 4.x before 4.7.3 allows remote attackers to execute arbitrary code via a crafted SMB1 request.","references":["http://www.securityfocus.com/bid/101907","http://www.securitytracker.com/id/1039856","http://www.ubuntu.com/usn/USN-3486-1"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":["<4.5.0",">=4.6.0","<4.7.3",">=4.0.0",">=4.5.0","<4.5.15",">=4.7.0","<4.6.11"]},
  {"id":"CVE-2017-15037","product":"smb","summary":"In FreeBSD through 11.1, the smb_strdupin function in sys/netsmb/smb_subr.c has a race condition with a resultant out-of-bounds read, because it can cause t2p->t_name strings to lack a final '\\0' character.","details":"In FreeBSD through 11.1, the smb_strdupin function in sys/netsmb/smb_subr.c has a race condition with a resultant out-of-bounds read, because it can cause t2p->t_name strings to lack a final '\\0' character.","references":["http://www.securityfocus.com/bid/101191","https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=222687","https://svnweb.freebsd.org/base?view=revision&revision=324102"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<=11.1"},
  {"id":"CVE-2017-16079","product":"smb","summary":"smb was a malicious module published with the intent to hijack environment variables. It has been unpublished by npm.","details":"smb was a malicious module published with the intent to hijack environment variables. It has been unpublished by npm.","references":["https://nodesecurity.io/advisories/518","https://nodesecurity.io/advisories/518"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-17867","product":"smb","summary":"Inteno iopsys 2.0-3.14 and 4.0 devices allow remote authenticated users to execute arbitrary OS commands by modifying the leasetrigger field in the odhcpd configuration to specify an arbitrary program, as demonstrated by a program located on an SMB share. This issue existed because the /etc/uci-defaults directory was not being used to secure the OpenWrt configuration.","details":"Inteno iopsys 2.0-3.14 and 4.0 devices allow remote authenticated users to execute arbitrary OS commands by modifying the leasetrigger field in the odhcpd configuration to specify an arbitrary program, as demonstrated by a program located on an SMB share. This issue existed because the /etc/uci-defaults directory was not being used to secure the OpenWrt configuration.","references":["http://public.inteno.se/?p=feed-inteno-openwrt.git%3Ba=commit%3Bh=efcc985a721107e72a66da4db66891ec54441998","https://neonsea.uk/blog/2017/12/23/rce-inteno-iopsys.html","https://www.exploit-db.com/exploits/43428/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=2.0"],["<=3.14"]]},
  {"id":"CVE-2017-5988","product":"smb","summary":"NetApp Clustered Data ONTAP 8.1 through 9.1P1, when NFS or SMB is enabled, allows remote attackers to cause a denial of service via unspecified vectors.","details":"NetApp Clustered Data ONTAP 8.1 through 9.1P1, when NFS or SMB is enabled, allows remote attackers to cause a denial of service via unspecified vectors.","references":["https://kb.netapp.com/support/s/article/NTAP-20170331-0001","https://kb.netapp.com/support/s/article/NTAP-20170331-0001"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-8404","product":"smb","summary":"An issue was discovered on D-Link DCS-1130 devices. The device provides a user with the capability of setting a SMB folder for the video clippings recorded by the device. It seems that the POST parameters passed in this request (to test if email credentials and hostname sent to the device work properly) result in being passed as commands to a \"system\" API in the function and thus result in command injection on the device. If the firmware version is dissected using binwalk tool, we obtain a cramfs-root archive which contains the filesystem set up on the device that contains all the binaries. The library \"libmailutils.so\" is the one that has the vulnerable function \"sub_1FC4\" that receives the values sent by the POST request. If we open this binary in IDA-pro we will notice that this follows an ARM little endian format. The function sub_1FC4 in IDA pro is identified to be receiving the values sent in the POST request and the value set in POST parameter \"receiver1\" is extracted in function \"sub_15AC\" which is then passed to the vulnerable system API call. The vulnerable library function is accessed in \"cgibox\" binary at address 0x0008F598 which calls the \"mailLoginTest\" function in \"libmailutils.so\" binary as shown below which results in the vulnerable POST parameter being passed to the library which results in the command injection issue.","details":"An issue was discovered on D-Link DCS-1130 devices. The device provides a user with the capability of setting a SMB folder for the video clippings recorded by the device. It seems that the POST parameters passed in this request (to test if email credentials and hostname sent to the device work properly) result in being passed as commands to a \"system\" API in the function and thus result in command injection on the device. If the firmware version is dissected using binwalk tool, we obtain a cramfs-root archive which contains the filesystem set up on the device that contains all the binaries. The library \"libmailutils.so\" is the one that has the vulnerable function \"sub_1FC4\" that receives the values sent by the POST request. If we open this binary in IDA-pro we will notice that this follows an ARM little endian format. The function sub_1FC4 in IDA pro is identified to be receiving the values sent in the POST request and the value set in POST parameter \"receiver1\" is extracted in function \"sub_15AC\" which is then passed to the vulnerable system API call. The vulnerable library function is accessed in \"cgibox\" binary at address 0x0008F598 which calls the \"mailLoginTest\" function in \"libmailutils.so\" binary as shown below which results in the vulnerable POST parameter being passed to the library which results in the command injection issue.","references":["http://packetstormsecurity.com/files/153226/Dlink-DCS-1130-Command-Injection-CSRF-Stack-Overflow.html","https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Dlink_DCS_1130_security.pdf","https://seclists.org/bugtraq/2019/Jun/8"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-8408","product":"smb","summary":"An issue was discovered on D-Link DCS-1130 devices. The device provides a user with the capability of setting a SMB folder for the video clippings recorded by the device. It seems that the GET parameters passed in this request (to test if SMB credentials and hostname sent to the device work properly) result in being passed as commands to a \"system\" API in the function and thus result in command injection on the device. If the firmware version is dissected using binwalk tool, we obtain a cramfs-root archive which contains the filesystem set up on the device that contains all the binaries. The binary \"cgibox\" is the one that has the vulnerable function \"sub_7EAFC\" that receives the values sent by the GET request. If we open this binary in IDA-pro we will notice that this follows a ARM little endian format. The function sub_7EAFC in IDA pro is identified to be receiving the values sent in the GET request and the value set in GET parameter \"user\" is extracted in function sub_7E49C which is then passed to the vulnerable system API call.","details":"An issue was discovered on D-Link DCS-1130 devices. The device provides a user with the capability of setting a SMB folder for the video clippings recorded by the device. It seems that the GET parameters passed in this request (to test if SMB credentials and hostname sent to the device work properly) result in being passed as commands to a \"system\" API in the function and thus result in command injection on the device. If the firmware version is dissected using binwalk tool, we obtain a cramfs-root archive which contains the filesystem set up on the device that contains all the binaries. The binary \"cgibox\" is the one that has the vulnerable function \"sub_7EAFC\" that receives the values sent by the GET request. If we open this binary in IDA-pro we will notice that this follows a ARM little endian format. The function sub_7EAFC in IDA pro is identified to be receiving the values sent in the GET request and the value set in GET parameter \"user\" is extracted in function sub_7E49C which is then passed to the vulnerable system API call.","references":["https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Dlink_DCS_1130_security.pdf","https://seclists.org/bugtraq/2019/Jun/8","https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Dlink_DCS_1130_security.pdf"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-8411","product":"smb","summary":"An issue was discovered on D-Link DCS-1130 devices. The device provides a user with the capability of setting a SMB folder for the video clippings recorded by the device. It seems that the POST parameters passed in this request (to test if email credentials and hostname sent to the device work properly) result in being passed as commands to a \"system\" API in the function and thus result in command injection on the device. If the firmware version is dissected using binwalk tool, we obtain a cramfs-root archive which contains the filesystem set up on the device that contains all the binaries. The library \"libmailutils.so\" is the one that has the vulnerable function \"sub_1FC4\" that receives the values sent by the POST request. If we open this binary in IDA-pro we will notice that this follows an ARM little endian format. The function sub_1FC4 in IDA pro is identified to be receiving the values sent in the POST request and the value set in POST parameter \"receiver1\" is extracted in function \"sub_15AC\" which is then passed to the vulnerable system API call. The vulnerable library function is accessed in \"cgibox\" binary at address 0x00023BCC which calls the \"Send_mail\" function in \"libmailutils.so\" binary as shown below which results in the vulnerable POST parameter being passed to the library which results in the command injection issue.","details":"An issue was discovered on D-Link DCS-1130 devices. The device provides a user with the capability of setting a SMB folder for the video clippings recorded by the device. It seems that the POST parameters passed in this request (to test if email credentials and hostname sent to the device work properly) result in being passed as commands to a \"system\" API in the function and thus result in command injection on the device. If the firmware version is dissected using binwalk tool, we obtain a cramfs-root archive which contains the filesystem set up on the device that contains all the binaries. The library \"libmailutils.so\" is the one that has the vulnerable function \"sub_1FC4\" that receives the values sent by the POST request. If we open this binary in IDA-pro we will notice that this follows an ARM little endian format. The function sub_1FC4 in IDA pro is identified to be receiving the values sent in the POST request and the value set in POST parameter \"receiver1\" is extracted in function \"sub_15AC\" which is then passed to the vulnerable system API call. The vulnerable library function is accessed in \"cgibox\" binary at address 0x00023BCC which calls the \"Send_mail\" function in \"libmailutils.so\" binary as shown below which results in the vulnerable POST parameter being passed to the library which results in the command injection issue.","references":["http://packetstormsecurity.com/files/153226/Dlink-DCS-1130-Command-Injection-CSRF-Stack-Overflow.html","https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Dlink_DCS_1130_security.pdf","https://seclists.org/bugtraq/2019/Jun/8"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2017-8849","product":"smb","summary":"smb4k before 2.0.1 allows local users to gain root privileges by leveraging failure to verify arguments to the mount helper DBUS service.","details":"smb4k before 2.0.1 allows local users to gain root privileges by leveraging failure to verify arguments to the mount helper DBUS service.","references":["http://www.debian.org/security/2017/dsa-3951","http://www.openwall.com/lists/oss-security/2017/05/10/3","http://www.securityfocus.com/bid/98690"],"severity":"HIGH","match_type":"active_check","confidence":"high","required_script":"ftp-vuln-cve2017-8849"},
  {"id":"CVE-2017-9461","product":"smb","summary":"smbd in Samba before 4.4.10 and 4.5.x before 4.5.6 has a denial of service vulnerability (fd_open_atomic infinite loop with high CPU usage and memory consumption) due to wrongly handling dangling symlinks.","details":"smbd in Samba before 4.4.10 and 4.5.x before 4.5.6 has a denial of service vulnerability (fd_open_atomic infinite loop with high CPU usage and memory consumption) due to wrongly handling dangling symlinks.","references":["http://www.securityfocus.com/bid/99455","https://access.redhat.com/errata/RHSA-2017:1950","https://access.redhat.com/errata/RHSA-2017:2338"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<=4.4.9"},
  {"id":"CVE-2018-0243","product":"smb","summary":"A vulnerability in the detection engine of Cisco Firepower System Software could allow an unauthenticated, remote attacker to bypass a configured file action policy that is intended to drop the Server Message Block Version 2 (SMB2) and SMB Version 3 (SMB3) protocols if malware is detected. The vulnerability is due to incorrect detection of an SMB2 or SMB3 file based on the total file length. An attacker could exploit this vulnerability by sending a crafted SMB2 or SMB3 transfer request through the targeted device. An exploit could allow the attacker to pass SMB2 or SMB3 files that could be malware even though the device is configured to block them. This vulnerability does not exist for SMB Version 1 (SMB1) files. This vulnerability affects Cisco Firepower System Software when one or more file action policies are configured, on software releases prior to 6.2.3. Cisco Bug IDs: CSCvg68807.","details":"A vulnerability in the detection engine of Cisco Firepower System Software could allow an unauthenticated, remote attacker to bypass a configured file action policy that is intended to drop the Server Message Block Version 2 (SMB2) and SMB Version 3 (SMB3) protocols if malware is detected. The vulnerability is due to incorrect detection of an SMB2 or SMB3 file based on the total file length. An attacker could exploit this vulnerability by sending a crafted SMB2 or SMB3 transfer request through the targeted device. An exploit could allow the attacker to pass SMB2 or SMB3 files that could be malware even though the device is configured to block them. This vulnerability does not exist for SMB Version 1 (SMB1) files. This vulnerability affects Cisco Firepower System Software when one or more file action policies are configured, on software releases prior to 6.2.3. Cisco Bug IDs: CSCvg68807.","references":["http://www.securityfocus.com/bid/103943","https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-fss","http://www.securityfocus.com/bid/103943"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<6.2.3"},
  {"id":"CVE-2018-0244","product":"smb","summary":"A vulnerability in the detection engine of Cisco Firepower System Software could allow an unauthenticated, remote attacker to bypass a configured file action policy to drop the Server Message Block (SMB) protocol if a malware file is detected. The vulnerability is due to how the SMB protocol handles a case in which a large file transfer fails. This case occurs when some pieces of the file are successfully transferred to the remote endpoint, but ultimately the file transfer fails and is reset. An attacker could exploit this vulnerability by sending a crafted SMB file transfer request through the targeted device. An exploit could allow the attacker to pass an SMB file that contains malware, which the device is configured to block. This vulnerability affects Cisco Firepower System Software when one or more file action policies are configured, on software releases prior to 6.2.3. Cisco Bug IDs: CSCvc20141.","details":"A vulnerability in the detection engine of Cisco Firepower System Software could allow an unauthenticated, remote attacker to bypass a configured file action policy to drop the Server Message Block (SMB) protocol if a malware file is detected. The vulnerability is due to how the SMB protocol handles a case in which a large file transfer fails. This case occurs when some pieces of the file are successfully transferred to the remote endpoint, but ultimately the file transfer fails and is reset. An attacker could exploit this vulnerability by sending a crafted SMB file transfer request through the targeted device. An exploit could allow the attacker to pass an SMB file that contains malware, which the device is configured to block. This vulnerability affects Cisco Firepower System Software when one or more file action policies are configured, on software releases prior to 6.2.3. Cisco Bug IDs: CSCvc20141.","references":["http://www.securityfocus.com/bid/103945","https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-fss1","http://www.securityfocus.com/bid/103945"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<6.2.3"},
  {"id":"CVE-2018-0455","product":"smb","summary":"A vulnerability in the Server Message Block Version 2 (SMBv2) and Version 3 (SMBv3) protocol implementation for the Cisco Firepower System Software could allow an unauthenticated, remote attacker to cause the device to run low on system memory, possibly preventing the device from forwarding traffic. It is also possible that a manual reload of the device may be required to clear the condition. The vulnerability is due to incorrect SMB header validation. An attacker could exploit this vulnerability by sending a custom SMB file transfer through the targeted device. A successful exploit could cause the device to consume an excessive amount of system memory and prevent the SNORT process from forwarding network traffic. This vulnerability can be exploited using either IPv4 or IPv6 in combination with SMBv2 or SMBv3 network traffic.","details":"A vulnerability in the Server Message Block Version 2 (SMBv2) and Version 3 (SMBv3) protocol implementation for the Cisco Firepower System Software could allow an unauthenticated, remote attacker to cause the device to run low on system memory, possibly preventing the device from forwarding traffic. It is also possible that a manual reload of the device may be required to clear the condition. The vulnerability is due to incorrect SMB header validation. An attacker could exploit this vulnerability by sending a custom SMB file transfer through the targeted device. A successful exploit could cause the device to consume an excessive amount of system memory and prevent the SNORT process from forwarding network traffic. This vulnerability can be exploited using either IPv4 or IPv6 in combination with SMBv2 or SMBv3 network traffic.","references":["https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181003-fp-smb-snort","https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181003-fp-smb-snort"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-0749","product":"smb","summary":"The Microsoft Server Message Block (SMB) Server in Windows 7 SP1, Windows 8.1 and RT 8.1, Windows Server 2008 SP2 and R2 SP1, Windows Server 2012 and R2, Windows 10 Gold, 1511, 1607, 1703 and 1709, Windows Server 2016 and Windows Server, version 1709 allows an elevation of privilege vulnerability due to the way SMB Server handles specially crafted files, aka \"Windows Elevation of Privilege Vulnerability\".","details":"The Microsoft Server Message Block (SMB) Server in Windows 7 SP1, Windows 8.1 and RT 8.1, Windows Server 2008 SP2 and R2 SP1, Windows Server 2012 and R2, Windows 10 Gold, 1511, 1607, 1703 and 1709, Windows Server 2016 and Windows Server, version 1709 allows an elevation of privilege vulnerability due to the way SMB Server handles specially crafted files, aka \"Windows Elevation of Privilege Vulnerability\".","references":["http://www.securityfocus.com/bid/102355","http://www.securitytracker.com/id/1040096","https://95cnsec.com/windows-smb-cve-2018-0749-exploit.html"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-1000041","product":"smb","summary":"GNOME librsvg version before commit c6ddf2ed4d768fd88adbea2b63f575cd523022ea contains a Improper input validation vulnerability in rsvg-io.c that can result in the victim's Windows username and NTLM password hash being leaked to remote attackers through SMB. This attack appear to be exploitable via The victim must process a specially crafted SVG file containing an UNC path on Windows.","details":"GNOME librsvg version before commit c6ddf2ed4d768fd88adbea2b63f575cd523022ea contains a Improper input validation vulnerability in rsvg-io.c that can result in the victim's Windows username and NTLM password hash being leaked to remote attackers through SMB. This attack appear to be exploitable via The victim must process a specially crafted SVG file containing an UNC path on Windows.","references":["https://github.com/GNOME/librsvg/commit/c6ddf2ed4d768fd88adbea2b63f575cd523022ea","https://github.com/ImageMagick/librsvg/commit/f9d69eadd2b16b00d1a1f9f286122123f8e547dd","https://lists.debian.org/debian-lts-announce/2018/02/msg00013.html"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<2.41.2"},
  {"id":"CVE-2018-1000515","product":"smb","summary":"ventrian News-Articles version NewsArticles.00.09.11 contains a XML External Entity (XXE) vulnerability in News-Articles/API/MetaWebLog/Handler.ashx.vb that can result in Attacker can read any file in the server or use smbrelay attack to access to server..","details":"ventrian News-Articles version NewsArticles.00.09.11 contains a XML External Entity (XXE) vulnerability in News-Articles/API/MetaWebLog/Handler.ashx.vb that can result in Attacker can read any file in the server or use smbrelay attack to access to server..","references":["https://drive.google.com/drive/folders/1P7djpYX8VQ0oplhOCMFNdKQByCcw2ncU?usp=sharing","https://drive.google.com/drive/folders/1P7djpYX8VQ0oplhOCMFNdKQByCcw2ncU?usp=sharing"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-10103","product":"smb","summary":"tcpdump before 4.9.3 mishandles the printing of SMB data (issue 1 of 2).","details":"tcpdump before 4.9.3 mishandles the printing of SMB data (issue 1 of 2).","references":["http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00050.html","http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00053.html","http://seclists.org/fulldisclosure/2019/Dec/26"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<4.9.3"},
  {"id":"CVE-2018-10105","product":"smb","summary":"tcpdump before 4.9.3 mishandles the printing of SMB data (issue 2 of 2).","details":"tcpdump before 4.9.3 mishandles the printing of SMB data (issue 2 of 2).","references":["http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00050.html","http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00053.html","http://seclists.org/fulldisclosure/2019/Dec/26"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<4.9.3"},
  {"id":"CVE-2018-10583","product":"smb","summary":"An information disclosure vulnerability occurs when LibreOffice 6.0.3 and Apache OpenOffice Writer 4.1.5 automatically process and initiate an SMB connection embedded in a malicious file, as demonstrated by xlink:href=file://192.168.0.2/test.jpg within an office:document-content element in a .odt XML document.","details":"An information disclosure vulnerability occurs when LibreOffice 6.0.3 and Apache OpenOffice Writer 4.1.5 automatically process and initiate an SMB connection embedded in a malicious file, as demonstrated by xlink:href=file://192.168.0.2/test.jpg within an office:document-content element in a .odt XML document.","references":["http://seclists.org/fulldisclosure/2020/Oct/26","http://secureyourit.co.uk/wp/2018/05/01/creating-malicious-odt-files/","https://access.redhat.com/errata/RHSA-2018:3054"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-11101","product":"smb","summary":"Open Whisper Signal (aka Signal-Desktop) through 1.10.1 allows XSS via a resource location specified in an attribute of a SCRIPT, IFRAME, or IMG element, leading to JavaScript execution after a reply, a different vulnerability than CVE-2018-10994. The attacker needs to send HTML code directly as a message, and then reply to that message to trigger this vulnerability. The Signal-Desktop software fails to sanitize specific HTML elements that can be used to inject HTML code into remote chat windows when replying to an HTML message. Specifically the IMG and IFRAME elements can be used to include remote or local resources. For example, the use of an IFRAME element enables full code execution, allowing an attacker to download/upload files, information, etc. The SCRIPT element was also found to be injectable. On the Windows operating system, the CSP fails to prevent remote inclusion of resources via the SMB protocol. In this case, remote execution of JavaScript can be achieved by referencing the script on an SMB share within an IFRAME element, for example: <IFRAME src=\\\\DESKTOP-XXXXX\\Temp\\test.html> and then replying to it. The included JavaScript code is then executed automatically, without any interaction needed from the user. The vulnerability can be triggered in the Signal-Desktop client by sending a specially crafted message and then replying to it with any text or content in the reply (it doesn't matter).","details":"Open Whisper Signal (aka Signal-Desktop) through 1.10.1 allows XSS via a resource location specified in an attribute of a SCRIPT, IFRAME, or IMG element, leading to JavaScript execution after a reply, a different vulnerability than CVE-2018-10994. The attacker needs to send HTML code directly as a message, and then reply to that message to trigger this vulnerability. The Signal-Desktop software fails to sanitize specific HTML elements that can be used to inject HTML code into remote chat windows when replying to an HTML message. Specifically the IMG and IFRAME elements can be used to include remote or local resources. For example, the use of an IFRAME element enables full code execution, allowing an attacker to download/upload files, information, etc. The SCRIPT element was also found to be injectable. On the Windows operating system, the CSP fails to prevent remote inclusion of resources via the SMB protocol. In this case, remote execution of JavaScript can be achieved by referencing the script on an SMB share within an IFRAME element, for example: <IFRAME src=\\\\DESKTOP-XXXXX\\Temp\\test.html> and then replying to it. The included JavaScript code is then executed automatically, without any interaction needed from the user. The vulnerability can be triggered in the Signal-Desktop client by sending a specially crafted message and then replying to it with any text or content in the reply (it doesn't matter).","references":["http://seclists.org/fulldisclosure/2018/May/46","http://seclists.org/fulldisclosure/2018/May/46"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<=1.10.1"},
  {"id":"CVE-2018-11338","product":"smb","summary":"Intuit Lacerte 2017 for Windows in a client/server environment transfers the entire customer list in cleartext over SMB, which allows attackers to (1) obtain sensitive information by sniffing the network or (2) conduct man-in-the-middle (MITM) attacks via unspecified vectors. The customer list contains each customer's full name, social security number (SSN), address, job title, phone number, Email address, spouse's phone/Email address, and other sensitive information. After the client software authenticates to the server database, the server sends the customer list. There is no need for further exploitation as all sensitive data is exposed. This vulnerability was validated on Intuit Lacerte 2017, however older versions of Lacerte may be vulnerable.","details":"Intuit Lacerte 2017 for Windows in a client/server environment transfers the entire customer list in cleartext over SMB, which allows attackers to (1) obtain sensitive information by sniffing the network or (2) conduct man-in-the-middle (MITM) attacks via unspecified vectors. The customer list contains each customer's full name, social security number (SSN), address, job title, phone number, Email address, spouse's phone/Email address, and other sensitive information. After the client software authenticates to the server database, the server sends the customer list. There is no need for further exploitation as all sensitive data is exposed. This vulnerability was validated on Intuit Lacerte 2017, however older versions of Lacerte may be vulnerable.","references":["https://corporateblue.com/your-taxes-are-being-leaked/","https://www.themikewylie.com/intuit-lacerte-vulnerability-and-data-exposure-cve-2018-11338-cve-2018-14833/","https://corporateblue.com/your-taxes-are-being-leaked/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<=2017"},
  {"id":"CVE-2018-1165","product":"smb","summary":"This vulnerability allows local attackers to escalate privileges on vulnerable installations of Joyent SmartOS release-20170803-20170803T064301Z. An attacker must first obtain the ability to execute low-privileged code on the target system in order to exploit this vulnerability. The specific flaw exists within the SMB_IOC_SVCENUM IOCTL. The issue results from the lack of proper validation of the length of user-supplied data prior to copying it to a fixed-length, heap-based buffer. An attacker can leverage this vulnerability to execute code under the context of the host OS. Was ZDI-CAN-4983.","details":"This vulnerability allows local attackers to escalate privileges on vulnerable installations of Joyent SmartOS release-20170803-20170803T064301Z. An attacker must first obtain the ability to execute low-privileged code on the target system in order to exploit this vulnerability. The specific flaw exists within the SMB_IOC_SVCENUM IOCTL. The issue results from the lack of proper validation of the length of user-supplied data prior to copying it to a fixed-length, heap-based buffer. An attacker can leverage this vulnerability to execute code under the context of the host OS. Was ZDI-CAN-4983.","references":["https://help.joyent.com/hc/en-us/articles/360000124928","https://www.oracle.com/security-alerts/cpuapr2020.html","https://zerodayinitiative.com/advisories/ZDI-18-158"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-1166","product":"smb","summary":"This vulnerability allows local attackers to escalate privileges on vulnerable installations of Joyent SmartOS release-20170803-20170803T064301Z. An attacker must first obtain the ability to execute low-privileged code on the target system in order to exploit this vulnerability. The specific flaw exists within the SMBIOC_TREE_RELE ioctl. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to execute code under the context of the host OS. Was ZDI-CAN-4984.","details":"This vulnerability allows local attackers to escalate privileges on vulnerable installations of Joyent SmartOS release-20170803-20170803T064301Z. An attacker must first obtain the ability to execute low-privileged code on the target system in order to exploit this vulnerability. The specific flaw exists within the SMBIOC_TREE_RELE ioctl. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to execute code under the context of the host OS. Was ZDI-CAN-4984.","references":["https://help.joyent.com/hc/en-us/articles/360000124928","https://zerodayinitiative.com/advisories/ZDI-18-159","https://help.joyent.com/hc/en-us/articles/360000124928"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-12268","product":"smb","summary":"acccheck.pl in acccheck 0.2.1 allows Command Injection via shell metacharacters in a username or password file, as demonstrated by injection into an smbclient command line.","details":"acccheck.pl in acccheck 0.2.1 allows Command Injection via shell metacharacters in a username or password file, as demonstrated by injection into an smbclient command line.","references":["http://b3n7s.github.io/acccheck-command-injection.html","http://b3n7s.github.io/acccheck-command-injection.html"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-13415","product":"smb","summary":"In Plex Media Server 1.13.2.5154, the XML parsing engine for SSDP/UPnP functionality is vulnerable to an XML External Entity Processing (XXE) attack. Remote, unauthenticated attackers can use this vulnerability to: (1) Access arbitrary files from the filesystem with the same permission as the user account running Plex, (2) Initiate SMB connections to capture a NetNTLM challenge/response and crack to cleartext password, or (3) Initiate SMB connections to relay a NetNTLM challenge/response and achieve Remote Command Execution in Windows domains.","details":"In Plex Media Server 1.13.2.5154, the XML parsing engine for SSDP/UPnP functionality is vulnerable to an XML External Entity Processing (XXE) attack. Remote, unauthenticated attackers can use this vulnerability to: (1) Access arbitrary files from the filesystem with the same permission as the user account running Plex, (2) Initiate SMB connections to capture a NetNTLM challenge/response and crack to cleartext password, or (3) Initiate SMB connections to relay a NetNTLM challenge/response and achieve Remote Command Execution in Windows domains.","references":["http://seclists.org/fulldisclosure/2018/Aug/1","https://www.exploit-db.com/exploits/45146/","http://seclists.org/fulldisclosure/2018/Aug/1"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-13416","product":"smb","summary":"In Universal Media Server (UMS) 7.1.0, the XML parsing engine for SSDP/UPnP functionality is vulnerable to an XML External Entity Processing (XXE) attack. Remote, unauthenticated attackers can use this vulnerability to: (1) Access arbitrary files from the filesystem with the same permission as the user account running UMS, (2) Initiate SMB connections to capture a NetNTLM challenge/response and crack to cleartext password, or (3) Initiate SMB connections to relay a NetNTLM challenge/response and achieve Remote Command Execution in Windows domains.","details":"In Universal Media Server (UMS) 7.1.0, the XML parsing engine for SSDP/UPnP functionality is vulnerable to an XML External Entity Processing (XXE) attack. Remote, unauthenticated attackers can use this vulnerability to: (1) Access arbitrary files from the filesystem with the same permission as the user account running UMS, (2) Initiate SMB connections to capture a NetNTLM challenge/response and crack to cleartext password, or (3) Initiate SMB connections to relay a NetNTLM challenge/response and achieve Remote Command Execution in Windows domains.","references":["http://seclists.org/fulldisclosure/2018/Jul/94","https://www.exploit-db.com/exploits/45133/","http://seclists.org/fulldisclosure/2018/Jul/94"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-13417","product":"smb","summary":"In Vuze Bittorrent Client 5.7.6.0, the XML parsing engine for SSDP/UPnP functionality is vulnerable to an XML External Entity Processing (XXE) attack. Remote, unauthenticated attackers can use this vulnerability to: (1) Access arbitrary files from the filesystem with the same permission as the user account running Vuze, (2) Initiate SMB connections to capture a NetNTLM challenge/response and crack to cleartext password, or (3) Initiate SMB connections to relay a NetNTLM challenge/response and achieve Remote Command Execution in Windows domains.","details":"In Vuze Bittorrent Client 5.7.6.0, the XML parsing engine for SSDP/UPnP functionality is vulnerable to an XML External Entity Processing (XXE) attack. Remote, unauthenticated attackers can use this vulnerability to: (1) Access arbitrary files from the filesystem with the same permission as the user account running Vuze, (2) Initiate SMB connections to capture a NetNTLM challenge/response and crack to cleartext password, or (3) Initiate SMB connections to relay a NetNTLM challenge/response and achieve Remote Command Execution in Windows domains.","references":["http://seclists.org/fulldisclosure/2018/Aug/2","https://www.exploit-db.com/exploits/45145/","http://seclists.org/fulldisclosure/2018/Aug/2"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-13789","product":"smb","summary":"An issue was discovered in Descor Infocad FM before 3.1.0.0. An unauthenticated web service allows the retrieval of files on the web server and on reachable SMB servers.","details":"An issue was discovered in Descor Infocad FM before 3.1.0.0. An unauthenticated web service allows the retrieval of files on the web server and on reachable SMB servers.","references":["https://www.quantumleap.it/infocad-facility-management-cve-2018-13789-unauthenticated-webservice-allows-retrieval-arbitrary-files/","https://www.quantumleap.it/infocad-facility-management-cve-2018-13789-unauthenticated-webservice-allows-retrieval-arbitrary-files/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<3.1.0.0"},
  {"id":"CVE-2018-14607","product":"smb","summary":"Thomson Reuters UltraTax CS 2017 on Windows, in a client/server configuration, transfers customer records and bank account numbers in cleartext over SMBv2, which allows attackers to (1) obtain sensitive information by sniffing the network or (2) conduct man-in-the-middle (MITM) attacks via unspecified vectors. The customer record transferred in cleartext contains: Client ID, Full Name, Spouse's Full Name, Social Security Number, Spouse's Social Security Number, Occupation, Spouse's Occupation, Daytime Phone, Home Phone, Tax Preparer, Federal and State Taxes to File, Bank Name, Bank Account Number, and possibly other sensitive information.","details":"Thomson Reuters UltraTax CS 2017 on Windows, in a client/server configuration, transfers customer records and bank account numbers in cleartext over SMBv2, which allows attackers to (1) obtain sensitive information by sniffing the network or (2) conduct man-in-the-middle (MITM) attacks via unspecified vectors. The customer record transferred in cleartext contains: Client ID, Full Name, Spouse's Full Name, Social Security Number, Spouse's Social Security Number, Occupation, Spouse's Occupation, Daytime Phone, Home Phone, Tax Preparer, Federal and State Taxes to File, Bank Name, Bank Account Number, and possibly other sensitive information.","references":["https://corporateblue.com/ultratax-cs-data-exposure-vulnerability/","https://www.themikewylie.com/ultratax-cs-data-exposure-vulnerability-cve-2018-14608-cve-2018-14607/","https://corporateblue.com/ultratax-cs-data-exposure-vulnerability/"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-15506","product":"smb","summary":"In BubbleUPnP 0.9 update 30, the XML parsing engine for SSDP/UPnP functionality is vulnerable to an XML External Entity Processing (XXE) attack. Remote, unauthenticated attackers can use this vulnerability to: (1) Access arbitrary files from the filesystem with the same permission as the user account running BubbleUPnP, (2) Initiate SMB connections to capture a NetNTLM challenge/response and crack the cleartext password, or (3) Initiate SMB connections to relay a NetNTLM challenge/response and achieve Remote Command Execution in Windows domains.","details":"In BubbleUPnP 0.9 update 30, the XML parsing engine for SSDP/UPnP functionality is vulnerable to an XML External Entity Processing (XXE) attack. Remote, unauthenticated attackers can use this vulnerability to: (1) Access arbitrary files from the filesystem with the same permission as the user account running BubbleUPnP, (2) Initiate SMB connections to capture a NetNTLM challenge/response and crack the cleartext password, or (3) Initiate SMB connections to relay a NetNTLM challenge/response and achieve Remote Command Execution in Windows domains.","references":["https://www.bubblesoftapps.com/bubbleupnpserver2/docs/changelog.html","https://www.bubblesoftapps.com/bubbleupnpserver2/docs/changelog.html"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-15553","product":"smb","summary":"fileshare.cmd on Telus Actiontec T2200H T2200H-31.128L.03 devices allows OS Command Injection via shell metacharacters in the smbdUserid or smbdPasswd field.","details":"fileshare.cmd on Telus Actiontec T2200H T2200H-31.128L.03 devices allows OS Command Injection via shell metacharacters in the smbdUserid or smbdPasswd field.","references":["http://seclists.org/fulldisclosure/2016/Aug/75","http://seclists.org/fulldisclosure/2016/Aug/75"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-16364","product":"smb","summary":"A serialization vulnerability in Zoho ManageEngine Applications Manager before build 13740 allows for remote code execution on Windows via a payload on an SMB share.","details":"A serialization vulnerability in Zoho ManageEngine Applications Manager before build 13740 allows for remote code execution on Windows via a payload on an SMB share.","references":["https://blog.jamesotten.com/post/applications-manager-rce/","https://blog.jamesotten.com/post/applications-manager-rce/"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-16451","product":"smb","summary":"The SMB parser in tcpdump before 4.9.3 has buffer over-reads in print-smb.c:print_trans() for \\MAILSLOT\\BROWSE and \\PIPE\\LANMAN.","details":"The SMB parser in tcpdump before 4.9.3 has buffer over-reads in print-smb.c:print_trans() for \\MAILSLOT\\BROWSE and \\PIPE\\LANMAN.","references":["http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00050.html","http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00053.html","http://seclists.org/fulldisclosure/2019/Dec/26"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<4.9.3"],["<10.15.2"]]},
  {"id":"CVE-2018-16452","product":"smb","summary":"The SMB parser in tcpdump before 4.9.3 has stack exhaustion in smbutil.c:smb_fdata() via recursion.","details":"The SMB parser in tcpdump before 4.9.3 has stack exhaustion in smbutil.c:smb_fdata() via recursion.","references":["http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00050.html","http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00053.html","http://seclists.org/fulldisclosure/2019/Dec/26"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<4.9.3"},
  {"id":"CVE-2018-20106","product":"smb","summary":"In yast2-printer up to and including version 4.0.2 the SMB printer settings don't escape characters in passwords properly. If a password with backticks or simliar characters is supplied this allows for executing code as root. This requires tricking root to enter such a password in yast.","details":"In yast2-printer up to and including version 4.0.2 the SMB printer settings don't escape characters in passwords properly. If a password with backticks or simliar characters is supplied this allows for executing code as root. This requires tricking root to enter such a password in yast.","references":["https://bugzilla.suse.com/show_bug.cgi?id=1114853","https://bugzilla.suse.com/show_bug.cgi?id=1114853"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<=4.0.2"},
  {"id":"CVE-2018-2449","product":"smb","summary":"SAP SRM MDM Catalog versions 3.73, 7.31, 7.32 in (SAP NetWeaver 7.3) - import functionality does not perform authentication checks for valid repository user. This is an unauthenticated functionality that you can use on windows machines to do SMB relaying.","details":"SAP SRM MDM Catalog versions 3.73, 7.31, 7.32 in (SAP NetWeaver 7.3) - import functionality does not perform authentication checks for valid repository user. This is an unauthenticated functionality that you can use on windows machines to do SMB relaying.","references":["http://www.securityfocus.com/bid/105079","https://launchpad.support.sap.com/#/notes/2655250","https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=499352742"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-3268","product":"smb","summary":"Vulnerability in the Solaris component of Oracle Sun Systems Products Suite (subcomponent: SMB Server). The supported version that is affected is 11.3. Easily exploitable vulnerability allows unauthenticated attacker with network access via SMB to compromise Solaris. Successful attacks of this vulnerability can result in unauthorized ability to cause a partial denial of service (partial DOS) of Solaris. CVSS 3.0 Base Score 5.3 (Availability impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L).","details":"Vulnerability in the Solaris component of Oracle Sun Systems Products Suite (subcomponent: SMB Server). The supported version that is affected is 11.3. Easily exploitable vulnerability allows unauthenticated attacker with network access via SMB to compromise Solaris. Successful attacks of this vulnerability can result in unauthorized ability to cause a partial denial of service (partial DOS) of Solaris. CVSS 3.0 Base Score 5.3 (Availability impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L).","references":["http://www.oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html","http://www.securityfocus.com/bid/105604","http://www.securitytracker.com/id/1041895"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-3269","product":"smb","summary":"Vulnerability in the Solaris component of Oracle Sun Systems Products Suite (subcomponent: SMB Server). The supported version that is affected is 11.3. Easily exploitable vulnerability allows low privileged attacker with network access via SMB to compromise Solaris. Successful attacks of this vulnerability can result in unauthorized ability to cause a partial denial of service (partial DOS) of Solaris. CVSS 3.0 Base Score 4.3 (Availability impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L).","details":"Vulnerability in the Solaris component of Oracle Sun Systems Products Suite (subcomponent: SMB Server). The supported version that is affected is 11.3. Easily exploitable vulnerability allows low privileged attacker with network access via SMB to compromise Solaris. Successful attacks of this vulnerability can result in unauthorized ability to cause a partial denial of service (partial DOS) of Solaris. CVSS 3.0 Base Score 4.3 (Availability impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L).","references":["http://www.oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html","http://www.securityfocus.com/bid/105604","http://www.securitytracker.com/id/1041895"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-3274","product":"smb","summary":"Vulnerability in the Solaris component of Oracle Sun Systems Products Suite (subcomponent: Kernel). The supported version that is affected is 11.3. Easily exploitable vulnerability allows low privileged attacker with network access via SMB to compromise Solaris. Successful attacks require human interaction from a person other than the attacker. Successful attacks of this vulnerability can result in unauthorized ability to cause a hang or frequently repeatable crash (complete DOS) of Solaris. CVSS 3.0 Base Score 5.7 (Availability impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:H).","details":"Vulnerability in the Solaris component of Oracle Sun Systems Products Suite (subcomponent: Kernel). The supported version that is affected is 11.3. Easily exploitable vulnerability allows low privileged attacker with network access via SMB to compromise Solaris. Successful attacks require human interaction from a person other than the attacker. Successful attacks of this vulnerability can result in unauthorized ability to cause a hang or frequently repeatable crash (complete DOS) of Solaris. CVSS 3.0 Base Score 5.7 (Availability impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:H).","references":["http://www.oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html","http://www.securityfocus.com/bid/105604","http://www.securitytracker.com/id/1041895"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-3682","product":"smb","summary":"BMC Firmware in Intel server boards, compute modules, and systems potentially allow an attacker with administrative privileges to make unauthorized read\\writes to the SMBUS.","details":"BMC Firmware in Intel server boards, compute modules, and systems potentially allow an attacker with administrative privileges to make unauthorized read\\writes to the SMBUS.","references":["https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00130.html","https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00130.html"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-5490","product":"smb","summary":"Read-Only export policy rules are not correctly enforced in Clustered Data ONTAP 8.3 Release Candidate versions and therefore may allow more than \"read-only\" access from authenticated SMBv2 and SMBv3 clients. This behavior has been resolved in the GA release. Customers running prior release candidates (RCs) are requested to update their systems to the NetApp Data ONTAP 8.3 GA release.","details":"Read-Only export policy rules are not correctly enforced in Clustered Data ONTAP 8.3 Release Candidate versions and therefore may allow more than \"read-only\" access from authenticated SMBv2 and SMBv3 clients. This behavior has been resolved in the GA release. Customers running prior release candidates (RCs) are requested to update their systems to the NetApp Data ONTAP 8.3 GA release.","references":["https://security.netapp.com/advisory/ntap-20150324-0001/","https://security.netapp.com/advisory/ntap-20150324-0001/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<8.3"},
  {"id":"CVE-2018-5498","product":"smb","summary":"Clustered Data ONTAP versions 9.0 through 9.4 are susceptible to a vulnerability which allows remote authenticated attackers to cause a Denial of Service (DoS) in NFS and SMB environments. Exploitation of this vulnerability will allow a remote authenticated attacker to cause a Denial of Service (DoS) on affected versions of clustered Data ONTAP configured for multiprotocol access.","details":"Clustered Data ONTAP versions 9.0 through 9.4 are susceptible to a vulnerability which allows remote authenticated attackers to cause a Denial of Service (DoS) in NFS and SMB environments. Exploitation of this vulnerability will allow a remote authenticated attacker to cause a Denial of Service (DoS) on affected versions of clustered Data ONTAP configured for multiprotocol access.","references":["https://security.netapp.com/advisory/ntap-20190115-0001/","https://security.netapp.com/advisory/ntap-20190115-0001/"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[">=9.0","<=9.4"]},
  {"id":"CVE-2018-6546","product":"smb","summary":"plays_service.exe in the plays.tv service before 1.27.7.0, as distributed in AMD driver-installation packages and Gaming Evolved products, executes code at a user-defined (local or SMB) path as SYSTEM when the execute_installer parameter is used in an HTTP message. This occurs without properly authenticating the user.","details":"plays_service.exe in the plays.tv service before 1.27.7.0, as distributed in AMD driver-installation packages and Gaming Evolved products, executes code at a user-defined (local or SMB) path as SYSTEM when the execute_installer parameter is used in an HTTP message. This occurs without properly authenticating the user.","references":["https://github.com/securifera/CVE-2018-6546-Exploit/","https://www.exploit-db.com/exploits/44476/","https://www.securifera.com/advisories/CVE-2018-6546/"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<1.27.7.0"},
  {"id":"CVE-2018-7445","product":"smb","summary":"A buffer overflow was found in the MikroTik RouterOS SMB service when processing NetBIOS session request messages. Remote attackers with access to the service can exploit this vulnerability and gain code execution on the system. The overflow occurs before authentication takes place, so it is possible for an unauthenticated remote attacker to exploit it. All architectures and all devices running RouterOS before versions 6.41.3/6.42rc27 are vulnerable.","details":"A buffer overflow was found in the MikroTik RouterOS SMB service when processing NetBIOS session request messages. Remote attackers with access to the service can exploit this vulnerability and gain code execution on the system. The overflow occurs before authentication takes place, so it is possible for an unauthenticated remote attacker to exploit it. All architectures and all devices running RouterOS before versions 6.41.3/6.42rc27 are vulnerable.","references":["http://seclists.org/fulldisclosure/2018/Mar/38","http://www.securityfocus.com/bid/103427","https://www.coresecurity.com/advisories/mikrotik-routeros-smb-buffer-overflow"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<6.41.3"},
  {"id":"CVE-2018-8335","product":"smb","summary":"A denial of service vulnerability exists in the Microsoft Server Block Message (SMB) when an attacker sends specially crafted requests to the server, aka \"Windows SMB Denial of Service Vulnerability.\" This affects Windows Server 2012 R2, Windows RT 8.1, Windows Server 2012, Windows Server 2016, Windows 8.1, Windows 10, Windows 10 Servers.","details":"A denial of service vulnerability exists in the Microsoft Server Block Message (SMB) when an attacker sends specially crafted requests to the server, aka \"Windows SMB Denial of Service Vulnerability.\" This affects Windows Server 2012 R2, Windows RT 8.1, Windows Server 2012, Windows Server 2016, Windows 8.1, Windows 10, Windows 10 Servers.","references":["http://www.securityfocus.com/bid/105224","http://www.securitytracker.com/id/1041634","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8335"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2018-8444","product":"smb","summary":"An information disclosure vulnerability exists in the way that the Microsoft Server Message Block 2.0 (SMBv2) server handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability.\" This affects Windows Server 2012, Windows 10, Windows 8.1, Windows RT 8.1, Windows Server 2012 R2.","details":"An information disclosure vulnerability exists in the way that the Microsoft Server Message Block 2.0 (SMBv2) server handles certain requests, aka \"Windows SMB Information Disclosure Vulnerability.\" This affects Windows Server 2012, Windows 10, Windows 8.1, Windows RT 8.1, Windows Server 2012 R2.","references":["http://www.securityfocus.com/bid/105226","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8444","http://www.securityfocus.com/bid/105226"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-0630","product":"smb","summary":"A remote code execution vulnerability exists in the way that the Microsoft Server Message Block 2.0 (SMBv2) server handles certain requests, aka 'Windows SMB Remote Code Execution Vulnerability'. This CVE ID is unique from CVE-2019-0633.","details":"A remote code execution vulnerability exists in the way that the Microsoft Server Message Block 2.0 (SMBv2) server handles certain requests, aka 'Windows SMB Remote Code Execution Vulnerability'. This CVE ID is unique from CVE-2019-0633.","references":["http://www.securityfocus.com/bid/106876","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0630","http://www.securityfocus.com/bid/106876"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-0633","product":"smb","summary":"A remote code execution vulnerability exists in the way that the Microsoft Server Message Block 2.0 (SMBv2) server handles certain requests, aka 'Windows SMB Remote Code Execution Vulnerability'. This CVE ID is unique from CVE-2019-0630.","details":"A remote code execution vulnerability exists in the way that the Microsoft Server Message Block 2.0 (SMBv2) server handles certain requests, aka 'Windows SMB Remote Code Execution Vulnerability'. This CVE ID is unique from CVE-2019-0630.","references":["http://www.securityfocus.com/bid/106916","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0633","http://www.securityfocus.com/bid/106916"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-0703","product":"smb","summary":"An information disclosure vulnerability exists in the way that the Windows SMB Server handles certain requests, aka 'Windows SMB Information Disclosure Vulnerability'. This CVE ID is unique from CVE-2019-0704, CVE-2019-0821.","details":"An information disclosure vulnerability exists in the way that the Windows SMB Server handles certain requests, aka 'Windows SMB Information Disclosure Vulnerability'. This CVE ID is unique from CVE-2019-0704, CVE-2019-0821.","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0703","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0703"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-0704","product":"smb","summary":"An information disclosure vulnerability exists in the way that the Windows SMB Server handles certain requests, aka 'Windows SMB Information Disclosure Vulnerability'. This CVE ID is unique from CVE-2019-0703, CVE-2019-0821.","details":"An information disclosure vulnerability exists in the way that the Windows SMB Server handles certain requests, aka 'Windows SMB Information Disclosure Vulnerability'. This CVE ID is unique from CVE-2019-0703, CVE-2019-0821.","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0704","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0704"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-0786","product":"smb","summary":"An elevation of privilege vulnerability exists in the Microsoft Server Message Block (SMB) Server when an attacker with valid credentials attempts to open a specially crafted file over the SMB protocol on the same machine, aka 'SMB Server Elevation of Privilege Vulnerability'.","details":"An elevation of privilege vulnerability exists in the Microsoft Server Message Block (SMB) Server when an attacker with valid credentials attempts to open a specially crafted file over the SMB protocol on the same machine, aka 'SMB Server Elevation of Privilege Vulnerability'.","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0786","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0786"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-0821","product":"smb","summary":"An information disclosure vulnerability exists in the way that the Windows SMB Server handles certain requests, aka 'Windows SMB Information Disclosure Vulnerability'. This CVE ID is unique from CVE-2019-0703, CVE-2019-0704.","details":"An information disclosure vulnerability exists in the way that the Windows SMB Server handles certain requests, aka 'Windows SMB Information Disclosure Vulnerability'. This CVE ID is unique from CVE-2019-0703, CVE-2019-0704.","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0821","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0821"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-10051","product":"smb","summary":"An issue was discovered in Suricata 4.1.3. If the function filetracker_newchunk encounters an unsafe \"Some(sfcm) => { ft.new_chunk }\" item, then the program enters an smb/files.rs error condition and crashes.","details":"An issue was discovered in Suricata 4.1.3. If the function filetracker_newchunk encounters an unsafe \"Some(sfcm) => { ft.new_chunk }\" item, then the program enters an smb/files.rs error condition and crashes.","references":["https://github.com/OISF/suricata/pull/3734","https://redmine.openinfosecfoundation.org/issues/2896","https://suricata-ids.org/2019/04/30/suricata-4-1-4-released/"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-10218","product":"smb","summary":"A flaw was found in the samba client, all samba versions before samba 4.11.2, 4.10.10 and 4.9.15, where a malicious server can supply a pathname to the client with separators. This could allow the client to access files and folders outside of the SMB network pathnames. An attacker could use this vulnerability to create files outside of the current working directory using the privileges of the client user.","details":"A flaw was found in the samba client, all samba versions before samba 4.11.2, 4.10.10 and 4.9.15, where a malicious server can supply a pathname to the client with separators. This could allow the client to access files and folders outside of the SMB network pathnames. An attacker could use this vulnerability to create files outside of the current working directory using the privileges of the client user.","references":["http://lists.opensuse.org/opensuse-security-announce/2019-11/msg00015.html","https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10218","https://lists.debian.org/debian-lts-announce/2021/05/msg00023.html"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[">=4.10.0","<4.11.2","<4.10.10","<4.9.15",">=4.11.0"]},
  {"id":"CVE-2019-11283","product":"smb","summary":"Cloud Foundry SMB Volume, versions prior to v2.0.3, accidentally outputs sensitive information to the logs. A remote user with access to the SMB Volume logs can discover the username and password for volumes that have been recently created, allowing the user to take control of the SMB Volume.","details":"Cloud Foundry SMB Volume, versions prior to v2.0.3, accidentally outputs sensitive information to the logs. A remote user with access to the SMB Volume logs can discover the username and password for volumes that have been recently created, allowing the user to take control of the SMB Volume.","references":["https://www.cloudfoundry.org/blog/cve-2019-11283","https://www.cloudfoundry.org/blog/cve-2019-11283"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<2.0.3"],["<12.2.0"]]},
  {"id":"CVE-2019-11899","product":"smb","summary":"An unauthenticated attacker can achieve unauthorized access to sensitive data by exploiting Windows SMB protocol on a client installation. With Bosch Access Professional Edition (APE) 3.8, client installations need to be authorized by the APE administrator.","details":"An unauthenticated attacker can achieve unauthorized access to sensitive data by exploiting Windows SMB protocol on a client installation. With Bosch Access Professional Edition (APE) 3.8, client installations need to be authorized by the APE administrator.","references":["https://psirt.bosch.com/Advisory/BOSCH-SA-844044.html","https://psirt.bosch.com/Advisory/BOSCH-SA-844044.html"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<=3.7"},
  {"id":"CVE-2019-1204","product":"smb","summary":"An elevation of privilege vulnerability exists when Microsoft Outlook initiates processing of incoming messages without sufficient validation of the formatting of the messages. An attacker who successfully exploited the vulnerability could attempt to force Outlook to load a local or remote message store (over SMB).To exploit the vulnerability, the attacker could send a specially crafted email to a victim. Outlook would then attempt to open a pre-configured message store contained in the email upon receipt of the email.This update addresses the vulnerability by ensuring Office fully validates incoming email formatting before processing message content.","details":"An elevation of privilege vulnerability exists when Microsoft Outlook initiates processing of incoming messages without sufficient validation of the formatting of the messages. An attacker who successfully exploited the vulnerability could attempt to force Outlook to load a local or remote message store (over SMB).To exploit the vulnerability, the attacker could send a specially crafted email to a victim. Outlook would then attempt to open a pre-configured message store contained in the email upon receipt of the email.This update addresses the vulnerability by ensuring Office fully validates incoming email formatting before processing message content.","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1204","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1204"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-1293","product":"smb","summary":"An information disclosure vulnerability exists in Windows when the Windows SMB Client kernel-mode driver fails to properly handle objects in memory, aka 'Windows SMB Client Driver Information Disclosure Vulnerability'.","details":"An information disclosure vulnerability exists in Windows when the Windows SMB Client kernel-mode driver fails to properly handle objects in memory, aka 'Windows SMB Client Driver Information Disclosure Vulnerability'.","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1293","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1293"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-14223","product":"smb","summary":"An issue was discovered in Alfresco Community Edition versions below 5.2.6, 6.0.N and 6.1.N. The Alfresco Share application is vulnerable to an Open Redirect attack via a crafted POST request. By manipulating the POST parameters, an attacker can redirect a victim to a malicious website over any protocol the attacker desires (e.g.,http, https, ftp, smb, etc.).","details":"An issue was discovered in Alfresco Community Edition versions below 5.2.6, 6.0.N and 6.1.N. The Alfresco Share application is vulnerable to an Open Redirect attack via a crafted POST request. By manipulating the POST parameters, an attacker can redirect a victim to a malicious website over any protocol the attacker desires (e.g.,http, https, ftp, smb, etc.).","references":["https://community.alfresco.com/content?filterID=all~objecttype~thread%5Bquestions%5D","https://github.com/DrunkenShells/Disclosures/tree/master/CVE-2019-14223-Open%20Redirect%20in%20Alfresco%20Share-Alfresco%20Community","https://community.alfresco.com/content?filterID=all~objecttype~thread%5Bquestions%5D"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<5.2.6"},
  {"id":"CVE-2019-1443","product":"smb","summary":"An information disclosure vulnerability exists in Microsoft SharePoint when an attacker uploads a specially crafted file to the SharePoint Server.An authenticated attacker who successfully exploited this vulnerability could potentially leverage SharePoint functionality to obtain SMB hashes.The security update addresses the vulnerability by correcting how SharePoint checks file content., aka 'Microsoft SharePoint Information Disclosure Vulnerability'.","details":"An information disclosure vulnerability exists in Microsoft SharePoint when an attacker uploads a specially crafted file to the SharePoint Server.An authenticated attacker who successfully exploited this vulnerability could potentially leverage SharePoint functionality to obtain SMB hashes.The security update addresses the vulnerability by correcting how SharePoint checks file content., aka 'Microsoft SharePoint Information Disclosure Vulnerability'.","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1443","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1443"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-14476","product":"smb","summary":"AdRem NetCrunch 10.6.0.4587 has a Server-Side Request Forgery (SSRF) vulnerability in the NetCrunch server. Every user can trick the server into performing SMB requests to other systems.","details":"AdRem NetCrunch 10.6.0.4587 has a Server-Side Request Forgery (SSRF) vulnerability in the NetCrunch server. Every user can trick the server into performing SMB requests to other systems.","references":["https://compass-security.com/fileadmin/Research/Advisories/2020-10_CSNC-2019-011_AdRem_NetCrunch_Server-Side_Request_Forgery_SSRF.txt","https://www.adremsoft.com/support/","https://compass-security.com/fileadmin/Research/Advisories/2020-10_CSNC-2019-011_AdRem_NetCrunch_Server-Side_Request_Forgery_SSRF.txt"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-14907","product":"smb","summary":"All samba versions 4.9.x before 4.9.18, 4.10.x before 4.10.12 and 4.11.x before 4.11.5 have an issue where if it is set with \"log level = 3\" (or above) then the string obtained from the client, after a failed character conversion, is printed. Such strings can be provided during the NTLMSSP authentication exchange. In the Samba AD DC in particular, this may cause a long-lived process(such as the RPC server) to terminate. (In the file server case, the most likely target, smbd, operates as process-per-client and so a crash there is harmless).","details":"All samba versions 4.9.x before 4.9.18, 4.10.x before 4.10.12 and 4.11.x before 4.11.5 have an issue where if it is set with \"log level = 3\" (or above) then the string obtained from the client, after a failed character conversion, is printed. Such strings can be provided during the NTLMSSP authentication exchange. In the Samba AD DC in particular, this may cause a long-lived process(such as the RPC server) to terminate. (In the file server case, the most likely target, smbd, operates as process-per-client and so a crash there is harmless).","references":["http://lists.opensuse.org/opensuse-security-announce/2020-01/msg00055.html","https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-14907","https://lists.debian.org/debian-lts-announce/2021/05/msg00023.html"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[">=4.10.0","<4.11.5","<4.10.12",">=4.9.0","<4.9.18",">=4.11.0"]},
  {"id":"CVE-2019-15918","product":"smb","summary":"An issue was discovered in the Linux kernel before 5.0.10. SMB2_negotiate in fs/cifs/smb2pdu.c has an out-of-bounds read because data structures are incompletely updated after a change from smb30 to smb21.","details":"An issue was discovered in the Linux kernel before 5.0.10. SMB2_negotiate in fs/cifs/smb2pdu.c has an out-of-bounds read because data structures are incompletely updated after a change from smb30 to smb21.","references":["https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.0.10","https://github.com/torvalds/linux/commit/b57a55e2200ede754e4dc9cce4ba9402544b9365","https://security.netapp.com/advisory/ntap-20191004-0001/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<5.0.10"],[">=4.15","<4.19.73",">=4.13.5",">=4.20","<4.14.166"]]},
  {"id":"CVE-2019-15919","product":"smb","summary":"An issue was discovered in the Linux kernel before 5.0.10. SMB2_write in fs/cifs/smb2pdu.c has a use-after-free.","details":"An issue was discovered in the Linux kernel before 5.0.10. SMB2_write in fs/cifs/smb2pdu.c has a use-after-free.","references":["http://lists.opensuse.org/opensuse-security-announce/2019-09/msg00064.html","http://lists.opensuse.org/opensuse-security-announce/2019-09/msg00066.html","https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.0.10"],"severity":"LOW","match_type":"version_range","confidence":"high","version_match":"<5.0.10"},
  {"id":"CVE-2019-15920","product":"smb","summary":"An issue was discovered in the Linux kernel before 5.0.10. SMB2_read in fs/cifs/smb2pdu.c has a use-after-free. NOTE: this was not fixed correctly in 5.0.10; see the 5.0.11 ChangeLog, which documents a memory leak.","details":"An issue was discovered in the Linux kernel before 5.0.10. SMB2_read in fs/cifs/smb2pdu.c has a use-after-free. NOTE: this was not fixed correctly in 5.0.10; see the 5.0.11 ChangeLog, which documents a memory leak.","references":["http://lists.opensuse.org/opensuse-security-announce/2019-09/msg00064.html","http://lists.opensuse.org/opensuse-security-announce/2019-09/msg00066.html","https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.0.10"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<5.0.10"},
  {"id":"CVE-2019-16160","product":"smb","summary":"An integer underflow in the SMB server of MikroTik RouterOS before 6.45.5 allows remote unauthenticated attackers to crash the service.","details":"An integer underflow in the SMB server of MikroTik RouterOS before 6.45.5 allows remote unauthenticated attackers to crash the service.","references":["https://forum.mikrotik.com/viewtopic.php?t=151603","https://gist.github.com/thebabush/3c71fc5001f8865e3ad579e80680ce24","https://mikrotik.com"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<6.45.5"},
  {"id":"CVE-2019-17455","product":"smb","summary":"Libntlm through 1.5 relies on a fixed buffer size for tSmbNtlmAuthRequest, tSmbNtlmAuthChallenge, and tSmbNtlmAuthResponse read and write operations, as demonstrated by a stack-based buffer over-read in buildSmbNtlmAuthRequest in smbutil.c for a crafted NTLM request.","details":"Libntlm through 1.5 relies on a fixed buffer size for tSmbNtlmAuthRequest, tSmbNtlmAuthChallenge, and tSmbNtlmAuthResponse read and write operations, as demonstrated by a stack-based buffer over-read in buildSmbNtlmAuthRequest in smbutil.c for a crafted NTLM request.","references":["http://lists.opensuse.org/opensuse-security-announce/2020-06/msg00029.html","http://lists.opensuse.org/opensuse-security-announce/2020-06/msg00032.html","https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=942145"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<=1.5"},
  {"id":"CVE-2019-18213","product":"smb","summary":"XML Language Server (aka lsp4xml) before 0.9.1, as used in Red Hat XML Language Support (aka vscode-xml) before 0.9.1 for Visual Studio and other products, allows XXE via a crafted XML document, with resultant SSRF (as well as SMB connection initiation that can lead to NetNTLM challenge/response capture for password cracking). This occurs in extensions/contentmodel/participants/diagnostics/LSPXMLParserConfiguration.java.","details":"XML Language Server (aka lsp4xml) before 0.9.1, as used in Red Hat XML Language Support (aka vscode-xml) before 0.9.1 for Visual Studio and other products, allows XXE via a crafted XML document, with resultant SSRF (as well as SMB connection initiation that can lead to NetNTLM challenge/response capture for password cracking). This occurs in extensions/contentmodel/participants/diagnostics/LSPXMLParserConfiguration.java.","references":["https://github.com/angelozerr/lsp4xml/","https://github.com/angelozerr/lsp4xml/blob/master/CHANGELOG.md#others","https://github.com/angelozerr/lsp4xml/pull/566"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<0.9.1"},
  {"id":"CVE-2019-5502","product":"smb","summary":"SMB in Data ONTAP operating in 7-Mode versions prior to 8.2.5P3 has weak cryptography which when exploited could lead to information disclosure or addition or modification of data.","details":"SMB in Data ONTAP operating in 7-Mode versions prior to 8.2.5P3 has weak cryptography which when exploited could lead to information disclosure or addition or modification of data.","references":["https://security.netapp.com/advisory/ntap-20190802-0002/","https://security.netapp.com/advisory/ntap-20190802-0002/"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<8.2.5"},
  {"id":"CVE-2019-6452","product":"smb","summary":"Kyocera Command Center RX TASKalfa4501i and TASKalfa5052ci allows remote attackers to abuse the Test button in the machine address book to obtain a cleartext FTP or SMB password.","details":"Kyocera Command Center RX TASKalfa4501i and TASKalfa5052ci allows remote attackers to abuse the Test button in the machine address book to obtain a cleartext FTP or SMB password.","references":["http://www.nccst.nat.gov.tw","https://github.com/cvereveal/CVEs/tree/master/CVE-2019-6452","http://www.nccst.nat.gov.tw"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2019-7097","product":"smb","summary":"Adobe Dreamweaver versions 19.0 and earlier have an insecure protocol implementation vulnerability. Successful exploitation could lead to sensitive data disclosure if smb request is subject to a relay attack.","details":"Adobe Dreamweaver versions 19.0 and earlier have an insecure protocol implementation vulnerability. Successful exploitation could lead to sensitive data disclosure if smb request is subject to a relay attack.","references":["https://helpx.adobe.com/security/products/dreamweaver/apsb19-21.html","https://helpx.adobe.com/security/products/dreamweaver/apsb19-21.html"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<=19.0"},
  {"id":"CVE-2019-9565","product":"smb","summary":"Druide Antidote RX, HD, 8 before 8.05.2287, 9 before 9.5.3937 and 10 before 10.1.2147 allows remote attackers to steal NTLM hashes or perform SMB relay attacks upon a direct launch of the product, or upon an indirect launch via an integration such as Chrome, Firefox, Word, Outlook, etc. This occurs because the product attempts to access a share with the PLUG-INS subdomain name; an attacker may be able to use Active Directory Domain Services to register that name.","details":"Druide Antidote RX, HD, 8 before 8.05.2287, 9 before 9.5.3937 and 10 before 10.1.2147 allows remote attackers to steal NTLM hashes or perform SMB relay attacks upon a direct launch of the product, or upon an indirect launch via an integration such as Chrome, Firefox, Word, Outlook, etc. This occurs because the product attempts to access a share with the PLUG-INS subdomain name; an attacker may be able to use Active Directory Domain Services to register that name.","references":["https://gosecure.net/2019/02/20/abusing-unsafe-defaults-in-active-directory/","https://www.druide.com/en/news/security-improvement-antidote-windows","https://gosecure.net/2019/02/20/abusing-unsafe-defaults-in-active-directory/"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[["<9.5.3937",">=9.0"],["<10.1.2147",">=10.0"],["<8.05.2287",">=8.0"]]},
  {"id":"CVE-2019-9579","product":"smb","summary":"An issue was discovered in Illumos in Nexenta NexentaStor 4.0.5 and 5.1.2, and other products. The SMB server allows an attacker to have unintended access, e.g., an attacker with WRITE_XATTR can change permissions. This occurs because of a combination of three factors: ZFS extended attributes are used to implement NT named streams, the SMB protocol requires implementations to have open handle semantics similar to those of NTFS, and the SMB server passes along certain attribute requests to the underlying object (i.e., they are not considered to be requests that pertain to the named stream).","details":"An issue was discovered in Illumos in Nexenta NexentaStor 4.0.5 and 5.1.2, and other products. The SMB server allows an attacker to have unintended access, e.g., an attacker with WRITE_XATTR can change permissions. This occurs because of a combination of three factors: ZFS extended attributes are used to implement NT named streams, the SMB protocol requires implementations to have open handle semantics similar to those of NTFS, and the SMB server passes along certain attribute requests to the underlying object (i.e., they are not considered to be requests that pertain to the named stream).","references":["https://www.illumos.org/issues/10506","https://www.oracle.com/security-alerts/cpuapr2020.html","https://www.illumos.org/issues/10506"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-0796","product":"smb","summary":"A remote code execution vulnerability exists in the way that the Microsoft Server Message Block 3.1.1 (SMBv3) protocol handles certain requests, aka 'Windows SMBv3 Client/Server Remote Code Execution Vulnerability'.","details":"A remote code execution vulnerability exists in the way that the Microsoft Server Message Block 3.1.1 (SMBv3) protocol handles certain requests, aka 'Windows SMBv3 Client/Server Remote Code Execution Vulnerability'.","references":["http://packetstormsecurity.com/files/156731/CoronaBlue-SMBGhost-Microsoft-Windows-10-SMB-3.1.1-Proof-Of-Concept.html","http://packetstormsecurity.com/files/156732/Microsoft-Windows-SMB-3.1.1-Remote-Code-Execution.html","http://packetstormsecurity.com/files/156980/Microsoft-Windows-10-SMB-3.1.1-Local-Privilege-Escalation.html"],"severity":"CRITICAL","match_type":"active_check","confidence":"high","required_script":"smb-vuln-cve-2020-0796"},
  {"id":"CVE-2020-11881","product":"smb","summary":"An array index error in MikroTik RouterOS 6.41.3 through 6.46.5, and 7.x through 7.0 Beta5, allows an unauthenticated remote attacker to crash the SMB server via modified setup-request packets, aka SUP-12964.","details":"An array index error in MikroTik RouterOS 6.41.3 through 6.46.5, and 7.x through 7.0 Beta5, allows an unauthenticated remote attacker to crash the SMB server via modified setup-request packets, aka SUP-12964.","references":["https://github.com/botlabsDev/CVE-2020-11881","https://mikrotik.com","https://github.com/botlabsDev/CVE-2020-11881"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[">=6.41.3","<=6.46.5"]},
  {"id":"CVE-2020-1206","product":"smb","summary":"An information disclosure vulnerability exists in the way that the Microsoft Server Message Block 3.1.1 (SMBv3) protocol handles certain requests, aka 'Windows SMBv3 Client/Server Information Disclosure Vulnerability'.","details":"An information disclosure vulnerability exists in the way that the Microsoft Server Message Block 3.1.1 (SMBv3) protocol handles certain requests, aka 'Windows SMBv3 Client/Server Information Disclosure Vulnerability'.","references":["http://packetstormsecurity.com/files/158053/SMBleed-Uninitialized-Kernel-Memory-Read-Proof-Of-Concept.html","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1206","http://packetstormsecurity.com/files/158053/SMBleed-Uninitialized-Kernel-Memory-Read-Proof-Of-Concept.html"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-1284","product":"smb","summary":"A denial of service vulnerability exists in the way that the Microsoft Server Message Block 3.1.1 (SMBv3) protocol handles certain requests, aka 'Windows SMBv3 Client/Server Denial of Service Vulnerability'.","details":"A denial of service vulnerability exists in the way that the Microsoft Server Message Block 3.1.1 (SMBv3) protocol handles certain requests, aka 'Windows SMBv3 Client/Server Denial of Service Vulnerability'.","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1284","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1284"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-1301","product":"smb","summary":"A remote code execution vulnerability exists in the way that the Microsoft Server Message Block 1.0 (SMBv1) server handles certain requests, aka 'Windows SMB Remote Code Execution Vulnerability'.","details":"A remote code execution vulnerability exists in the way that the Microsoft Server Message Block 1.0 (SMBv1) server handles certain requests, aka 'Windows SMB Remote Code Execution Vulnerability'.","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1301","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1301"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-17140","product":"smb","summary":"Windows SMB Information Disclosure Vulnerability","details":"Windows SMB Information Disclosure Vulnerability","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-17140","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-17140"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-21884","product":"smb","summary":"Unibox SMB 2.4 and UniBox Enterprise Series 2.4 and UniBox Campus Series 2.4 contain a cross-site request forgery (CSRF) vulnerability in /tools/network-trace, /list_users, /list_byod?usertype=raduser, /dhcp_leases, /go?rid=202 in which a specially crafted HTTP request may reconfigure the device.","details":"Unibox SMB 2.4 and UniBox Enterprise Series 2.4 and UniBox Campus Series 2.4 contain a cross-site request forgery (CSRF) vulnerability in /tools/network-trace, /list_users, /list_byod?usertype=raduser, /dhcp_leases, /go?rid=202 in which a specially crafted HTTP request may reconfigure the device.","references":["http://wifi-soft.com","https://s3curityb3ast.github.io/KSA-Dev-008.txt","https://www.mail-archive.com/fulldisclosure%40seclists.org/msg07139.html"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-22844","product":"smb","summary":"A buffer overflow in Mikrotik RouterOS 6.47 allows unauthenticated attackers to cause a denial of service (DOS) via crafted SMB requests.","details":"A buffer overflow in Mikrotik RouterOS 6.47 allows unauthenticated attackers to cause a denial of service (DOS) via crafted SMB requests.","references":["https://github.com/colorlight/mikrotik_poc/blob/master/two_vulns.md","https://mikrotik.com/support","https://github.com/colorlight/mikrotik_poc/blob/master/two_vulns.md"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-24772","product":"smb","summary":"In Dreamacro Clash for Windows v0.11.4, an attacker could embed a malicious iframe in a website with a crafted URL that would launch the Clash Windows client and force it to open a remote SMB share. Windows will perform NTLM authentication when opening the SMB share and that request can be relayed (using a tool like responder) for code execution (or captured for hash cracking).","details":"In Dreamacro Clash for Windows v0.11.4, an attacker could embed a malicious iframe in a website with a crafted URL that would launch the Clash Windows client and force it to open a remote SMB share. Windows will perform NTLM authentication when opening the SMB share and that request can be relayed (using a tool like responder) for code execution (or captured for hash cracking).","references":["https://github.com/Dreamacro/clash/issues/910","https://github.com/Dreamacro/clash/issues/910"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-25578","product":"smb","summary":"In FreeBSD 12.2-STABLE before r368969, 11.4-STABLE before r369047, 12.2-RELEASE before p3, 12.1-RELEASE before p13 and 11.4-RELEASE before p7 several file systems were not properly initializing the d_off field of the dirent structures returned by VOP_READDIR. In particular, tmpfs(5), smbfs(5), autofs(5) and mqueuefs(5) were failing to do so. As a result, eight uninitialized kernel stack bytes may be leaked to userspace by these file systems.","details":"In FreeBSD 12.2-STABLE before r368969, 11.4-STABLE before r369047, 12.2-RELEASE before p3, 12.1-RELEASE before p13 and 11.4-RELEASE before p7 several file systems were not properly initializing the d_off field of the dirent structures returned by VOP_READDIR. In particular, tmpfs(5), smbfs(5), autofs(5) and mqueuefs(5) were failing to do so. As a result, eight uninitialized kernel stack bytes may be leaked to userspace by these file systems.","references":["https://security.FreeBSD.org/advisories/FreeBSD-SA-21:01.fsdisclosure.asc","https://security.netapp.com/advisory/ntap-20210423-0002/","https://security.FreeBSD.org/advisories/FreeBSD-SA-21:01.fsdisclosure.asc"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-2558","product":"smb","summary":"Vulnerability in the Oracle Solaris product of Oracle Systems (component: Kernel). The supported version that is affected is 11. Easily exploitable vulnerability allows unauthenticated attacker with network access via SMB to compromise Oracle Solaris. While the vulnerability is in Oracle Solaris, attacks may significantly impact additional products. Successful attacks of this vulnerability can result in unauthorized ability to cause a partial denial of service (partial DOS) of Oracle Solaris. CVSS 3.0 Base Score 5.8 (Availability impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L).","details":"Vulnerability in the Oracle Solaris product of Oracle Systems (component: Kernel). The supported version that is affected is 11. Easily exploitable vulnerability allows unauthenticated attacker with network access via SMB to compromise Oracle Solaris. While the vulnerability is in Oracle Solaris, attacks may significantly impact additional products. Successful attacks of this vulnerability can result in unauthorized ability to cause a partial denial of service (partial DOS) of Oracle Solaris. CVSS 3.0 Base Score 5.8 (Availability impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L).","references":["https://www.oracle.com/security-alerts/cpujan2020.html","https://www.oracle.com/security-alerts/cpujan2020.html"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-2578","product":"smb","summary":"Vulnerability in the Oracle Solaris product of Oracle Systems (component: Kernel). The supported version that is affected is 11. Easily exploitable vulnerability allows unauthenticated attacker with network access via SMB to compromise Oracle Solaris. While the vulnerability is in Oracle Solaris, attacks may significantly impact additional products. Successful attacks of this vulnerability can result in unauthorized ability to cause a partial denial of service (partial DOS) of Oracle Solaris. CVSS 3.0 Base Score 5.8 (Availability impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L).","details":"Vulnerability in the Oracle Solaris product of Oracle Systems (component: Kernel). The supported version that is affected is 11. Easily exploitable vulnerability allows unauthenticated attacker with network access via SMB to compromise Oracle Solaris. While the vulnerability is in Oracle Solaris, attacks may significantly impact additional products. Successful attacks of this vulnerability can result in unauthorized ability to cause a partial denial of service (partial DOS) of Oracle Solaris. CVSS 3.0 Base Score 5.8 (Availability impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L).","references":["https://www.oracle.com/security-alerts/cpujan2020.html","https://www.oracle.com/security-alerts/cpujan2020.html"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-25845","product":"smb","summary":"Multiple functions of NHIServiSignAdapter failed to verify the users' file path, which leads to the SMB request being redirected to a malicious host, resulting in the leakage of user's credential.","details":"Multiple functions of NHIServiSignAdapter failed to verify the users' file path, which leads to the SMB request being redirected to a malicious host, resulting in the leakage of user's credential.","references":["https://www.twcert.org.tw/tw/cp-132-4273-24e01-1.html","https://www.twcert.org.tw/tw/cp-132-4273-24e01-1.html"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-25846","product":"smb","summary":"The digest generation function of NHIServiSignAdapter has not been verified for source file path, which leads to the SMB request being redirected to a malicious host, resulting in the leakage of user's credential.","details":"The digest generation function of NHIServiSignAdapter has not been verified for source file path, which leads to the SMB request being redirected to a malicious host, resulting in the leakage of user's credential.","references":["https://www.twcert.org.tw/tw/cp-132-4274-7bd65-1.html","https://www.twcert.org.tw/tw/cp-132-4274-7bd65-1.html"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-26195","product":"smb","summary":"Dell EMC PowerScale OneFS versions 8.1.2 – 9.1.0 contain an issue where the OneFS SMB directory auto-create may erroneously create a directory for a user. A remote unauthenticated attacker may take advantage of this issue to slow down the system.","details":"Dell EMC PowerScale OneFS versions 8.1.2 – 9.1.0 contain an issue where the OneFS SMB directory auto-create may erroneously create a directory for a user. A remote unauthenticated attacker may take advantage of this issue to slow down the system.","references":["https://www.dell.com/support/kbdoc/en-us/000182873/dsa-2021-009-dell-powerscale-onefs-security-update-for-multiple-vulnerabilities","https://www.dell.com/support/kbdoc/en-us/000182873/dsa-2021-009-dell-powerscale-onefs-security-update-for-multiple-vulnerabilities"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-26508","product":"smb","summary":"The WebTools component on Canon Oce ColorWave 3500 5.1.1.0 devices allows attackers to retrieve stored SMB credentials via the export feature, even though these are intentionally inaccessible in the UI.","details":"The WebTools component on Canon Oce ColorWave 3500 5.1.1.0 devices allows attackers to retrieve stored SMB credentials via the export feature, even though these are intentionally inaccessible in the UI.","references":["https://www.syss.de/pentest-blog/","https://www.syss.de/pentest-blog/"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2020-6963","product":"smb","summary":"In ApexPro Telemetry Server Versions 4.2 and prior, CARESCAPE Telemetry Server v4.2 & prior, Clinical Information Center (CIC) Versions 4.X and 5.X, CARESCAPE Central Station (CSCS) Versions 1.X, the affected products utilized hard coded SMB credentials, which may allow an attacker to remotely execute arbitrary code.","details":"In ApexPro Telemetry Server Versions 4.2 and prior, CARESCAPE Telemetry Server v4.2 & prior, Clinical Information Center (CIC) Versions 4.X and 5.X, CARESCAPE Central Station (CSCS) Versions 1.X, the affected products utilized hard coded SMB credentials, which may allow an attacker to remotely execute arbitrary code.","references":["https://www.us-cert.gov/ics/advisories/icsma-20-023-01","https://www3.gehealthcare.com/~/media/downloads/us/support/site-planning/site-readiness/gehc-gateway_project_implementation_guide_pdf.pdf","https://www.us-cert.gov/ics/advisories/icsma-20-023-01"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<=4.2"},
  {"id":"CVE-2020-8270","product":"smb","summary":"An unprivileged Windows user on the VDA or an SMB user can perform arbitrary command execution as SYSTEM in CVAD versions before 2009, 1912 LTSR CU1 hotfixes CTX285871 and CTX285872, 7.15 LTSR CU6 hotfix CTX285341 and CTX285342","details":"An unprivileged Windows user on the VDA or an SMB user can perform arbitrary command execution as SYSTEM in CVAD versions before 2009, 1912 LTSR CU1 hotfixes CTX285871 and CTX285872, 7.15 LTSR CU6 hotfix CTX285341 and CTX285342","references":["https://support.citrix.com/article/CTX285059","https://support.citrix.com/article/CTX285059"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=1903"],["<=1912"],["<=2006"]]},
  {"id":"CVE-2020-9324","product":"smb","summary":"Aquaforest TIFF Server 4.0 allows Unauthenticated SMB Hash Capture via UNC.","details":"Aquaforest TIFF Server 4.0 allows Unauthenticated SMB Hash Capture via UNC.","references":["https://www.aquaforest.com/en/release_history.asp","https://www.criticalstart.com/multiple-vulnerabilities-discovered-in-tiff-server-from-aquaforest/","https://www.criticalstart.com/resources/"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-20160","product":"smb","summary":"Trendnet AC2600 TEW-827DRU version 2.08B01 contains a command injection vulnerability in the smb functionality of the device. The username parameter used when configuring smb functionality for the device is vulnerable to command injection as root.","details":"Trendnet AC2600 TEW-827DRU version 2.08B01 contains a command injection vulnerability in the smb functionality of the device. The username parameter used when configuring smb functionality for the device is vulnerable to command injection as root.","references":["https://www.tenable.com/security/research/tra-2021-54","https://www.tenable.com/security/research/tra-2021-54"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-20164","product":"smb","summary":"Trendnet AC2600 TEW-827DRU version 2.08B01 improperly discloses credentials for the smb functionality of the device. Usernames and passwords for all smb users are revealed in plaintext on the smbserver.asp page.","details":"Trendnet AC2600 TEW-827DRU version 2.08B01 improperly discloses credentials for the smb functionality of the device. Usernames and passwords for all smb users are revealed in plaintext on the smbserver.asp page.","references":["https://www.tenable.com/security/research/tra-2021-54","https://www.tenable.com/security/research/tra-2021-54"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-20254","product":"smb","summary":"A flaw was found in samba. The Samba smbd file server must map Windows group identities (SIDs) into unix group ids (gids). The code that performs this had a flaw that could allow it to read data beyond the end of the array in the case where a negative cache entry had been added to the mapping cache. This could cause the calling code to return those values into the process token that stores the group membership for a user. The highest threat from this vulnerability is to data confidentiality and integrity.","details":"A flaw was found in samba. The Samba smbd file server must map Windows group identities (SIDs) into unix group ids (gids). The code that performs this had a flaw that could allow it to read data beyond the end of the array in the case where a negative cache entry had been added to the mapping cache. This could cause the calling code to return those values into the process token that stores the group membership for a user. The highest threat from this vulnerability is to data confidentiality and integrity.","references":["https://bugzilla.redhat.com/show_bug.cgi?id=1949442","https://lists.debian.org/debian-lts-announce/2021/05/msg00023.html","https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/3EP2VJ73OVBPVSOSTVOMGIEQA3MWF6F7/"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<4.12.15","<4.13.8",">=4.14.0",">=4.13.0","<4.14.4"],[">=3.6.0"]]},
  {"id":"CVE-2021-21469","product":"smb","summary":"When security guidelines for SAP NetWeaver Master Data Management running on windows have not been thoroughly reviewed, it might be possible for an external operator to try and set custom paths in the MDS server configuration. When no adequate protection has been enforced on any level (e.g., MDS Server password not set, network and OS configuration not properly secured, etc.), a malicious user might define UNC paths which could then be exploited to put the system at risk using a so-called SMB relay attack and obtain highly sensitive data, which leads to Information Disclosure.","details":"When security guidelines for SAP NetWeaver Master Data Management running on windows have not been thoroughly reviewed, it might be possible for an external operator to try and set custom paths in the MDS server configuration. When no adequate protection has been enforced on any level (e.g., MDS Server password not set, network and OS configuration not properly secured, etc.), a malicious user might define UNC paths which could then be exploited to put the system at risk using a so-called SMB relay attack and obtain highly sensitive data, which leads to Information Disclosure.","references":["https://launchpad.support.sap.com/#/notes/2993032","https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=564760476","https://launchpad.support.sap.com/#/notes/2993032"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-21472","product":"smb","summary":"SAP Software Provisioning Manager 1.0 (SAP NetWeaver Master Data Management Server 7.1) does not have an option to set password during its installation, this allows an authenticated attacker to perform various security attacks like Directory Traversal, Password Brute force Attack, SMB Relay attack, Security Downgrade.","details":"SAP Software Provisioning Manager 1.0 (SAP NetWeaver Master Data Management Server 7.1) does not have an option to set password during its installation, this allows an authenticated attacker to perform various security attacks like Directory Traversal, Password Brute force Attack, SMB Relay attack, Security Downgrade.","references":["https://launchpad.support.sap.com/#/notes/2998173","https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=568460543","https://launchpad.support.sap.com/#/notes/2998173"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-22908","product":"smb","summary":"A buffer overflow vulnerability exists in Windows File Resource Profiles in 9.X allows a remote authenticated user with privileges to browse SMB shares to execute arbitrary code as the root user. As of version 9.1R3, this permission is not enabled by default.","details":"A buffer overflow vulnerability exists in Windows File Resource Profiles in 9.X allows a remote authenticated user with privileges to browse SMB shares to execute arbitrary code as the root user. As of version 9.1R3, this permission is not enabled by default.","references":["https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800/","https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800/","https://www.kb.cert.org/vuls/id/667933"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-26989","product":"smb","summary":"Clustered Data ONTAP versions prior to 9.3P21, 9.5P16, 9.6P12, 9.7P9 and 9.8 are susceptible to a vulnerability which could allow a remote authenticated attacker to cause a Denial of Service (DoS) on clustered Data ONTAP configured for SMB access.","details":"Clustered Data ONTAP versions prior to 9.3P21, 9.5P16, 9.6P12, 9.7P9 and 9.8 are susceptible to a vulnerability which could allow a remote authenticated attacker to cause a Denial of Service (DoS) on clustered Data ONTAP configured for SMB access.","references":["https://security.netapp.com/advisory/NTAP-20210303-0002","https://security.netapp.com/advisory/NTAP-20210303-0002"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-28324","product":"smb","summary":"Windows SMB Information Disclosure Vulnerability","details":"Windows SMB Information Disclosure Vulnerability","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-28324","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-28324"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-28325","product":"smb","summary":"Windows SMB Information Disclosure Vulnerability","details":"Windows SMB Information Disclosure Vulnerability","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-28325","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-28325"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-29416","product":"smb","summary":"An issue was discovered in PortSwigger Burp Suite before 2021.2. During viewing of a malicious request, it can be manipulated into issuing a request that does not respect its upstream proxy configuration. This could leak NetNTLM hashes on Windows systems that fail to block outbound SMB.","details":"An issue was discovered in PortSwigger Burp Suite before 2021.2. During viewing of a malicious request, it can be manipulated into issuing a request that does not respect its upstream proxy configuration. This could leak NetNTLM hashes on Windows systems that fail to block outbound SMB.","references":["https://hackerone.com/reports/1054382","https://portswigger.net/burp/releases/professional-community-2020-12?requestededition=professional","https://hackerone.com/reports/1054382"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<2021.2"},
  {"id":"CVE-2021-31205","product":"smb","summary":"Windows SMB Client Security Feature Bypass Vulnerability","details":"Windows SMB Client Security Feature Bypass Vulnerability","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31205","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31205"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-31800","product":"smb","summary":"Multiple path traversal vulnerabilities exist in smbserver.py in Impacket through 0.9.22. An attacker that connects to a running smbserver instance can list and write to arbitrary files via ../ directory traversal. This could potentially be abused to achieve arbitrary code execution by replacing /etc/shadow or an SSH authorized key.","details":"Multiple path traversal vulnerabilities exist in smbserver.py in Impacket through 0.9.22. An attacker that connects to a running smbserver instance can list and write to arbitrary files via ../ directory traversal. This could potentially be abused to achieve arbitrary code execution by replacing /etc/shadow or an SSH authorized key.","references":["https://github.com/SecureAuthCorp/impacket/blob/cb6d43a677c338db930bc4e9161620832c1ec624/impacket/smbserver.py#L2008","https://github.com/SecureAuthCorp/impacket/blob/cb6d43a677c338db930bc4e9161620832c1ec624/impacket/smbserver.py#L2958","https://github.com/SecureAuthCorp/impacket/blob/cb6d43a677c338db930bc4e9161620832c1ec624/impacket/smbserver.py#L3485"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<=0.9.22"},
  {"id":"CVE-2021-3310","product":"smb","summary":"Western Digital My Cloud OS 5 devices before 5.10.122 mishandle Symbolic Link Following on SMB and AFP shares. This can lead to code execution and information disclosure (by reading local files).","details":"Western Digital My Cloud OS 5 devices before 5.10.122 mishandle Symbolic Link Following on SMB and AFP shares. This can lead to code execution and information disclosure (by reading local files).","references":["https://www.westerndigital.com/support/productsecurity/wdc-21002-my-cloud-firmware-version-5-10-122","https://www.zerodayinitiative.com/advisories/ZDI-21-277/","https://www.westerndigital.com/support/productsecurity/wdc-21002-my-cloud-firmware-version-5-10-122"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<5.10.122"},
  {"id":"CVE-2021-33783","product":"smb","summary":"Windows SMB Information Disclosure Vulnerability","details":"Windows SMB Information Disclosure Vulnerability","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-33783","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-33783"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-36305","product":"smb","summary":"Dell PowerScale OneFS contains an Unsynchronized Access to Shared Data in a Multithreaded Context in SMB CA handling. An authenticated user of SMB on a cluster with CA could potentially exploit this vulnerability, leading to a denial of service over SMB.","details":"Dell PowerScale OneFS contains an Unsynchronized Access to Shared Data in a Multithreaded Context in SMB CA handling. An authenticated user of SMB on a cluster with CA could potentially exploit this vulnerability, leading to a denial of service over SMB.","references":["https://www.dell.com/support/kbdoc/000192046","https://www.dell.com/support/kbdoc/000192046"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-36960","product":"smb","summary":"Windows SMB Information Disclosure Vulnerability","details":"Windows SMB Information Disclosure Vulnerability","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-36960","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-36960"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-36972","product":"smb","summary":"Windows SMB Information Disclosure Vulnerability","details":"Windows SMB Information Disclosure Vulnerability","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-36972","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-36972"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-36974","product":"smb","summary":"Windows SMB Elevation of Privilege Vulnerability","details":"Windows SMB Elevation of Privilege Vulnerability","references":["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-36974","https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-36974"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-38993","product":"smb","summary":"IBM AIX 7.1, 7.2, 7.3, and VIOS 3.1 could allow a non-privileged local user to exploit a vulnerability in the smbcd daemon to cause a denial of service. IBM X-Force ID: 212962.","details":"IBM AIX 7.1, 7.2, 7.3, and VIOS 3.1 could allow a non-privileged local user to exploit a vulnerability in the smbcd daemon to cause a denial of service. IBM X-Force ID: 212962.","references":["https://exchange.xforce.ibmcloud.com/vulnerabilities/212962","https://www.ibm.com/support/pages/node/6559320","https://exchange.xforce.ibmcloud.com/vulnerabilities/212962"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-4211","product":"smb","summary":"A potential vulnerability in the SMI callback function used in the SMBIOS event log driver in some Lenovo Desktop, ThinkStation, and ThinkEdge models may allow an attacker with local access and elevated privileges to execute arbitrary code.","details":"A potential vulnerability in the SMI callback function used in the SMBIOS event log driver in some Lenovo Desktop, ThinkStation, and ThinkEdge models may allow an attacker with local access and elevated privileges to execute arbitrary code.","references":["https://support.lenovo.com/us/en/product_security/LEN-77639","https://support.lenovo.com/us/en/product_security/LEN-77639"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-42835","product":"smb","summary":"An issue was discovered in Plex Media Server through 1.24.4.5081-e362dc1ee. An attacker (with a foothold in a endpoint via a low-privileged user account) can access the exposed RPC service of the update service component. This RPC functionality allows the attacker to interact with the RPC functionality and execute code from a path of his choice (local, or remote via SMB) because of a TOCTOU race condition. This code execution is in the context of the Plex update service (which runs as SYSTEM).","details":"An issue was discovered in Plex Media Server through 1.24.4.5081-e362dc1ee. An attacker (with a foothold in a endpoint via a low-privileged user account) can access the exposed RPC service of the update service component. This RPC functionality allows the attacker to interact with the RPC functionality and execute code from a path of his choice (local, or remote via SMB) because of a TOCTOU race condition. This code execution is in the context of the Plex update service (which runs as SYSTEM).","references":["https://bugsec.com/experts_teams/","https://forums.plex.tv/t/security-regarding-cve-2021-42835/761510","https://ir-on.io/2021/12/02/local-privilege-plexcalation/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<1.25.0.5282"},
  {"id":"CVE-2021-42913","product":"smb","summary":"The SyncThru Web Service on Samsung SCX-6x55X printers allows an attacker to gain access to a list of SMB users and cleartext passwords by reading the HTML source code. Authentication is not required.","details":"The SyncThru Web Service on Samsung SCX-6x55X printers allows an attacker to gain access to a list of SMB users and cleartext passwords by reading the HTML source code. Authentication is not required.","references":["https://medium.com/%40windsormoreira/samsung-printer-scx-6x55x-improper-access-control-cve-2021-42913-bd50837e5e9a","https://security.samsungmobile.com/securityUpdate.smsb","https://medium.com/%40windsormoreira/samsung-printer-scx-6x55x-improper-access-control-cve-2021-42913-bd50837e5e9a"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2021-43566","product":"smb","summary":"All versions of Samba prior to 4.13.16 are vulnerable to a malicious client using an SMB1 or NFS race to allow a directory to be created in an area of the server file system not exported under the share definition. Note that SMB1 has to be enabled, or the share also available via NFS in order for this attack to succeed.","details":"All versions of Samba prior to 4.13.16 are vulnerable to a malicious client using an SMB1 or NFS race to allow a directory to be created in an area of the server file system not exported under the share definition. Note that SMB1 has to be enabled, or the share also available via NFS in order for this attack to succeed.","references":["https://bugzilla.samba.org/show_bug.cgi?id=13979","https://security.netapp.com/advisory/ntap-20220110-0001/","https://www.samba.org/samba/security/CVE-2021-43566.html"],"severity":"LOW","match_type":"version_range","confidence":"high","version_match":"<4.13.16"},
  {"id":"CVE-2021-43844","product":"smb","summary":"MSEdgeRedirect is a tool to redirect news, search, widgets, weather, and more to a user's default browser. MSEdgeRedirect versions before 0.5.0.1 are vulnerable to Remote Code Execution via specifically crafted URLs. This vulnerability requires user interaction and the acceptance of a prompt. With how MSEdgeRedirect is coded, parameters are impossible to pass to any launched file. However, there are two possible scenarios in which an attacker can do more than a minor annoyance. In Scenario 1 (confirmed), a user visits an attacker controlled webpage; the user is prompted with, and downloads, an executable payload; the user is prompted with, and accepts, the aforementioned crafted URL prompt; and RCE executes the payload the user previously downloaded, if the download path is successfully guessed. In Scenario 2 (not yet confirmed), a user visits an attacked controlled webpage; the user is prompted with, and accepts, the aforementioned crafted URL prompt; and a payload on a remote, attacker controlled, SMB server is executed. The issue was found in the _DecodeAndRun() function, in which I incorrectly assumed _WinAPI_UrlIs() would only accept web resources. Unfortunately, file:/// passes the default _WinAPI_UrlIs check(). File paths are now directly checked for and must fail. There is no currently known exploitation of this vulnerability in the wild. A patched version, 0.5.0.1, has been released that checks for and denies these crafted URLs. There are no workarounds for this issue. Users are advised not to accept any unexpected prompts from web pages.","details":"MSEdgeRedirect is a tool to redirect news, search, widgets, weather, and more to a user's default browser. MSEdgeRedirect versions before 0.5.0.1 are vulnerable to Remote Code Execution via specifically crafted URLs. This vulnerability requires user interaction and the acceptance of a prompt. With how MSEdgeRedirect is coded, parameters are impossible to pass to any launched file. However, there are two possible scenarios in which an attacker can do more than a minor annoyance. In Scenario 1 (confirmed), a user visits an attacker controlled webpage; the user is prompted with, and downloads, an executable payload; the user is prompted with, and accepts, the aforementioned crafted URL prompt; and RCE executes the payload the user previously downloaded, if the download path is successfully guessed. In Scenario 2 (not yet confirmed), a user visits an attacked controlled webpage; the user is prompted with, and accepts, the aforementioned crafted URL prompt; and a payload on a remote, attacker controlled, SMB server is executed. The issue was found in the _DecodeAndRun() function, in which I incorrectly assumed _WinAPI_UrlIs() would only accept web resources. Unfortunately, file:/// passes the default _WinAPI_UrlIs check(). File paths are now directly checked for and must fail. There is no currently known exploitation of this vulnerability in the wild. A patched version, 0.5.0.1, has been released that checks for and denies these crafted URLs. There are no workarounds for this issue. Users are advised not to accept any unexpected prompts from web pages.","references":["https://github.com/rcmaehl/MSEdgeRedirect/releases/tag/0.5.0.1","https://github.com/rcmaehl/MSEdgeRedirect/security/advisories/GHSA-95v4-748v-fmf9","https://github.com/rcmaehl/MSEdgeRedirect/releases/tag/0.5.0.1"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<0.5.0.1"},
  {"id":"CVE-2021-44141","product":"smb","summary":"All versions of Samba prior to 4.15.5 are vulnerable to a malicious client using a server symlink to determine if a file or directory exists in an area of the server file system not exported under the share definition. SMB1 with unix extensions has to be enabled in order for this attack to succeed.","details":"All versions of Samba prior to 4.15.5 are vulnerable to a malicious client using a server symlink to determine if a file or directory exists in an area of the server file system not exported under the share definition. SMB1 with unix extensions has to be enabled in order for this attack to succeed.","references":["https://security.gentoo.org/glsa/202309-06","https://www.samba.org/samba/security/CVE-2021-44141.html","https://security.gentoo.org/glsa/202309-06"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<4.15.5"},
  {"id":"CVE-2021-44142","product":"smb","summary":"The Samba vfs_fruit module uses extended file attributes (EA, xattr) to provide \"...enhanced compatibility with Apple SMB clients and interoperability with a Netatalk 3 AFP fileserver.\" Samba versions prior to 4.13.17, 4.14.12 and 4.15.5 with vfs_fruit configured allow out-of-bounds heap read and write via specially crafted extended file attributes. A remote attacker with write access to extended file attributes can execute arbitrary code with the privileges of smbd, typically root.","details":"The Samba vfs_fruit module uses extended file attributes (EA, xattr) to provide \"...enhanced compatibility with Apple SMB clients and interoperability with a Netatalk 3 AFP fileserver.\" Samba versions prior to 4.13.17, 4.14.12 and 4.15.5 with vfs_fruit configured allow out-of-bounds heap read and write via specially crafted extended file attributes. A remote attacker with write access to extended file attributes can execute arbitrary code with the privileges of smbd, typically root.","references":["https://bugzilla.samba.org/show_bug.cgi?id=14914","https://kb.cert.org/vuls/id/119678","https://security.gentoo.org/glsa/202309-06"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=6.2","<6.2.4-25556.4"],["<4.13.17","<4.14.12",">=4.15.0",">=4.14.0","<4.15.5"]]},
  {"id":"CVE-2021-44548","product":"smb","summary":"An Improper Input Validation vulnerability in DataImportHandler of Apache Solr allows an attacker to provide a Windows UNC path resulting in an SMB network call being made from the Solr host to another host on the network. If the attacker has wider access to the network, this may lead to SMB attacks, which may result in: * The exfiltration of sensitive data such as OS user hashes (NTLM/LM hashes), * In case of misconfigured systems, SMB Relay Attacks which can lead to user impersonation on SMB Shares or, in a worse-case scenario, Remote Code Execution This issue affects all Apache Solr versions prior to 8.11.1. This issue only affects Windows.","details":"An Improper Input Validation vulnerability in DataImportHandler of Apache Solr allows an attacker to provide a Windows UNC path resulting in an SMB network call being made from the Solr host to another host on the network. If the attacker has wider access to the network, this may lead to SMB attacks, which may result in: * The exfiltration of sensitive data such as OS user hashes (NTLM/LM hashes), * In case of misconfigured systems, SMB Relay Attacks which can lead to user impersonation on SMB Shares or, in a worse-case scenario, Remote Code Execution This issue affects all Apache Solr versions prior to 8.11.1. This issue only affects Windows.","references":["https://security.netapp.com/advisory/ntap-20220114-0005/","https://solr.apache.org/security.html#cve-2021-44548-apache-solr-information-disclosure-vulnerability-through-dataimporthandler","https://security.netapp.com/advisory/ntap-20220114-0005/"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<8.11.1"},
  {"id":"CVE-2021-45100","product":"smb","summary":"The ksmbd server through 3.4.2, as used in the Linux kernel through 5.15.8, sometimes communicates in cleartext even though encryption has been enabled. This occurs because it sets the SMB2_GLOBAL_CAP_ENCRYPTION flag when using the SMB 3.1.1 protocol, which is a violation of the SMB protocol specification. When Windows 10 detects this protocol violation, it disables encryption.","details":"The ksmbd server through 3.4.2, as used in the Linux kernel through 5.15.8, sometimes communicates in cleartext even though encryption has been enabled. This occurs because it sets the SMB2_GLOBAL_CAP_ENCRYPTION flag when using the SMB 3.1.1 protocol, which is a violation of the SMB protocol specification. When Windows 10 detects this protocol violation, it disables encryption.","references":["https://github.com/cifsd-team/ksmbd/issues/550","https://github.com/cifsd-team/ksmbd/pull/551","https://marc.info/?l=linux-kernel&m=163961726017023&w=2"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<=3.4.2"},
  {"id":"CVE-2021-46960","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:cifs: Return correct error code from smb2_get_enc_keyAvoid a warning if the error percolates back up:[440700.376476] CIFS VFS: \\\\otters.example.com crypt_message: Could not get encryption key[440700.386947] ------------[ cut here ]------------[440700.386948] err = 1[440700.386977] WARNING: CPU: 11 PID: 2733 at /build/linux-hwe-5.4-p6lk6L/linux-hwe-5.4-5.4.0/lib/errseq.c:74 errseq_set+0x5c/0x70...[440700.397304] CPU: 11 PID: 2733 Comm: tar Tainted: G           OE     5.4.0-70-generic #78~18.04.1-Ubuntu...[440700.397334] Call Trace:[440700.397346]  __filemap_set_wb_err+0x1a/0x70[440700.397419]  cifs_writepages+0x9c7/0xb30 [cifs][440700.397426]  do_writepages+0x4b/0xe0[440700.397444]  __filemap_fdatawrite_range+0xcb/0x100[440700.397455]  filemap_write_and_wait+0x42/0xa0[440700.397486]  cifs_setattr+0x68b/0xf30 [cifs][440700.397493]  notify_change+0x358/0x4a0[440700.397500]  utimes_common+0xe9/0x1c0[440700.397510]  do_utimes+0xc5/0x150[440700.397520]  __x64_sys_utimensat+0x88/0xd0","details":"In the Linux kernel, the following vulnerability has been resolved:cifs: Return correct error code from smb2_get_enc_keyAvoid a warning if the error percolates back up:[440700.376476] CIFS VFS: \\\\otters.example.com crypt_message: Could not get encryption key[440700.386947] ------------[ cut here ]------------[440700.386948] err = 1[440700.386977] WARNING: CPU: 11 PID: 2733 at /build/linux-hwe-5.4-p6lk6L/linux-hwe-5.4-5.4.0/lib/errseq.c:74 errseq_set+0x5c/0x70...[440700.397304] CPU: 11 PID: 2733 Comm: tar Tainted: G           OE     5.4.0-70-generic #78~18.04.1-Ubuntu...[440700.397334] Call Trace:[440700.397346]  __filemap_set_wb_err+0x1a/0x70[440700.397419]  cifs_writepages+0x9c7/0xb30 [cifs][440700.397426]  do_writepages+0x4b/0xe0[440700.397444]  __filemap_fdatawrite_range+0xcb/0x100[440700.397455]  filemap_write_and_wait+0x42/0xa0[440700.397486]  cifs_setattr+0x68b/0xf30 [cifs][440700.397493]  notify_change+0x358/0x4a0[440700.397500]  utimes_common+0xe9/0x1c0[440700.397510]  do_utimes+0xc5/0x150[440700.397520]  __x64_sys_utimensat+0x88/0xd0","references":["https://git.kernel.org/stable/c/83728cbf366e334301091d5b808add468ab46b27","https://git.kernel.org/stable/c/93f3339b22ba17e66f0808737467b70ba087eaec","https://git.kernel.org/stable/c/aaa0faa5c28a91c362352d6b35dc3ed10df56fb0"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<5.4.118",">=5.5",">=5.11","<5.10.36",">=5.12","<5.12.3","<5.11.20"],[">=4.11","<4.14.233",">=4.15","<4.19.191",">=4.20"]]},
  {"id":"CVE-2021-47544","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:tcp: fix page frag corruption on page faultSteffen reported a TCP stream corruption for HTTP requestsserved by the apache web-server using a cifs mount-pointand memory mapping the relevant file.The root cause is quite similar to the one addressed bycommit 20eb4f29b602 (\"net: fix sk_page_frag() recursion frommemory reclaim\"). Here the nested access to the task page fragis caused by a page fault on the (mmapped) user-space memorybuffer coming from the cifs file.The page fault handler performs an smb transaction on a differentsocket, inside the same process context. Since sk->sk_allactionfor such socket does not prevent the usage for the task_frag,the nested allocation modify \"under the hood\" the page fragin use by the outer sendmsg call, corrupting the stream.The overall relevant stack trace looks like the following:httpd 78268 [001] 3461630.850950:      probe:tcp_sendmsg_locked:        ffffffff91461d91 tcp_sendmsg_locked+0x1        ffffffff91462b57 tcp_sendmsg+0x27        ffffffff9139814e sock_sendmsg+0x3e        ffffffffc06dfe1d smb_send_kvec+0x28        [...]        ffffffffc06cfaf8 cifs_readpages+0x213        ffffffff90e83c4b read_pages+0x6b        ffffffff90e83f31 __do_page_cache_readahead+0x1c1        ffffffff90e79e98 filemap_fault+0x788        ffffffff90eb0458 __do_fault+0x38        ffffffff90eb5280 do_fault+0x1a0        ffffffff90eb7c84 __handle_mm_fault+0x4d4        ffffffff90eb8093 handle_mm_fault+0xc3        ffffffff90c74f6d __do_page_fault+0x1ed        ffffffff90c75277 do_page_fault+0x37        ffffffff9160111e page_fault+0x1e        ffffffff9109e7b5 copyin+0x25        ffffffff9109eb40 _copy_from_iter_full+0xe0        ffffffff91462370 tcp_sendmsg_locked+0x5e0        ffffffff91462370 tcp_sendmsg_locked+0x5e0        ffffffff91462b57 tcp_sendmsg+0x27        ffffffff9139815c sock_sendmsg+0x4c        ffffffff913981f7 sock_write_iter+0x97        ffffffff90f2cc56 do_iter_readv_writev+0x156        ffffffff90f2dff0 do_iter_write+0x80        ffffffff90f2e1c3 vfs_writev+0xa3        ffffffff90f2e27c do_writev+0x5c        ffffffff90c042bb do_syscall_64+0x5b        ffffffff916000ad entry_SYSCALL_64_after_hwframe+0x65The cifs filesystem rightfully sets sk_allocations to GFP_NOFS,we can avoid the nesting using the sk page frag for allocationlacking the __GFP_FS flag. Do not define an additional mm-helperfor that, as this is strictly tied to the sk page frag usage.v1 -> v2: - use a stricted sk_page_frag() check instead of reordering the   code (Eric)","details":"In the Linux kernel, the following vulnerability has been resolved:tcp: fix page frag corruption on page faultSteffen reported a TCP stream corruption for HTTP requestsserved by the apache web-server using a cifs mount-pointand memory mapping the relevant file.The root cause is quite similar to the one addressed bycommit 20eb4f29b602 (\"net: fix sk_page_frag() recursion frommemory reclaim\"). Here the nested access to the task page fragis caused by a page fault on the (mmapped) user-space memorybuffer coming from the cifs file.The page fault handler performs an smb transaction on a differentsocket, inside the same process context. Since sk->sk_allactionfor such socket does not prevent the usage for the task_frag,the nested allocation modify \"under the hood\" the page fragin use by the outer sendmsg call, corrupting the stream.The overall relevant stack trace looks like the following:httpd 78268 [001] 3461630.850950:      probe:tcp_sendmsg_locked:        ffffffff91461d91 tcp_sendmsg_locked+0x1        ffffffff91462b57 tcp_sendmsg+0x27        ffffffff9139814e sock_sendmsg+0x3e        ffffffffc06dfe1d smb_send_kvec+0x28        [...]        ffffffffc06cfaf8 cifs_readpages+0x213        ffffffff90e83c4b read_pages+0x6b        ffffffff90e83f31 __do_page_cache_readahead+0x1c1        ffffffff90e79e98 filemap_fault+0x788        ffffffff90eb0458 __do_fault+0x38        ffffffff90eb5280 do_fault+0x1a0        ffffffff90eb7c84 __handle_mm_fault+0x4d4        ffffffff90eb8093 handle_mm_fault+0xc3        ffffffff90c74f6d __do_page_fault+0x1ed        ffffffff90c75277 do_page_fault+0x37        ffffffff9160111e page_fault+0x1e        ffffffff9109e7b5 copyin+0x25        ffffffff9109eb40 _copy_from_iter_full+0xe0        ffffffff91462370 tcp_sendmsg_locked+0x5e0        ffffffff91462370 tcp_sendmsg_locked+0x5e0        ffffffff91462b57 tcp_sendmsg+0x27        ffffffff9139815c sock_sendmsg+0x4c        ffffffff913981f7 sock_write_iter+0x97        ffffffff90f2cc56 do_iter_readv_writev+0x156        ffffffff90f2dff0 do_iter_write+0x80        ffffffff90f2e1c3 vfs_writev+0xa3        ffffffff90f2e27c do_writev+0x5c        ffffffff90c042bb do_syscall_64+0x5b        ffffffff916000ad entry_SYSCALL_64_after_hwframe+0x65The cifs filesystem rightfully sets sk_allocations to GFP_NOFS,we can avoid the nesting using the sk page frag for allocationlacking the __GFP_FS flag. Do not define an additional mm-helperfor that, as this is strictly tied to the sk page frag usage.v1 -> v2: - use a stricted sk_page_frag() check instead of reordering the   code (Eric)","references":["https://git.kernel.org/stable/c/5a9afcd827cafe14a95c9fcbded2c2d104f18dfc","https://git.kernel.org/stable/c/c6f340a331fb72e5ac23a083de9c780e132ca3ae","https://git.kernel.org/stable/c/dacb5d8875cc6cd3a553363b4d6f06760fcbe70c"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-0168","product":"smb","summary":"A denial of service (DOS) issue was found in the Linux kernel's smb2_ioctl_query_info function in the fs/cifs/smb2ops.c Common Internet File System (CIFS) due to an incorrect return from the memdup_user function. This flaw allows a local, privileged (CAP_SYS_ADMIN) attacker to crash the system.","details":"A denial of service (DOS) issue was found in the Linux kernel's smb2_ioctl_query_info function in the fs/cifs/smb2ops.c Common Internet File System (CIFS) due to an incorrect return from the memdup_user function. This flaw allows a local, privileged (CAP_SYS_ADMIN) attacker to crash the system.","references":["https://access.redhat.com/security/cve/CVE-2022-0168","https://bugzilla.redhat.com/show_bug.cgi?id=2037386","https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d6f5e358452479fa8a773b5c6ccc9e4ec5a20880"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<5.18"},
  {"id":"CVE-2022-20922","product":"smb","summary":"Multiple vulnerabilities in the Server Message Block Version 2 (SMB2) processor of the Snort detection engine on multiple Cisco products could allow an unauthenticated, remote attacker to bypass the configured policies or cause a denial of service (DoS) condition on an affected device. These vulnerabilities are due to improper management of system resources when the Snort detection engine is processing SMB2 traffic. An attacker could exploit these vulnerabilities by sending a high rate of certain types of SMB2 packets through an affected device. A successful exploit could allow the attacker to trigger a reload of the Snort process, resulting in a DoS condition. Note: When the snort preserve-connection option is enabled for the Snort detection engine, a successful exploit could also allow the attacker to bypass the configured policies and deliver a malicious payload to the protected network. The snort preserve-connection setting is enabled by default. See the Details [\"#details\"] section of this advisory for more information. Note: Only products that have Snort 3 configured are affected. Products that are configured with Snort 2 are not affected.","details":"Multiple vulnerabilities in the Server Message Block Version 2 (SMB2) processor of the Snort detection engine on multiple Cisco products could allow an unauthenticated, remote attacker to bypass the configured policies or cause a denial of service (DoS) condition on an affected device. These vulnerabilities are due to improper management of system resources when the Snort detection engine is processing SMB2 traffic. An attacker could exploit these vulnerabilities by sending a high rate of certain types of SMB2 packets through an affected device. A successful exploit could allow the attacker to trigger a reload of the Snort process, resulting in a DoS condition. Note: When the snort preserve-connection option is enabled for the Snort detection engine, a successful exploit could also allow the attacker to bypass the configured policies and deliver a malicious payload to the protected network. The snort preserve-connection setting is enabled by default. See the Details [\"#details\"] section of this advisory for more information. Note: Only products that have Snort 3 configured are affected. Products that are configured with Snort 2 are not affected.","references":["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-smb-3nfhJtr","https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-smb-3nfhJtr"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-20943","product":"smb","summary":"Multiple vulnerabilities in the Server Message Block Version 2 (SMB2) processor of the Snort detection engine on multiple Cisco products could allow an unauthenticated, remote attacker to bypass the configured policies or cause a denial of service (DoS) condition on an affected device. These vulnerabilities are due to improper management of system resources when the Snort detection engine is processing SMB2 traffic. An attacker could exploit these vulnerabilities by sending a high rate of certain types of SMB2 packets through an affected device. A successful exploit could allow the attacker to trigger a reload of the Snort process, resulting in a DoS condition. Note: When the snort preserve-connection option is enabled for the Snort detection engine, a successful exploit could also allow the attacker to bypass the configured policies and deliver a malicious payload to the protected network. The snort preserve-connection setting is enabled by default. See the Details [\"#details\"] section of this advisory for more information. Note: Only products that have Snort 3 configured are affected. Products that are configured with Snort 2 are not affected.","details":"Multiple vulnerabilities in the Server Message Block Version 2 (SMB2) processor of the Snort detection engine on multiple Cisco products could allow an unauthenticated, remote attacker to bypass the configured policies or cause a denial of service (DoS) condition on an affected device. These vulnerabilities are due to improper management of system resources when the Snort detection engine is processing SMB2 traffic. An attacker could exploit these vulnerabilities by sending a high rate of certain types of SMB2 packets through an affected device. A successful exploit could allow the attacker to trigger a reload of the Snort process, resulting in a DoS condition. Note: When the snort preserve-connection option is enabled for the Snort detection engine, a successful exploit could also allow the attacker to bypass the configured policies and deliver a malicious payload to the protected network. The snort preserve-connection setting is enabled by default. See the Details [\"#details\"] section of this advisory for more information. Note: Only products that have Snort 3 configured are affected. Products that are configured with Snort 2 are not affected.","references":["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-smb-3nfhJtr","https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-smb-3nfhJtr"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<17.11.1",">=17.0"],["<16.6.7"],[">=18.0","<18.1.3"]]},
  {"id":"CVE-2022-21524","product":"smb","summary":"Vulnerability in the Oracle Solaris product of Oracle Systems (component: Filesystem). The supported version that is affected is 11. Easily exploitable vulnerability allows low privileged attacker with network access via SMB to compromise Oracle Solaris. Successful attacks of this vulnerability can result in unauthorized ability to cause a hang or frequently repeatable crash (complete DOS) of Oracle Solaris as well as unauthorized update, insert or delete access to some of Oracle Solaris accessible data and unauthorized read access to a subset of Oracle Solaris accessible data. CVSS 3.1 Base Score 7.6 (Confidentiality, Integrity and Availability impacts). CVSS Vector: (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H).","details":"Vulnerability in the Oracle Solaris product of Oracle Systems (component: Filesystem). The supported version that is affected is 11. Easily exploitable vulnerability allows low privileged attacker with network access via SMB to compromise Oracle Solaris. Successful attacks of this vulnerability can result in unauthorized ability to cause a hang or frequently repeatable crash (complete DOS) of Oracle Solaris as well as unauthorized update, insert or delete access to some of Oracle Solaris accessible data and unauthorized read access to a subset of Oracle Solaris accessible data. CVSS 3.1 Base Score 7.6 (Confidentiality, Integrity and Availability impacts). CVSS Vector: (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H).","references":["https://www.oracle.com/security-alerts/cpujul2022.html","https://www.oracle.com/security-alerts/cpujul2022.html"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-21533","product":"smb","summary":"Vulnerability in the Oracle Solaris product of Oracle Systems (component: SMB Server). The supported version that is affected is 11. Easily exploitable vulnerability allows low privileged attacker with logon to the infrastructure where Oracle Solaris executes to compromise Oracle Solaris. Successful attacks of this vulnerability can result in unauthorized ability to cause a hang or frequently repeatable crash (complete DOS) of Oracle Solaris. CVSS 3.1 Base Score 5.5 (Availability impacts). CVSS Vector: (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H).","details":"Vulnerability in the Oracle Solaris product of Oracle Systems (component: SMB Server). The supported version that is affected is 11. Easily exploitable vulnerability allows low privileged attacker with logon to the infrastructure where Oracle Solaris executes to compromise Oracle Solaris. Successful attacks of this vulnerability can result in unauthorized ability to cause a hang or frequently repeatable crash (complete DOS) of Oracle Solaris. CVSS 3.1 Base Score 5.5 (Availability impacts). CVSS Vector: (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H).","references":["https://www.oracle.com/security-alerts/cpujul2022.html","https://www.oracle.com/security-alerts/cpujul2022.html"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-22995","product":"smb","summary":"The combination of primitives offered by SMB and AFP in their default configuration allows the arbitrary writing of files. By exploiting these combination of primitives, an attacker can execute arbitrary code.","details":"The combination of primitives offered by SMB and AFP in their default configuration allows the arbitrary writing of files. By exploiting these combination of primitives, an attacker can execute arbitrary code.","references":["https://lists.debian.org/debian-lts-announce/2024/01/msg00000.html","https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/55ROUJI22SHZX5EM23QAILZHI67EZQKW/","https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/T5CZZLFOTUP3QYHGHSDUNENGSLPJ6KGO/"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[["<5.19.117"],["<7.16-220"],["<3.1.18"]]},
  {"id":"CVE-2022-24372","product":"smb","summary":"Linksys MR9600 devices before 2.0.5 allow attackers to read arbitrary files via a symbolic link to the root directory of a NAS SMB share.","details":"Linksys MR9600 devices before 2.0.5 allow attackers to read arbitrary files via a symbolic link to the root directory of a NAS SMB share.","references":["https://www.linksys.com/de/linksys-dual-band-mesh-wifi-6-router-mr9600/p/p-mr9600/","https://www.linksys.com/mesh-routers/linksys-dual-band-mesh-wifi-6-router-mr9600/p/p-mr9600/","https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2021-046.txt"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<2.0.5"},
  {"id":"CVE-2022-24500","product":"smb","summary":"Windows SMB Remote Code Execution Vulnerability","details":"Windows SMB Remote Code Execution Vulnerability","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-24500","https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-24500"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-24581","product":"smb","summary":"ACEweb Online Portal 3.5.065 allows unauthenticated SMB hash capture via UNC. By specifying the UNC file path of an external SMB share when uploading a file, an attacker can induce the victim server to disclose the username and password hash of the user executing the ACEweb Online software.","details":"ACEweb Online Portal 3.5.065 allows unauthenticated SMB hash capture via UNC. By specifying the UNC file path of an external SMB share when uploading a file, an attacker can induce the victim server to disclose the username and password hash of the user executing the ACEweb Online software.","references":["http://aceware.com","http://aceweb.com","https://www.aceware.com/forum/viewtopic.php?f=7&t=481"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<3.5.065"},
  {"id":"CVE-2022-2780","product":"smb","summary":"In affected versions of Octopus Server it is possible to use the Git Connectivity test function on the VCS project to initiate an SMB request resulting in the potential for an NTLM relay attack.","details":"In affected versions of Octopus Server it is possible to use the Git Connectivity test function on the VCS project to initiate an SMB request resulting in the potential for an NTLM relay attack.","references":["https://advisories.octopus.com/post/2022/sa2022-20/","https://advisories.octopus.com/post/2022/sa2022-20/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=2022.2.6729","<2022.2.7965","<2022.3.10586",">=2022.3.348","<2022.1.3180"],[">=2021.2.994"]]},
  {"id":"CVE-2022-2873","product":"smb","summary":"An out-of-bounds memory access flaw was found in the Linux kernel Intel's iSMT SMBus host controller driver in the way a user triggers the I2C_SMBUS_BLOCK_DATA (with the ioctl I2C_SMBUS) with malicious input data. This flaw allows a local user to crash the system.","details":"An out-of-bounds memory access flaw was found in the Linux kernel Intel's iSMT SMBus host controller driver in the way a user triggers the I2C_SMBUS_BLOCK_DATA (with the ioctl I2C_SMBUS) with malicious input data. This flaw allows a local user to crash the system.","references":["https://lists.debian.org/debian-lts-announce/2023/03/msg00000.html","https://lists.debian.org/debian-lts-announce/2023/05/msg00006.html","https://lore.kernel.org/lkml/20220729093451.551672-1-zheyuma97%40gmail.com/T/"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<5.19"},
  {"id":"CVE-2022-29281","product":"smb","summary":"Notable before 1.9.0-beta.8 doesn't effectively prevent the opening of executable files when clicking on a link. There is improper validation of the file URI scheme. A hyperlink to an SMB share could lead to execution of an arbitrary program (or theft of NTLM credentials via an SMB relay attack, because the application resolves UNC paths).","details":"Notable before 1.9.0-beta.8 doesn't effectively prevent the opening of executable files when clicking on a link. There is improper validation of the file URI scheme. A hyperlink to an SMB share could lead to execution of an arbitrary program (or theft of NTLM credentials via an SMB relay attack, because the application resolves UNC paths).","references":["https://github.com/hmnthabit/Advisories/blob/master/CVE-2022-29281.md","https://github.com/notable/notable-insiders/releases/tag/v1.9.0-beta.8","https://github.com/hmnthabit/Advisories/blob/master/CVE-2022-29281.md"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<1.9.0"},
  {"id":"CVE-2022-3077","product":"smb","summary":"A buffer overflow vulnerability was found in the Linux kernel Intel's iSMT SMBus host controller driver in the way it handled the I2C_SMBUS_BLOCK_PROC_CALL case (via the ioctl I2C_SMBUS) with malicious input data. This flaw could allow a local user to crash the system.","details":"A buffer overflow vulnerability was found in the Linux kernel Intel's iSMT SMBus host controller driver in the way it handled the I2C_SMBUS_BLOCK_PROC_CALL case (via the ioctl I2C_SMBUS) with malicious input data. This flaw could allow a local user to crash the system.","references":["https://github.com/torvalds/linux/commit/690b2549b19563ec5ad53e5c82f6a944d910086e","https://github.com/torvalds/linux/commit/690b2549b19563ec5ad53e5c82f6a944d910086e"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[">=5.11","<5.19"]},
  {"id":"CVE-2022-30772","product":"smb","summary":"Manipulation of the input address in PnpSmm function 0x52 could be used by malware to overwrite SMRAM or OS kernel memory. Function 0x52 of the PnpSmm driver is passed the address and size of data to write into the SMBIOS table, but manipulation of the address could be used by malware to overwrite SMRAM or OS kernel memory. This issue was discovered by Insyde engineering during a security review. This issue is fixed in: Kernel 5.0: 05.09.41 Kernel 5.1: 05.17.43 Kernel 5.2: 05.27.30 Kernel 5.3: 05.36.30 Kernel 5.4: 05.44.30 Kernel 5.5: 05.52.30 https://www.insyde.com/security-pledge/SA-2022065","details":"Manipulation of the input address in PnpSmm function 0x52 could be used by malware to overwrite SMRAM or OS kernel memory. Function 0x52 of the PnpSmm driver is passed the address and size of data to write into the SMBIOS table, but manipulation of the address could be used by malware to overwrite SMRAM or OS kernel memory. This issue was discovered by Insyde engineering during a security review. This issue is fixed in: Kernel 5.0: 05.09.41 Kernel 5.1: 05.17.43 Kernel 5.2: 05.27.30 Kernel 5.3: 05.36.30 Kernel 5.4: 05.44.30 Kernel 5.5: 05.52.30 https://www.insyde.com/security-pledge/SA-2022065","references":["https://www.insyde.com/security-pledge","https://www.insyde.com/security-pledge/SA-2022065","https://www.insyde.com/security-pledge"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[">=5.4",">=5.5","<5.3.05.36.30",">=5.2","<5.4.05.44.30","<5.5.05.52.30",">=5.1","<5.0.05.09.41","<5.1.05.17.43","<5.2.05.27.30",">=5.0",">=5.3"]},
  {"id":"CVE-2022-31246","product":"smb","summary":"paymentrequest.py in Electrum before 4.2.2 allows a file:// URL in the r parameter of a payment request (e.g., within QR code data). On Windows, this can lead to capture of credentials over SMB. On Linux and UNIX, it can lead to a denial of service by specifying the /dev/zero filename.","details":"paymentrequest.py in Electrum before 4.2.2 allows a file:// URL in the r parameter of a payment request (e.g., within QR code data). On Windows, this can lead to capture of credentials over SMB. On Linux and UNIX, it can lead to a denial of service by specifying the /dev/zero filename.","references":["https://github.com/spesmilo/electrum/security/advisories/GHSA-4fh4-hx35-r355","https://twitter.com/ElectrumWallet/status/1534540879905665028","https://github.com/spesmilo/electrum/security/advisories/GHSA-4fh4-hx35-r355"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<4.2.2"},
  {"id":"CVE-2022-31601","product":"smb","summary":"NVIDIA DGX A100 contains a vulnerability in SBIOS in the SmbiosPei, which may allow a highly privileged local attacker to cause an out-of-bounds write, which may lead to code execution, denial of service, compromised integrity, and information disclosure.","details":"NVIDIA DGX A100 contains a vulnerability in SBIOS in the SmbiosPei, which may allow a highly privileged local attacker to cause an out-of-bounds write, which may lead to code execution, denial of service, compromised integrity, and information disclosure.","references":["https://nvidia.custhelp.com/app/answers/detail/a_id/5367","https://nvidia.custhelp.com/app/answers/detail/a_id/5367"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<22.5.5"},
  {"id":"CVE-2022-32230","product":"smb","summary":"Microsoft Windows SMBv3 suffers from a null pointer dereference in versions of Windows prior to the April, 2022 patch set. By sending a malformed FileNormalizedNameInformation SMBv3 request over a named pipe, an attacker can cause a Blue Screen of Death (BSOD) crash of the Windows kernel. For most systems, this attack requires authentication, except in the special case of Windows Domain Controllers, where unauthenticated users can always open named pipes as long as they can establish an SMB session. Typically, after the BSOD, the victim SMBv3 server will reboot.","details":"Microsoft Windows SMBv3 suffers from a null pointer dereference in versions of Windows prior to the April, 2022 patch set. By sending a malformed FileNormalizedNameInformation SMBv3 request over a named pipe, an attacker can cause a Blue Screen of Death (BSOD) crash of the Windows kernel. For most systems, this attack requires authentication, except in the special case of Windows Domain Controllers, where unauthenticated users can always open named pipes as long as they can establish an SMB session. Typically, after the BSOD, the victim SMBv3 server will reboot.","references":["https://github.com/zeroSteiner/metasploit-framework/blob/feat/mod/cve-2022-32230/modules/auxiliary/dos/smb/smb_filenormalizednameinformation.rb","https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-32230","https://support.microsoft.com/en-us/topic/may-10-2022-kb5013942-os-builds-19042-1706-19043-1706-and-19044-1706-60b51119-85be-4a34-9e21-8954f6749504"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-32742","product":"smb","summary":"A flaw was found in Samba. Some SMB1 write requests were not correctly range-checked to ensure the client had sent enough data to fulfill the write, allowing server memory contents to be written into the file (or printer) instead of client-supplied data. The client cannot control the area of the server memory written to the file (or printer).","details":"A flaw was found in Samba. Some SMB1 write requests were not correctly range-checked to ensure the client had sent enough data to fulfill the write, allowing server memory contents to be written into the file (or printer) instead of client-supplied data. The client cannot control the area of the server memory written to the file (or printer).","references":["https://lists.debian.org/debian-lts-announce/2024/04/msg00015.html","https://security.gentoo.org/glsa/202309-06","https://www.samba.org/samba/security/CVE-2022-32742.html"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<4.15.9",">=4.16.0","<4.16.4",">=4.15.0","<4.14.14"]},
  {"id":"CVE-2022-35804","product":"smb","summary":"SMB Client and Server Remote Code Execution Vulnerability","details":"SMB Client and Server Remote Code Execution Vulnerability","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-35804","https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-35804"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-3592","product":"smb","summary":"A symlink following vulnerability was found in Samba, where a user can create a symbolic link that will make 'smbd' escape the configured share path. This flaw allows a remote user with access to the exported part of the file system under a share via SMB1 unix extensions or NFS to create symlinks to files outside the 'smbd' configured share path and gain access to another restricted server's filesystem.","details":"A symlink following vulnerability was found in Samba, where a user can create a symbolic link that will make 'smbd' escape the configured share path. This flaw allows a remote user with access to the exported part of the file system under a share via SMB1 unix extensions or NFS to create symlinks to files outside the 'smbd' configured share path and gain access to another restricted server's filesystem.","references":["https://access.redhat.com/security/cve/CVE-2022-3592","https://bugzilla.redhat.com/show_bug.cgi?id=2137776","https://security.gentoo.org/glsa/202309-06"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<4.17.2",">=4.17.0"]},
  {"id":"CVE-2022-36077","product":"smb","summary":"The Electron framework enables writing cross-platform desktop applications using JavaScript, HTML and CSS. In versions prior to 21.0.0-beta.1, 20.0.1, 19.0.11, and 18.3.7, Electron is vulnerable to Exposure of Sensitive Information. When following a redirect, Electron delays a check for redirecting to file:// URLs from other schemes. The contents of the file is not available to the renderer following the redirect, but if the redirect target is a SMB URL such as `file://some.website.com/`, then in some cases, Windows will connect to that server and attempt NTLM authentication, which can include sending hashed credentials.This issue has been patched in versions: 21.0.0-beta.1, 20.0.1, 19.0.11, and 18.3.7. Users are recommended to upgrade to the latest stable version of Electron. If upgrading isn't possible, this issue can be addressed without upgrading by preventing redirects to file:// URLs in the `WebContents.on('will-redirect')` event, for all WebContents as a workaround.","details":"The Electron framework enables writing cross-platform desktop applications using JavaScript, HTML and CSS. In versions prior to 21.0.0-beta.1, 20.0.1, 19.0.11, and 18.3.7, Electron is vulnerable to Exposure of Sensitive Information. When following a redirect, Electron delays a check for redirecting to file:// URLs from other schemes. The contents of the file is not available to the renderer following the redirect, but if the redirect target is a SMB URL such as `file://some.website.com/`, then in some cases, Windows will connect to that server and attempt NTLM authentication, which can include sending hashed credentials.This issue has been patched in versions: 21.0.0-beta.1, 20.0.1, 19.0.11, and 18.3.7. Users are recommended to upgrade to the latest stable version of Electron. If upgrading isn't possible, this issue can be addressed without upgrading by preventing redirects to file:// URLs in the `WebContents.on('will-redirect')` event, for all WebContents as a workaround.","references":["https://github.com/electron/electron/security/advisories/GHSA-p2jh-44qj-pf2v","https://github.com/electron/electron/security/advisories/GHSA-p2jh-44qj-pf2v"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<19.0.11",">=19.0.0"],["<18.3.7"],["<20.0.1",">=20.0.0"]]},
  {"id":"CVE-2022-41318","product":"smb","summary":"A buffer over-read was discovered in libntlmauth in Squid 2.5 through 5.6. Due to incorrect integer-overflow protection, the SSPI and SMB authentication helpers are vulnerable to reading unintended memory locations. In some configurations, cleartext credentials from these locations are sent to a client. This is fixed in 5.7.","details":"A buffer over-read was discovered in libntlmauth in Squid 2.5 through 5.6. Due to incorrect integer-overflow protection, the SSPI and SMB authentication helpers are vulnerable to reading unintended memory locations. In some configurations, cleartext credentials from these locations are sent to a client. This is fixed in 5.7.","references":["http://www.squid-cache.org/Versions/v4/changesets/SQUID-2022_2.patch","http://www.squid-cache.org/Versions/v5/changesets/SQUID-2022_2.patch","https://github.com/squid-cache/squid/security/advisories/GHSA-394c-rr7q-6g78"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=2.5"],["<5.7"]]},
  {"id":"CVE-2022-41924","product":"smb","summary":"A vulnerability identified in the Tailscale Windows client allows a malicious website to reconfigure the Tailscale daemon `tailscaled`, which can then be used to remotely execute code. In the Tailscale Windows client, the local API was bound to a local TCP socket, and communicated with the Windows client GUI in cleartext with no Host header verification. This allowed an attacker-controlled website visited by the node to rebind DNS to an attacker-controlled DNS server, and then make local API requests in the client, including changing the coordination server to an attacker-controlled coordination server. An attacker-controlled coordination server can send malicious URL responses to the client, including pushing executables or installing an SMB share. These allow the attacker to remotely execute code on the node. All Windows clients prior to version v.1.32.3 are affected. If you are running Tailscale on Windows, upgrade to v1.32.3 or later to remediate the issue.","details":"A vulnerability identified in the Tailscale Windows client allows a malicious website to reconfigure the Tailscale daemon `tailscaled`, which can then be used to remotely execute code. In the Tailscale Windows client, the local API was bound to a local TCP socket, and communicated with the Windows client GUI in cleartext with no Host header verification. This allowed an attacker-controlled website visited by the node to rebind DNS to an attacker-controlled DNS server, and then make local API requests in the client, including changing the coordination server to an attacker-controlled coordination server. An attacker-controlled coordination server can send malicious URL responses to the client, including pushing executables or installing an SMB share. These allow the attacker to remotely execute code on the node. All Windows clients prior to version v.1.32.3 are affected. If you are running Tailscale on Windows, upgrade to v1.32.3 or later to remediate the issue.","references":["https://emily.id.au/tailscale","https://github.com/tailscale/tailscale/security/advisories/GHSA-vqp6-rc3h-83cp","https://tailscale.com/security-bulletins/#ts-2022-004"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<1.32.3"},
  {"id":"CVE-2022-43381","product":"smb","summary":"IBM AIX 7.1, 7.2, 7.3, and VIOS 3.1could allow a non-privileged local user to exploit a vulnerability in the AIX SMB client to cause a denial of service. IBM X-Force ID: 238639.","details":"IBM AIX 7.1, 7.2, 7.3, and VIOS 3.1could allow a non-privileged local user to exploit a vulnerability in the AIX SMB client to cause a denial of service. IBM X-Force ID: 238639.","references":["https://exchange.xforce.ibmcloud.com/vulnerabilities/238639","https://www.ibm.com/support/pages/node/6851443","https://exchange.xforce.ibmcloud.com/vulnerabilities/238639"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-43552","product":"smb","summary":"A use after free vulnerability exists in curl <7.87.0. Curl can be asked to *tunnel* virtually all protocols it supports through an HTTP proxy. HTTP proxies can (and often do) deny such tunnel operations. When getting denied to tunnel the specific protocols SMB or TELNET, curl would use a heap-allocated struct after it had been freed, in its transfer shutdown code path.","details":"A use after free vulnerability exists in curl <7.87.0. Curl can be asked to *tunnel* virtually all protocols it supports through an HTTP proxy. HTTP proxies can (and often do) deny such tunnel operations. When getting denied to tunnel the specific protocols SMB or TELNET, curl would use a heap-allocated struct after it had been freed, in its transfer shutdown code path.","references":["http://seclists.org/fulldisclosure/2023/Mar/17","https://hackerone.com/reports/1764858","https://security.gentoo.org/glsa/202310-12"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<13.3",">=13.0"],[">=9.0.0","<9.0.6"],[">=8.2.0","<8.2.12"],["<7.87.0"]]},
  {"id":"CVE-2022-45897","product":"smb","summary":"On Xerox WorkCentre 3550 25.003.03.000 devices, an authenticated attacker can view the SMB server settings and can obtain the stored cleartext credentials associated with those settings.","details":"On Xerox WorkCentre 3550 25.003.03.000 devices, an authenticated attacker can view the SMB server settings and can obtain the stored cleartext credentials associated with those settings.","references":["https://Xerox.com","https://gist.github.com/waffl3ss/eb61d38b5c44131d3586578002c63640#file-cve-2022-45897","https://Xerox.com"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-47938","product":"smb","summary":"An issue was discovered in ksmbd in the Linux kernel 5.15 through 5.19 before 5.19.2. fs/ksmbd/smb2misc.c has an out-of-bounds read and OOPS for SMB2_TREE_CONNECT.","details":"An issue was discovered in ksmbd in the Linux kernel 5.15 through 5.19 before 5.19.2. fs/ksmbd/smb2misc.c has an out-of-bounds read and OOPS for SMB2_TREE_CONNECT.","references":["http://www.openwall.com/lists/oss-security/2022/12/23/10","https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.19.2","https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=824d4f64c20093275f72fc8101394d75ff6a249e"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<5.19.2",">=5.15"]},
  {"id":"CVE-2022-47939","product":"smb","summary":"An issue was discovered in ksmbd in the Linux kernel 5.15 through 5.19 before 5.19.2. fs/ksmbd/smb2pdu.c has a use-after-free and OOPS for SMB2_TREE_DISCONNECT.","details":"An issue was discovered in ksmbd in the Linux kernel 5.15 through 5.19 before 5.19.2. fs/ksmbd/smb2pdu.c has a use-after-free and OOPS for SMB2_TREE_DISCONNECT.","references":["http://www.openwall.com/lists/oss-security/2022/12/23/10","https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.19.2","https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=cf6531d98190fa2cf92a6d8bbc8af0a4740a223c"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[">=5.19","<5.19.2","<5.18.18",">=5.16",">=5.15","<5.15.61"]},
  {"id":"CVE-2022-47940","product":"smb","summary":"An issue was discovered in ksmbd in the Linux kernel 5.15 through 5.18 before 5.18.18. fs/ksmbd/smb2pdu.c lacks length validation in the non-padding case in smb2_write.","details":"An issue was discovered in ksmbd in the Linux kernel 5.15 through 5.18 before 5.18.18. fs/ksmbd/smb2pdu.c lacks length validation in the non-padding case in smb2_write.","references":["http://www.openwall.com/lists/oss-security/2022/12/23/10","https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.18.18","https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=158a66b245739e15858de42c0ba60fcf3de9b8e6"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[">=5.16",">=5.15","<5.18.18","<5.15.145"]},
  {"id":"CVE-2022-47941","product":"smb","summary":"An issue was discovered in ksmbd in the Linux kernel 5.15 through 5.19 before 5.19.2. fs/ksmbd/smb2pdu.c omits a kfree call in certain smb2_handle_negotiate error conditions, aka a memory leak.","details":"An issue was discovered in ksmbd in the Linux kernel 5.15 through 5.19 before 5.19.2. fs/ksmbd/smb2pdu.c omits a kfree call in certain smb2_handle_negotiate error conditions, aka a memory leak.","references":["http://www.openwall.com/lists/oss-security/2022/12/23/10","https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.19.2","https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=aa7253c2393f6dcd6a1468b0792f6da76edad917"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[">=5.19","<5.19.2","<5.18.18",">=5.16",">=5.15","<5.15.61"]},
  {"id":"CVE-2022-47942","product":"smb","summary":"An issue was discovered in ksmbd in the Linux kernel 5.15 through 5.19 before 5.19.2. There is a heap-based buffer overflow in set_ntacl_dacl, related to use of SMB2_QUERY_INFO_HE after a malformed SMB2_SET_INFO_HE command.","details":"An issue was discovered in ksmbd in the Linux kernel 5.15 through 5.19 before 5.19.2. There is a heap-based buffer overflow in set_ntacl_dacl, related to use of SMB2_QUERY_INFO_HE after a malformed SMB2_SET_INFO_HE command.","references":["http://www.openwall.com/lists/oss-security/2022/12/23/10","https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.19.2","https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=8f0541186e9ad1b62accc9519cc2b7a7240272a7"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[">=5.19","<5.19.2","<5.18.18",">=5.16",">=5.15","<5.15.62"]},
  {"id":"CVE-2022-47943","product":"smb","summary":"An issue was discovered in ksmbd in the Linux kernel 5.15 through 5.19 before 5.19.2. There is an out-of-bounds read and OOPS for SMB2_WRITE, when there is a large length in the zero DataOffset case.","details":"An issue was discovered in ksmbd in the Linux kernel 5.15 through 5.19 before 5.19.2. There is an out-of-bounds read and OOPS for SMB2_WRITE, when there is a large length in the zero DataOffset case.","references":["http://www.openwall.com/lists/oss-security/2022/12/23/10","https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.19.2","https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=ac60778b87e45576d7bfdbd6f53df902654e6f09"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[">=5.19","<5.19.2","<5.18.18",">=5.16",">=5.15","<5.15.62"]},
  {"id":"CVE-2022-48667","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb3: fix temporary data corruption in insert rangeinsert range doesn't discard the affected cached regionso can risk temporarily corrupting file data.Also includes some minor cleanup (avoiding rereadinginode size repeatedly unnecessarily) to make it clearer.","details":"In the Linux kernel, the following vulnerability has been resolved:smb3: fix temporary data corruption in insert rangeinsert range doesn't discard the affected cached regionso can risk temporarily corrupting file data.Also includes some minor cleanup (avoiding rereadinginode size repeatedly unnecessarily) to make it clearer.","references":["https://git.kernel.org/stable/c/0cdde8460c304283d4ebe3f767a70215d1ab9d4e","https://git.kernel.org/stable/c/9c8b7a293f50253e694f19161c045817a938e551","https://git.kernel.org/stable/c/0cdde8460c304283d4ebe3f767a70215d1ab9d4e"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-48668","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb3: fix temporary data corruption in collapse rangecollapse range doesn't discard the affected cached regionso can risk temporarily corrupting the file data. Thisfixes xfstest generic/031I also decided to merge a minor cleanup to this into the same patch(avoiding rereading inode size repeatedly unnecessarily) to make itclearer.","details":"In the Linux kernel, the following vulnerability has been resolved:smb3: fix temporary data corruption in collapse rangecollapse range doesn't discard the affected cached regionso can risk temporarily corrupting the file data. Thisfixes xfstest generic/031I also decided to merge a minor cleanup to this into the same patch(avoiding rereading inode size repeatedly unnecessarily) to make itclearer.","references":["https://git.kernel.org/stable/c/49523a4732204bdacbf3941a016503ddb4ddb3b9","https://git.kernel.org/stable/c/fa30a81f255a56cccd89552cd6ce7ea6e8d8acc4","https://git.kernel.org/stable/c/49523a4732204bdacbf3941a016503ddb4ddb3b9"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-48919","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:cifs: fix double free race when mount fails in cifs_get_root()When cifs_get_root() fails during cifs_smb3_do_mount() we calldeactivate_locked_super() which eventually will call delayed_free() whichwill free the context.In this situation we should not proceed to enter the out: section incifs_smb3_do_mount() and free the same resources a second time.[Thu Feb 10 12:59:06 2022] BUG: KASAN: use-after-free in rcu_cblist_dequeue+0x32/0x60[Thu Feb 10 12:59:06 2022] Read of size 8 at addr ffff888364f4d110 by task swapper/1/0[Thu Feb 10 12:59:06 2022] CPU: 1 PID: 0 Comm: swapper/1 Tainted: G           OE     5.17.0-rc3+ #4[Thu Feb 10 12:59:06 2022] Hardware name: Microsoft Corporation Virtual Machine/Virtual Machine, BIOS Hyper-V UEFI Release v4.0 12/17/2019[Thu Feb 10 12:59:06 2022] Call Trace:[Thu Feb 10 12:59:06 2022]  <IRQ>[Thu Feb 10 12:59:06 2022]  dump_stack_lvl+0x5d/0x78[Thu Feb 10 12:59:06 2022]  print_address_description.constprop.0+0x24/0x150[Thu Feb 10 12:59:06 2022]  ? rcu_cblist_dequeue+0x32/0x60[Thu Feb 10 12:59:06 2022]  kasan_report.cold+0x7d/0x117[Thu Feb 10 12:59:06 2022]  ? rcu_cblist_dequeue+0x32/0x60[Thu Feb 10 12:59:06 2022]  __asan_load8+0x86/0xa0[Thu Feb 10 12:59:06 2022]  rcu_cblist_dequeue+0x32/0x60[Thu Feb 10 12:59:06 2022]  rcu_core+0x547/0xca0[Thu Feb 10 12:59:06 2022]  ? call_rcu+0x3c0/0x3c0[Thu Feb 10 12:59:06 2022]  ? __this_cpu_preempt_check+0x13/0x20[Thu Feb 10 12:59:06 2022]  ? lock_is_held_type+0xea/0x140[Thu Feb 10 12:59:06 2022]  rcu_core_si+0xe/0x10[Thu Feb 10 12:59:06 2022]  __do_softirq+0x1d4/0x67b[Thu Feb 10 12:59:06 2022]  __irq_exit_rcu+0x100/0x150[Thu Feb 10 12:59:06 2022]  irq_exit_rcu+0xe/0x30[Thu Feb 10 12:59:06 2022]  sysvec_hyperv_stimer0+0x9d/0xc0...[Thu Feb 10 12:59:07 2022] Freed by task 58179:[Thu Feb 10 12:59:07 2022]  kasan_save_stack+0x26/0x50[Thu Feb 10 12:59:07 2022]  kasan_set_track+0x25/0x30[Thu Feb 10 12:59:07 2022]  kasan_set_free_info+0x24/0x40[Thu Feb 10 12:59:07 2022]  ____kasan_slab_free+0x137/0x170[Thu Feb 10 12:59:07 2022]  __kasan_slab_free+0x12/0x20[Thu Feb 10 12:59:07 2022]  slab_free_freelist_hook+0xb3/0x1d0[Thu Feb 10 12:59:07 2022]  kfree+0xcd/0x520[Thu Feb 10 12:59:07 2022]  cifs_smb3_do_mount+0x149/0xbe0 [cifs][Thu Feb 10 12:59:07 2022]  smb3_get_tree+0x1a0/0x2e0 [cifs][Thu Feb 10 12:59:07 2022]  vfs_get_tree+0x52/0x140[Thu Feb 10 12:59:07 2022]  path_mount+0x635/0x10c0[Thu Feb 10 12:59:07 2022]  __x64_sys_mount+0x1bf/0x210[Thu Feb 10 12:59:07 2022]  do_syscall_64+0x5c/0xc0[Thu Feb 10 12:59:07 2022]  entry_SYSCALL_64_after_hwframe+0x44/0xae[Thu Feb 10 12:59:07 2022] Last potentially related work creation:[Thu Feb 10 12:59:07 2022]  kasan_save_stack+0x26/0x50[Thu Feb 10 12:59:07 2022]  __kasan_record_aux_stack+0xb6/0xc0[Thu Feb 10 12:59:07 2022]  kasan_record_aux_stack_noalloc+0xb/0x10[Thu Feb 10 12:59:07 2022]  call_rcu+0x76/0x3c0[Thu Feb 10 12:59:07 2022]  cifs_umount+0xce/0xe0 [cifs][Thu Feb 10 12:59:07 2022]  cifs_kill_sb+0xc8/0xe0 [cifs][Thu Feb 10 12:59:07 2022]  deactivate_locked_super+0x5d/0xd0[Thu Feb 10 12:59:07 2022]  cifs_smb3_do_mount+0xab9/0xbe0 [cifs][Thu Feb 10 12:59:07 2022]  smb3_get_tree+0x1a0/0x2e0 [cifs][Thu Feb 10 12:59:07 2022]  vfs_get_tree+0x52/0x140[Thu Feb 10 12:59:07 2022]  path_mount+0x635/0x10c0[Thu Feb 10 12:59:07 2022]  __x64_sys_mount+0x1bf/0x210[Thu Feb 10 12:59:07 2022]  do_syscall_64+0x5c/0xc0[Thu Feb 10 12:59:07 2022]  entry_SYSCALL_64_after_hwframe+0x44/0xae","details":"In the Linux kernel, the following vulnerability has been resolved:cifs: fix double free race when mount fails in cifs_get_root()When cifs_get_root() fails during cifs_smb3_do_mount() we calldeactivate_locked_super() which eventually will call delayed_free() whichwill free the context.In this situation we should not proceed to enter the out: section incifs_smb3_do_mount() and free the same resources a second time.[Thu Feb 10 12:59:06 2022] BUG: KASAN: use-after-free in rcu_cblist_dequeue+0x32/0x60[Thu Feb 10 12:59:06 2022] Read of size 8 at addr ffff888364f4d110 by task swapper/1/0[Thu Feb 10 12:59:06 2022] CPU: 1 PID: 0 Comm: swapper/1 Tainted: G           OE     5.17.0-rc3+ #4[Thu Feb 10 12:59:06 2022] Hardware name: Microsoft Corporation Virtual Machine/Virtual Machine, BIOS Hyper-V UEFI Release v4.0 12/17/2019[Thu Feb 10 12:59:06 2022] Call Trace:[Thu Feb 10 12:59:06 2022]  <IRQ>[Thu Feb 10 12:59:06 2022]  dump_stack_lvl+0x5d/0x78[Thu Feb 10 12:59:06 2022]  print_address_description.constprop.0+0x24/0x150[Thu Feb 10 12:59:06 2022]  ? rcu_cblist_dequeue+0x32/0x60[Thu Feb 10 12:59:06 2022]  kasan_report.cold+0x7d/0x117[Thu Feb 10 12:59:06 2022]  ? rcu_cblist_dequeue+0x32/0x60[Thu Feb 10 12:59:06 2022]  __asan_load8+0x86/0xa0[Thu Feb 10 12:59:06 2022]  rcu_cblist_dequeue+0x32/0x60[Thu Feb 10 12:59:06 2022]  rcu_core+0x547/0xca0[Thu Feb 10 12:59:06 2022]  ? call_rcu+0x3c0/0x3c0[Thu Feb 10 12:59:06 2022]  ? __this_cpu_preempt_check+0x13/0x20[Thu Feb 10 12:59:06 2022]  ? lock_is_held_type+0xea/0x140[Thu Feb 10 12:59:06 2022]  rcu_core_si+0xe/0x10[Thu Feb 10 12:59:06 2022]  __do_softirq+0x1d4/0x67b[Thu Feb 10 12:59:06 2022]  __irq_exit_rcu+0x100/0x150[Thu Feb 10 12:59:06 2022]  irq_exit_rcu+0xe/0x30[Thu Feb 10 12:59:06 2022]  sysvec_hyperv_stimer0+0x9d/0xc0...[Thu Feb 10 12:59:07 2022] Freed by task 58179:[Thu Feb 10 12:59:07 2022]  kasan_save_stack+0x26/0x50[Thu Feb 10 12:59:07 2022]  kasan_set_track+0x25/0x30[Thu Feb 10 12:59:07 2022]  kasan_set_free_info+0x24/0x40[Thu Feb 10 12:59:07 2022]  ____kasan_slab_free+0x137/0x170[Thu Feb 10 12:59:07 2022]  __kasan_slab_free+0x12/0x20[Thu Feb 10 12:59:07 2022]  slab_free_freelist_hook+0xb3/0x1d0[Thu Feb 10 12:59:07 2022]  kfree+0xcd/0x520[Thu Feb 10 12:59:07 2022]  cifs_smb3_do_mount+0x149/0xbe0 [cifs][Thu Feb 10 12:59:07 2022]  smb3_get_tree+0x1a0/0x2e0 [cifs][Thu Feb 10 12:59:07 2022]  vfs_get_tree+0x52/0x140[Thu Feb 10 12:59:07 2022]  path_mount+0x635/0x10c0[Thu Feb 10 12:59:07 2022]  __x64_sys_mount+0x1bf/0x210[Thu Feb 10 12:59:07 2022]  do_syscall_64+0x5c/0xc0[Thu Feb 10 12:59:07 2022]  entry_SYSCALL_64_after_hwframe+0x44/0xae[Thu Feb 10 12:59:07 2022] Last potentially related work creation:[Thu Feb 10 12:59:07 2022]  kasan_save_stack+0x26/0x50[Thu Feb 10 12:59:07 2022]  __kasan_record_aux_stack+0xb6/0xc0[Thu Feb 10 12:59:07 2022]  kasan_record_aux_stack_noalloc+0xb/0x10[Thu Feb 10 12:59:07 2022]  call_rcu+0x76/0x3c0[Thu Feb 10 12:59:07 2022]  cifs_umount+0xce/0xe0 [cifs][Thu Feb 10 12:59:07 2022]  cifs_kill_sb+0xc8/0xe0 [cifs][Thu Feb 10 12:59:07 2022]  deactivate_locked_super+0x5d/0xd0[Thu Feb 10 12:59:07 2022]  cifs_smb3_do_mount+0xab9/0xbe0 [cifs][Thu Feb 10 12:59:07 2022]  smb3_get_tree+0x1a0/0x2e0 [cifs][Thu Feb 10 12:59:07 2022]  vfs_get_tree+0x52/0x140[Thu Feb 10 12:59:07 2022]  path_mount+0x635/0x10c0[Thu Feb 10 12:59:07 2022]  __x64_sys_mount+0x1bf/0x210[Thu Feb 10 12:59:07 2022]  do_syscall_64+0x5c/0xc0[Thu Feb 10 12:59:07 2022]  entry_SYSCALL_64_after_hwframe+0x44/0xae","references":["https://git.kernel.org/stable/c/147a0e71ccf96df9fc8c2ac500829d8e423ef02c","https://git.kernel.org/stable/c/2fe0e281f7ad0a62259649764228227dd6b2561d","https://git.kernel.org/stable/c/3d6cc9898efdfb062efb74dc18cfc700e082f5d5"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<5.16.13",">=5.5","<5.10.104","<5.15.27",">=5.16","<5.4.183",">=5.11"],[">=4.15","<4.19.233","<4.14.270",">=4.10",">=4.20","<4.9.305"]]},
  {"id":"CVE-2022-49271","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:cifs: prevent bad output lengths in smb2_ioctl_query_info()When calling smb2_ioctl_query_info() withsmb_query_info::flags=PASSTHRU_FSCTL andsmb_query_info::output_buffer_length=0, the following would return0x10buffer = memdup_user(arg + sizeof(struct smb_query_info),     qi.output_buffer_length);if (IS_ERR(buffer)) {kfree(vars);return PTR_ERR(buffer);}rather than a valid pointer thus making IS_ERR() check fail.  Thiswould then cause a NULL ptr deference in @buffer when accessing itlater in smb2_ioctl_query_ioctl().  While at it, prevent having a@buffer smaller than 8 bytes to correctly handle SMB2_SET_INFOFileEndOfFileInformation requests whensmb_query_info::flags=PASSTHRU_SET_INFO.Here is a small C reproducer which triggers a NULL ptr in @buffer whenpassing an invalid smb_query_info::flags#include <stdio.h>#include <stdlib.h>#include <stdint.h>#include <unistd.h>#include <fcntl.h>#include <sys/ioctl.h>#define die(s) perror(s), exit(1)#define QUERY_INFO 0xc018cf07int main(int argc, char *argv[]){int fd;if (argc < 2)exit(1);fd = open(argv[1], O_RDONLY);if (fd == -1)die(\"open\");if (ioctl(fd, QUERY_INFO, (uint32_t[]) { 0, 0, 0, 4, 0, 0}) == -1)die(\"ioctl\");close(fd);return 0;}mount.cifs //srv/share /mnt -o ...gcc repro.c && ./a.out /mnt/f0[  114.138620] general protection fault, probably for non-canonical address 0xdffffc0000000000: 0000 [#1] PREEMPT SMP KASAN NOPTI[  114.139310] KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007][  114.139775] CPU: 2 PID: 995 Comm: a.out Not tainted 5.17.0-rc8 #1[  114.140148] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.15.0-0-g2dd4b9b-rebuilt.opensuse.org 04/01/2014[  114.140818] RIP: 0010:smb2_ioctl_query_info+0x206/0x410 [cifs][  114.141221] Code: 00 00 00 00 fc ff df 48 c1 ea 03 80 3c 02 00 0f 85 c8 01 00 00 48 b8 00 00 00 00 00 fc ff df 4c 8b 7b 28 4c 89 fa 48 c1 ea 03 <80> 3c 02 00 0f 85 9c 01 00 00 49 8b 3f e8 58 02 fb ff 48 8b 14 24[  114.142348] RSP: 0018:ffffc90000b47b00 EFLAGS: 00010256[  114.142692] RAX: dffffc0000000000 RBX: ffff888115503200 RCX: ffffffffa020580d[  114.143119] RDX: 0000000000000000 RSI: 0000000000000004 RDI: ffffffffa043a380[  114.143544] RBP: ffff888115503278 R08: 0000000000000001 R09: 0000000000000003[  114.143983] R10: fffffbfff4087470 R11: 0000000000000001 R12: ffff888115503288[  114.144424] R13: 00000000ffffffea R14: ffff888115503228 R15: 0000000000000000[  114.144852] FS:  00007f7aeabdf740(0000) GS:ffff888151600000(0000) knlGS:0000000000000000[  114.145338] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033[  114.145692] CR2: 00007f7aeacfdf5e CR3: 000000012000e000 CR4: 0000000000350ee0[  114.146131] Call Trace:[  114.146291]  <TASK>[  114.146432]  ? smb2_query_reparse_tag+0x890/0x890 [cifs][  114.146800]  ? cifs_mapchar+0x460/0x460 [cifs][  114.147121]  ? rcu_read_lock_sched_held+0x3f/0x70[  114.147412]  ? cifs_strndup_to_utf16+0x15b/0x250 [cifs][  114.147775]  ? dentry_path_raw+0xa6/0xf0[  114.148024]  ? cifs_convert_path_to_utf16+0x198/0x220 [cifs][  114.148413]  ? smb2_check_message+0x1080/0x1080 [cifs][  114.148766]  ? rcu_read_lock_sched_held+0x3f/0x70[  114.149065]  cifs_ioctl+0x1577/0x3320 [cifs][  114.149371]  ? lock_downgrade+0x6f0/0x6f0[  114.149631]  ? cifs_readdir+0x2e60/0x2e60 [cifs][  114.149956]  ? rcu_read_lock_sched_held+0x3f/0x70[  114.150250]  ? __rseq_handle_notify_resume+0x80b/0xbe0[  114.150562]  ? __up_read+0x192/0x710[  114.150791]  ? __ia32_sys_rseq+0xf0/0xf0[  114.151025]  ? __x64_sys_openat+0x11f/0x1d0[  114.151296]  __x64_sys_ioctl+0x127/0x190[  114.151549]  do_syscall_64+0x3b/0x90[  114.151768]  entry_SYSCALL_64_after_hwframe+0x44/0xae[  114.152079] RIP: 0033:0x7f7aead043df[  114.152306] Code: 00 48 89 44 24 18 31 c0 48 8d 44 24 60 c7 04 24---truncated---","details":"In the Linux kernel, the following vulnerability has been resolved:cifs: prevent bad output lengths in smb2_ioctl_query_info()When calling smb2_ioctl_query_info() withsmb_query_info::flags=PASSTHRU_FSCTL andsmb_query_info::output_buffer_length=0, the following would return0x10buffer = memdup_user(arg + sizeof(struct smb_query_info),     qi.output_buffer_length);if (IS_ERR(buffer)) {kfree(vars);return PTR_ERR(buffer);}rather than a valid pointer thus making IS_ERR() check fail.  Thiswould then cause a NULL ptr deference in @buffer when accessing itlater in smb2_ioctl_query_ioctl().  While at it, prevent having a@buffer smaller than 8 bytes to correctly handle SMB2_SET_INFOFileEndOfFileInformation requests whensmb_query_info::flags=PASSTHRU_SET_INFO.Here is a small C reproducer which triggers a NULL ptr in @buffer whenpassing an invalid smb_query_info::flags#include <stdio.h>#include <stdlib.h>#include <stdint.h>#include <unistd.h>#include <fcntl.h>#include <sys/ioctl.h>#define die(s) perror(s), exit(1)#define QUERY_INFO 0xc018cf07int main(int argc, char *argv[]){int fd;if (argc < 2)exit(1);fd = open(argv[1], O_RDONLY);if (fd == -1)die(\"open\");if (ioctl(fd, QUERY_INFO, (uint32_t[]) { 0, 0, 0, 4, 0, 0}) == -1)die(\"ioctl\");close(fd);return 0;}mount.cifs //srv/share /mnt -o ...gcc repro.c && ./a.out /mnt/f0[  114.138620] general protection fault, probably for non-canonical address 0xdffffc0000000000: 0000 [#1] PREEMPT SMP KASAN NOPTI[  114.139310] KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007][  114.139775] CPU: 2 PID: 995 Comm: a.out Not tainted 5.17.0-rc8 #1[  114.140148] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.15.0-0-g2dd4b9b-rebuilt.opensuse.org 04/01/2014[  114.140818] RIP: 0010:smb2_ioctl_query_info+0x206/0x410 [cifs][  114.141221] Code: 00 00 00 00 fc ff df 48 c1 ea 03 80 3c 02 00 0f 85 c8 01 00 00 48 b8 00 00 00 00 00 fc ff df 4c 8b 7b 28 4c 89 fa 48 c1 ea 03 <80> 3c 02 00 0f 85 9c 01 00 00 49 8b 3f e8 58 02 fb ff 48 8b 14 24[  114.142348] RSP: 0018:ffffc90000b47b00 EFLAGS: 00010256[  114.142692] RAX: dffffc0000000000 RBX: ffff888115503200 RCX: ffffffffa020580d[  114.143119] RDX: 0000000000000000 RSI: 0000000000000004 RDI: ffffffffa043a380[  114.143544] RBP: ffff888115503278 R08: 0000000000000001 R09: 0000000000000003[  114.143983] R10: fffffbfff4087470 R11: 0000000000000001 R12: ffff888115503288[  114.144424] R13: 00000000ffffffea R14: ffff888115503228 R15: 0000000000000000[  114.144852] FS:  00007f7aeabdf740(0000) GS:ffff888151600000(0000) knlGS:0000000000000000[  114.145338] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033[  114.145692] CR2: 00007f7aeacfdf5e CR3: 000000012000e000 CR4: 0000000000350ee0[  114.146131] Call Trace:[  114.146291]  <TASK>[  114.146432]  ? smb2_query_reparse_tag+0x890/0x890 [cifs][  114.146800]  ? cifs_mapchar+0x460/0x460 [cifs][  114.147121]  ? rcu_read_lock_sched_held+0x3f/0x70[  114.147412]  ? cifs_strndup_to_utf16+0x15b/0x250 [cifs][  114.147775]  ? dentry_path_raw+0xa6/0xf0[  114.148024]  ? cifs_convert_path_to_utf16+0x198/0x220 [cifs][  114.148413]  ? smb2_check_message+0x1080/0x1080 [cifs][  114.148766]  ? rcu_read_lock_sched_held+0x3f/0x70[  114.149065]  cifs_ioctl+0x1577/0x3320 [cifs][  114.149371]  ? lock_downgrade+0x6f0/0x6f0[  114.149631]  ? cifs_readdir+0x2e60/0x2e60 [cifs][  114.149956]  ? rcu_read_lock_sched_held+0x3f/0x70[  114.150250]  ? __rseq_handle_notify_resume+0x80b/0xbe0[  114.150562]  ? __up_read+0x192/0x710[  114.150791]  ? __ia32_sys_rseq+0xf0/0xf0[  114.151025]  ? __x64_sys_openat+0x11f/0x1d0[  114.151296]  __x64_sys_ioctl+0x127/0x190[  114.151549]  do_syscall_64+0x3b/0x90[  114.151768]  entry_SYSCALL_64_after_hwframe+0x44/0xae[  114.152079] RIP: 0033:0x7f7aead043df[  114.152306] Code: 00 48 89 44 24 18 31 c0 48 8d 44 24 60 c7 04 24---truncated---","references":["https://git.kernel.org/stable/c/7529fbee10d82493c5cb109e51788bf74816d1c0","https://git.kernel.org/stable/c/9963ccea6087268e1275b992dca5d0dd4b938765","https://git.kernel.org/stable/c/b92e358757b91c2827af112cae9af513f26a3f34"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-49366","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix reference count leak in smb_check_perm_dacl()The issue happens in a specific path in smb_check_perm_dacl(). When\"id\" and \"uid\" have the same value, the function simply jumps out ofthe loop without decrementing the reference count of the object\"posix_acls\", which is increased by get_acl() earlier. This mayresult in memory leaks.Fix it by decreasing the reference count of \"posix_acls\" beforejumping to label \"check_access_bits\".","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix reference count leak in smb_check_perm_dacl()The issue happens in a specific path in smb_check_perm_dacl(). When\"id\" and \"uid\" have the same value, the function simply jumps out ofthe loop without decrementing the reference count of the object\"posix_acls\", which is increased by get_acl() earlier. This mayresult in memory leaks.Fix it by decreasing the reference count of \"posix_acls\" beforejumping to label \"check_access_bits\".","references":["https://git.kernel.org/stable/c/248d71b440aef829f5cc5f6545ca113ef5062900","https://git.kernel.org/stable/c/9758a6653c27867d810de02b4e5697163dda9883","https://git.kernel.org/stable/c/cf824b95c12a1abacadbc2d069931963221a3414"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<5.18.4","<5.15.47","<5.17.15",">=5.18",">=5.16",">=5.15"]},
  {"id":"CVE-2022-49900","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:i2c: piix4: Fix adapter not be removed in piix4_remove()In piix4_probe(), the piix4 adapter will be registered in:   piix4_probe()     piix4_add_adapters_sb800() / piix4_add_adapter()       i2c_add_adapter()Based on the probed device type, piix4_add_adapters_sb800() or singlepiix4_add_adapter() will be called.For the former case, piix4_adapter_count is set as the number of adapters,while for antoher case it is not set and kept default *zero*.When piix4 is removed, piix4_remove() removes the adapters added inpiix4_probe(), basing on the piix4_adapter_count value.Because the count is zero for the single adapter case, the adapter won'tbe removed and makes the sources allocated for adapter leaked, such asthe i2c client and device.These sources can still be accessed by i2c or bus and cause problems.An easily reproduced case is that if a new adapter is registered, i2cwill get the leaked adapter and try to call smbus_algorithm, which wasalready freed:Triggered by: rmmod i2c_piix4 && modprobe max31730 BUG: unable to handle page fault for address: ffffffffc053d860 #PF: supervisor read access in kernel mode #PF: error_code(0x0000) - not-present page Oops: 0000 [#1] PREEMPT SMP KASAN CPU: 0 PID: 3752 Comm: modprobe Tainted: G Hardware name: QEMU Standard PC (i440FX + PIIX, 1996) RIP: 0010:i2c_default_probe (drivers/i2c/i2c-core-base.c:2259) i2c_core RSP: 0018:ffff888107477710 EFLAGS: 00000246 ... <TASK>  i2c_detect (drivers/i2c/i2c-core-base.c:2302) i2c_core  __process_new_driver (drivers/i2c/i2c-core-base.c:1336) i2c_core  bus_for_each_dev (drivers/base/bus.c:301)  i2c_for_each_dev (drivers/i2c/i2c-core-base.c:1823) i2c_core  i2c_register_driver (drivers/i2c/i2c-core-base.c:1861) i2c_core  do_one_initcall (init/main.c:1296)  do_init_module (kernel/module/main.c:2455)  ... </TASK> ---[ end trace 0000000000000000 ]---Fix this problem by correctly set piix4_adapter_count as 1 for thesingle adapter so it can be normally removed.","details":"In the Linux kernel, the following vulnerability has been resolved:i2c: piix4: Fix adapter not be removed in piix4_remove()In piix4_probe(), the piix4 adapter will be registered in:   piix4_probe()     piix4_add_adapters_sb800() / piix4_add_adapter()       i2c_add_adapter()Based on the probed device type, piix4_add_adapters_sb800() or singlepiix4_add_adapter() will be called.For the former case, piix4_adapter_count is set as the number of adapters,while for antoher case it is not set and kept default *zero*.When piix4 is removed, piix4_remove() removes the adapters added inpiix4_probe(), basing on the piix4_adapter_count value.Because the count is zero for the single adapter case, the adapter won'tbe removed and makes the sources allocated for adapter leaked, such asthe i2c client and device.These sources can still be accessed by i2c or bus and cause problems.An easily reproduced case is that if a new adapter is registered, i2cwill get the leaked adapter and try to call smbus_algorithm, which wasalready freed:Triggered by: rmmod i2c_piix4 && modprobe max31730 BUG: unable to handle page fault for address: ffffffffc053d860 #PF: supervisor read access in kernel mode #PF: error_code(0x0000) - not-present page Oops: 0000 [#1] PREEMPT SMP KASAN CPU: 0 PID: 3752 Comm: modprobe Tainted: G Hardware name: QEMU Standard PC (i440FX + PIIX, 1996) RIP: 0010:i2c_default_probe (drivers/i2c/i2c-core-base.c:2259) i2c_core RSP: 0018:ffff888107477710 EFLAGS: 00000246 ... <TASK>  i2c_detect (drivers/i2c/i2c-core-base.c:2302) i2c_core  __process_new_driver (drivers/i2c/i2c-core-base.c:1336) i2c_core  bus_for_each_dev (drivers/base/bus.c:301)  i2c_for_each_dev (drivers/i2c/i2c-core-base.c:1823) i2c_core  i2c_register_driver (drivers/i2c/i2c-core-base.c:1861) i2c_core  do_one_initcall (init/main.c:1296)  do_init_module (kernel/module/main.c:2455)  ... </TASK> ---[ end trace 0000000000000000 ]---Fix this problem by correctly set piix4_adapter_count as 1 for thesingle adapter so it can be normally removed.","references":["https://git.kernel.org/stable/c/569bea74c94d37785682b11bab76f557520477cd","https://git.kernel.org/stable/c/bfd5e62f9a7ee214661cb6f143a3b40ccc63317f","https://git.kernel.org/stable/c/d78ccdce662e88f41e87e90cf2bee63c1715d2a5"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-49938","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:cifs: fix small mempool leak in SMB2_negotiate()In some cases of failure (dialect mismatches) in SMB2_negotiate(), afterthe request is sent, the checks would return -EIO when they should berather setting rc = -EIO and jumping to neg_exit to free the responsebuffer from mempool.","details":"In the Linux kernel, the following vulnerability has been resolved:cifs: fix small mempool leak in SMB2_negotiate()In some cases of failure (dialect mismatches) in SMB2_negotiate(), afterthe request is sent, the checks would return -EIO when they should berather setting rc = -EIO and jumping to neg_exit to free the responsebuffer from mempool.","references":["https://git.kernel.org/stable/c/27893dfc1285f80f80f46b3b8c95f5d15d2e66d0","https://git.kernel.org/stable/c/38a6b469bf22f153282fbe7d702a24e9eb43f50e","https://git.kernel.org/stable/c/9e3c9efa7caf16e5acc05eab5e4d0a714e1610b0"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2022-50076","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:cifs: Fix memory leak on the deferred closexfstests on smb21 report kmemleak as below:  unreferenced object 0xffff8881767d6200 (size 64):    comm \"xfs_io\", pid 1284, jiffies 4294777434 (age 20.789s)    hex dump (first 32 bytes):      80 5a d0 11 81 88 ff ff 78 8a aa 63 81 88 ff ff  .Z......x..c....      00 71 99 76 81 88 ff ff 00 00 00 00 00 00 00 00  .q.v............    backtrace:      [<00000000ad04e6ea>] cifs_close+0x92/0x2c0      [<0000000028b93c82>] __fput+0xff/0x3f0      [<00000000d8116851>] task_work_run+0x85/0xc0      [<0000000027e14f9e>] do_exit+0x5e5/0x1240      [<00000000fb492b95>] do_group_exit+0x58/0xe0      [<00000000129a32d9>] __x64_sys_exit_group+0x28/0x30      [<00000000e3f7d8e9>] do_syscall_64+0x35/0x80      [<00000000102e8a0b>] entry_SYSCALL_64_after_hwframe+0x46/0xb0When cancel the deferred close work, we should also cleanup the structcifs_deferred_close.","details":"In the Linux kernel, the following vulnerability has been resolved:cifs: Fix memory leak on the deferred closexfstests on smb21 report kmemleak as below:  unreferenced object 0xffff8881767d6200 (size 64):    comm \"xfs_io\", pid 1284, jiffies 4294777434 (age 20.789s)    hex dump (first 32 bytes):      80 5a d0 11 81 88 ff ff 78 8a aa 63 81 88 ff ff  .Z......x..c....      00 71 99 76 81 88 ff ff 00 00 00 00 00 00 00 00  .q.v............    backtrace:      [<00000000ad04e6ea>] cifs_close+0x92/0x2c0      [<0000000028b93c82>] __fput+0xff/0x3f0      [<00000000d8116851>] task_work_run+0x85/0xc0      [<0000000027e14f9e>] do_exit+0x5e5/0x1240      [<00000000fb492b95>] do_group_exit+0x58/0xe0      [<00000000129a32d9>] __x64_sys_exit_group+0x28/0x30      [<00000000e3f7d8e9>] do_syscall_64+0x35/0x80      [<00000000102e8a0b>] entry_SYSCALL_64_after_hwframe+0x46/0xb0When cancel the deferred close work, we should also cleanup the structcifs_deferred_close.","references":["https://git.kernel.org/stable/c/60b6d38add7b9c17d6e5d49ee8e930ea1a5650c5","https://git.kernel.org/stable/c/860efae127888ae535bc4eda1b7f27642727c69e","https://git.kernel.org/stable/c/ca08d0eac020d48a3141dbec0a3cf64fbdb17cde"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-1192","product":"smb","summary":"A use-after-free flaw was found in smb2_is_status_io_timeout() in CIFS in the Linux Kernel. After CIFS transfers response data to a system call, there are still local variable points to the memory region, and if the system call frees it faster than CIFS uses it, CIFS will access a free memory region, leading to a denial of service.","details":"A use-after-free flaw was found in smb2_is_status_io_timeout() in CIFS in the Linux Kernel. After CIFS transfers response data to a system call, there are still local variable points to the memory region, and if the system call frees it faster than CIFS uses it, CIFS will access a free memory region, leading to a denial of service.","references":["https://access.redhat.com/security/cve/CVE-2023-1192","https://bugzilla.redhat.com/show_bug.cgi?id=2154178","https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d527f51331cace562393a8038d870b3e9916686f"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<6.4"},
  {"id":"CVE-2023-1801","product":"smb","summary":"The SMB protocol decoder in tcpdump version 4.99.3 can perform an out-of-bounds write when decoding a crafted network packet.","details":"The SMB protocol decoder in tcpdump version 4.99.3 can perform an out-of-bounds write when decoding a crafted network packet.","references":["https://github.com/the-tcpdump-group/tcpdump/commit/03c037bbd75588beba3ee09f26d17783d21e30bc","https://github.com/the-tcpdump-group/tcpdump/commit/7578e1c04ee280dda50c4c2813e7d55f539c6501","https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KOA2BJFERAC3VRQIRHJOWN4HZY4ZA7CH/"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-20270","product":"smb","summary":"A vulnerability in the interaction between the Server Message Block (SMB) protocol preprocessor and the Snort 3 detection engine for Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to bypass the configured policies or cause a denial of service (DoS) condition on an affected device. This vulnerability is due to improper error-checking when the Snort 3 detection engine is processing SMB traffic. An attacker could exploit this vulnerability by sending a crafted SMB packet stream through an affected device. A successful exploit could allow the attacker to cause the Snort process to reload, resulting in a DoS condition.","details":"A vulnerability in the interaction between the Server Message Block (SMB) protocol preprocessor and the Snort 3 detection engine for Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to bypass the configured policies or cause a denial of service (DoS) condition on an affected device. This vulnerability is due to improper error-checking when the Snort 3 detection engine is processing SMB traffic. An attacker could exploit this vulnerability by sending a crafted SMB packet stream through an affected device. A successful exploit could allow the attacker to cause the Snort process to reload, resulting in a DoS condition.","references":["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-smbsnort3-dos-pfOjOYUV","https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-smbsnort3-dos-pfOjOYUV"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-20885","product":"smb","summary":"Vulnerability in Cloud Foundry Notifications, Cloud Foundry SMB-volume release, Cloud FOundry cf-nfs-volume release.This issue affects Notifications: All versions prior to 63; SMB-volume release: All versions prior to 3.1.19; cf-nfs-volume release: 5.0.X versions prior to 5.0.27, 7.1.X versions prior to 7.1.19.","details":"Vulnerability in Cloud Foundry Notifications, Cloud Foundry SMB-volume release, Cloud FOundry cf-nfs-volume release.This issue affects Notifications: All versions prior to 63; SMB-volume release: All versions prior to 3.1.19; cf-nfs-volume release: 5.0.X versions prior to 5.0.27, 7.1.X versions prior to 7.1.19.","references":["https://www.cloudfoundry.org/blog/cve-2023-20885-cf-workflows-leak-credentials-in-system-audit-logs/","https://www.cloudfoundry.org/blog/cve-2023-20885-cf-workflows-leak-credentials-in-system-audit-logs/"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<3.1.19"],["<7.1.19",">=7.1.0"],["<5.0.27",">=5.0.0"],["<63"]]},
  {"id":"CVE-2023-21549","product":"smb","summary":"Windows SMB Witness Service Elevation of Privilege Vulnerability","details":"Windows SMB Witness Service Elevation of Privilege Vulnerability","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-21549","https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-21549"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-22855","product":"smb","summary":"Kardex Mlog MCC 5.7.12+0-a203c2a213-master allows remote code execution. It spawns a web interface listening on port 8088. A user-controllable path is handed to a path-concatenation method (Path.Combine from .NET) without proper sanitisation. This yields the possibility of including local files, as well as remote files on SMB shares. If one provides a file with the extension .t4, it is rendered with the .NET templating engine mono/t4, which can execute code.","details":"Kardex Mlog MCC 5.7.12+0-a203c2a213-master allows remote code execution. It spawns a web interface listening on port 8088. A user-controllable path is handed to a path-concatenation method (Path.Combine from .NET) without proper sanitisation. This yields the possibility of including local files, as well as remote files on SMB shares. If one provides a file with the extension .t4, it is rendered with the .NET templating engine mono/t4, which can execute code.","references":["http://packetstormsecurity.com/files/171046/Kardex-Mlog-MCC-5.7.12-0-a203c2a213-master-File-Inclusion-Remote-Code-Execution.html","http://packetstormsecurity.com/files/171689/Kardex-Mlog-MCC-5.7.12-Remote-Code-Execution.html","http://seclists.org/fulldisclosure/2023/Feb/10"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-24898","product":"smb","summary":"Windows SMB Denial of Service Vulnerability","details":"Windows SMB Denial of Service Vulnerability","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-24898","https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-24898"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<10.0.20348.1724"},
  {"id":"CVE-2023-25942","product":"smb","summary":"Dell PowerScale OneFS versions 8.2.x-9.4.x contain an uncontrolled resource consumption vulnerability. A malicious network user with low privileges could potentially exploit this vulnerability in SMB, leading to a potential denial of service.","details":"Dell PowerScale OneFS versions 8.2.x-9.4.x contain an uncontrolled resource consumption vulnerability. A malicious network user with low privileges could potentially exploit this vulnerability in SMB, leading to a potential denial of service.","references":["https://www.dell.com/support/kbdoc/en-us/000211539/dell-emc-powerscale-onefs-security","https://www.dell.com/support/kbdoc/en-us/000211539/dell-emc-powerscale-onefs-security"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<=9.1.0.28","<9.2.1.22","<9.4.0.13",">=9.4.0.0",">=9.1.0.0",">=9.2.1.0"]},
  {"id":"CVE-2023-27352","product":"smb","summary":"This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of Sonos One Speaker 70.3-35220. Authentication is not required to exploit this vulnerability. The specific flaw exists within the processing of the SMB directory query command. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-19845.","details":"This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of Sonos One Speaker 70.3-35220. Authentication is not required to exploit this vulnerability. The specific flaw exists within the processing of the SMB directory query command. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-19845.","references":["https://www.zerodayinitiative.com/advisories/ZDI-23-447/","https://www.zerodayinitiative.com/advisories/ZDI-23-447/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<11.7.1"],["<15.1"]]},
  {"id":"CVE-2023-27354","product":"smb","summary":"This vulnerability allows network-adjacent attackers to disclose sensitive information on affected installations of Sonos One Speaker 70.3-35220. Authentication is not required to exploit this vulnerability. The specific flaw exists within the processing of the SMB directory query command. The issue results from the lack of proper validation of user-supplied data, which can result in an integer overflow before reading from memory. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of root. Was ZDI-CAN-19727.","details":"This vulnerability allows network-adjacent attackers to disclose sensitive information on affected installations of Sonos One Speaker 70.3-35220. Authentication is not required to exploit this vulnerability. The specific flaw exists within the processing of the SMB directory query command. The issue results from the lack of proper validation of user-supplied data, which can result in an integer overflow before reading from memory. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of root. Was ZDI-CAN-19727.","references":["https://www.zerodayinitiative.com/advisories/ZDI-23-446/","https://www.zerodayinitiative.com/advisories/ZDI-23-446/"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<11.7.1"],["<15.1"]]},
  {"id":"CVE-2023-27863","product":"smb","summary":"IBM Spectrum Protect Plus Server 10.1.13, under specific configurations, could allow an elevated user to obtain SMB credentials that may be used to access vSnap data stores.  IBM X-Force ID:  249325.","details":"IBM Spectrum Protect Plus Server 10.1.13, under specific configurations, could allow an elevated user to obtain SMB credentials that may be used to access vSnap data stores.  IBM X-Force ID:  249325.","references":["https://exchange.xforce.ibmcloud.com/vulnerabilities/249325","https://www.ibm.com/support/pages/node/6965812","https://exchange.xforce.ibmcloud.com/vulnerabilities/249325"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-28597","product":"smb","summary":"Zoom clients prior to 5.13.5 contain an improper trust boundary implementation vulnerability. If a victim saves a local recording to an SMB location and later opens it using a link from Zoom's web portal, an attacker positioned on an adjacent network to the victim client could set up a malicious SMB server to respond to client requests, causing the client to execute attacker controlled executables. This could result in an attacker gaining access to a user's device and data, and remote code execution.","details":"Zoom clients prior to 5.13.5 contain an improper trust boundary implementation vulnerability. If a victim saves a local recording to an SMB location and later opens it using a link from Zoom's web portal, an attacker positioned on an adjacent network to the victim client could set up a malicious SMB server to respond to client requests, causing the client to execute attacker controlled executables. This could result in an attacker gaining access to a user's device and data, and remote code execution.","references":["https://explore.zoom.us/en/trust/security/security-bulletin/","https://explore.zoom.us/en/trust/security/security-bulletin/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<5.13.10","<5.13.5"]},
  {"id":"CVE-2023-29532","product":"smb","summary":"A local attacker can trick the Mozilla Maintenance Service into applying an unsigned update file by pointing the service at an update file on a malicious SMB server. The update file can be replaced after the signature check, before the use, because the write-lock requested by the service does not work on a SMB server.*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.* This vulnerability affects Firefox < 112, Firefox ESR < 102.10, and Thunderbird < 102.10.","details":"A local attacker can trick the Mozilla Maintenance Service into applying an unsigned update file by pointing the service at an update file on a malicious SMB server. The update file can be replaced after the signature check, before the use, because the write-lock requested by the service does not work on a SMB server.*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.* This vulnerability affects Firefox < 112, Firefox ESR < 102.10, and Thunderbird < 102.10.","references":["https://bugzilla.mozilla.org/show_bug.cgi?id=1806394","https://www.mozilla.org/security/advisories/mfsa2023-13/","https://www.mozilla.org/security/advisories/mfsa2023-14/"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<112.0"],["<102.10"]]},
  {"id":"CVE-2023-31403","product":"smb","summary":"SAP Business One installation - version 10.0, does not perform proper authentication and authorization checks for SMB shared folder. As a result, any malicious user can read and write to the SMB shared folder. Additionally, the files in the folder can be executed or be used by the installation process leading to considerable impact on confidentiality, integrity and availability.","details":"SAP Business One installation - version 10.0, does not perform proper authentication and authorization checks for SMB shared folder. As a result, any malicious user can read and write to the SMB shared folder. Additionally, the files in the folder can be executed or be used by the installation process leading to considerable impact on confidentiality, integrity and availability.","references":["https://me.sap.com/notes/3355658","https://www.sap.com/documents/2022/02/fa865ea4-167e-0010-bca6-c68f7e60039b.html","https://me.sap.com/notes/3355658"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-32021","product":"smb","summary":"Windows SMB Witness Service Security Feature Bypass Vulnerability","details":"Windows SMB Witness Service Security Feature Bypass Vulnerability","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-32021","https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-32021"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-32247","product":"smb","summary":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the handling of SMB2_SESSION_SETUP commands. The issue results from the lack of control of resource consumption. An attacker can leverage this vulnerability to create a denial-of-service condition on the system.","details":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the handling of SMB2_SESSION_SETUP commands. The issue results from the lack of control of resource consumption. An attacker can leverage this vulnerability to create a denial-of-service condition on the system.","references":["https://access.redhat.com/security/cve/CVE-2023-32247","https://bugzilla.redhat.com/show_bug.cgi?id=2219803","https://security.netapp.com/advisory/ntap-20230915-0011/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<6.3.2",">=6.3","<6.2.16","<6.1.29",">=6.2"],[">=5.16",">=5.15","<5.15.145"]]},
  {"id":"CVE-2023-32248","product":"smb","summary":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the handling of SMB2_TREE_CONNECT and SMB2_QUERY_INFO commands. The issue results from the lack of proper validation of a pointer prior to accessing it. An attacker can leverage this vulnerability to create a denial-of-service condition on the system.","details":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the handling of SMB2_TREE_CONNECT and SMB2_QUERY_INFO commands. The issue results from the lack of proper validation of a pointer prior to accessing it. An attacker can leverage this vulnerability to create a denial-of-service condition on the system.","references":["https://access.redhat.com/security/cve/CVE-2023-32248","https://bugzilla.redhat.com/show_bug.cgi?id=2219818","https://security.netapp.com/advisory/ntap-20230915-0006/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<6.3.2",">=6.3","<6.2.15",">=6.2","<6.1.28"],[">=5.16",">=5.15","<5.15.111"]]},
  {"id":"CVE-2023-32250","product":"smb","summary":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the processing of SMB2_SESSION_SETUP commands. The issue results from the lack of proper locking when performing operations on an object. An attacker can leverage this vulnerability to execute code in the context of the kernel.","details":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the processing of SMB2_SESSION_SETUP commands. The issue results from the lack of proper locking when performing operations on an object. An attacker can leverage this vulnerability to execute code in the context of the kernel.","references":["https://access.redhat.com/security/cve/CVE-2023-32250","https://bugzilla.redhat.com/show_bug.cgi?id=2208849","https://security.netapp.com/advisory/ntap-20230824-0004/"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[["<6.3.2",">=6.3","<6.2.16","<6.1.29",">=6.2"],[">=5.16",">=5.15","<5.15.145"]]},
  {"id":"CVE-2023-32252","product":"smb","summary":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the handling of SMB2_LOGOFF commands. The issue results from the lack of proper validation of a pointer prior to accessing it. An attacker can leverage this vulnerability to create a denial-of-service condition on the system.","details":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the handling of SMB2_LOGOFF commands. The issue results from the lack of proper validation of a pointer prior to accessing it. An attacker can leverage this vulnerability to create a denial-of-service condition on the system.","references":["https://access.redhat.com/security/cve/CVE-2023-32252","https://bugzilla.redhat.com/show_bug.cgi?id=2219815","https://security.netapp.com/advisory/ntap-20231124-0001/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<6.3.2",">=6.3","<6.2.16","<6.1.29",">=6.2"],[">=5.16",">=5.15","<5.15.145"]]},
  {"id":"CVE-2023-32254","product":"smb","summary":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the processing of SMB2_TREE_DISCONNECT commands. The issue results from the lack of proper locking when performing operations on an object. An attacker can leverage this vulnerability to execute code in the context of the kernel.","details":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the processing of SMB2_TREE_DISCONNECT commands. The issue results from the lack of proper locking when performing operations on an object. An attacker can leverage this vulnerability to execute code in the context of the kernel.","references":["https://access.redhat.com/security/cve/CVE-2023-32254","https://bugzilla.redhat.com/show_bug.cgi?id=2191658","https://security.netapp.com/advisory/ntap-20230824-0004/"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[["<6.3.2",">=6.3","<6.2.15",">=6.2","<6.1.28"],[">=5.16",">=5.15","<5.15.145"]]},
  {"id":"CVE-2023-32257","product":"smb","summary":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the processing of SMB2_SESSION_SETUP and SMB2_LOGOFF commands. The issue results from the lack of proper locking when performing operations on an object. An attacker can leverage this vulnerability to execute code in the context of the kernel.","details":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the processing of SMB2_SESSION_SETUP and SMB2_LOGOFF commands. The issue results from the lack of proper locking when performing operations on an object. An attacker can leverage this vulnerability to execute code in the context of the kernel.","references":["https://access.redhat.com/security/cve/CVE-2023-32257","https://bugzilla.redhat.com/show_bug.cgi?id=2219806","https://security.netapp.com/advisory/ntap-20230915-0011/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<6.3.2",">=6.3","<6.2.16","<6.1.29",">=6.2"],[">=5.16",">=5.15","<5.15.145"]]},
  {"id":"CVE-2023-32258","product":"smb","summary":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the processing of SMB2_LOGOFF and SMB2_CLOSE commands. The issue results from the lack of proper locking when performing operations on an object. An attacker can leverage this vulnerability to execute code in the context of the kernel.","details":"A flaw was found in the Linux kernel's ksmbd, a high-performance in-kernel SMB server. The specific flaw exists within the processing of SMB2_LOGOFF and SMB2_CLOSE commands. The issue results from the lack of proper locking when performing operations on an object. An attacker can leverage this vulnerability to execute code in the context of the kernel.","references":["https://access.redhat.com/security/cve/CVE-2023-32258","https://bugzilla.redhat.com/show_bug.cgi?id=2219809","https://security.netapp.com/advisory/ntap-20230915-0011/"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<6.3.2",">=6.3","<6.2.16","<6.1.29",">=6.2"],[">=5.16",">=5.15","<5.15.145"]]},
  {"id":"CVE-2023-3347","product":"smb","summary":"A vulnerability was found in Samba's SMB2 packet signing mechanism. The SMB2 packet signing is not enforced if an admin configured \"server signing = required\" or for SMB2 connections to Domain Controllers where SMB2 packet signing is mandatory. This flaw allows an attacker to perform attacks, such as a man-in-the-middle attack, by intercepting the network traffic and modifying the SMB2 messages between client and server, affecting the integrity of the data.","details":"A vulnerability was found in Samba's SMB2 packet signing mechanism. The SMB2 packet signing is not enforced if an admin configured \"server signing = required\" or for SMB2 connections to Domain Controllers where SMB2 packet signing is mandatory. This flaw allows an attacker to perform attacks, such as a man-in-the-middle attack, by intercepting the network traffic and modifying the SMB2 messages between client and server, affecting the integrity of the data.","references":["https://access.redhat.com/errata/RHSA-2023:4325","https://access.redhat.com/errata/RHSA-2023:4328","https://access.redhat.com/security/cve/CVE-2023-3347"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<4.18.5",">=4.18.0","<4.17.10",">=4.17.0"]},
  {"id":"CVE-2023-37469","product":"smb","summary":"CasaOS is an open-source personal cloud system. Prior to version 0.4.4, if an authenticated user using CasaOS is able to successfully connect to a controlled SMB server, they are able to execute arbitrary commands. Version 0.4.4 contains a patch for the issue.","details":"CasaOS is an open-source personal cloud system. Prior to version 0.4.4, if an authenticated user using CasaOS is able to successfully connect to a controlled SMB server, they are able to execute arbitrary commands. Version 0.4.4 contains a patch for the issue.","references":["https://github.com/IceWhaleTech/CasaOS/blob/96e92842357230098c771bc41fd3baf46189b859/route/v1/samba.go#L121","https://github.com/IceWhaleTech/CasaOS/blob/96e92842357230098c771bc41fd3baf46189b859/service/connections.go#L58","https://github.com/IceWhaleTech/CasaOS/commit/af440eac5563644854ff33f72041e52d3fd1f47c"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<0.4.4"},
  {"id":"CVE-2023-38426","product":"smb","summary":"An issue was discovered in the Linux kernel before 6.3.4. ksmbd has an out-of-bounds read in smb2_find_context_vals when create_context's name_len is larger than the tag length.","details":"An issue was discovered in the Linux kernel before 6.3.4. ksmbd has an out-of-bounds read in smb2_find_context_vals when create_context's name_len is larger than the tag length.","references":["https://cdn.kernel.org/pub/linux/kernel/v6.x/ChangeLog-6.3.4","https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/fs/ksmbd?id=02f76c401d17e409ed45bf7887148fcc22c93c85","https://security.netapp.com/advisory/ntap-20230915-0010/"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[[">=6.2","<6.3.4","<6.1.30"],[">=5.16",">=5.15","<5.15.113"]]},
  {"id":"CVE-2023-38430","product":"smb","summary":"An issue was discovered in the Linux kernel before 6.3.9. ksmbd does not validate the SMB request protocol ID, leading to an out-of-bounds read.","details":"An issue was discovered in the Linux kernel before 6.3.9. ksmbd does not validate the SMB request protocol ID, leading to an out-of-bounds read.","references":["https://cdn.kernel.org/pub/linux/kernel/v6.x/ChangeLog-6.3.9","https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/fs/smb/server?id=1c1bcf2d3ea061613119b534f57507c377df20f9","https://security.netapp.com/advisory/ntap-20230831-0003/"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[[">=6.2","<6.1.35","<6.3.9"],[">=5.16",">=5.15","<5.15.145"]]},
  {"id":"CVE-2023-38431","product":"smb","summary":"An issue was discovered in the Linux kernel before 6.3.8. fs/smb/server/connection.c in ksmbd does not validate the relationship between the NetBIOS header's length field and the SMB header sizes, via pdu_size in ksmbd_conn_handler_loop, leading to an out-of-bounds read.","details":"An issue was discovered in the Linux kernel before 6.3.8. fs/smb/server/connection.c in ksmbd does not validate the relationship between the NetBIOS header's length field and the SMB header sizes, via pdu_size in ksmbd_conn_handler_loop, leading to an out-of-bounds read.","references":["https://cdn.kernel.org/pub/linux/kernel/v6.x/ChangeLog-6.3.8","https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/fs/smb/server?id=368ba06881c395f1c9a7ba22203cf8d78b4addc0","https://security.netapp.com/advisory/ntap-20230824-0011/"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[[">=6.2","<6.3.8","<6.1.34"],[">=5.16",">=5.15","<5.15.145"]]},
  {"id":"CVE-2023-39176","product":"smb","summary":"A flaw was found within the parsing of SMB2 requests that have a transform header in the kernel ksmbd module. The issue results from the lack of proper validation of user-supplied data, which can result in a read past the end of an allocated buffer. An attacker can leverage this to disclose sensitive information on affected installations of Linux. Only systems with ksmbd enabled are vulnerable to this CVE.","details":"A flaw was found within the parsing of SMB2 requests that have a transform header in the kernel ksmbd module. The issue results from the lack of proper validation of user-supplied data, which can result in a read past the end of an allocated buffer. An attacker can leverage this to disclose sensitive information on affected installations of Linux. Only systems with ksmbd enabled are vulnerable to this CVE.","references":["https://access.redhat.com/security/cve/CVE-2023-39176","https://bugzilla.redhat.com/show_bug.cgi?id=2326503","https://www.zerodayinitiative.com/advisories/ZDI-24-586/"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-39179","product":"smb","summary":"A flaw was found within the handling of SMB2 read requests in the kernel ksmbd module. The issue results from the lack of proper validation of user-supplied data, which can result in a read past the end of an allocated buffer. An attacker can leverage this to disclose sensitive information on affected installations of Linux. Only systems with ksmbd enabled are vulnerable to this CVE.","details":"A flaw was found within the handling of SMB2 read requests in the kernel ksmbd module. The issue results from the lack of proper validation of user-supplied data, which can result in a read past the end of an allocated buffer. An attacker can leverage this to disclose sensitive information on affected installations of Linux. Only systems with ksmbd enabled are vulnerable to this CVE.","references":["https://access.redhat.com/security/cve/CVE-2023-39179","https://bugzilla.redhat.com/show_bug.cgi?id=2326529","https://www.zerodayinitiative.com/advisories/ZDI-24-586/"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-39180","product":"smb","summary":"A flaw was found within the handling of SMB2_READ commands in the kernel ksmbd module. The issue results from not releasing memory after its effective lifetime. An attacker can leverage this to create a denial-of-service condition on affected installations of Linux. Authentication is not required to exploit this vulnerability, but only systems with ksmbd enabled are vulnerable.","details":"A flaw was found within the handling of SMB2_READ commands in the kernel ksmbd module. The issue results from not releasing memory after its effective lifetime. An attacker can leverage this to create a denial-of-service condition on affected installations of Linux. Authentication is not required to exploit this vulnerability, but only systems with ksmbd enabled are vulnerable.","references":["https://access.redhat.com/security/cve/CVE-2023-39180","https://bugzilla.redhat.com/show_bug.cgi?id=2326531","https://www.zerodayinitiative.com/advisories/ZDI-24-589/"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-39292","product":"smb","summary":"A SQL Injection vulnerability has been identified in the MiVoice Office 400 SMB Controller through 1.2.5.23 which could allow a malicious actor to access sensitive information and execute arbitrary database and management operations.","details":"A SQL Injection vulnerability has been identified in the MiVoice Office 400 SMB Controller through 1.2.5.23 which could allow a malicious actor to access sensitive information and execute arbitrary database and management operations.","references":["https://www.mitel.com/support/security-advisories/mitel-product-security-advisory-23-0008","https://www.mitel.com/support/security-advisories/mitel-product-security-advisory-23-0008"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[["<=1.2.5.23"],["<=7.0.9281"]]},
  {"id":"CVE-2023-39293","product":"smb","summary":"A Command Injection vulnerability has been identified in the MiVoice Office 400 SMB Controller through 1.2.5.23 which could allow a malicious actor to execute arbitrary commands within the context of the system.","details":"A Command Injection vulnerability has been identified in the MiVoice Office 400 SMB Controller through 1.2.5.23 which could allow a malicious actor to execute arbitrary commands within the context of the system.","references":["https://www.mitel.com/support/security-advisories/mitel-product-security-advisory-23-0009","https://www.mitel.com/support/security-advisories/mitel-product-security-advisory-23-0009"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[["<=1.2.5.23"],["<=7.0.9281"]]},
  {"id":"CVE-2023-3961","product":"smb","summary":"A path traversal vulnerability was identified in Samba when processing client pipe names connecting to Unix domain sockets within a private directory. Samba typically uses this mechanism to connect SMB clients to remote procedure call (RPC) services like SAMR LSA or SPOOLSS, which Samba initiates on demand. However, due to inadequate sanitization of incoming client pipe names, allowing a client to send a pipe name containing Unix directory traversal characters (../). This could result in SMB clients connecting as root to Unix domain sockets outside the private directory. If an attacker or client managed to send a pipe name resolving to an external service using an existing Unix domain socket, it could potentially lead to unauthorized access to the service and consequential adverse events, including compromise or service crashes.","details":"A path traversal vulnerability was identified in Samba when processing client pipe names connecting to Unix domain sockets within a private directory. Samba typically uses this mechanism to connect SMB clients to remote procedure call (RPC) services like SAMR LSA or SPOOLSS, which Samba initiates on demand. However, due to inadequate sanitization of incoming client pipe names, allowing a client to send a pipe name containing Unix directory traversal characters (../). This could result in SMB clients connecting as root to Unix domain sockets outside the private directory. If an attacker or client managed to send a pipe name resolving to an external service using an existing Unix domain socket, it could potentially lead to unauthorized access to the service and consequential adverse events, including compromise or service crashes.","references":["https://access.redhat.com/errata/RHSA-2023:6209","https://access.redhat.com/errata/RHSA-2023:6744","https://access.redhat.com/errata/RHSA-2023:7371"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[">=4.19.0","<4.18.8","<4.17.12",">=4.18.0","<4.19.1"]},
  {"id":"CVE-2023-4091","product":"smb","summary":"A vulnerability was discovered in Samba, where the flaw allows SMB clients to truncate files, even with read-only permissions when the Samba VFS module \"acl_xattr\" is configured with \"acl_xattr:ignore system acls = yes\". The SMB protocol allows opening files when the client requests read-only access but then implicitly truncates the opened file to 0 bytes if the client specifies a separate OVERWRITE create disposition request. The issue arises in configurations that bypass kernel file system permissions checks, relying solely on Samba's permissions.","details":"A vulnerability was discovered in Samba, where the flaw allows SMB clients to truncate files, even with read-only permissions when the Samba VFS module \"acl_xattr\" is configured with \"acl_xattr:ignore system acls = yes\". The SMB protocol allows opening files when the client requests read-only access but then implicitly truncates the opened file to 0 bytes if the client specifies a separate OVERWRITE create disposition request. The issue arises in configurations that bypass kernel file system permissions checks, relying solely on Samba's permissions.","references":["https://access.redhat.com/errata/RHSA-2023:6209","https://access.redhat.com/errata/RHSA-2023:6744","https://access.redhat.com/errata/RHSA-2023:7371"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[">=4.19.0","<4.18.8","<4.17.12",">=4.18.0","<4.19.1"]},
  {"id":"CVE-2023-43505","product":"smb","summary":"A vulnerability has been identified in COMOS (All versions). The affected application lacks proper access controls in SMB shares. This could allow an attacker to access files that the user should not have access to.","details":"A vulnerability has been identified in COMOS (All versions). The affected application lacks proper access controls in SMB shares. This could allow an attacker to access files that the user should not have access to.","references":["https://cert-portal.siemens.com/productcert/pdf/ssa-137900.pdf","https://cert-portal.siemens.com/productcert/pdf/ssa-137900.pdf"],"severity":"CRITICAL","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-45165","product":"smb","summary":"IBM AIX 7.2 and 7.3 could allow a non-privileged local user to exploit a vulnerability in the AIX SMB client to cause a denial of service.  IBM X-Force ID:  267963.","details":"IBM AIX 7.2 and 7.3 could allow a non-privileged local user to exploit a vulnerability in the AIX SMB client to cause a denial of service.  IBM X-Force ID:  267963.","references":["https://exchange.xforce.ibmcloud.com/vulnerabilities/267963","https://www.ibm.com/support/pages/node/7100970","https://exchange.xforce.ibmcloud.com/vulnerabilities/267963"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-47574","product":"smb","summary":"An issue was discovered on Relyum RELY-PCIe 22.2.1 and RELY-REC 23.1.0 devices. There is a Weak SMB configuration with signing disabled.","details":"An issue was discovered on Relyum RELY-PCIe 22.2.1 and RELY-REC 23.1.0 devices. There is a Weak SMB configuration with signing disabled.","references":["https://www.relyum.com/web/support/vulnerability-report/","https://www.relyum.com/web/support/vulnerability-report/"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-51062","product":"smb","summary":"An unauthenticated log file read in the component log-smblog-save of QStar Archive Solutions RELEASE_3-0 Build 7 Patch 0 allows attackers to disclose the SMB Log contents via executing a crafted command.","details":"An unauthenticated log file read in the component log-smblog-save of QStar Archive Solutions RELEASE_3-0 Build 7 Patch 0 allows attackers to disclose the SMB Log contents via executing a crafted command.","references":["https://github.com/Oracle-Security/CVEs/blob/main/QStar%20Archive%20Solutions/CVE-2023-51062.md","https://github.com/Oracle-Security/CVEs/blob/main/QStar%20Archive%20Solutions/CVE-2023-51062.md"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-51070","product":"smb","summary":"An access control issue in QStar Archive Solutions Release RELEASE_3-0 Build 7 Patch 0 allows unauthenticated attackers to arbitrarily adjust sensitive SMB settings on the QStar Server.","details":"An access control issue in QStar Archive Solutions Release RELEASE_3-0 Build 7 Patch 0 allows unauthenticated attackers to arbitrarily adjust sensitive SMB settings on the QStar Server.","references":["https://github.com/Oracle-Security/CVEs/blob/main/QStar%20Archive%20Solutions/CVE-2023-51070.md","https://github.com/Oracle-Security/CVEs/blob/main/QStar%20Archive%20Solutions/CVE-2023-51070.md"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-51071","product":"smb","summary":"An access control issue in QStar Archive Solutions Release RELEASE_3-0 Build 7 Patch 0 allows unauthenticated attackers to arbitrarily disable the SMB service on a victim's Qstar instance by executing a specific command in a link.","details":"An access control issue in QStar Archive Solutions Release RELEASE_3-0 Build 7 Patch 0 allows unauthenticated attackers to arbitrarily disable the SMB service on a victim's Qstar instance by executing a specific command in a link.","references":["https://github.com/Oracle-Security/CVEs/blob/main/QStar%20Archive%20Solutions/CVE-2023-51071.md","https://github.com/Oracle-Security/CVEs/blob/main/QStar%20Archive%20Solutions/CVE-2023-51071.md"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-52434","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential OOBs in smb2_parse_contexts()Validate offsets and lengths before dereferencing create contexts insmb2_parse_contexts().This fixes following oops when accessing invalid create contexts fromserver:  BUG: unable to handle page fault for address: ffff8881178d8cc3  #PF: supervisor read access in kernel mode  #PF: error_code(0x0000) - not-present page  PGD 4a01067 P4D 4a01067 PUD 0  Oops: 0000 [#1] PREEMPT SMP NOPTI  CPU: 3 PID: 1736 Comm: mount.cifs Not tainted 6.7.0-rc4 #1  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS  rel-1.16.2-3-gd478f380-rebuilt.opensuse.org 04/01/2014  RIP: 0010:smb2_parse_contexts+0xa0/0x3a0 [cifs]  Code: f8 10 75 13 48 b8 93 ad 25 50 9c b4 11 e7 49 39 06 0f 84 d2 00  00 00 8b 45 00 85 c0 74 61 41 29 c5 48 01 c5 41 83 fd 0f 76 55 <0f> b7  7d 04 0f b7 45 06 4c 8d 74 3d 00 66 83 f8 04 75 bc ba 04 00  RSP: 0018:ffffc900007939e0 EFLAGS: 00010216  RAX: ffffc90000793c78 RBX: ffff8880180cc000 RCX: ffffc90000793c90  RDX: ffffc90000793cc0 RSI: ffff8880178d8cc0 RDI: ffff8880180cc000  RBP: ffff8881178d8cbf R08: ffffc90000793c22 R09: 0000000000000000  R10: ffff8880180cc000 R11: 0000000000000024 R12: 0000000000000000  R13: 0000000000000020 R14: 0000000000000000 R15: ffffc90000793c22  FS: 00007f873753cbc0(0000) GS:ffff88806bc00000(0000)  knlGS:0000000000000000  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033  CR2: ffff8881178d8cc3 CR3: 00000000181ca000 CR4: 0000000000750ef0  PKRU: 55555554  Call Trace:   <TASK>   ? __die+0x23/0x70   ? page_fault_oops+0x181/0x480   ? search_module_extables+0x19/0x60   ? srso_alias_return_thunk+0x5/0xfbef5   ? exc_page_fault+0x1b6/0x1c0   ? asm_exc_page_fault+0x26/0x30   ? smb2_parse_contexts+0xa0/0x3a0 [cifs]   SMB2_open+0x38d/0x5f0 [cifs]   ? smb2_is_path_accessible+0x138/0x260 [cifs]   smb2_is_path_accessible+0x138/0x260 [cifs]   cifs_is_path_remote+0x8d/0x230 [cifs]   cifs_mount+0x7e/0x350 [cifs]   cifs_smb3_do_mount+0x128/0x780 [cifs]   smb3_get_tree+0xd9/0x290 [cifs]   vfs_get_tree+0x2c/0x100   ? capable+0x37/0x70   path_mount+0x2d7/0xb80   ? srso_alias_return_thunk+0x5/0xfbef5   ? _raw_spin_unlock_irqrestore+0x44/0x60   __x64_sys_mount+0x11a/0x150   do_syscall_64+0x47/0xf0   entry_SYSCALL_64_after_hwframe+0x6f/0x77  RIP: 0033:0x7f8737657b1e","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential OOBs in smb2_parse_contexts()Validate offsets and lengths before dereferencing create contexts insmb2_parse_contexts().This fixes following oops when accessing invalid create contexts fromserver:  BUG: unable to handle page fault for address: ffff8881178d8cc3  #PF: supervisor read access in kernel mode  #PF: error_code(0x0000) - not-present page  PGD 4a01067 P4D 4a01067 PUD 0  Oops: 0000 [#1] PREEMPT SMP NOPTI  CPU: 3 PID: 1736 Comm: mount.cifs Not tainted 6.7.0-rc4 #1  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS  rel-1.16.2-3-gd478f380-rebuilt.opensuse.org 04/01/2014  RIP: 0010:smb2_parse_contexts+0xa0/0x3a0 [cifs]  Code: f8 10 75 13 48 b8 93 ad 25 50 9c b4 11 e7 49 39 06 0f 84 d2 00  00 00 8b 45 00 85 c0 74 61 41 29 c5 48 01 c5 41 83 fd 0f 76 55 <0f> b7  7d 04 0f b7 45 06 4c 8d 74 3d 00 66 83 f8 04 75 bc ba 04 00  RSP: 0018:ffffc900007939e0 EFLAGS: 00010216  RAX: ffffc90000793c78 RBX: ffff8880180cc000 RCX: ffffc90000793c90  RDX: ffffc90000793cc0 RSI: ffff8880178d8cc0 RDI: ffff8880180cc000  RBP: ffff8881178d8cbf R08: ffffc90000793c22 R09: 0000000000000000  R10: ffff8880180cc000 R11: 0000000000000024 R12: 0000000000000000  R13: 0000000000000020 R14: 0000000000000000 R15: ffffc90000793c22  FS: 00007f873753cbc0(0000) GS:ffff88806bc00000(0000)  knlGS:0000000000000000  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033  CR2: ffff8881178d8cc3 CR3: 00000000181ca000 CR4: 0000000000750ef0  PKRU: 55555554  Call Trace:   <TASK>   ? __die+0x23/0x70   ? page_fault_oops+0x181/0x480   ? search_module_extables+0x19/0x60   ? srso_alias_return_thunk+0x5/0xfbef5   ? exc_page_fault+0x1b6/0x1c0   ? asm_exc_page_fault+0x26/0x30   ? smb2_parse_contexts+0xa0/0x3a0 [cifs]   SMB2_open+0x38d/0x5f0 [cifs]   ? smb2_is_path_accessible+0x138/0x260 [cifs]   smb2_is_path_accessible+0x138/0x260 [cifs]   cifs_is_path_remote+0x8d/0x230 [cifs]   cifs_mount+0x7e/0x350 [cifs]   cifs_smb3_do_mount+0x128/0x780 [cifs]   smb3_get_tree+0xd9/0x290 [cifs]   vfs_get_tree+0x2c/0x100   ? capable+0x37/0x70   path_mount+0x2d7/0xb80   ? srso_alias_return_thunk+0x5/0xfbef5   ? _raw_spin_unlock_irqrestore+0x44/0x60   __x64_sys_mount+0x11a/0x150   do_syscall_64+0x47/0xf0   entry_SYSCALL_64_after_hwframe+0x6f/0x77  RIP: 0033:0x7f8737657b1e","references":["https://git.kernel.org/stable/c/13fb0fc4917621f3dfa285a27eaf7151d770b5e5","https://git.kernel.org/stable/c/17a0f64cc02d4972e21c733d9f21d1c512963afa","https://git.kernel.org/stable/c/1ae3c59355dc9882e09c020afe8ffbd895ad0f29"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=5.5",">=5.16",">=5.11","<5.4.277",">=5.3","<5.10.211","<5.15.150"],["<6.6.8",">=6.2","<=6.1.79"]]},
  {"id":"CVE-2023-52441","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix out of bounds in init_smb2_rsp_hdr()If client send smb2 negotiate request and then send smb1 negotiaterequest, init_smb2_rsp_hdr is called for smb1 negotiate request sinceneed_neg is set to false. This patch ignore smb1 packets after ->need_negis set to false.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix out of bounds in init_smb2_rsp_hdr()If client send smb2 negotiate request and then send smb1 negotiaterequest, init_smb2_rsp_hdr is called for smb1 negotiate request sinceneed_neg is set to false. This patch ignore smb1 packets after ->need_negis set to false.","references":["https://git.kernel.org/stable/c/330d900620dfc9893011d725b3620cd2ee0bc2bc","https://git.kernel.org/stable/c/536bb492d39bb6c080c92f31e8a55fe9934f452b","https://git.kernel.org/stable/c/5c0df9d30c289d6b9d7d44e2a450de2f8e3cf40b"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<6.4.16","<6.1.53",">=6.2.0"],["<5.15.145",">=5.15.0",">=5.16.0"]]},
  {"id":"CVE-2023-52442","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: validate session id and tree id in compound request`smb2_get_msg()` in smb2_get_ksmbd_tcon() and smb2_check_user_session()will always return the first request smb2 header in a compound request.if `SMB2_TREE_CONNECT_HE` is the first command in compound request, willreturn 0, i.e. The tree id check is skipped.This patch use ksmbd_req_buf_next() to get current command in compound.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: validate session id and tree id in compound request`smb2_get_msg()` in smb2_get_ksmbd_tcon() and smb2_check_user_session()will always return the first request smb2 header in a compound request.if `SMB2_TREE_CONNECT_HE` is the first command in compound request, willreturn 0, i.e. The tree id check is skipped.This patch use ksmbd_req_buf_next() to get current command in compound.","references":["https://git.kernel.org/stable/c/017d85c94f02090a87f4a473dbe0d6ee0da72693","https://git.kernel.org/stable/c/3df0411e132ee74a87aa13142dfd2b190275332e","https://git.kernel.org/stable/c/4c2b350b2e269e3fd17bbfa42de1b42775b777ac"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[[">=6.2","<6.4.16","<6.1.53"],[">=5.16",">=5.15","<5.15.145"]]},
  {"id":"CVE-2023-52465","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:power: supply: Fix null pointer dereference in smb2_probedevm_kasprintf and devm_kzalloc return a pointer to dynamicallyallocated memory which can be NULL upon failure.","details":"In the Linux kernel, the following vulnerability has been resolved:power: supply: Fix null pointer dereference in smb2_probedevm_kasprintf and devm_kzalloc return a pointer to dynamicallyallocated memory which can be NULL upon failure.","references":["https://git.kernel.org/stable/c/88f04bc3e737155e13caddf0ba8ed19db87f0212","https://git.kernel.org/stable/c/bd3d2ec447ede9da822addf3960a5f4275e3ae76","https://git.kernel.org/stable/c/e2717302fbc20f148bcda362facee0444b949a3a"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.6.14","<6.7.2",">=6.7.0",">=6.5.0"]},
  {"id":"CVE-2023-52479","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix uaf in smb20_oplock_break_ackdrop reference after use opinfo.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix uaf in smb20_oplock_break_ackdrop reference after use opinfo.","references":["https://git.kernel.org/stable/c/694e13732e830cbbfedb562e57f28644927c33fd","https://git.kernel.org/stable/c/8226ffc759ea59f10067b9acdf7f94bae1c69930","https://git.kernel.org/stable/c/c69813471a1ec081a0b9bf0c6bd7e8afd818afce"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=6.2","<6.5.7","<6.1.57"],[">=5.16","<5.15.135"]]},
  {"id":"CVE-2023-52480","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix race condition between session lookup and expire Thread A                        +  Thread B ksmbd_session_lookup            |  smb2_sess_setup   sess = xa_load                |                                 |                                 |    xa_erase(&conn->sessions, sess->id);                                 |                                 |    ksmbd_session_destroy(sess) --> kfree(sess)                                 |   // UAF!                       |   sess->last_active = jiffies   |                                 +This patch add rwsem to fix race condition between ksmbd_session_lookupand ksmbd_expire_session.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix race condition between session lookup and expire Thread A                        +  Thread B ksmbd_session_lookup            |  smb2_sess_setup   sess = xa_load                |                                 |                                 |    xa_erase(&conn->sessions, sess->id);                                 |                                 |    ksmbd_session_destroy(sess) --> kfree(sess)                                 |   // UAF!                       |   sess->last_active = jiffies   |                                 +This patch add rwsem to fix race condition between ksmbd_session_lookupand ksmbd_expire_session.","references":["https://git.kernel.org/stable/c/18ced78b0ebccc2d16f426143dc56ab3aad666be","https://git.kernel.org/stable/c/53ff5cf89142b978b1a5ca8dc4d4425e6a09745f","https://git.kernel.org/stable/c/a2ca5fd3dbcc665e1169044fa0c9e3eba779202b"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=6.2","<6.5.7","<6.1.57"],[">=5.16",">=5.15","<5.15.145"]]},
  {"id":"CVE-2023-52572","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:cifs: Fix UAF in cifs_demultiplex_thread()There is a UAF when xfstests on cifs:  BUG: KASAN: use-after-free in smb2_is_network_name_deleted+0x27/0x160  Read of size 4 at addr ffff88810103fc08 by task cifsd/923  CPU: 1 PID: 923 Comm: cifsd Not tainted 6.1.0-rc4+ #45  ...  Call Trace:   <TASK>   dump_stack_lvl+0x34/0x44   print_report+0x171/0x472   kasan_report+0xad/0x130   kasan_check_range+0x145/0x1a0   smb2_is_network_name_deleted+0x27/0x160   cifs_demultiplex_thread.cold+0x172/0x5a4   kthread+0x165/0x1a0   ret_from_fork+0x1f/0x30   </TASK>  Allocated by task 923:   kasan_save_stack+0x1e/0x40   kasan_set_track+0x21/0x30   __kasan_slab_alloc+0x54/0x60   kmem_cache_alloc+0x147/0x320   mempool_alloc+0xe1/0x260   cifs_small_buf_get+0x24/0x60   allocate_buffers+0xa1/0x1c0   cifs_demultiplex_thread+0x199/0x10d0   kthread+0x165/0x1a0   ret_from_fork+0x1f/0x30  Freed by task 921:   kasan_save_stack+0x1e/0x40   kasan_set_track+0x21/0x30   kasan_save_free_info+0x2a/0x40   ____kasan_slab_free+0x143/0x1b0   kmem_cache_free+0xe3/0x4d0   cifs_small_buf_release+0x29/0x90   SMB2_negotiate+0x8b7/0x1c60   smb2_negotiate+0x51/0x70   cifs_negotiate_protocol+0xf0/0x160   cifs_get_smb_ses+0x5fa/0x13c0   mount_get_conns+0x7a/0x750   cifs_mount+0x103/0xd00   cifs_smb3_do_mount+0x1dd/0xcb0   smb3_get_tree+0x1d5/0x300   vfs_get_tree+0x41/0xf0   path_mount+0x9b3/0xdd0   __x64_sys_mount+0x190/0x1d0   do_syscall_64+0x35/0x80   entry_SYSCALL_64_after_hwframe+0x46/0xb0The UAF is because: mount(pid: 921)               | cifsd(pid: 923)-------------------------------|-------------------------------                               | cifs_demultiplex_threadSMB2_negotiate                 | cifs_send_recv                |  compound_send_recv           |   smb_send_rqst               |    wait_for_response          |     wait_event_state      [1] |                               |  standard_receive3                               |   cifs_handle_standard                               |    handle_mid                               |     mid->resp_buf = buf;  [2]                               |     dequeue_mid           [3]     KILL the process      [4] |    resp_iov[i].iov_base = buf | free_rsp_buf              [5] |                               |   is_network_name_deleted [6]                               |   callback1. After send request to server, wait the response until    mid->mid_state != SUBMITTED;2. Receive response from server, and set it to mid;3. Set the mid state to RECEIVED;4. Kill the process, the mid state already RECEIVED, get 0;5. Handle and release the negotiate response;6. UAF.It can be easily reproduce with add some delay in [3] - [6].Only sync call has the problem since async call's callback isexecuted in cifsd process.Add an extra state to mark the mid state to READY before wakeup thewaitter, then it can get the resp safely.","details":"In the Linux kernel, the following vulnerability has been resolved:cifs: Fix UAF in cifs_demultiplex_thread()There is a UAF when xfstests on cifs:  BUG: KASAN: use-after-free in smb2_is_network_name_deleted+0x27/0x160  Read of size 4 at addr ffff88810103fc08 by task cifsd/923  CPU: 1 PID: 923 Comm: cifsd Not tainted 6.1.0-rc4+ #45  ...  Call Trace:   <TASK>   dump_stack_lvl+0x34/0x44   print_report+0x171/0x472   kasan_report+0xad/0x130   kasan_check_range+0x145/0x1a0   smb2_is_network_name_deleted+0x27/0x160   cifs_demultiplex_thread.cold+0x172/0x5a4   kthread+0x165/0x1a0   ret_from_fork+0x1f/0x30   </TASK>  Allocated by task 923:   kasan_save_stack+0x1e/0x40   kasan_set_track+0x21/0x30   __kasan_slab_alloc+0x54/0x60   kmem_cache_alloc+0x147/0x320   mempool_alloc+0xe1/0x260   cifs_small_buf_get+0x24/0x60   allocate_buffers+0xa1/0x1c0   cifs_demultiplex_thread+0x199/0x10d0   kthread+0x165/0x1a0   ret_from_fork+0x1f/0x30  Freed by task 921:   kasan_save_stack+0x1e/0x40   kasan_set_track+0x21/0x30   kasan_save_free_info+0x2a/0x40   ____kasan_slab_free+0x143/0x1b0   kmem_cache_free+0xe3/0x4d0   cifs_small_buf_release+0x29/0x90   SMB2_negotiate+0x8b7/0x1c60   smb2_negotiate+0x51/0x70   cifs_negotiate_protocol+0xf0/0x160   cifs_get_smb_ses+0x5fa/0x13c0   mount_get_conns+0x7a/0x750   cifs_mount+0x103/0xd00   cifs_smb3_do_mount+0x1dd/0xcb0   smb3_get_tree+0x1d5/0x300   vfs_get_tree+0x41/0xf0   path_mount+0x9b3/0xdd0   __x64_sys_mount+0x190/0x1d0   do_syscall_64+0x35/0x80   entry_SYSCALL_64_after_hwframe+0x46/0xb0The UAF is because: mount(pid: 921)               | cifsd(pid: 923)-------------------------------|-------------------------------                               | cifs_demultiplex_threadSMB2_negotiate                 | cifs_send_recv                |  compound_send_recv           |   smb_send_rqst               |    wait_for_response          |     wait_event_state      [1] |                               |  standard_receive3                               |   cifs_handle_standard                               |    handle_mid                               |     mid->resp_buf = buf;  [2]                               |     dequeue_mid           [3]     KILL the process      [4] |    resp_iov[i].iov_base = buf | free_rsp_buf              [5] |                               |   is_network_name_deleted [6]                               |   callback1. After send request to server, wait the response until    mid->mid_state != SUBMITTED;2. Receive response from server, and set it to mid;3. Set the mid state to RECEIVED;4. Kill the process, the mid state already RECEIVED, get 0;5. Handle and release the negotiate response;6. UAF.It can be easily reproduce with add some delay in [3] - [6].Only sync call has the problem since async call's callback isexecuted in cifsd process.Add an extra state to mark the mid state to READY before wakeup thewaitter, then it can get the resp safely.","references":["https://git.kernel.org/stable/c/76569e3819e0bb59fc19b1b8688b017e627c268a","https://git.kernel.org/stable/c/908b3b5e97d25e879de3d1f172a255665491c2c3","https://git.kernel.org/stable/c/99960d282fba6634fa758df4124cb73ef8a77d8a"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=6.2","<6.1.56","<6.5.6"],[">=2.6.16"]]},
  {"id":"CVE-2023-52741","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:cifs: Fix use-after-free in rdata->read_into_pages()When the network status is unstable, use-after-free may occur whenread data from the server.  BUG: KASAN: use-after-free in readpages_fill_pages+0x14c/0x7e0  Call Trace:   <TASK>   dump_stack_lvl+0x38/0x4c   print_report+0x16f/0x4a6   kasan_report+0xb7/0x130   readpages_fill_pages+0x14c/0x7e0   cifs_readv_receive+0x46d/0xa40   cifs_demultiplex_thread+0x121c/0x1490   kthread+0x16b/0x1a0   ret_from_fork+0x2c/0x50   </TASK>  Allocated by task 2535:   kasan_save_stack+0x22/0x50   kasan_set_track+0x25/0x30   __kasan_kmalloc+0x82/0x90   cifs_readdata_direct_alloc+0x2c/0x110   cifs_readdata_alloc+0x2d/0x60   cifs_readahead+0x393/0xfe0   read_pages+0x12f/0x470   page_cache_ra_unbounded+0x1b1/0x240   filemap_get_pages+0x1c8/0x9a0   filemap_read+0x1c0/0x540   cifs_strict_readv+0x21b/0x240   vfs_read+0x395/0x4b0   ksys_read+0xb8/0x150   do_syscall_64+0x3f/0x90   entry_SYSCALL_64_after_hwframe+0x72/0xdc  Freed by task 79:   kasan_save_stack+0x22/0x50   kasan_set_track+0x25/0x30   kasan_save_free_info+0x2e/0x50   __kasan_slab_free+0x10e/0x1a0   __kmem_cache_free+0x7a/0x1a0   cifs_readdata_release+0x49/0x60   process_one_work+0x46c/0x760   worker_thread+0x2a4/0x6f0   kthread+0x16b/0x1a0   ret_from_fork+0x2c/0x50  Last potentially related work creation:   kasan_save_stack+0x22/0x50   __kasan_record_aux_stack+0x95/0xb0   insert_work+0x2b/0x130   __queue_work+0x1fe/0x660   queue_work_on+0x4b/0x60   smb2_readv_callback+0x396/0x800   cifs_abort_connection+0x474/0x6a0   cifs_reconnect+0x5cb/0xa50   cifs_readv_from_socket.cold+0x22/0x6c   cifs_read_page_from_socket+0xc1/0x100   readpages_fill_pages.cold+0x2f/0x46   cifs_readv_receive+0x46d/0xa40   cifs_demultiplex_thread+0x121c/0x1490   kthread+0x16b/0x1a0   ret_from_fork+0x2c/0x50The following function calls will cause UAF of the rdata pointer.readpages_fill_pages cifs_read_page_from_socket  cifs_readv_from_socket   cifs_reconnect    __cifs_reconnect     cifs_abort_connection      mid->callback() --> smb2_readv_callback       queue_work(&rdata->work)  # if the worker completes first,                                 # the rdata is freed          cifs_readv_complete            kref_put              cifs_readdata_release                kfree(rdata) return rdata->...               # UAF in readpages_fill_pages()Similarly, this problem also occurs in the uncache_fill_pages().Fix this by adjusts the order of condition judgment in the returnstatement.","details":"In the Linux kernel, the following vulnerability has been resolved:cifs: Fix use-after-free in rdata->read_into_pages()When the network status is unstable, use-after-free may occur whenread data from the server.  BUG: KASAN: use-after-free in readpages_fill_pages+0x14c/0x7e0  Call Trace:   <TASK>   dump_stack_lvl+0x38/0x4c   print_report+0x16f/0x4a6   kasan_report+0xb7/0x130   readpages_fill_pages+0x14c/0x7e0   cifs_readv_receive+0x46d/0xa40   cifs_demultiplex_thread+0x121c/0x1490   kthread+0x16b/0x1a0   ret_from_fork+0x2c/0x50   </TASK>  Allocated by task 2535:   kasan_save_stack+0x22/0x50   kasan_set_track+0x25/0x30   __kasan_kmalloc+0x82/0x90   cifs_readdata_direct_alloc+0x2c/0x110   cifs_readdata_alloc+0x2d/0x60   cifs_readahead+0x393/0xfe0   read_pages+0x12f/0x470   page_cache_ra_unbounded+0x1b1/0x240   filemap_get_pages+0x1c8/0x9a0   filemap_read+0x1c0/0x540   cifs_strict_readv+0x21b/0x240   vfs_read+0x395/0x4b0   ksys_read+0xb8/0x150   do_syscall_64+0x3f/0x90   entry_SYSCALL_64_after_hwframe+0x72/0xdc  Freed by task 79:   kasan_save_stack+0x22/0x50   kasan_set_track+0x25/0x30   kasan_save_free_info+0x2e/0x50   __kasan_slab_free+0x10e/0x1a0   __kmem_cache_free+0x7a/0x1a0   cifs_readdata_release+0x49/0x60   process_one_work+0x46c/0x760   worker_thread+0x2a4/0x6f0   kthread+0x16b/0x1a0   ret_from_fork+0x2c/0x50  Last potentially related work creation:   kasan_save_stack+0x22/0x50   __kasan_record_aux_stack+0x95/0xb0   insert_work+0x2b/0x130   __queue_work+0x1fe/0x660   queue_work_on+0x4b/0x60   smb2_readv_callback+0x396/0x800   cifs_abort_connection+0x474/0x6a0   cifs_reconnect+0x5cb/0xa50   cifs_readv_from_socket.cold+0x22/0x6c   cifs_read_page_from_socket+0xc1/0x100   readpages_fill_pages.cold+0x2f/0x46   cifs_readv_receive+0x46d/0xa40   cifs_demultiplex_thread+0x121c/0x1490   kthread+0x16b/0x1a0   ret_from_fork+0x2c/0x50The following function calls will cause UAF of the rdata pointer.readpages_fill_pages cifs_read_page_from_socket  cifs_readv_from_socket   cifs_reconnect    __cifs_reconnect     cifs_abort_connection      mid->callback() --> smb2_readv_callback       queue_work(&rdata->work)  # if the worker completes first,                                 # the rdata is freed          cifs_readv_complete            kref_put              cifs_readdata_release                kfree(rdata) return rdata->...               # UAF in readpages_fill_pages()Similarly, this problem also occurs in the uncache_fill_pages().Fix this by adjusts the order of condition judgment in the returnstatement.","references":["https://git.kernel.org/stable/c/2b693fe3f760c87fd9768e759f6297f743a1b3b0","https://git.kernel.org/stable/c/3684a2f6affa1ca52a5d4a12f04d0652efdee65e","https://git.kernel.org/stable/c/aa5465aeca3c66fecdf7efcf554aed79b4c4b211"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=5.16","<5.15.94",">=5.11","<5.10.168"],["<6.1.12"]]},
  {"id":"CVE-2023-52751","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix use-after-free in smb2_query_info_compound()The following UAF was triggered when running fstests generic/072 withKASAN enabled against Windows Server 2022 and mount options'multichannel,max_channels=2,vers=3.1.1,mfsymlinks,noperm'  BUG: KASAN: slab-use-after-free in smb2_query_info_compound+0x423/0x6d0 [cifs]  Read of size 8 at addr ffff888014941048 by task xfs_io/27534  CPU: 0 PID: 27534 Comm: xfs_io Not tainted 6.6.0-rc7 #1  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS  rel-1.16.2-3-gd478f380-rebuilt.opensuse.org 04/01/2014  Call Trace:   dump_stack_lvl+0x4a/0x80   print_report+0xcf/0x650   ? srso_alias_return_thunk+0x5/0x7f   ? srso_alias_return_thunk+0x5/0x7f   ? __phys_addr+0x46/0x90   kasan_report+0xda/0x110   ? smb2_query_info_compound+0x423/0x6d0 [cifs]   ? smb2_query_info_compound+0x423/0x6d0 [cifs]   smb2_query_info_compound+0x423/0x6d0 [cifs]   ? __pfx_smb2_query_info_compound+0x10/0x10 [cifs]   ? srso_alias_return_thunk+0x5/0x7f   ? __stack_depot_save+0x39/0x480   ? kasan_save_stack+0x33/0x60   ? kasan_set_track+0x25/0x30   ? ____kasan_slab_free+0x126/0x170   smb2_queryfs+0xc2/0x2c0 [cifs]   ? __pfx_smb2_queryfs+0x10/0x10 [cifs]   ? __pfx___lock_acquire+0x10/0x10   smb311_queryfs+0x210/0x220 [cifs]   ? __pfx_smb311_queryfs+0x10/0x10 [cifs]   ? srso_alias_return_thunk+0x5/0x7f   ? __lock_acquire+0x480/0x26c0   ? lock_release+0x1ed/0x640   ? srso_alias_return_thunk+0x5/0x7f   ? do_raw_spin_unlock+0x9b/0x100   cifs_statfs+0x18c/0x4b0 [cifs]   statfs_by_dentry+0x9b/0xf0   fd_statfs+0x4e/0xb0   __do_sys_fstatfs+0x7f/0xe0   ? __pfx___do_sys_fstatfs+0x10/0x10   ? srso_alias_return_thunk+0x5/0x7f   ? lockdep_hardirqs_on_prepare+0x136/0x200   ? srso_alias_return_thunk+0x5/0x7f   do_syscall_64+0x3f/0x90   entry_SYSCALL_64_after_hwframe+0x6e/0xd8  Allocated by task 27534:   kasan_save_stack+0x33/0x60   kasan_set_track+0x25/0x30   __kasan_kmalloc+0x8f/0xa0   open_cached_dir+0x71b/0x1240 [cifs]   smb2_query_info_compound+0x5c3/0x6d0 [cifs]   smb2_queryfs+0xc2/0x2c0 [cifs]   smb311_queryfs+0x210/0x220 [cifs]   cifs_statfs+0x18c/0x4b0 [cifs]   statfs_by_dentry+0x9b/0xf0   fd_statfs+0x4e/0xb0   __do_sys_fstatfs+0x7f/0xe0   do_syscall_64+0x3f/0x90   entry_SYSCALL_64_after_hwframe+0x6e/0xd8  Freed by task 27534:   kasan_save_stack+0x33/0x60   kasan_set_track+0x25/0x30   kasan_save_free_info+0x2b/0x50   ____kasan_slab_free+0x126/0x170   slab_free_freelist_hook+0xd0/0x1e0   __kmem_cache_free+0x9d/0x1b0   open_cached_dir+0xff5/0x1240 [cifs]   smb2_query_info_compound+0x5c3/0x6d0 [cifs]   smb2_queryfs+0xc2/0x2c0 [cifs]This is a race between open_cached_dir() and cached_dir_lease_break()where the cache entry for the open directory handle receives a leasebreak while creating it.  And before returning from open_cached_dir(),we put the last reference of the new @cfid because of!@cfid->has_lease.Besides the UAF, while running xfstests a lot of missed lease breakshave been noticed in tests that run several concurrent statfs(2) callson those cached fids  CIFS: VFS: \\\\w22-root1.gandalf.test No task to wake, unknown frame...  CIFS: VFS: \\\\w22-root1.gandalf.test Cmd: 18 Err: 0x0 Flags: 0x1...  CIFS: VFS: \\\\w22-root1.gandalf.test smb buf 00000000715bfe83 len 108  CIFS: VFS: Dump pending requests:  CIFS: VFS: \\\\w22-root1.gandalf.test No task to wake, unknown frame...  CIFS: VFS: \\\\w22-root1.gandalf.test Cmd: 18 Err: 0x0 Flags: 0x1...  CIFS: VFS: \\\\w22-root1.gandalf.test smb buf 000000005aa7316e len 108  ...To fix both, in open_cached_dir() ensure that @cfid->has_lease is setright before sending out compounded request so that any potentiallease break will be get processed by demultiplex thread while we'restill caching @cfid.  And, if open failed for some reason, re-check@cfid->has_lease to decide whether or not put lease reference.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix use-after-free in smb2_query_info_compound()The following UAF was triggered when running fstests generic/072 withKASAN enabled against Windows Server 2022 and mount options'multichannel,max_channels=2,vers=3.1.1,mfsymlinks,noperm'  BUG: KASAN: slab-use-after-free in smb2_query_info_compound+0x423/0x6d0 [cifs]  Read of size 8 at addr ffff888014941048 by task xfs_io/27534  CPU: 0 PID: 27534 Comm: xfs_io Not tainted 6.6.0-rc7 #1  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS  rel-1.16.2-3-gd478f380-rebuilt.opensuse.org 04/01/2014  Call Trace:   dump_stack_lvl+0x4a/0x80   print_report+0xcf/0x650   ? srso_alias_return_thunk+0x5/0x7f   ? srso_alias_return_thunk+0x5/0x7f   ? __phys_addr+0x46/0x90   kasan_report+0xda/0x110   ? smb2_query_info_compound+0x423/0x6d0 [cifs]   ? smb2_query_info_compound+0x423/0x6d0 [cifs]   smb2_query_info_compound+0x423/0x6d0 [cifs]   ? __pfx_smb2_query_info_compound+0x10/0x10 [cifs]   ? srso_alias_return_thunk+0x5/0x7f   ? __stack_depot_save+0x39/0x480   ? kasan_save_stack+0x33/0x60   ? kasan_set_track+0x25/0x30   ? ____kasan_slab_free+0x126/0x170   smb2_queryfs+0xc2/0x2c0 [cifs]   ? __pfx_smb2_queryfs+0x10/0x10 [cifs]   ? __pfx___lock_acquire+0x10/0x10   smb311_queryfs+0x210/0x220 [cifs]   ? __pfx_smb311_queryfs+0x10/0x10 [cifs]   ? srso_alias_return_thunk+0x5/0x7f   ? __lock_acquire+0x480/0x26c0   ? lock_release+0x1ed/0x640   ? srso_alias_return_thunk+0x5/0x7f   ? do_raw_spin_unlock+0x9b/0x100   cifs_statfs+0x18c/0x4b0 [cifs]   statfs_by_dentry+0x9b/0xf0   fd_statfs+0x4e/0xb0   __do_sys_fstatfs+0x7f/0xe0   ? __pfx___do_sys_fstatfs+0x10/0x10   ? srso_alias_return_thunk+0x5/0x7f   ? lockdep_hardirqs_on_prepare+0x136/0x200   ? srso_alias_return_thunk+0x5/0x7f   do_syscall_64+0x3f/0x90   entry_SYSCALL_64_after_hwframe+0x6e/0xd8  Allocated by task 27534:   kasan_save_stack+0x33/0x60   kasan_set_track+0x25/0x30   __kasan_kmalloc+0x8f/0xa0   open_cached_dir+0x71b/0x1240 [cifs]   smb2_query_info_compound+0x5c3/0x6d0 [cifs]   smb2_queryfs+0xc2/0x2c0 [cifs]   smb311_queryfs+0x210/0x220 [cifs]   cifs_statfs+0x18c/0x4b0 [cifs]   statfs_by_dentry+0x9b/0xf0   fd_statfs+0x4e/0xb0   __do_sys_fstatfs+0x7f/0xe0   do_syscall_64+0x3f/0x90   entry_SYSCALL_64_after_hwframe+0x6e/0xd8  Freed by task 27534:   kasan_save_stack+0x33/0x60   kasan_set_track+0x25/0x30   kasan_save_free_info+0x2b/0x50   ____kasan_slab_free+0x126/0x170   slab_free_freelist_hook+0xd0/0x1e0   __kmem_cache_free+0x9d/0x1b0   open_cached_dir+0xff5/0x1240 [cifs]   smb2_query_info_compound+0x5c3/0x6d0 [cifs]   smb2_queryfs+0xc2/0x2c0 [cifs]This is a race between open_cached_dir() and cached_dir_lease_break()where the cache entry for the open directory handle receives a leasebreak while creating it.  And before returning from open_cached_dir(),we put the last reference of the new @cfid because of!@cfid->has_lease.Besides the UAF, while running xfstests a lot of missed lease breakshave been noticed in tests that run several concurrent statfs(2) callson those cached fids  CIFS: VFS: \\\\w22-root1.gandalf.test No task to wake, unknown frame...  CIFS: VFS: \\\\w22-root1.gandalf.test Cmd: 18 Err: 0x0 Flags: 0x1...  CIFS: VFS: \\\\w22-root1.gandalf.test smb buf 00000000715bfe83 len 108  CIFS: VFS: Dump pending requests:  CIFS: VFS: \\\\w22-root1.gandalf.test No task to wake, unknown frame...  CIFS: VFS: \\\\w22-root1.gandalf.test Cmd: 18 Err: 0x0 Flags: 0x1...  CIFS: VFS: \\\\w22-root1.gandalf.test smb buf 000000005aa7316e len 108  ...To fix both, in open_cached_dir() ensure that @cfid->has_lease is setright before sending out compounded request so that any potentiallease break will be get processed by demultiplex thread while we'restill caching @cfid.  And, if open failed for some reason, re-check@cfid->has_lease to decide whether or not put lease reference.","references":["https://git.kernel.org/stable/c/5c86919455c1edec99ebd3338ad213b59271a71b","https://git.kernel.org/stable/c/6db94d08359c43f2c8fe372811cdee04564a41b9","https://git.kernel.org/stable/c/93877b9afc2994c89362007aac480a7b150f386f"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.5.13",">=6.6","<6.6.3"]},
  {"id":"CVE-2023-52752","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix use-after-free bug in cifs_debug_data_proc_show()Skip SMB sessions that are being teared down(e.g. @ses->ses_status == SES_EXITING) in cifs_debug_data_proc_show()to avoid use-after-free in @ses.This fixes the following GPF when reading from /proc/fs/cifs/DebugDatawhile mounting and umounting  [ 816.251274] general protection fault, probably for non-canonical  address 0x6b6b6b6b6b6b6d81: 0000 [#1] PREEMPT SMP NOPTI  ...  [  816.260138] Call Trace:  [  816.260329]  <TASK>  [  816.260499]  ? die_addr+0x36/0x90  [  816.260762]  ? exc_general_protection+0x1b3/0x410  [  816.261126]  ? asm_exc_general_protection+0x26/0x30  [  816.261502]  ? cifs_debug_tcon+0xbd/0x240 [cifs]  [  816.261878]  ? cifs_debug_tcon+0xab/0x240 [cifs]  [  816.262249]  cifs_debug_data_proc_show+0x516/0xdb0 [cifs]  [  816.262689]  ? seq_read_iter+0x379/0x470  [  816.262995]  seq_read_iter+0x118/0x470  [  816.263291]  proc_reg_read_iter+0x53/0x90  [  816.263596]  ? srso_alias_return_thunk+0x5/0x7f  [  816.263945]  vfs_read+0x201/0x350  [  816.264211]  ksys_read+0x75/0x100  [  816.264472]  do_syscall_64+0x3f/0x90  [  816.264750]  entry_SYSCALL_64_after_hwframe+0x6e/0xd8  [  816.265135] RIP: 0033:0x7fd5e669d381","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix use-after-free bug in cifs_debug_data_proc_show()Skip SMB sessions that are being teared down(e.g. @ses->ses_status == SES_EXITING) in cifs_debug_data_proc_show()to avoid use-after-free in @ses.This fixes the following GPF when reading from /proc/fs/cifs/DebugDatawhile mounting and umounting  [ 816.251274] general protection fault, probably for non-canonical  address 0x6b6b6b6b6b6b6d81: 0000 [#1] PREEMPT SMP NOPTI  ...  [  816.260138] Call Trace:  [  816.260329]  <TASK>  [  816.260499]  ? die_addr+0x36/0x90  [  816.260762]  ? exc_general_protection+0x1b3/0x410  [  816.261126]  ? asm_exc_general_protection+0x26/0x30  [  816.261502]  ? cifs_debug_tcon+0xbd/0x240 [cifs]  [  816.261878]  ? cifs_debug_tcon+0xab/0x240 [cifs]  [  816.262249]  cifs_debug_data_proc_show+0x516/0xdb0 [cifs]  [  816.262689]  ? seq_read_iter+0x379/0x470  [  816.262995]  seq_read_iter+0x118/0x470  [  816.263291]  proc_reg_read_iter+0x53/0x90  [  816.263596]  ? srso_alias_return_thunk+0x5/0x7f  [  816.263945]  vfs_read+0x201/0x350  [  816.264211]  ksys_read+0x75/0x100  [  816.264472]  do_syscall_64+0x3f/0x90  [  816.264750]  entry_SYSCALL_64_after_hwframe+0x6e/0xd8  [  816.265135] RIP: 0033:0x7fd5e669d381","references":["https://git.kernel.org/stable/c/0ab6f842452ce2cae04209d4671ac6289d0aef8a","https://git.kernel.org/stable/c/2abdf136784b7edaec7ffe0f4b461b63f9c4c4de","https://git.kernel.org/stable/c/336a066990bb3962c46daf574ace596bda9303ce"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.6.3","<6.1.64","<6.5.13",">=6.6",">=6.2"]},
  {"id":"CVE-2023-52755","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix slab out of bounds write in smb_inherit_dacl()slab out-of-bounds write is caused by that offsets is bigger than pntsdallocation size. This patch add the check to validate 3 offsets usingallocation size.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix slab out of bounds write in smb_inherit_dacl()slab out-of-bounds write is caused by that offsets is bigger than pntsdallocation size. This patch add the check to validate 3 offsets usingallocation size.","references":["https://git.kernel.org/stable/c/09d9d8b40a3338193619c14ed4dc040f4f119e70","https://git.kernel.org/stable/c/712e01f32e577e7e48ab0adb5fe550646a3d93cb","https://git.kernel.org/stable/c/8387c94d73ec66eb597c7a23a8d9eadf64bfbafa"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<6.6.3",">=6.6","<6.1.64",">=6.2","<6.5.13"],[">=5.16",">=5.15","<5.15.140"]]},
  {"id":"CVE-2023-52757","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential deadlock when releasing midsAll release_mid() callers seem to hold a reference of @mid so there isno need to call kref_put(&mid->refcount, __release_mid) under@server->mid_lock spinlock.  If they don't, then an use-after-free bugwould have occurred anyways.By getting rid of such spinlock also fixes a potential deadlock asshown belowCPU 0                                CPU 1------------------------------------------------------------------cifs_demultiplex_thread()            cifs_debug_data_proc_show() release_mid()  spin_lock(&server->mid_lock);                                     spin_lock(&cifs_tcp_ses_lock)      spin_lock(&server->mid_lock)  __release_mid()   smb2_find_smb_tcon()    spin_lock(&cifs_tcp_ses_lock) *deadlock*","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential deadlock when releasing midsAll release_mid() callers seem to hold a reference of @mid so there isno need to call kref_put(&mid->refcount, __release_mid) under@server->mid_lock spinlock.  If they don't, then an use-after-free bugwould have occurred anyways.By getting rid of such spinlock also fixes a potential deadlock asshown belowCPU 0                                CPU 1------------------------------------------------------------------cifs_demultiplex_thread()            cifs_debug_data_proc_show() release_mid()  spin_lock(&server->mid_lock);                                     spin_lock(&cifs_tcp_ses_lock)      spin_lock(&server->mid_lock)  __release_mid()   smb2_find_smb_tcon()    spin_lock(&cifs_tcp_ses_lock) *deadlock*","references":["https://git.kernel.org/stable/c/99f476e27aad5964ab13777d84fda67d1356dec1","https://git.kernel.org/stable/c/9eb44db68c5b7f5aa22b8fc7de74a3e2e08d1f29","https://git.kernel.org/stable/c/b9bb9607b1fc12fca51f5632da25b36975f599bf"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.6.3","<6.1.64","<6.5.13",">=6.6",">=6.2"]},
  {"id":"CVE-2023-53006","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:cifs: Fix oops due to uncleared server->smbd_conn in reconnectIn smbd_destroy(), clear the server->smbd_conn pointer after freeing thesmbd_connection struct that it points to so that reconnection doesn't getconfused.","details":"In the Linux kernel, the following vulnerability has been resolved:cifs: Fix oops due to uncleared server->smbd_conn in reconnectIn smbd_destroy(), clear the server->smbd_conn pointer after freeing thesmbd_connection struct that it points to so that reconnection doesn't getconfused.","references":["https://git.kernel.org/stable/c/4b83bc6f87eedab4599b0123e572a422689444be","https://git.kernel.org/stable/c/5109607a4ece7cd8536172bf7549eb4dce1f3576","https://git.kernel.org/stable/c/91be54849d5392050f5b847b42bd5e6221551ac8"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-53061","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix possible refcount leak in smb2_open()Reference count of acls will leak when memory allocation fails. Fix thisby adding the missing posix_acl_release().","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix possible refcount leak in smb2_open()Reference count of acls will leak when memory allocation fails. Fix thisby adding the missing posix_acl_release().","references":["https://git.kernel.org/stable/c/2624b445544ffc1472ccabfb6ec867c199d4c95c","https://git.kernel.org/stable/c/303f8e58cc3ace744801dcdcabfc06ffc72ed62d","https://git.kernel.org/stable/c/a22c49a05e5e7aa2c414fbc42c49c4c01a5c9a78"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-5345","product":"smb","summary":"A use-after-free vulnerability in the Linux kernel's fs/smb/client component can be exploited to achieve local privilege escalation.In case of an error in smb3_fs_context_parse_param, ctx->password was freed but the field was not set to NULL which could lead to double free.We recommend upgrading past commit e6e43b8aa7cd3c3af686caf0c2e11819a886d705.","details":"A use-after-free vulnerability in the Linux kernel's fs/smb/client component can be exploited to achieve local privilege escalation.In case of an error in smb3_fs_context_parse_param, ctx->password was freed but the field was not set to NULL which could lead to double free.We recommend upgrading past commit e6e43b8aa7cd3c3af686caf0c2e11819a886d705.","references":["http://packetstormsecurity.com/files/177029/Kernel-Live-Patch-Security-Notice-LSN-0100-1.html","https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=e6e43b8aa7cd3c3af686caf0c2e11819a886d705","https://kernel.dance/e6e43b8aa7cd3c3af686caf0c2e11819a886d705"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.5.6",">=6.0.16","<6.1.56",">=6.2"]},
  {"id":"CVE-2023-6381","product":"smb","summary":"Improper input validation vulnerability in Newsletter Software SuperMailer affecting version 11.20.0.2204. An attacker could exploit this vulnerability by sending a malicious configuration file (file with SMB extension) to a user via a link or email attachment and persuade the user to open the file with the affected software on the local system. A successful exploit could allow the attacker to crash the application when attempting to load the malicious file.","details":"Improper input validation vulnerability in Newsletter Software SuperMailer affecting version 11.20.0.2204. An attacker could exploit this vulnerability by sending a malicious configuration file (file with SMB extension) to a user via a link or email attachment and persuade the user to open the file with the affected software on the local system. A successful exploit could allow the attacker to crash the application when attempting to load the malicious file.","references":["https://www.incibe.es/en/incibe-cert/notices/aviso/improper-input-validation-newsletter-software-supermailer","https://www.incibe.es/en/incibe-cert/notices/aviso/improper-input-validation-newsletter-software-supermailer"],"severity":"LOW","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2023-6606","product":"smb","summary":"An out-of-bounds read vulnerability was found in smbCalcSize in fs/smb/client/netmisc.c in the Linux Kernel. This issue could allow a local attacker to crash the system or leak internal kernel information.","details":"An out-of-bounds read vulnerability was found in smbCalcSize in fs/smb/client/netmisc.c in the Linux Kernel. This issue could allow a local attacker to crash the system or leak internal kernel information.","references":["https://access.redhat.com/errata/RHSA-2024:0723","https://access.redhat.com/errata/RHSA-2024:0725","https://access.redhat.com/errata/RHSA-2024:0881"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.7",">=6.4.1"]},
  {"id":"CVE-2023-6610","product":"smb","summary":"An out-of-bounds read vulnerability was found in smb2_dump_detail in fs/smb/client/smb2ops.c in the Linux Kernel. This issue could allow a local attacker to crash the system or leak internal kernel information.","details":"An out-of-bounds read vulnerability was found in smb2_dump_detail in fs/smb/client/smb2ops.c in the Linux Kernel. This issue could allow a local attacker to crash the system or leak internal kernel information.","references":["https://access.redhat.com/errata/RHSA-2024:0723","https://access.redhat.com/errata/RHSA-2024:0724","https://access.redhat.com/errata/RHSA-2024:0725"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-0565","product":"smb","summary":"An out-of-bounds memory read flaw was found in receive_encrypted_standard in fs/smb/client/smb2ops.c in the SMB Client sub-component in the Linux Kernel. This issue occurs due to integer underflow on the memcpy length, leading to a denial of service.","details":"An out-of-bounds memory read flaw was found in receive_encrypted_standard in fs/smb/client/smb2ops.c in the SMB Client sub-component in the Linux Kernel. This issue occurs due to integer underflow on the memcpy length, leading to a denial of service.","references":["https://access.redhat.com/errata/RHSA-2024:1188","https://access.redhat.com/errata/RHSA-2024:1404","https://access.redhat.com/errata/RHSA-2024:1532"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.7",">=6.1.36"]},
  {"id":"CVE-2024-12511","product":"smb","summary":"With address book access, SMB/FTP settings could be modified, redirecting scans and possibly capturing credentials. This requires enabled scan functions and printer access.","details":"With address book access, SMB/FTP settings could be modified, redirecting scans and possibly capturing credentials. This requires enabled scan functions and printer access.","references":["https://securitydocs.business.xerox.com/wp-content/uploads/2025/02/Xerox-Security-Bulletin-XRX25-003-for-Xerox%C2%AE-for-VersaLinkPhaser-and-WorkCentre.pdf"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-12673","product":"smb","summary":"An improper privilege vulnerability was reported in a BIOS customization feature of Lenovo Vantage on SMB notebook devices which could allow a local attacker to elevate privileges on the system.This vulnerability only affects Vantage installed on these devices:  *  Lenovo V Series (Gen 5)  *  ThinkBook 14 (Gen 6, 7)  *  ThinkBook 16 (Gen 6, 7)  *  ThinkPad E Series (Gen 1)","details":"An improper privilege vulnerability was reported in a BIOS customization feature of Lenovo Vantage on SMB notebook devices which could allow a local attacker to elevate privileges on the system.This vulnerability only affects Vantage installed on these devices:  *  Lenovo V Series (Gen 5)  *  ThinkBook 14 (Gen 6, 7)  *  ThinkBook 16 (Gen 6, 7)  *  ThinkPad E Series (Gen 1)","references":["https://support.lenovo.com/us/en/product_security/LEN-183176"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-22705","product":"smb","summary":"An issue was discovered in ksmbd in the Linux kernel before 6.6.10. smb2_get_data_area_len in fs/smb/server/smb2misc.c can cause an smb_strndup_from_utf16 out-of-bounds access because the relationship between Name data and CreateContexts data is mishandled.","details":"An issue was discovered in ksmbd in the Linux kernel before 6.6.10. smb2_get_data_area_len in fs/smb/server/smb2misc.c can cause an smb_strndup_from_utf16 out-of-bounds access because the relationship between Name data and CreateContexts data is mishandled.","references":["https://cdn.kernel.org/pub/linux/kernel/v6.x/ChangeLog-6.6.10","https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d10c77873ba1e9e6b91905018e29e196fd5f863d","https://cdn.kernel.org/pub/linux/kernel/v6.x/ChangeLog-6.6.10"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<6.6.10"},
  {"id":"CVE-2024-26245","product":"smb","summary":"Windows SMB Elevation of Privilege Vulnerability","details":"Windows SMB Elevation of Privilege Vulnerability","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-26245","https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-26245"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<10.0.10240.20596"},
  {"id":"CVE-2024-26692","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: Fix regression in writes when non-standard maximum write size negotiatedThe conversion to netfs in the 6.3 kernel caused a regression whenmaximum write size is set by the server to an unexpected value which isnot a multiple of 4096 (similarly if the user overrides the maximumwrite size by setting mount parm \"wsize\", but sets it to a value thatis not a multiple of 4096).  When negotiated write size is not amultiple of 4096 the netfs code can skip the end of the finalpage when doing large sequential writes, causing data corruption.This section of code is being rewritten/removed due to a largenetfs change, but until that point (ie for the 6.3 kernel until now)we can not support non-standard maximum write sizes.Add a warning if a user specifies a wsize on mount that is nota multiple of 4096 (and round down), also add a change where weround down the maximum write size if the server negotiates a valuethat is not a multiple of 4096 (we also have to check to make sure thatwe do not round it down to zero).","details":"In the Linux kernel, the following vulnerability has been resolved:smb: Fix regression in writes when non-standard maximum write size negotiatedThe conversion to netfs in the 6.3 kernel caused a regression whenmaximum write size is set by the server to an unexpected value which isnot a multiple of 4096 (similarly if the user overrides the maximumwrite size by setting mount parm \"wsize\", but sets it to a value thatis not a multiple of 4096).  When negotiated write size is not amultiple of 4096 the netfs code can skip the end of the finalpage when doing large sequential writes, causing data corruption.This section of code is being rewritten/removed due to a largenetfs change, but until that point (ie for the 6.3 kernel until now)we can not support non-standard maximum write sizes.Add a warning if a user specifies a wsize on mount that is nota multiple of 4096 (and round down), also add a change where weround down the maximum write size if the server negotiates a valuethat is not a multiple of 4096 (we also have to check to make sure thatwe do not round it down to zero).","references":["https://git.kernel.org/stable/c/4145ccff546ea868428b3e0fe6818c6261b574a9","https://git.kernel.org/stable/c/4860abb91f3d7fbaf8147d54782149bb1fc45892","https://git.kernel.org/stable/c/63c35afd50e28b49c5b75542045a8c42b696dab9"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.6.18",">=6.7",">=6.3","<6.7.6"]},
  {"id":"CVE-2024-26822","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: set correct id, uid and cruid for multiuser automountsWhen uid, gid and cruid are not specified, we need to dynamicallyset them into the filesystem context used for automounting otherwisethey'll end up reusing the values from the parent mount.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: set correct id, uid and cruid for multiuser automountsWhen uid, gid and cruid are not specified, we need to dynamicallyset them into the filesystem context used for automounting otherwisethey'll end up reusing the values from the parent mount.","references":["https://git.kernel.org/stable/c/4508ec17357094e2075f334948393ddedbb75157","https://git.kernel.org/stable/c/7590ba9057c6d74c66f3b909a383ec47cd2f27fb","https://git.kernel.org/stable/c/c2aa2718cda2d56b4a551cb40043e9abc9684626"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.6.18",">=6.7",">=6.2","<6.7.6"]},
  {"id":"CVE-2024-26928","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in cifs_debug_files_proc_show()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in cifs_debug_files_proc_show()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","references":["https://git.kernel.org/stable/c/229042314602db62559ecacba127067c22ee7b88","https://git.kernel.org/stable/c/3402faf78b2516b0af1259baff50cc8453ef0bd1","https://git.kernel.org/stable/c/8f8718afd446cd4ea3b62bacc3eec09f8aae85ee"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.6.26","<6.1.85","<6.8.5",">=6.7",">=6.2"]},
  {"id":"CVE-2024-26936","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: validate request buffer size in smb2_allocate_rsp_buf()The response buffer should be allocated in smb2_allocate_rsp_bufbefore validating request. But the fields in payload as well as smb2 headeris used in smb2_allocate_rsp_buf(). This patch add simple buffer sizevalidation to avoid potencial out-of-bounds in request buffer.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: validate request buffer size in smb2_allocate_rsp_buf()The response buffer should be allocated in smb2_allocate_rsp_bufbefore validating request. But the fields in payload as well as smb2 headeris used in smb2_allocate_rsp_buf(). This patch add simple buffer sizevalidation to avoid potencial out-of-bounds in request buffer.","references":["https://git.kernel.org/stable/c/17cf0c2794bdb6f39671265aa18aea5c22ee8c4a","https://git.kernel.org/stable/c/21ff9d7d223c5c19cb4334009e4c0c83a2f4d674","https://git.kernel.org/stable/c/2c27a64a2bc47d9bfc7c3cf8be14be53b1ee7cb6"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-26954","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix slab-out-of-bounds in smb_strndup_from_utf16()If ->NameOffset of smb2_create_req is smaller than Buffer offset ofsmb2_create_req, slab-out-of-bounds read can happen from smb2_open.This patch set the minimum value of the name offset to the buffer offsetto validate name length of smb2_create_req().","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix slab-out-of-bounds in smb_strndup_from_utf16()If ->NameOffset of smb2_create_req is smaller than Buffer offset ofsmb2_create_req, slab-out-of-bounds read can happen from smb2_open.This patch set the minimum value of the name offset to the buffer offsetto validate name length of smb2_create_req().","references":["https://git.kernel.org/stable/c/3b8da67191e938a63d2736dabb4ac5d337e5de57","https://git.kernel.org/stable/c/4f97e6a9d62cb1fce82fbf4baff44b83221bc178","https://git.kernel.org/stable/c/a80a486d72e20bd12c335bcd38b6e6f19356b0aa"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<6.1.119",">=6.8","<6.7.12","<6.8.3",">=6.2"],[">=5.15"]]},
  {"id":"CVE-2024-26980","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix slab-out-of-bounds in smb2_allocate_rsp_bufIf ->ProtocolId is SMB2_TRANSFORM_PROTO_NUM, smb2 request sizevalidation could be skipped. if request size is smaller thansizeof(struct smb2_query_info_req), slab-out-of-bounds read can happen insmb2_allocate_rsp_buf(). This patch allocate response buffer afterdecrypting transform request. smb3_decrypt_req() will validate transformrequest size and avoid slab-out-of-bound in smb2_allocate_rsp_buf().","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix slab-out-of-bounds in smb2_allocate_rsp_bufIf ->ProtocolId is SMB2_TRANSFORM_PROTO_NUM, smb2 request sizevalidation could be skipped. if request size is smaller thansizeof(struct smb2_query_info_req), slab-out-of-bounds read can happen insmb2_allocate_rsp_buf(). This patch allocate response buffer afterdecrypting transform request. smb3_decrypt_req() will validate transformrequest size and avoid slab-out-of-bound in smb2_allocate_rsp_buf().","references":["https://git.kernel.org/stable/c/0977f89722eceba165700ea384f075143f012085","https://git.kernel.org/stable/c/3160d9734453a40db248487f8204830879c207f1","https://git.kernel.org/stable/c/b80ba648714e6d790d69610cf14656be222d0248"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<6.6.29","<6.8.8",">=6.7","<6.1.88",">=6.2"],[">=5.16",">=5.15","<5.15.159"]]},
  {"id":"CVE-2024-35861","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in cifs_signal_cifsd_for_reconnect()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in cifs_signal_cifsd_for_reconnect()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","references":["https://git.kernel.org/stable/c/2cfff21732132e363b4cc275d63ea98f1af726c1","https://git.kernel.org/stable/c/7e8360ac8774e19b0b25f44fff84a105bb2417e4","https://git.kernel.org/stable/c/e0e50401cc3921c9eaf1b0e667db174519ea939f"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.6.26","<6.1.85","<6.8.5",">=6.7",">=6.2"]},
  {"id":"CVE-2024-35862","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in smb2_is_network_name_deleted()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in smb2_is_network_name_deleted()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","references":["https://git.kernel.org/stable/c/63981561ffd2d4987807df4126f96a11e18b0c1d","https://git.kernel.org/stable/c/aa582b33f94453fdeaff1e7d0aa252c505975e01","https://git.kernel.org/stable/c/d919b6ea15ffa56fbafef4a1d92f47aeda9af645"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.6.26","<6.1.85","<6.8.5",">=6.7",">=6.2"]},
  {"id":"CVE-2024-35863","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in is_valid_oplock_break()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in is_valid_oplock_break()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","references":["https://git.kernel.org/stable/c/0a15ba88a32fa7a516aff7ffd27befed5334dff2","https://git.kernel.org/stable/c/16d58c6a7db5050b9638669084b63fc05f951825","https://git.kernel.org/stable/c/494c91e1e9413b407d12166a61b84200d4d54fac"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.6.26","<6.1.85","<6.8.5",">=6.7",">=6.2"]},
  {"id":"CVE-2024-35864","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in smb2_is_valid_lease_break()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in smb2_is_valid_lease_break()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","references":["https://git.kernel.org/stable/c/705c76fbf726c7a2f6ff9143d4013b18daaaebf1","https://git.kernel.org/stable/c/a8344e2b69bde63f713b0aa796d70dbeadffddfb","https://git.kernel.org/stable/c/c868cabdf6fdd61bea54532271f4708254e57fc5"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.6.26","<6.1.85","<6.8.5",">=6.7",">=6.2"]},
  {"id":"CVE-2024-35865","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in smb2_is_valid_oplock_break()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in smb2_is_valid_oplock_break()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","references":["https://git.kernel.org/stable/c/21fed37d2bdcde33453faf61d3d4d96c355f04bd","https://git.kernel.org/stable/c/22863485a4626ec6ecf297f4cc0aef709bc862e4","https://git.kernel.org/stable/c/3dba0e5276f131e36d6d8043191d856f49238628"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.6.26","<6.1.85","<6.8.5",">=6.7",">=6.2"]},
  {"id":"CVE-2024-35866","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in cifs_dump_full_key()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in cifs_dump_full_key()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","references":["https://git.kernel.org/stable/c/10e17ca4000ec34737bde002a13435c38ace2682","https://git.kernel.org/stable/c/3103163ccd3be4adcfa37e15608fb497be044113","https://git.kernel.org/stable/c/58acd1f497162e7d282077f816faa519487be045"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.8.5",">=6.7","<6.6.26"]},
  {"id":"CVE-2024-35867","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in cifs_stats_proc_show()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in cifs_stats_proc_show()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","references":["https://git.kernel.org/stable/c/0865ffefea197b437ba78b5dd8d8e256253efd65","https://git.kernel.org/stable/c/16b7d785775eb03929766819415055e367398f49","https://git.kernel.org/stable/c/1e12f0d5c66f07c934041621351973a116fa13c7"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.6.26","<6.1.85","<6.8.5",">=6.7",">=6.2"]},
  {"id":"CVE-2024-35868","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in cifs_stats_proc_write()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential UAF in cifs_stats_proc_write()Skip sessions that are being teared down (status == SES_EXITING) toavoid UAF.","references":["https://git.kernel.org/stable/c/5b5475ce69f02ecc1b13ea23106e5b89c690429b","https://git.kernel.org/stable/c/8fefd166fcb368c5fcf48238e3f7c8af829e0a72","https://git.kernel.org/stable/c/cf03020c56d3ed28c4942280957a007b5e9544f7"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.6.26","<6.1.85","<6.8.5",">=6.7",">=6.2"]},
  {"id":"CVE-2024-35869","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: guarantee refcounted children from parent sessionAvoid potential use-after-free bugs when walking DFS referrals,mounting and performing DFS failover by ensuring that all childrenfrom parent @tcon->ses are also refcounted.  They're all needed acrossthe entire DFS mount.  Get rid of @tcon->dfs_ses_list while we're atit, too.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: guarantee refcounted children from parent sessionAvoid potential use-after-free bugs when walking DFS referrals,mounting and performing DFS failover by ensuring that all childrenfrom parent @tcon->ses are also refcounted.  They're all needed acrossthe entire DFS mount.  Get rid of @tcon->dfs_ses_list while we're atit, too.","references":["https://git.kernel.org/stable/c/062a7f0ff46eb57aff526897bd2bebfdb1d3046a","https://git.kernel.org/stable/c/645f332c6b63499cc76197f9b6bffcc659ba64cc","https://git.kernel.org/stable/c/e1db9ae87b7148c021daee1fcc4bc71b2ac58a79"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.8.5",">=6.7","<6.6.29"]},
  {"id":"CVE-2024-35870","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix UAF in smb2_reconnect_server()The UAF bug is due to smb2_reconnect_server() accessing a session thatis already being teared down by another thread that is executing__cifs_put_smb_ses().  This can happen when (a) the client hasconnection to the server but no session or (b) another thread ends upsetting @ses->ses_status again to something different thanSES_EXITING.To fix this, we need to make sure to unconditionally set@ses->ses_status to SES_EXITING and prevent any other threads fromsetting a new status while we're still tearing it down.The following can be reproduced by adding some delay to right afterthe ipc is freed in __cifs_put_smb_ses() - which will givesmb2_reconnect_server() worker a chance to run and then accessing@ses->ipc:kinit ...mount.cifs //srv/share /mnt/1 -o sec=krb5,nohandlecache,echo_interval=10[disconnect srv]ls /mnt/1 &>/dev/nullsleep 30kdestroy[reconnect srv]sleep 10umount /mnt/1...CIFS: VFS: Verify user has a krb5 ticket and keyutils is installedCIFS: VFS: \\\\srv Send error in SessSetup = -126CIFS: VFS: Verify user has a krb5 ticket and keyutils is installedCIFS: VFS: \\\\srv Send error in SessSetup = -126general protection fault, probably for non-canonical address0x6b6b6b6b6b6b6b6b: 0000 [#1] PREEMPT SMP NOPTICPU: 3 PID: 50 Comm: kworker/3:1 Not tainted 6.9.0-rc2 #1Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-1.fc3904/01/2014Workqueue: cifsiod smb2_reconnect_server [cifs]RIP: 0010:__list_del_entry_valid_or_report+0x33/0xf0Code: 4f 08 48 85 d2 74 42 48 85 c9 74 59 48 b8 00 01 00 00 00 00 adde 48 39 c2 74 61 48 b8 22 01 00 00 00 00 74 69 <48> 8b 01 48 39 f8 757b 48 8b 72 08 48 39 c6 0f 85 88 00 00 00 b8RSP: 0018:ffffc900001bfd70 EFLAGS: 00010a83RAX: dead000000000122 RBX: ffff88810da53838 RCX: 6b6b6b6b6b6b6b6bRDX: 6b6b6b6b6b6b6b6b RSI: ffffffffc02f6878 RDI: ffff88810da53800RBP: ffff88810da53800 R08: 0000000000000001 R09: 0000000000000000R10: 0000000000000000 R11: 0000000000000001 R12: ffff88810c064000R13: 0000000000000001 R14: ffff88810c064000 R15: ffff8881039cc000FS: 0000000000000000(0000) GS:ffff888157c00000(0000)knlGS:0000000000000000CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033CR2: 00007fe3728b1000 CR3: 000000010caa4000 CR4: 0000000000750ef0PKRU: 55555554Call Trace: <TASK> ? die_addr+0x36/0x90 ? exc_general_protection+0x1c1/0x3f0 ? asm_exc_general_protection+0x26/0x30 ? __list_del_entry_valid_or_report+0x33/0xf0 __cifs_put_smb_ses+0x1ae/0x500 [cifs] smb2_reconnect_server+0x4ed/0x710 [cifs] process_one_work+0x205/0x6b0 worker_thread+0x191/0x360 ? __pfx_worker_thread+0x10/0x10 kthread+0xe2/0x110 ? __pfx_kthread+0x10/0x10 ret_from_fork+0x34/0x50 ? __pfx_kthread+0x10/0x10 ret_from_fork_asm+0x1a/0x30 </TASK>","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix UAF in smb2_reconnect_server()The UAF bug is due to smb2_reconnect_server() accessing a session thatis already being teared down by another thread that is executing__cifs_put_smb_ses().  This can happen when (a) the client hasconnection to the server but no session or (b) another thread ends upsetting @ses->ses_status again to something different thanSES_EXITING.To fix this, we need to make sure to unconditionally set@ses->ses_status to SES_EXITING and prevent any other threads fromsetting a new status while we're still tearing it down.The following can be reproduced by adding some delay to right afterthe ipc is freed in __cifs_put_smb_ses() - which will givesmb2_reconnect_server() worker a chance to run and then accessing@ses->ipc:kinit ...mount.cifs //srv/share /mnt/1 -o sec=krb5,nohandlecache,echo_interval=10[disconnect srv]ls /mnt/1 &>/dev/nullsleep 30kdestroy[reconnect srv]sleep 10umount /mnt/1...CIFS: VFS: Verify user has a krb5 ticket and keyutils is installedCIFS: VFS: \\\\srv Send error in SessSetup = -126CIFS: VFS: Verify user has a krb5 ticket and keyutils is installedCIFS: VFS: \\\\srv Send error in SessSetup = -126general protection fault, probably for non-canonical address0x6b6b6b6b6b6b6b6b: 0000 [#1] PREEMPT SMP NOPTICPU: 3 PID: 50 Comm: kworker/3:1 Not tainted 6.9.0-rc2 #1Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-1.fc3904/01/2014Workqueue: cifsiod smb2_reconnect_server [cifs]RIP: 0010:__list_del_entry_valid_or_report+0x33/0xf0Code: 4f 08 48 85 d2 74 42 48 85 c9 74 59 48 b8 00 01 00 00 00 00 adde 48 39 c2 74 61 48 b8 22 01 00 00 00 00 74 69 <48> 8b 01 48 39 f8 757b 48 8b 72 08 48 39 c6 0f 85 88 00 00 00 b8RSP: 0018:ffffc900001bfd70 EFLAGS: 00010a83RAX: dead000000000122 RBX: ffff88810da53838 RCX: 6b6b6b6b6b6b6b6bRDX: 6b6b6b6b6b6b6b6b RSI: ffffffffc02f6878 RDI: ffff88810da53800RBP: ffff88810da53800 R08: 0000000000000001 R09: 0000000000000000R10: 0000000000000000 R11: 0000000000000001 R12: ffff88810c064000R13: 0000000000000001 R14: ffff88810c064000 R15: ffff8881039cc000FS: 0000000000000000(0000) GS:ffff888157c00000(0000)knlGS:0000000000000000CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033CR2: 00007fe3728b1000 CR3: 000000010caa4000 CR4: 0000000000750ef0PKRU: 55555554Call Trace: <TASK> ? die_addr+0x36/0x90 ? exc_general_protection+0x1c1/0x3f0 ? asm_exc_general_protection+0x26/0x30 ? __list_del_entry_valid_or_report+0x33/0xf0 __cifs_put_smb_ses+0x1ae/0x500 [cifs] smb2_reconnect_server+0x4ed/0x710 [cifs] process_one_work+0x205/0x6b0 worker_thread+0x191/0x360 ? __pfx_worker_thread+0x10/0x10 kthread+0xe2/0x110 ? __pfx_kthread+0x10/0x10 ret_from_fork+0x34/0x50 ? __pfx_kthread+0x10/0x10 ret_from_fork_asm+0x1a/0x30 </TASK>","references":["https://git.kernel.org/stable/c/24a9799aa8efecd0eb55a75e35f9d8e6400063aa","https://git.kernel.org/stable/c/45f2beda1f1bc3d962ec07db1ccc3197c25499a5","https://git.kernel.org/stable/c/6202996a1c1887e83d0b3b0fcd86d0e5e6910ea0"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.1.121","<6.6.29","<6.8.5",">=6.7",">=6.2"]},
  {"id":"CVE-2024-35984","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:i2c: smbus: fix NULL function pointer dereferenceBaruch reported an OOPS when using the designware controller as targetonly. Target-only modes break the assumption of one transfer functionalways being available. Fix this by always checking the pointer in__i2c_transfer.[wsa: dropped the simplification in core-smbus to avoid theoretical regressions]","details":"In the Linux kernel, the following vulnerability has been resolved:i2c: smbus: fix NULL function pointer dereferenceBaruch reported an OOPS when using the designware controller as targetonly. Target-only modes break the assumption of one transfer functionalways being available. Fix this by always checking the pointer in__i2c_transfer.[wsa: dropped the simplification in core-smbus to avoid theoretical regressions]","references":["https://git.kernel.org/stable/c/357c64ef1ef39b1e7cd91ab6bdd304d043702c83","https://git.kernel.org/stable/c/40f1d79f07b49c8a64a861706e5163f2db4bd95d","https://git.kernel.org/stable/c/4e75e222d397c6752b229ed72fc4644c8c36ecde"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[[">=5.5",">=5.16",">=5.11","<5.10.216","<5.15.158","<5.4.275"],["<6.8.9","<6.6.30",">=6.7","<6.1.90",">=6.2"],["<4.19.313",">=4.20"],[">=3.19"]]},
  {"id":"CVE-2024-35998","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb3: fix lock ordering potential deadlock in cifs_sync_mid_resultCoverity spotted that the cifs_sync_mid_result function could deadlock\"Thread deadlock (ORDER_REVERSAL) lock_order: Calling spin_lock acquireslock TCP_Server_Info.srv_lock while holding lock TCP_Server_Info.mid_lock\"Addresses-Coverity: 1590401 (\"Thread deadlock (ORDER_REVERSAL)\")","details":"In the Linux kernel, the following vulnerability has been resolved:smb3: fix lock ordering potential deadlock in cifs_sync_mid_resultCoverity spotted that the cifs_sync_mid_result function could deadlock\"Thread deadlock (ORDER_REVERSAL) lock_order: Calling spin_lock acquireslock TCP_Server_Info.srv_lock while holding lock TCP_Server_Info.mid_lock\"Addresses-Coverity: 1590401 (\"Thread deadlock (ORDER_REVERSAL)\")","references":["https://git.kernel.org/stable/c/699f8958dece132709c0bff6a9700999a2a63b75","https://git.kernel.org/stable/c/8248224ab5b8ca7559b671917c224296a4d671fc","https://git.kernel.org/stable/c/8861fd5180476f45f9e8853db154600469a0284f"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.1.90",">=6.7","<6.8.9","<6.6.30",">=6.2"]},
  {"id":"CVE-2024-35999","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb3: missing lock when picking channelCoverity spotted a place where we should have been holding thechannel lock when accessing the ses channel index.Addresses-Coverity: 1582039 (\"Data race condition (MISSING_LOCK)\")","details":"In the Linux kernel, the following vulnerability has been resolved:smb3: missing lock when picking channelCoverity spotted a place where we should have been holding thechannel lock when accessing the ses channel index.Addresses-Coverity: 1582039 (\"Data race condition (MISSING_LOCK)\")","references":["https://git.kernel.org/stable/c/0fcf7e219448e937681216353c9a58abae6d3c2e","https://git.kernel.org/stable/c/60ab245292280905603bc0d3654f4cf8fceccb00","https://git.kernel.org/stable/c/8094a600245e9b28eb36a13036f202ad67c1f887"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.1.91",">=6.7","<6.8.9","<6.6.30",">=6.2"]},
  {"id":"CVE-2024-39468","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix deadlock in smb2_find_smb_tcon()Unlock cifs_tcp_ses_lock before calling cifs_put_smb_ses() to avoid suchdeadlock.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix deadlock in smb2_find_smb_tcon()Unlock cifs_tcp_ses_lock before calling cifs_put_smb_ses() to avoid suchdeadlock.","references":["https://git.kernel.org/stable/c/02c418774f76a0a36a6195c9dbf8971eb4130a15","https://git.kernel.org/stable/c/21f5dd36e655d25a7b45b61c1e537198b671f720","https://git.kernel.org/stable/c/225de871ddf994f69a57f035709cad9c0ab8615a"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<6.6.34","<6.9.5",">=6.7",">=6.2","<6.1.94"],["<5.10.221",">=5.11",">=5.16","<5.15.162"]]},
  {"id":"CVE-2024-41030","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: discard write access to the directory openmay_open() does not allow a directory to be opened with the write access.However, some writing flags set by client result in adding write accesson server, making ksmbd incompatible with FUSE file system. Simply, let'sdiscard the write access when opening a directory.list_add corruption. next is NULL.------------[ cut here ]------------kernel BUG at lib/list_debug.c:26!pc : __list_add_valid+0x88/0xbclr : __list_add_valid+0x88/0xbcCall trace:__list_add_valid+0x88/0xbcfuse_finish_open+0x11c/0x170fuse_open_common+0x284/0x5e8fuse_dir_open+0x14/0x24do_dentry_open+0x2a4/0x4e0dentry_open+0x50/0x80smb2_open+0xbe4/0x15a4handle_ksmbd_work+0x478/0x5ecprocess_one_work+0x1b4/0x448worker_thread+0x25c/0x430kthread+0x104/0x1d4ret_from_fork+0x10/0x20","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: discard write access to the directory openmay_open() does not allow a directory to be opened with the write access.However, some writing flags set by client result in adding write accesson server, making ksmbd incompatible with FUSE file system. Simply, let'sdiscard the write access when opening a directory.list_add corruption. next is NULL.------------[ cut here ]------------kernel BUG at lib/list_debug.c:26!pc : __list_add_valid+0x88/0xbclr : __list_add_valid+0x88/0xbcCall trace:__list_add_valid+0x88/0xbcfuse_finish_open+0x11c/0x170fuse_open_common+0x284/0x5e8fuse_dir_open+0x14/0x24do_dentry_open+0x2a4/0x4e0dentry_open+0x50/0x80smb2_open+0xbe4/0x15a4handle_ksmbd_work+0x478/0x5ecprocess_one_work+0x1b4/0x448worker_thread+0x25c/0x430kthread+0x104/0x1d4ret_from_fork+0x10/0x20","references":["https://git.kernel.org/stable/c/198498b2049c0f11f7670be6974570e02b0cc035","https://git.kernel.org/stable/c/66cf853e1c7a2407f15d9f7aaa3e47d61745e361","https://git.kernel.org/stable/c/9e84b1ba5c98fb5c9f869c85db1d870354613baa"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-42256","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:cifs: Fix server re-repick on subrequest retryWhen a subrequest is marked for needing retry, netfs will callcifs_prepare_write() which will make cifs repick the server for the opbefore renegotiating credits; it then calls cifs_issue_write() whichinvokes smb2_async_writev() - which re-repicks the server.If a different server is then selected, this causes the increment ofserver->in_flight to happen against one record and the decrement to happenagainst another, leading to misaccounting.Fix this by just removing the repick code in smb2_async_writev().  As thisis only called from netfslib-driven code, cifs_prepare_write() shouldalways have been called first, and so server should never be NULL and thepreparatory step is repeated in the event that we do a retry.The problem manifests as a warning looking something like: WARNING: CPU: 4 PID: 72896 at fs/smb/client/smb2ops.c:97 smb2_add_credits+0x3f0/0x9e0 [cifs] ... RIP: 0010:smb2_add_credits+0x3f0/0x9e0 [cifs] ...  smb2_writev_callback+0x334/0x560 [cifs]  cifs_demultiplex_thread+0x77a/0x11b0 [cifs]  kthread+0x187/0x1d0  ret_from_fork+0x34/0x60  ret_from_fork_asm+0x1a/0x30Which may be triggered by a number of different xfstests running against anAzure server in multichannel mode.  generic/249 seems the most repeatable,but generic/215, generic/249 and generic/308 may also show it.","details":"In the Linux kernel, the following vulnerability has been resolved:cifs: Fix server re-repick on subrequest retryWhen a subrequest is marked for needing retry, netfs will callcifs_prepare_write() which will make cifs repick the server for the opbefore renegotiating credits; it then calls cifs_issue_write() whichinvokes smb2_async_writev() - which re-repicks the server.If a different server is then selected, this causes the increment ofserver->in_flight to happen against one record and the decrement to happenagainst another, leading to misaccounting.Fix this by just removing the repick code in smb2_async_writev().  As thisis only called from netfslib-driven code, cifs_prepare_write() shouldalways have been called first, and so server should never be NULL and thepreparatory step is repeated in the event that we do a retry.The problem manifests as a warning looking something like: WARNING: CPU: 4 PID: 72896 at fs/smb/client/smb2ops.c:97 smb2_add_credits+0x3f0/0x9e0 [cifs] ... RIP: 0010:smb2_add_credits+0x3f0/0x9e0 [cifs] ...  smb2_writev_callback+0x334/0x560 [cifs]  cifs_demultiplex_thread+0x77a/0x11b0 [cifs]  kthread+0x187/0x1d0  ret_from_fork+0x34/0x60  ret_from_fork_asm+0x1a/0x30Which may be triggered by a number of different xfstests running against anAzure server in multichannel mode.  generic/249 seems the most repeatable,but generic/215, generic/249 and generic/308 may also show it.","references":["https://git.kernel.org/stable/c/b1d0a566769b6fb3795b5289fc1daf9e0638d97a","https://git.kernel.org/stable/c/de40579b903883274fe203865f29d66b168b7236"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":["<6.10.1",">=6.10"]},
  {"id":"CVE-2024-43394","product":"smb","summary":"Server-Side Request Forgery (SSRF) in Apache HTTP Server on Windows allows to potentially leak NTLM hashes to a malicious server via mod_rewrite or apache expressions that pass unvalidated request input.This issue affects Apache HTTP Server: from 2.4.0 through 2.4.63.Note:  The Apache HTTP Server Project will be setting a higher bar for accepting vulnerability reports regarding SSRF via UNC paths. The server offers limited protection against administrators directing the server to open UNC paths.Windows servers should limit the hosts they will connect over via SMB based on the nature of NTLM authentication.","details":"Server-Side Request Forgery (SSRF) in Apache HTTP Server on Windows allows to potentially leak NTLM hashes to a malicious server via mod_rewrite or apache expressions that pass unvalidated request input.This issue affects Apache HTTP Server: from 2.4.0 through 2.4.63.Note:  The Apache HTTP Server Project will be setting a higher bar for accepting vulnerability reports regarding SSRF via UNC paths. The server offers limited protection against administrators directing the server to open UNC paths.Windows servers should limit the hosts they will connect over via SMB based on the nature of NTLM authentication.","references":["https://httpd.apache.org/security/vulnerabilities_24.html"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-43447","product":"smb","summary":"Windows SMBv3 Server Remote Code Execution Vulnerability","details":"Windows SMBv3 Server Remote Code Execution Vulnerability","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-43447"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":"<10.0.20348.2849"},
  {"id":"CVE-2024-43642","product":"smb","summary":"Windows SMB Denial of Service Vulnerability","details":"Windows SMB Denial of Service Vulnerability","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-43642"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<10.0.22621.4460","<10.0.25398.1251","<10.0.22631.4460","<10.0.20348.2849","<10.0.26100.2314"]},
  {"id":"CVE-2024-44992","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb/client: avoid possible NULL dereference in cifs_free_subrequest()Clang static checker (scan-build) warning:cifsglob.h:line 890, column 3Access to field 'ops' results in a dereference of a null pointer.Commit 519be989717c (\"cifs: Add a tracepoint to track credits involved inR/W requests\") adds a check for 'rdata->server', and let clang throw thiswarning about NULL dereference.When 'rdata->credits.value != 0 && rdata->server == NULL' happens,add_credits_and_wake_if() will call rdata->server->ops->add_credits().This will cause NULL dereference problem. Add a check for 'rdata->server'to avoid NULL dereference.","details":"In the Linux kernel, the following vulnerability has been resolved:smb/client: avoid possible NULL dereference in cifs_free_subrequest()Clang static checker (scan-build) warning:cifsglob.h:line 890, column 3Access to field 'ops' results in a dereference of a null pointer.Commit 519be989717c (\"cifs: Add a tracepoint to track credits involved inR/W requests\") adds a check for 'rdata->server', and let clang throw thiswarning about NULL dereference.When 'rdata->credits.value != 0 && rdata->server == NULL' happens,add_credits_and_wake_if() will call rdata->server->ops->add_credits().This will cause NULL dereference problem. Add a check for 'rdata->server'to avoid NULL dereference.","references":["https://git.kernel.org/stable/c/74c2ab6d653b4c2354df65a7f7f2df1925a40a51","https://git.kernel.org/stable/c/fead60a6d5f84b472b928502a42c419253afe6c1"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.10.7",">=6.10"]},
  {"id":"CVE-2024-46686","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb/client: avoid dereferencing rdata=NULL in smb2_new_read_req()This happens when called from SMB2_read() while using rdmaand reaching the rdma_readwrite_threshold.","details":"In the Linux kernel, the following vulnerability has been resolved:smb/client: avoid dereferencing rdata=NULL in smb2_new_read_req()This happens when called from SMB2_read() while using rdmaand reaching the rdma_readwrite_threshold.","references":["https://git.kernel.org/stable/c/6df57c63c200cd05e085c3b695128260e21959b7","https://git.kernel.org/stable/c/a01859dd6aebf826576513850a3b05992809e9d2","https://git.kernel.org/stable/c/b902fb78ab21299e4dd1775e7e8d251d5c0735bc"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.1.108","<6.6.49","<6.10.8",">=6.1.16",">=6.3",">=6.7"]},
  {"id":"CVE-2024-46736","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix double put of @cfile in smb2_rename_path()If smb2_set_path_attr() is called with a valid @cfile and returned-EINVAL, we need to call cifs_get_writable_path() again as thereference of @cfile was already dropped by previous smb2_compound_op()call.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix double put of @cfile in smb2_rename_path()If smb2_set_path_attr() is called with a valid @cfile and returned-EINVAL, we need to call cifs_get_writable_path() again as thereference of @cfile was already dropped by previous smb2_compound_op()call.","references":["https://git.kernel.org/stable/c/1a46c7f6546b73cbf36f5a618a1a6bbb45391eb3","https://git.kernel.org/stable/c/3523a3df03c6f04f7ea9c2e7050102657e331a4f","https://git.kernel.org/stable/c/b27ea9c96efd2c252a981fb00d0f001b86c90f3e"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-46742","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb/server: fix potential null-ptr-deref of lease_ctx_info in smb2_open()null-ptr-deref will occur when (req_op_level == SMB2_OPLOCK_LEVEL_LEASE)and parse_lease_state() return NULL.Fix this by check if 'lease_ctx_info' is NULL.Additionally, remove the redundant parentheses inparse_durable_handle_context().","details":"In the Linux kernel, the following vulnerability has been resolved:smb/server: fix potential null-ptr-deref of lease_ctx_info in smb2_open()null-ptr-deref will occur when (req_op_level == SMB2_OPLOCK_LEVEL_LEASE)and parse_lease_state() return NULL.Fix this by check if 'lease_ctx_info' is NULL.Additionally, remove the redundant parentheses inparse_durable_handle_context().","references":["https://git.kernel.org/stable/c/07f384c5be1f8633b13f0a22616e227570450bc6","https://git.kernel.org/stable/c/3b692794b81f2ecad69a4adbba687f3836824ada","https://git.kernel.org/stable/c/4e8771a3666c8f216eefd6bd2fd50121c6c437db"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.6.51",">=6.7","<6.10.10"]},
  {"id":"CVE-2024-46795","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: unset the binding mark of a reused connectionSteve French reported null pointer dereference error from sha256 lib.cifs.ko can send session setup requests on reused connection.If reused connection is used for binding session, conn->binding canstill remain true and generate_preauth_hash() will not setsess->Preauth_HashValue and it will be NULL.It is used as a material to create an encryption key inksmbd_gen_smb311_encryptionkey. ->Preauth_HashValue cause null pointerdereference error from crypto_shash_update().BUG: kernel NULL pointer dereference, address: 0000000000000000#PF: supervisor read access in kernel mode#PF: error_code(0x0000) - not-present pagePGD 0 P4D 0Oops: 0000 [#1] PREEMPT SMP PTICPU: 8 PID: 429254 Comm: kworker/8:39Hardware name: LENOVO 20MAS08500/20MAS08500, BIOS N2CET69W (1.52 )Workqueue: ksmbd-io handle_ksmbd_work [ksmbd]RIP: 0010:lib_sha256_base_do_update.isra.0+0x11e/0x1d0 [sha256_ssse3]<TASK>? show_regs+0x6d/0x80? __die+0x24/0x80? page_fault_oops+0x99/0x1b0? do_user_addr_fault+0x2ee/0x6b0? exc_page_fault+0x83/0x1b0? asm_exc_page_fault+0x27/0x30? __pfx_sha256_transform_rorx+0x10/0x10 [sha256_ssse3]? lib_sha256_base_do_update.isra.0+0x11e/0x1d0 [sha256_ssse3]? __pfx_sha256_transform_rorx+0x10/0x10 [sha256_ssse3]? __pfx_sha256_transform_rorx+0x10/0x10 [sha256_ssse3]_sha256_update+0x77/0xa0 [sha256_ssse3]sha256_avx2_update+0x15/0x30 [sha256_ssse3]crypto_shash_update+0x1e/0x40hmac_update+0x12/0x20crypto_shash_update+0x1e/0x40generate_key+0x234/0x380 [ksmbd]generate_smb3encryptionkey+0x40/0x1c0 [ksmbd]ksmbd_gen_smb311_encryptionkey+0x72/0xa0 [ksmbd]ntlm_authenticate.isra.0+0x423/0x5d0 [ksmbd]smb2_sess_setup+0x952/0xaa0 [ksmbd]__process_request+0xa3/0x1d0 [ksmbd]__handle_ksmbd_work+0x1c4/0x2f0 [ksmbd]handle_ksmbd_work+0x2d/0xa0 [ksmbd]process_one_work+0x16c/0x350worker_thread+0x306/0x440? __pfx_worker_thread+0x10/0x10kthread+0xef/0x120? __pfx_kthread+0x10/0x10ret_from_fork+0x44/0x70? __pfx_kthread+0x10/0x10ret_from_fork_asm+0x1b/0x30</TASK>","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: unset the binding mark of a reused connectionSteve French reported null pointer dereference error from sha256 lib.cifs.ko can send session setup requests on reused connection.If reused connection is used for binding session, conn->binding canstill remain true and generate_preauth_hash() will not setsess->Preauth_HashValue and it will be NULL.It is used as a material to create an encryption key inksmbd_gen_smb311_encryptionkey. ->Preauth_HashValue cause null pointerdereference error from crypto_shash_update().BUG: kernel NULL pointer dereference, address: 0000000000000000#PF: supervisor read access in kernel mode#PF: error_code(0x0000) - not-present pagePGD 0 P4D 0Oops: 0000 [#1] PREEMPT SMP PTICPU: 8 PID: 429254 Comm: kworker/8:39Hardware name: LENOVO 20MAS08500/20MAS08500, BIOS N2CET69W (1.52 )Workqueue: ksmbd-io handle_ksmbd_work [ksmbd]RIP: 0010:lib_sha256_base_do_update.isra.0+0x11e/0x1d0 [sha256_ssse3]<TASK>? show_regs+0x6d/0x80? __die+0x24/0x80? page_fault_oops+0x99/0x1b0? do_user_addr_fault+0x2ee/0x6b0? exc_page_fault+0x83/0x1b0? asm_exc_page_fault+0x27/0x30? __pfx_sha256_transform_rorx+0x10/0x10 [sha256_ssse3]? lib_sha256_base_do_update.isra.0+0x11e/0x1d0 [sha256_ssse3]? __pfx_sha256_transform_rorx+0x10/0x10 [sha256_ssse3]? __pfx_sha256_transform_rorx+0x10/0x10 [sha256_ssse3]_sha256_update+0x77/0xa0 [sha256_ssse3]sha256_avx2_update+0x15/0x30 [sha256_ssse3]crypto_shash_update+0x1e/0x40hmac_update+0x12/0x20crypto_shash_update+0x1e/0x40generate_key+0x234/0x380 [ksmbd]generate_smb3encryptionkey+0x40/0x1c0 [ksmbd]ksmbd_gen_smb311_encryptionkey+0x72/0xa0 [ksmbd]ntlm_authenticate.isra.0+0x423/0x5d0 [ksmbd]smb2_sess_setup+0x952/0xaa0 [ksmbd]__process_request+0xa3/0x1d0 [ksmbd]__handle_ksmbd_work+0x1c4/0x2f0 [ksmbd]handle_ksmbd_work+0x2d/0xa0 [ksmbd]process_one_work+0x16c/0x350worker_thread+0x306/0x440? __pfx_worker_thread+0x10/0x10kthread+0xef/0x120? __pfx_kthread+0x10/0x10ret_from_fork+0x44/0x70? __pfx_kthread+0x10/0x10ret_from_fork_asm+0x1b/0x30</TASK>","references":["https://git.kernel.org/stable/c/41bc256da7e47b679df87c7fc7a5b393052b9cce","https://git.kernel.org/stable/c/4c8496f44f5bb5c06cdef5eb130ab259643392a1","https://git.kernel.org/stable/c/78c5a6f1f630172b19af4912e755e1da93ef0ab5"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<6.6.51",">=6.7","<6.1.110",">=6.2","<6.10.10"],[">=5.16",">=5.15","<5.15.167"]]},
  {"id":"CVE-2024-46796","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix double put of @cfile in smb2_set_path_size()If smb2_compound_op() is called with a valid @cfile and returned-EINVAL, we need to call cifs_get_writable_path() before retrying itas the reference of @cfile was already dropped by previous call.This fixes the following KASAN splat when running fstests generic/013against Windows Server 2022:  CIFS: Attempting to mount //w22-fs0/scratch  run fstests generic/013 at 2024-09-02 19:48:59  ==================================================================  BUG: KASAN: slab-use-after-free in detach_if_pending+0xab/0x200  Write of size 8 at addr ffff88811f1a3730 by task kworker/3:2/176  CPU: 3 UID: 0 PID: 176 Comm: kworker/3:2 Not tainted 6.11.0-rc6 #2  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-2.fc40  04/01/2014  Workqueue: cifsoplockd cifs_oplock_break [cifs]  Call Trace:   <TASK>   dump_stack_lvl+0x5d/0x80   ? detach_if_pending+0xab/0x200   print_report+0x156/0x4d9   ? detach_if_pending+0xab/0x200   ? __virt_addr_valid+0x145/0x300   ? __phys_addr+0x46/0x90   ? detach_if_pending+0xab/0x200   kasan_report+0xda/0x110   ? detach_if_pending+0xab/0x200   detach_if_pending+0xab/0x200   timer_delete+0x96/0xe0   ? __pfx_timer_delete+0x10/0x10   ? rcu_is_watching+0x20/0x50   try_to_grab_pending+0x46/0x3b0   __cancel_work+0x89/0x1b0   ? __pfx___cancel_work+0x10/0x10   ? kasan_save_track+0x14/0x30   cifs_close_deferred_file+0x110/0x2c0 [cifs]   ? __pfx_cifs_close_deferred_file+0x10/0x10 [cifs]   ? __pfx_down_read+0x10/0x10   cifs_oplock_break+0x4c1/0xa50 [cifs]   ? __pfx_cifs_oplock_break+0x10/0x10 [cifs]   ? lock_is_held_type+0x85/0xf0   ? mark_held_locks+0x1a/0x90   process_one_work+0x4c6/0x9f0   ? find_held_lock+0x8a/0xa0   ? __pfx_process_one_work+0x10/0x10   ? lock_acquired+0x220/0x550   ? __list_add_valid_or_report+0x37/0x100   worker_thread+0x2e4/0x570   ? __kthread_parkme+0xd1/0xf0   ? __pfx_worker_thread+0x10/0x10   kthread+0x17f/0x1c0   ? kthread+0xda/0x1c0   ? __pfx_kthread+0x10/0x10   ret_from_fork+0x31/0x60   ? __pfx_kthread+0x10/0x10   ret_from_fork_asm+0x1a/0x30   </TASK>  Allocated by task 1118:   kasan_save_stack+0x30/0x50   kasan_save_track+0x14/0x30   __kasan_kmalloc+0xaa/0xb0   cifs_new_fileinfo+0xc8/0x9d0 [cifs]   cifs_atomic_open+0x467/0x770 [cifs]   lookup_open.isra.0+0x665/0x8b0   path_openat+0x4c3/0x1380   do_filp_open+0x167/0x270   do_sys_openat2+0x129/0x160   __x64_sys_creat+0xad/0xe0   do_syscall_64+0xbb/0x1d0   entry_SYSCALL_64_after_hwframe+0x77/0x7f  Freed by task 83:   kasan_save_stack+0x30/0x50   kasan_save_track+0x14/0x30   kasan_save_free_info+0x3b/0x70   poison_slab_object+0xe9/0x160   __kasan_slab_free+0x32/0x50   kfree+0xf2/0x300   process_one_work+0x4c6/0x9f0   worker_thread+0x2e4/0x570   kthread+0x17f/0x1c0   ret_from_fork+0x31/0x60   ret_from_fork_asm+0x1a/0x30  Last potentially related work creation:   kasan_save_stack+0x30/0x50   __kasan_record_aux_stack+0xad/0xc0   insert_work+0x29/0xe0   __queue_work+0x5ea/0x760   queue_work_on+0x6d/0x90   _cifsFileInfo_put+0x3f6/0x770 [cifs]   smb2_compound_op+0x911/0x3940 [cifs]   smb2_set_path_size+0x228/0x270 [cifs]   cifs_set_file_size+0x197/0x460 [cifs]   cifs_setattr+0xd9c/0x14b0 [cifs]   notify_change+0x4e3/0x740   do_truncate+0xfa/0x180   vfs_truncate+0x195/0x200   __x64_sys_truncate+0x109/0x150   do_syscall_64+0xbb/0x1d0   entry_SYSCALL_64_after_hwframe+0x77/0x7f","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix double put of @cfile in smb2_set_path_size()If smb2_compound_op() is called with a valid @cfile and returned-EINVAL, we need to call cifs_get_writable_path() before retrying itas the reference of @cfile was already dropped by previous call.This fixes the following KASAN splat when running fstests generic/013against Windows Server 2022:  CIFS: Attempting to mount //w22-fs0/scratch  run fstests generic/013 at 2024-09-02 19:48:59  ==================================================================  BUG: KASAN: slab-use-after-free in detach_if_pending+0xab/0x200  Write of size 8 at addr ffff88811f1a3730 by task kworker/3:2/176  CPU: 3 UID: 0 PID: 176 Comm: kworker/3:2 Not tainted 6.11.0-rc6 #2  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-2.fc40  04/01/2014  Workqueue: cifsoplockd cifs_oplock_break [cifs]  Call Trace:   <TASK>   dump_stack_lvl+0x5d/0x80   ? detach_if_pending+0xab/0x200   print_report+0x156/0x4d9   ? detach_if_pending+0xab/0x200   ? __virt_addr_valid+0x145/0x300   ? __phys_addr+0x46/0x90   ? detach_if_pending+0xab/0x200   kasan_report+0xda/0x110   ? detach_if_pending+0xab/0x200   detach_if_pending+0xab/0x200   timer_delete+0x96/0xe0   ? __pfx_timer_delete+0x10/0x10   ? rcu_is_watching+0x20/0x50   try_to_grab_pending+0x46/0x3b0   __cancel_work+0x89/0x1b0   ? __pfx___cancel_work+0x10/0x10   ? kasan_save_track+0x14/0x30   cifs_close_deferred_file+0x110/0x2c0 [cifs]   ? __pfx_cifs_close_deferred_file+0x10/0x10 [cifs]   ? __pfx_down_read+0x10/0x10   cifs_oplock_break+0x4c1/0xa50 [cifs]   ? __pfx_cifs_oplock_break+0x10/0x10 [cifs]   ? lock_is_held_type+0x85/0xf0   ? mark_held_locks+0x1a/0x90   process_one_work+0x4c6/0x9f0   ? find_held_lock+0x8a/0xa0   ? __pfx_process_one_work+0x10/0x10   ? lock_acquired+0x220/0x550   ? __list_add_valid_or_report+0x37/0x100   worker_thread+0x2e4/0x570   ? __kthread_parkme+0xd1/0xf0   ? __pfx_worker_thread+0x10/0x10   kthread+0x17f/0x1c0   ? kthread+0xda/0x1c0   ? __pfx_kthread+0x10/0x10   ret_from_fork+0x31/0x60   ? __pfx_kthread+0x10/0x10   ret_from_fork_asm+0x1a/0x30   </TASK>  Allocated by task 1118:   kasan_save_stack+0x30/0x50   kasan_save_track+0x14/0x30   __kasan_kmalloc+0xaa/0xb0   cifs_new_fileinfo+0xc8/0x9d0 [cifs]   cifs_atomic_open+0x467/0x770 [cifs]   lookup_open.isra.0+0x665/0x8b0   path_openat+0x4c3/0x1380   do_filp_open+0x167/0x270   do_sys_openat2+0x129/0x160   __x64_sys_creat+0xad/0xe0   do_syscall_64+0xbb/0x1d0   entry_SYSCALL_64_after_hwframe+0x77/0x7f  Freed by task 83:   kasan_save_stack+0x30/0x50   kasan_save_track+0x14/0x30   kasan_save_free_info+0x3b/0x70   poison_slab_object+0xe9/0x160   __kasan_slab_free+0x32/0x50   kfree+0xf2/0x300   process_one_work+0x4c6/0x9f0   worker_thread+0x2e4/0x570   kthread+0x17f/0x1c0   ret_from_fork+0x31/0x60   ret_from_fork_asm+0x1a/0x30  Last potentially related work creation:   kasan_save_stack+0x30/0x50   __kasan_record_aux_stack+0xad/0xc0   insert_work+0x29/0xe0   __queue_work+0x5ea/0x760   queue_work_on+0x6d/0x90   _cifsFileInfo_put+0x3f6/0x770 [cifs]   smb2_compound_op+0x911/0x3940 [cifs]   smb2_set_path_size+0x228/0x270 [cifs]   cifs_set_file_size+0x197/0x460 [cifs]   cifs_setattr+0xd9c/0x14b0 [cifs]   notify_change+0x4e3/0x740   do_truncate+0xfa/0x180   vfs_truncate+0x195/0x200   __x64_sys_truncate+0x109/0x150   do_syscall_64+0xbb/0x1d0   entry_SYSCALL_64_after_hwframe+0x77/0x7f","references":["https://git.kernel.org/stable/c/5a72d1edb0843e4c927a4096f81e631031c25c28","https://git.kernel.org/stable/c/762099898309218b4a7954f3d49e985dc4dfd638","https://git.kernel.org/stable/c/f9c169b51b6ce20394594ef674d6b10efba31220"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[">=6.6.32","<6.10.10",">=6.9","<6.6.51"]},
  {"id":"CVE-2024-47883","product":"smb","summary":"The OpenRefine fork of the MIT Simile Butterfly server is a modular web application framework. The Butterfly framework uses the `java.net.URL` class to refer to (what are expected to be) local resource files, like images or templates. This works: \"opening a connection\" to these URLs opens the local file. However, prior to version 1.2.6, if a `file:/` URL is directly given where a relative path (resource name) is expected, this is also accepted in some code paths; the app then fetches the file, from a remote machine if indicated, and uses it as if it was a trusted part of the app's codebase. This leads to multiple weaknesses and potential weaknesses. An attacker that has network access to the application could use it to gain access to files, either on the the server's filesystem (path traversal) or shared by nearby machines (server-side request forgery with e.g. SMB). An attacker that can lead or redirect a user to a crafted URL belonging to the app could cause arbitrary attacker-controlled JavaScript to be loaded in the victim's browser (cross-site scripting). If an app is written in such a way that an attacker can influence the resource name used for a template, that attacker could cause the app to fetch and execute an attacker-controlled template (remote code execution). Version 1.2.6 contains a patch.","details":"The OpenRefine fork of the MIT Simile Butterfly server is a modular web application framework. The Butterfly framework uses the `java.net.URL` class to refer to (what are expected to be) local resource files, like images or templates. This works: \"opening a connection\" to these URLs opens the local file. However, prior to version 1.2.6, if a `file:/` URL is directly given where a relative path (resource name) is expected, this is also accepted in some code paths; the app then fetches the file, from a remote machine if indicated, and uses it as if it was a trusted part of the app's codebase. This leads to multiple weaknesses and potential weaknesses. An attacker that has network access to the application could use it to gain access to files, either on the the server's filesystem (path traversal) or shared by nearby machines (server-side request forgery with e.g. SMB). An attacker that can lead or redirect a user to a crafted URL belonging to the app could cause arbitrary attacker-controlled JavaScript to be loaded in the victim's browser (cross-site scripting). If an app is written in such a way that an attacker can influence the resource name used for a template, that attacker could cause the app to fetch and execute an attacker-controlled template (remote code execution). Version 1.2.6 contains a patch.","references":["https://github.com/OpenRefine/simile-butterfly/commit/537f64bfa72746f8b21d4bda461fad843435319c","https://github.com/OpenRefine/simile-butterfly/security/advisories/GHSA-3p8v-w8mr-m3x8"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<=1.2.6"},
  {"id":"CVE-2024-50047","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix UAF in async decryptionDoing an async decryption (large read) crashes with aslab-use-after-free way down in the crypto API.Reproducer:    # mount.cifs -o ...,seal,esize=1 //srv/share /mnt    # dd if=/mnt/largefile of=/dev/null    ...    [  194.196391] ==================================================================    [  194.196844] BUG: KASAN: slab-use-after-free in gf128mul_4k_lle+0xc1/0x110    [  194.197269] Read of size 8 at addr ffff888112bd0448 by task kworker/u77:2/899    [  194.197707]    [  194.197818] CPU: 12 UID: 0 PID: 899 Comm: kworker/u77:2 Not tainted 6.11.0-lku-00028-gfca3ca14a17a-dirty #43    [  194.198400] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.16.2-3-gd478f380-prebuilt.qemu.org 04/01/2014    [  194.199046] Workqueue: smb3decryptd smb2_decrypt_offload [cifs]    [  194.200032] Call Trace:    [  194.200191]  <TASK>    [  194.200327]  dump_stack_lvl+0x4e/0x70    [  194.200558]  ? gf128mul_4k_lle+0xc1/0x110    [  194.200809]  print_report+0x174/0x505    [  194.201040]  ? __pfx__raw_spin_lock_irqsave+0x10/0x10    [  194.201352]  ? srso_return_thunk+0x5/0x5f    [  194.201604]  ? __virt_addr_valid+0xdf/0x1c0    [  194.201868]  ? gf128mul_4k_lle+0xc1/0x110    [  194.202128]  kasan_report+0xc8/0x150    [  194.202361]  ? gf128mul_4k_lle+0xc1/0x110    [  194.202616]  gf128mul_4k_lle+0xc1/0x110    [  194.202863]  ghash_update+0x184/0x210    [  194.203103]  shash_ahash_update+0x184/0x2a0    [  194.203377]  ? __pfx_shash_ahash_update+0x10/0x10    [  194.203651]  ? srso_return_thunk+0x5/0x5f    [  194.203877]  ? crypto_gcm_init_common+0x1ba/0x340    [  194.204142]  gcm_hash_assoc_remain_continue+0x10a/0x140    [  194.204434]  crypt_message+0xec1/0x10a0 [cifs]    [  194.206489]  ? __pfx_crypt_message+0x10/0x10 [cifs]    [  194.208507]  ? srso_return_thunk+0x5/0x5f    [  194.209205]  ? srso_return_thunk+0x5/0x5f    [  194.209925]  ? srso_return_thunk+0x5/0x5f    [  194.210443]  ? srso_return_thunk+0x5/0x5f    [  194.211037]  decrypt_raw_data+0x15f/0x250 [cifs]    [  194.212906]  ? __pfx_decrypt_raw_data+0x10/0x10 [cifs]    [  194.214670]  ? srso_return_thunk+0x5/0x5f    [  194.215193]  smb2_decrypt_offload+0x12a/0x6c0 [cifs]This is because TFM is being used in parallel.Fix this by allocating a new AEAD TFM for async decryption, but keepthe existing one for synchronous READ cases (similar to what is donein smb3_calc_signature()).Also remove the calls to aead_request_set_callback() andcrypto_wait_req() since it's always going to be a synchronous operation.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix UAF in async decryptionDoing an async decryption (large read) crashes with aslab-use-after-free way down in the crypto API.Reproducer:    # mount.cifs -o ...,seal,esize=1 //srv/share /mnt    # dd if=/mnt/largefile of=/dev/null    ...    [  194.196391] ==================================================================    [  194.196844] BUG: KASAN: slab-use-after-free in gf128mul_4k_lle+0xc1/0x110    [  194.197269] Read of size 8 at addr ffff888112bd0448 by task kworker/u77:2/899    [  194.197707]    [  194.197818] CPU: 12 UID: 0 PID: 899 Comm: kworker/u77:2 Not tainted 6.11.0-lku-00028-gfca3ca14a17a-dirty #43    [  194.198400] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.16.2-3-gd478f380-prebuilt.qemu.org 04/01/2014    [  194.199046] Workqueue: smb3decryptd smb2_decrypt_offload [cifs]    [  194.200032] Call Trace:    [  194.200191]  <TASK>    [  194.200327]  dump_stack_lvl+0x4e/0x70    [  194.200558]  ? gf128mul_4k_lle+0xc1/0x110    [  194.200809]  print_report+0x174/0x505    [  194.201040]  ? __pfx__raw_spin_lock_irqsave+0x10/0x10    [  194.201352]  ? srso_return_thunk+0x5/0x5f    [  194.201604]  ? __virt_addr_valid+0xdf/0x1c0    [  194.201868]  ? gf128mul_4k_lle+0xc1/0x110    [  194.202128]  kasan_report+0xc8/0x150    [  194.202361]  ? gf128mul_4k_lle+0xc1/0x110    [  194.202616]  gf128mul_4k_lle+0xc1/0x110    [  194.202863]  ghash_update+0x184/0x210    [  194.203103]  shash_ahash_update+0x184/0x2a0    [  194.203377]  ? __pfx_shash_ahash_update+0x10/0x10    [  194.203651]  ? srso_return_thunk+0x5/0x5f    [  194.203877]  ? crypto_gcm_init_common+0x1ba/0x340    [  194.204142]  gcm_hash_assoc_remain_continue+0x10a/0x140    [  194.204434]  crypt_message+0xec1/0x10a0 [cifs]    [  194.206489]  ? __pfx_crypt_message+0x10/0x10 [cifs]    [  194.208507]  ? srso_return_thunk+0x5/0x5f    [  194.209205]  ? srso_return_thunk+0x5/0x5f    [  194.209925]  ? srso_return_thunk+0x5/0x5f    [  194.210443]  ? srso_return_thunk+0x5/0x5f    [  194.211037]  decrypt_raw_data+0x15f/0x250 [cifs]    [  194.212906]  ? __pfx_decrypt_raw_data+0x10/0x10 [cifs]    [  194.214670]  ? srso_return_thunk+0x5/0x5f    [  194.215193]  smb2_decrypt_offload+0x12a/0x6c0 [cifs]This is because TFM is being used in parallel.Fix this by allocating a new AEAD TFM for async decryption, but keepthe existing one for synchronous READ cases (similar to what is donein smb3_calc_signature()).Also remove the calls to aead_request_set_callback() andcrypto_wait_req() since it's always going to be a synchronous operation.","references":["https://git.kernel.org/stable/c/0809fb86ad13b29e1d6d491364fc7ea4fb545995","https://git.kernel.org/stable/c/538c26d9bf70c90edc460d18c81008a4e555925a","https://git.kernel.org/stable/c/8f14a476abba13144df5434871a7225fd29af633"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.6.57",">=6.7","<6.11.4"]},
  {"id":"CVE-2024-50086","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix user-after-free from session log offThere is racy issue between smb2 session log off and smb2 session setup.It will cause user-after-free from session log off.This add session_lock when setting SMB2_SESSION_EXPIRED and referececount to session struct not to free session while it is being used.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix user-after-free from session log offThere is racy issue between smb2 session log off and smb2 session setup.It will cause user-after-free from session log off.This add session_lock when setting SMB2_SESSION_EXPIRED and referececount to session struct not to free session while it is being used.","references":["https://git.kernel.org/stable/c/0f62358ce85b2d4c949ef1b648be01b29cec667a","https://git.kernel.org/stable/c/5511999e9615e4318e9142d23b29bd1597befc08","https://git.kernel.org/stable/c/7aa8804c0b67b3cb263a472d17f2cb50d7f1a930"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.11.5","<6.6.58",">=6.7","<6.1.114",">=6.2"]},
  {"id":"CVE-2024-50120","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: Handle kstrdup failures for passwordsIn smb3_reconfigure(), after duplicating ctx->password andctx->password2 with kstrdup(), we need to check for allocationfailures.If ses->password allocation fails, return -ENOMEM.If ses->password2 allocation fails, free ses->password, set itto NULL, and return -ENOMEM.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: Handle kstrdup failures for passwordsIn smb3_reconfigure(), after duplicating ctx->password andctx->password2 with kstrdup(), we need to check for allocationfailures.If ses->password allocation fails, return -ENOMEM.If ses->password2 allocation fails, free ses->password, set itto NULL, and return -ENOMEM.","references":["https://git.kernel.org/stable/c/35488799b0ab6e4327f82e1d9209a60805665b37","https://git.kernel.org/stable/c/35dbac8c328d6afe937cd45ecd41d209d0b9f8b8","https://git.kernel.org/stable/c/9a5dd61151399ad5a5d69aad28ab164734c1e3bc"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.6.59",">=6.6.24",">=6.7.12","<6.8","<6.11.6","<6.9",">=6.8.3",">=6.9"]},
  {"id":"CVE-2024-50151","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix OOBs when building SMB2_IOCTL requestWhen using encryption, either enforced by the server or when using'seal' mount option, the client will squash all compound request buffersdown for encryption into a single iov in smb2_set_next_command().SMB2_ioctl_init() allocates a small buffer (448 bytes) to hold theSMB2_IOCTL request in the first iov, and if the user passes an inputbuffer that is greater than 328 bytes, smb2_set_next_command() willend up writing off the end of @rqst->iov[0].iov_base as shown below:  mount.cifs //srv/share /mnt -o ...,seal  ln -s $(perl -e \"print('a')for 1..1024\") /mnt/link  BUG: KASAN: slab-out-of-bounds in  smb2_set_next_command.cold+0x1d6/0x24c [cifs]  Write of size 4116 at addr ffff8881148fcab8 by task ln/859  CPU: 1 UID: 0 PID: 859 Comm: ln Not tainted 6.12.0-rc3 #1  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS  1.16.3-2.fc40 04/01/2014  Call Trace:   <TASK>   dump_stack_lvl+0x5d/0x80   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]   print_report+0x156/0x4d9   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]   ? __virt_addr_valid+0x145/0x310   ? __phys_addr+0x46/0x90   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]   kasan_report+0xda/0x110   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]   kasan_check_range+0x10f/0x1f0   __asan_memcpy+0x3c/0x60   smb2_set_next_command.cold+0x1d6/0x24c [cifs]   smb2_compound_op+0x238c/0x3840 [cifs]   ? kasan_save_track+0x14/0x30   ? kasan_save_free_info+0x3b/0x70   ? vfs_symlink+0x1a1/0x2c0   ? do_symlinkat+0x108/0x1c0   ? __pfx_smb2_compound_op+0x10/0x10 [cifs]   ? kmem_cache_free+0x118/0x3e0   ? cifs_get_writable_path+0xeb/0x1a0 [cifs]   smb2_get_reparse_inode+0x423/0x540 [cifs]   ? __pfx_smb2_get_reparse_inode+0x10/0x10 [cifs]   ? rcu_is_watching+0x20/0x50   ? __kmalloc_noprof+0x37c/0x480   ? smb2_create_reparse_symlink+0x257/0x490 [cifs]   ? smb2_create_reparse_symlink+0x38f/0x490 [cifs]   smb2_create_reparse_symlink+0x38f/0x490 [cifs]   ? __pfx_smb2_create_reparse_symlink+0x10/0x10 [cifs]   ? find_held_lock+0x8a/0xa0   ? hlock_class+0x32/0xb0   ? __build_path_from_dentry_optional_prefix+0x19d/0x2e0 [cifs]   cifs_symlink+0x24f/0x960 [cifs]   ? __pfx_make_vfsuid+0x10/0x10   ? __pfx_cifs_symlink+0x10/0x10 [cifs]   ? make_vfsgid+0x6b/0xc0   ? generic_permission+0x96/0x2d0   vfs_symlink+0x1a1/0x2c0   do_symlinkat+0x108/0x1c0   ? __pfx_do_symlinkat+0x10/0x10   ? strncpy_from_user+0xaa/0x160   __x64_sys_symlinkat+0xb9/0xf0   do_syscall_64+0xbb/0x1d0   entry_SYSCALL_64_after_hwframe+0x77/0x7f  RIP: 0033:0x7f08d75c13bb","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix OOBs when building SMB2_IOCTL requestWhen using encryption, either enforced by the server or when using'seal' mount option, the client will squash all compound request buffersdown for encryption into a single iov in smb2_set_next_command().SMB2_ioctl_init() allocates a small buffer (448 bytes) to hold theSMB2_IOCTL request in the first iov, and if the user passes an inputbuffer that is greater than 328 bytes, smb2_set_next_command() willend up writing off the end of @rqst->iov[0].iov_base as shown below:  mount.cifs //srv/share /mnt -o ...,seal  ln -s $(perl -e \"print('a')for 1..1024\") /mnt/link  BUG: KASAN: slab-out-of-bounds in  smb2_set_next_command.cold+0x1d6/0x24c [cifs]  Write of size 4116 at addr ffff8881148fcab8 by task ln/859  CPU: 1 UID: 0 PID: 859 Comm: ln Not tainted 6.12.0-rc3 #1  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS  1.16.3-2.fc40 04/01/2014  Call Trace:   <TASK>   dump_stack_lvl+0x5d/0x80   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]   print_report+0x156/0x4d9   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]   ? __virt_addr_valid+0x145/0x310   ? __phys_addr+0x46/0x90   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]   kasan_report+0xda/0x110   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]   kasan_check_range+0x10f/0x1f0   __asan_memcpy+0x3c/0x60   smb2_set_next_command.cold+0x1d6/0x24c [cifs]   smb2_compound_op+0x238c/0x3840 [cifs]   ? kasan_save_track+0x14/0x30   ? kasan_save_free_info+0x3b/0x70   ? vfs_symlink+0x1a1/0x2c0   ? do_symlinkat+0x108/0x1c0   ? __pfx_smb2_compound_op+0x10/0x10 [cifs]   ? kmem_cache_free+0x118/0x3e0   ? cifs_get_writable_path+0xeb/0x1a0 [cifs]   smb2_get_reparse_inode+0x423/0x540 [cifs]   ? __pfx_smb2_get_reparse_inode+0x10/0x10 [cifs]   ? rcu_is_watching+0x20/0x50   ? __kmalloc_noprof+0x37c/0x480   ? smb2_create_reparse_symlink+0x257/0x490 [cifs]   ? smb2_create_reparse_symlink+0x38f/0x490 [cifs]   smb2_create_reparse_symlink+0x38f/0x490 [cifs]   ? __pfx_smb2_create_reparse_symlink+0x10/0x10 [cifs]   ? find_held_lock+0x8a/0xa0   ? hlock_class+0x32/0xb0   ? __build_path_from_dentry_optional_prefix+0x19d/0x2e0 [cifs]   cifs_symlink+0x24f/0x960 [cifs]   ? __pfx_make_vfsuid+0x10/0x10   ? __pfx_cifs_symlink+0x10/0x10 [cifs]   ? make_vfsgid+0x6b/0xc0   ? generic_permission+0x96/0x2d0   vfs_symlink+0x1a1/0x2c0   do_symlinkat+0x108/0x1c0   ? __pfx_do_symlinkat+0x10/0x10   ? strncpy_from_user+0xaa/0x160   __x64_sys_symlinkat+0xb9/0xf0   do_syscall_64+0xbb/0x1d0   entry_SYSCALL_64_after_hwframe+0x77/0x7f  RIP: 0033:0x7f08d75c13bb","references":["https://git.kernel.org/stable/c/1ab60323c5201bef25f2a3dc0ccc404d9aca77f1","https://git.kernel.org/stable/c/2ef632bfb888d1a14f81c1703817951e0bec5531","https://git.kernel.org/stable/c/6f0516ef1290da24b85461ed08a0938af7415e49"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<6.6.59","<6.11.6",">=6.7","<6.1.115",">=6.2"],[">=5.5",">=5.16",">=5.11","<5.4.285",">=5.0","<5.15.170","<5.10.229"]]},
  {"id":"CVE-2024-50152","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix possible double free in smb2_set_ea()Clang static checker(scan-build) warning：fs/smb/client/smb2ops.c:1304:2: Attempt to free released memory. 1304 |         kfree(ea);      |         ^~~~~~~~~There is a double free in such case:'ea is initialized to NULL' -> 'first successful memory allocation forea' -> 'something failed, goto sea_exit' -> 'first memory release for ea'-> 'goto replay_again' -> 'second goto sea_exit before allocate memoryfor ea' -> 'second memory release for ea resulted in double free'.Re-initialie 'ea' to NULL near to the replay_again label, it can fix thisdouble free problem.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix possible double free in smb2_set_ea()Clang static checker(scan-build) warning：fs/smb/client/smb2ops.c:1304:2: Attempt to free released memory. 1304 |         kfree(ea);      |         ^~~~~~~~~There is a double free in such case:'ea is initialized to NULL' -> 'first successful memory allocation forea' -> 'something failed, goto sea_exit' -> 'first memory release for ea'-> 'goto replay_again' -> 'second goto sea_exit before allocate memoryfor ea' -> 'second memory release for ea resulted in double free'.Re-initialie 'ea' to NULL near to the replay_again label, it can fix thisdouble free problem.","references":["https://git.kernel.org/stable/c/19ebc1e6cab334a8193398d4152deb76019b5d34","https://git.kernel.org/stable/c/b1813c220b76f60b1727984794377c4aa849d4c1","https://git.kernel.org/stable/c/c9f758ecf2562dfdd4adf12c22921b5de8366123"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[">=6.6.32",">=6.8","<6.11.6","<6.6.59"]},
  {"id":"CVE-2024-50283","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix slab-use-after-free in smb3_preauth_hash_rspksmbd_user_session_put should be called under smb3_preauth_hash_rsp().It will avoid freeing session before calling smb3_preauth_hash_rsp().","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix slab-use-after-free in smb3_preauth_hash_rspksmbd_user_session_put should be called under smb3_preauth_hash_rsp().It will avoid freeing session before calling smb3_preauth_hash_rsp().","references":["https://git.kernel.org/stable/c/1b6ad475d4ed577d34e0157eb507be00c588bf5c","https://git.kernel.org/stable/c/b8fc56fbca7482c1e5c0e3351c6ae78982e25ada","https://git.kernel.org/stable/c/c6cdc08c25a868a08068dfc319fa9fce982b8e7f"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.6.61","<6.1.117",">=6.7",">=6.2","<6.11.8"]},
  {"id":"CVE-2024-50285","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: check outstanding simultaneous SMB operationsIf Client send simultaneous SMB operations to ksmbd, It exhausts too muchmemory through the \"ksmbd_work_cache\". It will cause OOM issue.ksmbd has a credit mechanism but it can't handle this problem. This patchadd the check if it exceeds max credits to prevent this problem by assumingthat one smb request consumes at least one credit.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: check outstanding simultaneous SMB operationsIf Client send simultaneous SMB operations to ksmbd, It exhausts too muchmemory through the \"ksmbd_work_cache\". It will cause OOM issue.ksmbd has a credit mechanism but it can't handle this problem. This patchadd the check if it exceeds max credits to prevent this problem by assumingthat one smb request consumes at least one credit.","references":["https://git.kernel.org/stable/c/0a77d947f599b1f39065015bec99390d0c0022ee","https://git.kernel.org/stable/c/1f993777275cbd8f74765c4f9d9285cb907c9be5","https://git.kernel.org/stable/c/e257ac6fe138623cf59fca8898abdf659dbc8356"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[">=6.7","<6.6.61","<6.11.8"]},
  {"id":"CVE-2024-50387","product":"smb","summary":"A SQL injection vulnerability has been reported to affect several QNAP operating system versions. If exploited, the vulnerability could allow remote attackers to inject malicious code.We have already fixed the vulnerability in the following version:SMB Service 4.15.002 and laterSMB Service h4.15.002 and later","details":"A SQL injection vulnerability has been reported to affect several QNAP operating system versions. If exploited, the vulnerability could allow remote attackers to inject malicious code.We have already fixed the vulnerability in the following version:SMB Service 4.15.002 and laterSMB Service h4.15.002 and later","references":["https://www.qnap.com/en/security-advisory/qsa-24-42"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-5256","product":"smb","summary":"Sonos Era 100 SMB2 Message Handling Integer Underflow Information Disclosure Vulnerability. This vulnerability allows network-adjacent attackers to disclose sensitive information on affected installations of Sonos Era 100 smart speakers. Authentication is not required to exploit this vulnerability.The specific flaw exists within the handling of SMB2 messages. The issue results from the lack of proper validation of user-supplied data, which can result in an integer underflow before reading from memory. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of root. Was ZDI-CAN-22336.","details":"Sonos Era 100 SMB2 Message Handling Integer Underflow Information Disclosure Vulnerability. This vulnerability allows network-adjacent attackers to disclose sensitive information on affected installations of Sonos Era 100 smart speakers. Authentication is not required to exploit this vulnerability.The specific flaw exists within the handling of SMB2 messages. The issue results from the lack of proper validation of user-supplied data, which can result in an integer underflow before reading from memory. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of root. Was ZDI-CAN-22336.","references":["https://www.zerodayinitiative.com/advisories/ZDI-24-542/","https://www.zerodayinitiative.com/advisories/ZDI-24-542/"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-5262","product":"smb","summary":"Files or Directories Accessible to External Parties vulnerability in smb server in ProjectDiscovery Interactsh allows remote attackers to read/write any files in the directory and subdirectories of where the victim runs interactsh-server via anonymous login.","details":"Files or Directories Accessible to External Parties vulnerability in smb server in ProjectDiscovery Interactsh allows remote attackers to read/write any files in the directory and subdirectories of where the victim runs interactsh-server via anonymous login.","references":["https://github.com/projectdiscovery/interactsh/pull/874","https://zuso.ai/advisory/za-2024-01","https://github.com/projectdiscovery/interactsh/pull/874"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[["<1.2.0"],[">=0.0.6"]]},
  {"id":"CVE-2024-5267","product":"smb","summary":"Sonos Era 100 SMB2 Message Handling Out-Of-Bounds Write Remote Code Execution Vulnerability. This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of Sonos Era 100 smart speakers. Authentication is not required to exploit this vulnerability.The specific flaw exists within the handling of SMB2 messages. The issue results from the lack of proper validation of user-supplied data, which can result in a write past the end of an allocated buffer. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-22384.","details":"Sonos Era 100 SMB2 Message Handling Out-Of-Bounds Write Remote Code Execution Vulnerability. This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of Sonos Era 100 smart speakers. Authentication is not required to exploit this vulnerability.The specific flaw exists within the handling of SMB2 messages. The issue results from the lack of proper validation of user-supplied data, which can result in a write past the end of an allocated buffer. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-22384.","references":["https://www.zerodayinitiative.com/advisories/ZDI-24-543/","https://www.zerodayinitiative.com/advisories/ZDI-24-543/"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-5268","product":"smb","summary":"Sonos Era 100 SMB2 Message Handling Out-Of-Bounds Read Information Disclosure Vulnerability. This vulnerability allows network-adjacent attackers to disclose sensitive information on affected installations of Sonos Era 100 smart speakers. Authentication is not required to exploit this vulnerability.The specific flaw exists within the handling of SMB2 messages. The issue results from the lack of proper validation of user-supplied data, which can result in a read past the end of an allocated buffer. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of root. Was ZDI-CAN-22428.","details":"Sonos Era 100 SMB2 Message Handling Out-Of-Bounds Read Information Disclosure Vulnerability. This vulnerability allows network-adjacent attackers to disclose sensitive information on affected installations of Sonos Era 100 smart speakers. Authentication is not required to exploit this vulnerability.The specific flaw exists within the handling of SMB2 messages. The issue results from the lack of proper validation of user-supplied data, which can result in a read past the end of an allocated buffer. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of root. Was ZDI-CAN-22428.","references":["https://www.zerodayinitiative.com/advisories/ZDI-24-544/","https://www.zerodayinitiative.com/advisories/ZDI-24-544/"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-5269","product":"smb","summary":"Sonos Era 100 SMB2 Message Handling Use-After-Free Remote Code Execution Vulnerability. This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of Sonos Era 100 smart speakers. Authentication is not required to exploit this vulnerability.The specific flaw exists within the handling of SMB2 messages. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-22459.","details":"Sonos Era 100 SMB2 Message Handling Use-After-Free Remote Code Execution Vulnerability. This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of Sonos Era 100 smart speakers. Authentication is not required to exploit this vulnerability.The specific flaw exists within the handling of SMB2 messages. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-22459.","references":["https://www.zerodayinitiative.com/advisories/ZDI-24-545/","https://www.zerodayinitiative.com/advisories/ZDI-24-545/"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-53095","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: Fix use-after-free of network namespace.Recently, we got a customer report that CIFS triggers oops whilereconnecting to a server.  [0]The workload runs on Kubernetes, and some pods mount CIFS serversin non-root network namespaces.  The problem rarely happened, butit was always while the pod was dying.The root cause is wrong reference counting for network namespace.CIFS uses kernel sockets, which do not hold refcnt of the netns thatthe socket belongs to.  That means CIFS must ensure the socket isalways freed before its netns; otherwise, use-after-free happens.The repro steps are roughly:  1. mount CIFS in a non-root netns  2. drop packets from the netns  3. destroy the netns  4. unmount CIFSWe can reproduce the issue quickly with the script [1] below and seethe splat [2] if CONFIG_NET_NS_REFCNT_TRACKER is enabled.When the socket is TCP, it is hard to guarantee the netns lifetimewithout holding refcnt due to async timers.Let's hold netns refcnt for each socket as done for SMC in commit9744d2bf1976 (\"smc: Fix use-after-free in tcp_write_timer_handler().\").Note that we need to move put_net() from cifs_put_tcp_session() toclean_demultiplex_info(); otherwise, __sock_create() still could touch afreed netns while cifsd tries to reconnect from cifs_demultiplex_thread().Also, maybe_get_net() cannot be put just before __sock_create() becausethe code is not under RCU and there is a small chance that the sameaddress happened to be reallocated to another netns.[0]:CIFS: VFS: \\\\XXXXXXXXXXX has not responded in 15 seconds. Reconnecting...CIFS: Serverclose failed 4 times, giving upUnable to handle kernel paging request at virtual address 14de99e461f84a07Mem abort info:  ESR = 0x0000000096000004  EC = 0x25: DABT (current EL), IL = 32 bits  SET = 0, FnV = 0  EA = 0, S1PTW = 0  FSC = 0x04: level 0 translation faultData abort info:  ISV = 0, ISS = 0x00000004  CM = 0, WnR = 0[14de99e461f84a07] address between user and kernel address rangesInternal error: Oops: 0000000096000004 [#1] SMPModules linked in: cls_bpf sch_ingress nls_utf8 cifs cifs_arc4 cifs_md4 dns_resolver tcp_diag inet_diag veth xt_state xt_connmark nf_conntrack_netlink xt_nat xt_statistic xt_MASQUERADE xt_mark xt_addrtype ipt_REJECT nf_reject_ipv4 nft_chain_nat nf_nat xt_conntrack nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 xt_comment nft_compat nf_tables nfnetlink overlay nls_ascii nls_cp437 sunrpc vfat fat aes_ce_blk aes_ce_cipher ghash_ce sm4_ce_cipher sm4 sm3_ce sm3 sha3_ce sha512_ce sha512_arm64 sha1_ce ena button sch_fq_codel loop fuse configfs dmi_sysfs sha2_ce sha256_arm64 dm_mirror dm_region_hash dm_log dm_mod dax efivarfsCPU: 5 PID: 2690970 Comm: cifsd Not tainted 6.1.103-109.184.amzn2023.aarch64 #1Hardware name: Amazon EC2 r7g.4xlarge/, BIOS 1.0 11/1/2018pstate: 00400005 (nzcv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)pc : fib_rules_lookup+0x44/0x238lr : __fib_lookup+0x64/0xbcsp : ffff8000265db790x29: ffff8000265db790 x28: 0000000000000000 x27: 000000000000bd01x26: 0000000000000000 x25: ffff000b4baf8000 x24: ffff00047b5e4580x23: ffff8000265db7e0 x22: 0000000000000000 x21: ffff00047b5e4500x20: ffff0010e3f694f8 x19: 14de99e461f849f7 x18: 0000000000000000x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000000x14: 0000000000000000 x13: 0000000000000000 x12: 3f92800abd010002x11: 0000000000000001 x10: ffff0010e3f69420 x9 : ffff800008a6f294x8 : 0000000000000000 x7 : 0000000000000006 x6 : 0000000000000000x5 : 0000000000000001 x4 : ffff001924354280 x3 : ffff8000265db7e0x2 : 0000000000000000 x1 : ffff0010e3f694f8 x0 : ffff00047b5e4500Call trace: fib_rules_lookup+0x44/0x238 __fib_lookup+0x64/0xbc ip_route_output_key_hash_rcu+0x2c4/0x398 ip_route_output_key_hash+0x60/0x8c tcp_v4_connect+0x290/0x488 __inet_stream_connect+0x108/0x3d0 inet_stream_connect+0x50/0x78 kernel_connect+0x6c/0xac generic_ip_conne---truncated---","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: Fix use-after-free of network namespace.Recently, we got a customer report that CIFS triggers oops whilereconnecting to a server.  [0]The workload runs on Kubernetes, and some pods mount CIFS serversin non-root network namespaces.  The problem rarely happened, butit was always while the pod was dying.The root cause is wrong reference counting for network namespace.CIFS uses kernel sockets, which do not hold refcnt of the netns thatthe socket belongs to.  That means CIFS must ensure the socket isalways freed before its netns; otherwise, use-after-free happens.The repro steps are roughly:  1. mount CIFS in a non-root netns  2. drop packets from the netns  3. destroy the netns  4. unmount CIFSWe can reproduce the issue quickly with the script [1] below and seethe splat [2] if CONFIG_NET_NS_REFCNT_TRACKER is enabled.When the socket is TCP, it is hard to guarantee the netns lifetimewithout holding refcnt due to async timers.Let's hold netns refcnt for each socket as done for SMC in commit9744d2bf1976 (\"smc: Fix use-after-free in tcp_write_timer_handler().\").Note that we need to move put_net() from cifs_put_tcp_session() toclean_demultiplex_info(); otherwise, __sock_create() still could touch afreed netns while cifsd tries to reconnect from cifs_demultiplex_thread().Also, maybe_get_net() cannot be put just before __sock_create() becausethe code is not under RCU and there is a small chance that the sameaddress happened to be reallocated to another netns.[0]:CIFS: VFS: \\\\XXXXXXXXXXX has not responded in 15 seconds. Reconnecting...CIFS: Serverclose failed 4 times, giving upUnable to handle kernel paging request at virtual address 14de99e461f84a07Mem abort info:  ESR = 0x0000000096000004  EC = 0x25: DABT (current EL), IL = 32 bits  SET = 0, FnV = 0  EA = 0, S1PTW = 0  FSC = 0x04: level 0 translation faultData abort info:  ISV = 0, ISS = 0x00000004  CM = 0, WnR = 0[14de99e461f84a07] address between user and kernel address rangesInternal error: Oops: 0000000096000004 [#1] SMPModules linked in: cls_bpf sch_ingress nls_utf8 cifs cifs_arc4 cifs_md4 dns_resolver tcp_diag inet_diag veth xt_state xt_connmark nf_conntrack_netlink xt_nat xt_statistic xt_MASQUERADE xt_mark xt_addrtype ipt_REJECT nf_reject_ipv4 nft_chain_nat nf_nat xt_conntrack nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 xt_comment nft_compat nf_tables nfnetlink overlay nls_ascii nls_cp437 sunrpc vfat fat aes_ce_blk aes_ce_cipher ghash_ce sm4_ce_cipher sm4 sm3_ce sm3 sha3_ce sha512_ce sha512_arm64 sha1_ce ena button sch_fq_codel loop fuse configfs dmi_sysfs sha2_ce sha256_arm64 dm_mirror dm_region_hash dm_log dm_mod dax efivarfsCPU: 5 PID: 2690970 Comm: cifsd Not tainted 6.1.103-109.184.amzn2023.aarch64 #1Hardware name: Amazon EC2 r7g.4xlarge/, BIOS 1.0 11/1/2018pstate: 00400005 (nzcv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)pc : fib_rules_lookup+0x44/0x238lr : __fib_lookup+0x64/0xbcsp : ffff8000265db790x29: ffff8000265db790 x28: 0000000000000000 x27: 000000000000bd01x26: 0000000000000000 x25: ffff000b4baf8000 x24: ffff00047b5e4580x23: ffff8000265db7e0 x22: 0000000000000000 x21: ffff00047b5e4500x20: ffff0010e3f694f8 x19: 14de99e461f849f7 x18: 0000000000000000x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000000x14: 0000000000000000 x13: 0000000000000000 x12: 3f92800abd010002x11: 0000000000000001 x10: ffff0010e3f69420 x9 : ffff800008a6f294x8 : 0000000000000000 x7 : 0000000000000006 x6 : 0000000000000000x5 : 0000000000000001 x4 : ffff001924354280 x3 : ffff8000265db7e0x2 : 0000000000000000 x1 : ffff0010e3f694f8 x0 : ffff00047b5e4500Call trace: fib_rules_lookup+0x44/0x238 __fib_lookup+0x64/0xbc ip_route_output_key_hash_rcu+0x2c4/0x398 ip_route_output_key_hash+0x60/0x8c tcp_v4_connect+0x290/0x488 __inet_stream_connect+0x108/0x3d0 inet_stream_connect+0x50/0x78 kernel_connect+0x6c/0xac generic_ip_conne---truncated---","references":["https://git.kernel.org/stable/c/c7f9282fc27fc36dbaffc8527c723de264a132f8","https://git.kernel.org/stable/c/e8c71494181153a134c96da28766a57bd1eac8cb","https://git.kernel.org/stable/c/ef7134c7fc48e1441b398e55a862232868a6f0a7"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=6.7","<6.6.62","<6.11.9"],[">=4.2"]]},
  {"id":"CVE-2024-53176","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: During unmount, ensure all cached dir instances drop their dentryThe unmount process (cifs_kill_sb() calling close_all_cached_dirs()) canrace with various cached directory operations, which ultimately resultsin dentries not being dropped and these kernel BUGs:BUG: Dentry ffff88814f37e358{i=1000000000080,n=/}  still in use (2) [unmount of cifs cifs]VFS: Busy inodes after unmount of cifs (cifs)------------[ cut here ]------------kernel BUG at fs/super.c:661!This happens when a cfid is in the process of being cleaned up when, andhas been removed from the cfids->entries list, including:- Receiving a lease break from the server- Server reconnection triggers invalidate_all_cached_dirs(), which  removes all the cfids from the list- The laundromat thread decides to expire an old cfid.To solve these problems, dropping the dentry is done in queued work donein a newly-added cfid_put_wq workqueue, and close_all_cached_dirs()flushes that workqueue after it drops all the dentries of which it'saware. This is a global workqueue (rather than scoped to a mount), butthe queued work is minimal.The final cleanup work for cleaning up a cfid is performed via workqueued in the serverclose_wq workqueue; this is done separate fromdropping the dentries so that close_all_cached_dirs() doesn't block onany server operations.Both of these queued works expect to invoked with a cfid reference anda tcon reference to avoid those objects from being freed while the workis ongoing.While we're here, add proper locking to close_all_cached_dirs(), andlocking around the freeing of cfid->dentry.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: During unmount, ensure all cached dir instances drop their dentryThe unmount process (cifs_kill_sb() calling close_all_cached_dirs()) canrace with various cached directory operations, which ultimately resultsin dentries not being dropped and these kernel BUGs:BUG: Dentry ffff88814f37e358{i=1000000000080,n=/}  still in use (2) [unmount of cifs cifs]VFS: Busy inodes after unmount of cifs (cifs)------------[ cut here ]------------kernel BUG at fs/super.c:661!This happens when a cfid is in the process of being cleaned up when, andhas been removed from the cfids->entries list, including:- Receiving a lease break from the server- Server reconnection triggers invalidate_all_cached_dirs(), which  removes all the cfids from the list- The laundromat thread decides to expire an old cfid.To solve these problems, dropping the dentry is done in queued work donein a newly-added cfid_put_wq workqueue, and close_all_cached_dirs()flushes that workqueue after it drops all the dentries of which it'saware. This is a global workqueue (rather than scoped to a mount), butthe queued work is minimal.The final cleanup work for cleaning up a cfid is performed via workqueued in the serverclose_wq workqueue; this is done separate fromdropping the dentries so that close_all_cached_dirs() doesn't block onany server operations.Both of these queued works expect to invoked with a cfid reference anda tcon reference to avoid those objects from being freed while the workis ongoing.While we're here, add proper locking to close_all_cached_dirs(), andlocking around the freeing of cfid->dentry.","references":["https://git.kernel.org/stable/c/3fa640d035e5ae526769615c35cb9ed4be6e3662","https://git.kernel.org/stable/c/548812afd96982a76a93ba76c0582ea670c40d9e","https://git.kernel.org/stable/c/73934e535cffbda1490fa97d82690a0f9aa73e94"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-53177","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: prevent use-after-free due to open_cached_dir error pathsIf open_cached_dir() encounters an error parsing the lease from theserver, the error handling may race with receiving a lease break,resulting in open_cached_dir() freeing the cfid while the queued work ispending.Update open_cached_dir() to drop refs rather than directly freeing thecfid.Have cached_dir_lease_break(), cfids_laundromat_worker(), andinvalidate_all_cached_dirs() clear has_lease immediately while stillholding cfids->cfid_list_lock, and then use this to also simplify thereference counting in cfids_laundromat_worker() andinvalidate_all_cached_dirs().Fixes this KASAN splat (which manually injects an error and lease breakin open_cached_dir()):==================================================================BUG: KASAN: slab-use-after-free in smb2_cached_lease_break+0x27/0xb0Read of size 8 at addr ffff88811cc24c10 by task kworker/3:1/65CPU: 3 UID: 0 PID: 65 Comm: kworker/3:1 Not tainted 6.12.0-rc6-g255cf264e6e5-dirty #87Hardware name: VMware, Inc. VMware Virtual Platform/440BX Desktop Reference Platform, BIOS 6.00 11/12/2020Workqueue: cifsiod smb2_cached_lease_breakCall Trace: <TASK> dump_stack_lvl+0x77/0xb0 print_report+0xce/0x660 kasan_report+0xd3/0x110 smb2_cached_lease_break+0x27/0xb0 process_one_work+0x50a/0xc50 worker_thread+0x2ba/0x530 kthread+0x17c/0x1c0 ret_from_fork+0x34/0x60 ret_from_fork_asm+0x1a/0x30 </TASK>Allocated by task 2464: kasan_save_stack+0x33/0x60 kasan_save_track+0x14/0x30 __kasan_kmalloc+0xaa/0xb0 open_cached_dir+0xa7d/0x1fb0 smb2_query_path_info+0x43c/0x6e0 cifs_get_fattr+0x346/0xf10 cifs_get_inode_info+0x157/0x210 cifs_revalidate_dentry_attr+0x2d1/0x460 cifs_getattr+0x173/0x470 vfs_statx_path+0x10f/0x160 vfs_statx+0xe9/0x150 vfs_fstatat+0x5e/0xc0 __do_sys_newfstatat+0x91/0xf0 do_syscall_64+0x95/0x1a0 entry_SYSCALL_64_after_hwframe+0x76/0x7eFreed by task 2464: kasan_save_stack+0x33/0x60 kasan_save_track+0x14/0x30 kasan_save_free_info+0x3b/0x60 __kasan_slab_free+0x51/0x70 kfree+0x174/0x520 open_cached_dir+0x97f/0x1fb0 smb2_query_path_info+0x43c/0x6e0 cifs_get_fattr+0x346/0xf10 cifs_get_inode_info+0x157/0x210 cifs_revalidate_dentry_attr+0x2d1/0x460 cifs_getattr+0x173/0x470 vfs_statx_path+0x10f/0x160 vfs_statx+0xe9/0x150 vfs_fstatat+0x5e/0xc0 __do_sys_newfstatat+0x91/0xf0 do_syscall_64+0x95/0x1a0 entry_SYSCALL_64_after_hwframe+0x76/0x7eLast potentially related work creation: kasan_save_stack+0x33/0x60 __kasan_record_aux_stack+0xad/0xc0 insert_work+0x32/0x100 __queue_work+0x5c9/0x870 queue_work_on+0x82/0x90 open_cached_dir+0x1369/0x1fb0 smb2_query_path_info+0x43c/0x6e0 cifs_get_fattr+0x346/0xf10 cifs_get_inode_info+0x157/0x210 cifs_revalidate_dentry_attr+0x2d1/0x460 cifs_getattr+0x173/0x470 vfs_statx_path+0x10f/0x160 vfs_statx+0xe9/0x150 vfs_fstatat+0x5e/0xc0 __do_sys_newfstatat+0x91/0xf0 do_syscall_64+0x95/0x1a0 entry_SYSCALL_64_after_hwframe+0x76/0x7eThe buggy address belongs to the object at ffff88811cc24c00 which belongs to the cache kmalloc-1k of size 1024The buggy address is located 16 bytes inside of freed 1024-byte region [ffff88811cc24c00, ffff88811cc25000)","details":"In the Linux kernel, the following vulnerability has been resolved:smb: prevent use-after-free due to open_cached_dir error pathsIf open_cached_dir() encounters an error parsing the lease from theserver, the error handling may race with receiving a lease break,resulting in open_cached_dir() freeing the cfid while the queued work ispending.Update open_cached_dir() to drop refs rather than directly freeing thecfid.Have cached_dir_lease_break(), cfids_laundromat_worker(), andinvalidate_all_cached_dirs() clear has_lease immediately while stillholding cfids->cfid_list_lock, and then use this to also simplify thereference counting in cfids_laundromat_worker() andinvalidate_all_cached_dirs().Fixes this KASAN splat (which manually injects an error and lease breakin open_cached_dir()):==================================================================BUG: KASAN: slab-use-after-free in smb2_cached_lease_break+0x27/0xb0Read of size 8 at addr ffff88811cc24c10 by task kworker/3:1/65CPU: 3 UID: 0 PID: 65 Comm: kworker/3:1 Not tainted 6.12.0-rc6-g255cf264e6e5-dirty #87Hardware name: VMware, Inc. VMware Virtual Platform/440BX Desktop Reference Platform, BIOS 6.00 11/12/2020Workqueue: cifsiod smb2_cached_lease_breakCall Trace: <TASK> dump_stack_lvl+0x77/0xb0 print_report+0xce/0x660 kasan_report+0xd3/0x110 smb2_cached_lease_break+0x27/0xb0 process_one_work+0x50a/0xc50 worker_thread+0x2ba/0x530 kthread+0x17c/0x1c0 ret_from_fork+0x34/0x60 ret_from_fork_asm+0x1a/0x30 </TASK>Allocated by task 2464: kasan_save_stack+0x33/0x60 kasan_save_track+0x14/0x30 __kasan_kmalloc+0xaa/0xb0 open_cached_dir+0xa7d/0x1fb0 smb2_query_path_info+0x43c/0x6e0 cifs_get_fattr+0x346/0xf10 cifs_get_inode_info+0x157/0x210 cifs_revalidate_dentry_attr+0x2d1/0x460 cifs_getattr+0x173/0x470 vfs_statx_path+0x10f/0x160 vfs_statx+0xe9/0x150 vfs_fstatat+0x5e/0xc0 __do_sys_newfstatat+0x91/0xf0 do_syscall_64+0x95/0x1a0 entry_SYSCALL_64_after_hwframe+0x76/0x7eFreed by task 2464: kasan_save_stack+0x33/0x60 kasan_save_track+0x14/0x30 kasan_save_free_info+0x3b/0x60 __kasan_slab_free+0x51/0x70 kfree+0x174/0x520 open_cached_dir+0x97f/0x1fb0 smb2_query_path_info+0x43c/0x6e0 cifs_get_fattr+0x346/0xf10 cifs_get_inode_info+0x157/0x210 cifs_revalidate_dentry_attr+0x2d1/0x460 cifs_getattr+0x173/0x470 vfs_statx_path+0x10f/0x160 vfs_statx+0xe9/0x150 vfs_fstatat+0x5e/0xc0 __do_sys_newfstatat+0x91/0xf0 do_syscall_64+0x95/0x1a0 entry_SYSCALL_64_after_hwframe+0x76/0x7eLast potentially related work creation: kasan_save_stack+0x33/0x60 __kasan_record_aux_stack+0xad/0xc0 insert_work+0x32/0x100 __queue_work+0x5c9/0x870 queue_work_on+0x82/0x90 open_cached_dir+0x1369/0x1fb0 smb2_query_path_info+0x43c/0x6e0 cifs_get_fattr+0x346/0xf10 cifs_get_inode_info+0x157/0x210 cifs_revalidate_dentry_attr+0x2d1/0x460 cifs_getattr+0x173/0x470 vfs_statx_path+0x10f/0x160 vfs_statx+0xe9/0x150 vfs_fstatat+0x5e/0xc0 __do_sys_newfstatat+0x91/0xf0 do_syscall_64+0x95/0x1a0 entry_SYSCALL_64_after_hwframe+0x76/0x7eThe buggy address belongs to the object at ffff88811cc24c00 which belongs to the cache kmalloc-1k of size 1024The buggy address is located 16 bytes inside of freed 1024-byte region [ffff88811cc24c00, ffff88811cc25000)","references":["https://git.kernel.org/stable/c/47655a12c6b1bca8fa230085eab2e85a076932b7","https://git.kernel.org/stable/c/791f833053578b9fd24252ebb7162a61bc3f805b","https://git.kernel.org/stable/c/97e2afcac0bebfef6a5360f4267ce4c44507b845"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.11.11",">=6.12","<6.12.2","<6.6.64",">=6.7"]},
  {"id":"CVE-2024-53178","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: Don't leak cfid when reconnect races with open_cached_diropen_cached_dir() may either race with the tcon reconnection even beforecompound_send_recv() or directly trigger a reconnection viaSMB2_open_init() or SMB_query_info_init().The reconnection process invokes invalidate_all_cached_dirs() viacifs_mark_open_files_invalid(), which removes all cfids from thecfids->entries list but doesn't drop a ref if has_lease isn't true. Thisresults in the currently-being-constructed cfid not being on the list,but still having a refcount of 2. It leaks if returned fromopen_cached_dir().Fix this by setting cfid->has_lease when the ref is actually taken; thecfid will not be used by other threads until it has a valid time.Addresses these kmemleaks:unreferenced object 0xffff8881090c4000 (size 1024):  comm \"bash\", pid 1860, jiffies 4295126592  hex dump (first 32 bytes):    00 01 00 00 00 00 ad de 22 01 00 00 00 00 ad de  ........\".......    00 ca 45 22 81 88 ff ff f8 dc 4f 04 81 88 ff ff  ..E\"......O.....  backtrace (crc 6f58c20f):    [<ffffffff8b895a1e>] __kmalloc_cache_noprof+0x2be/0x350    [<ffffffff8bda06e3>] open_cached_dir+0x993/0x1fb0    [<ffffffff8bdaa750>] cifs_readdir+0x15a0/0x1d50    [<ffffffff8b9a853f>] iterate_dir+0x28f/0x4b0    [<ffffffff8b9a9aed>] __x64_sys_getdents64+0xfd/0x200    [<ffffffff8cf6da05>] do_syscall_64+0x95/0x1a0    [<ffffffff8d00012f>] entry_SYSCALL_64_after_hwframe+0x76/0x7eunreferenced object 0xffff8881044fdcf8 (size 8):  comm \"bash\", pid 1860, jiffies 4295126592  hex dump (first 8 bytes):    00 cc cc cc cc cc cc cc                          ........  backtrace (crc 10c106a9):    [<ffffffff8b89a3d3>] __kmalloc_node_track_caller_noprof+0x363/0x480    [<ffffffff8b7d7256>] kstrdup+0x36/0x60    [<ffffffff8bda0700>] open_cached_dir+0x9b0/0x1fb0    [<ffffffff8bdaa750>] cifs_readdir+0x15a0/0x1d50    [<ffffffff8b9a853f>] iterate_dir+0x28f/0x4b0    [<ffffffff8b9a9aed>] __x64_sys_getdents64+0xfd/0x200    [<ffffffff8cf6da05>] do_syscall_64+0x95/0x1a0    [<ffffffff8d00012f>] entry_SYSCALL_64_after_hwframe+0x76/0x7eAnd addresses these BUG splats when unmounting the SMB filesystem:BUG: Dentry ffff888140590ba0{i=1000000000080,n=/}  still in use (2) [unmount of cifs cifs]WARNING: CPU: 3 PID: 3433 at fs/dcache.c:1536 umount_check+0xd0/0x100Modules linked in:CPU: 3 UID: 0 PID: 3433 Comm: bash Not tainted 6.12.0-rc4-g850925a8133c-dirty #49Hardware name: VMware, Inc. VMware Virtual Platform/440BX Desktop Reference Platform, BIOS 6.00 11/12/2020RIP: 0010:umount_check+0xd0/0x100Code: 8d 7c 24 40 e8 31 5a f4 ff 49 8b 54 24 40 41 56 49 89 e9 45 89 e8 48 89 d9 41 57 48 89 de 48 c7 c7 80 e7 db ac e8 f0 72 9a ff <0f> 0b 58 31 c0 5a 5b 5d 41 5c 41 5d 41 5e 41 5f e9 2b e5 5d 01 41RSP: 0018:ffff88811cc27978 EFLAGS: 00010286RAX: 0000000000000000 RBX: ffff888140590ba0 RCX: ffffffffaaf20baeRDX: dffffc0000000000 RSI: 0000000000000008 RDI: ffff8881f6fb6f40RBP: ffff8881462ec000 R08: 0000000000000001 R09: ffffed1023984ee3R10: ffff88811cc2771f R11: 00000000016cfcc0 R12: ffff888134383e08R13: 0000000000000002 R14: ffff8881462ec668 R15: ffffffffaceab4c0FS:  00007f23bfa98740(0000) GS:ffff8881f6f80000(0000) knlGS:0000000000000000CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033CR2: 0000556de4a6f808 CR3: 0000000123c80000 CR4: 0000000000350ef0Call Trace: <TASK> d_walk+0x6a/0x530 shrink_dcache_for_umount+0x6a/0x200 generic_shutdown_super+0x52/0x2a0 kill_anon_super+0x22/0x40 cifs_kill_sb+0x159/0x1e0 deactivate_locked_super+0x66/0xe0 cleanup_mnt+0x140/0x210 task_work_run+0xfb/0x170 syscall_exit_to_user_mode+0x29f/0x2b0 do_syscall_64+0xa1/0x1a0 entry_SYSCALL_64_after_hwframe+0x76/0x7eRIP: 0033:0x7f23bfb93ae7Code: ff ff ff ff c3 66 0f 1f 44 00 00 48 8b 0d 11 93 0d 00 f7 d8 64 89 01 b8 ff ff ff ff eb bf 0f 1f 44 00 00 b8 50 00 00 00 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d e9 92 0d 00 f7 d8 64 89 ---truncated---","details":"In the Linux kernel, the following vulnerability has been resolved:smb: Don't leak cfid when reconnect races with open_cached_diropen_cached_dir() may either race with the tcon reconnection even beforecompound_send_recv() or directly trigger a reconnection viaSMB2_open_init() or SMB_query_info_init().The reconnection process invokes invalidate_all_cached_dirs() viacifs_mark_open_files_invalid(), which removes all cfids from thecfids->entries list but doesn't drop a ref if has_lease isn't true. Thisresults in the currently-being-constructed cfid not being on the list,but still having a refcount of 2. It leaks if returned fromopen_cached_dir().Fix this by setting cfid->has_lease when the ref is actually taken; thecfid will not be used by other threads until it has a valid time.Addresses these kmemleaks:unreferenced object 0xffff8881090c4000 (size 1024):  comm \"bash\", pid 1860, jiffies 4295126592  hex dump (first 32 bytes):    00 01 00 00 00 00 ad de 22 01 00 00 00 00 ad de  ........\".......    00 ca 45 22 81 88 ff ff f8 dc 4f 04 81 88 ff ff  ..E\"......O.....  backtrace (crc 6f58c20f):    [<ffffffff8b895a1e>] __kmalloc_cache_noprof+0x2be/0x350    [<ffffffff8bda06e3>] open_cached_dir+0x993/0x1fb0    [<ffffffff8bdaa750>] cifs_readdir+0x15a0/0x1d50    [<ffffffff8b9a853f>] iterate_dir+0x28f/0x4b0    [<ffffffff8b9a9aed>] __x64_sys_getdents64+0xfd/0x200    [<ffffffff8cf6da05>] do_syscall_64+0x95/0x1a0    [<ffffffff8d00012f>] entry_SYSCALL_64_after_hwframe+0x76/0x7eunreferenced object 0xffff8881044fdcf8 (size 8):  comm \"bash\", pid 1860, jiffies 4295126592  hex dump (first 8 bytes):    00 cc cc cc cc cc cc cc                          ........  backtrace (crc 10c106a9):    [<ffffffff8b89a3d3>] __kmalloc_node_track_caller_noprof+0x363/0x480    [<ffffffff8b7d7256>] kstrdup+0x36/0x60    [<ffffffff8bda0700>] open_cached_dir+0x9b0/0x1fb0    [<ffffffff8bdaa750>] cifs_readdir+0x15a0/0x1d50    [<ffffffff8b9a853f>] iterate_dir+0x28f/0x4b0    [<ffffffff8b9a9aed>] __x64_sys_getdents64+0xfd/0x200    [<ffffffff8cf6da05>] do_syscall_64+0x95/0x1a0    [<ffffffff8d00012f>] entry_SYSCALL_64_after_hwframe+0x76/0x7eAnd addresses these BUG splats when unmounting the SMB filesystem:BUG: Dentry ffff888140590ba0{i=1000000000080,n=/}  still in use (2) [unmount of cifs cifs]WARNING: CPU: 3 PID: 3433 at fs/dcache.c:1536 umount_check+0xd0/0x100Modules linked in:CPU: 3 UID: 0 PID: 3433 Comm: bash Not tainted 6.12.0-rc4-g850925a8133c-dirty #49Hardware name: VMware, Inc. VMware Virtual Platform/440BX Desktop Reference Platform, BIOS 6.00 11/12/2020RIP: 0010:umount_check+0xd0/0x100Code: 8d 7c 24 40 e8 31 5a f4 ff 49 8b 54 24 40 41 56 49 89 e9 45 89 e8 48 89 d9 41 57 48 89 de 48 c7 c7 80 e7 db ac e8 f0 72 9a ff <0f> 0b 58 31 c0 5a 5b 5d 41 5c 41 5d 41 5e 41 5f e9 2b e5 5d 01 41RSP: 0018:ffff88811cc27978 EFLAGS: 00010286RAX: 0000000000000000 RBX: ffff888140590ba0 RCX: ffffffffaaf20baeRDX: dffffc0000000000 RSI: 0000000000000008 RDI: ffff8881f6fb6f40RBP: ffff8881462ec000 R08: 0000000000000001 R09: ffffed1023984ee3R10: ffff88811cc2771f R11: 00000000016cfcc0 R12: ffff888134383e08R13: 0000000000000002 R14: ffff8881462ec668 R15: ffffffffaceab4c0FS:  00007f23bfa98740(0000) GS:ffff8881f6f80000(0000) knlGS:0000000000000000CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033CR2: 0000556de4a6f808 CR3: 0000000123c80000 CR4: 0000000000350ef0Call Trace: <TASK> d_walk+0x6a/0x530 shrink_dcache_for_umount+0x6a/0x200 generic_shutdown_super+0x52/0x2a0 kill_anon_super+0x22/0x40 cifs_kill_sb+0x159/0x1e0 deactivate_locked_super+0x66/0xe0 cleanup_mnt+0x140/0x210 task_work_run+0xfb/0x170 syscall_exit_to_user_mode+0x29f/0x2b0 do_syscall_64+0xa1/0x1a0 entry_SYSCALL_64_after_hwframe+0x76/0x7eRIP: 0033:0x7f23bfb93ae7Code: ff ff ff ff c3 66 0f 1f 44 00 00 48 8b 0d 11 93 0d 00 f7 d8 64 89 01 b8 ff ff ff ff eb bf 0f 1f 44 00 00 b8 50 00 00 00 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d e9 92 0d 00 f7 d8 64 89 ---truncated---","references":["https://git.kernel.org/stable/c/1d76332d783db12684b67592f1fb2057b88af4c3","https://git.kernel.org/stable/c/31fabf70d58388d5475e48ca8a6b7d2847b36678","https://git.kernel.org/stable/c/73a57b25b4df23f22814fc06b7e8f9cf570be026"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-53179","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix use-after-free of signing keyCustomers have reported use-after-free in @ses->auth_key.response withSMB2.1 + sign mounts which occurs due to following race:task A                         task Bcifs_mount() dfs_mount_share()  get_session()   cifs_mount_get_session()    cifs_send_recv()    cifs_get_smb_ses()          compound_send_recv()     cifs_setup_session()        smb2_setup_request()      kfree_sensitive()           smb2_calc_signature()                                   crypto_shash_setkey() *UAF*Fix this by ensuring that we have a valid @ses->auth_key.response bychecking whether @ses->ses_status is SES_GOOD or SES_EXITING with@ses->ses_lock held.  After commit 24a9799aa8ef (\"smb: client: fix UAFin smb2_reconnect_server()\"), we made sure to call ->logoff() onlywhen @ses was known to be good (e.g. valid ->auth_key.response), soit's safe to access signing key when @ses->ses_status == SES_EXITING.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix use-after-free of signing keyCustomers have reported use-after-free in @ses->auth_key.response withSMB2.1 + sign mounts which occurs due to following race:task A                         task Bcifs_mount() dfs_mount_share()  get_session()   cifs_mount_get_session()    cifs_send_recv()    cifs_get_smb_ses()          compound_send_recv()     cifs_setup_session()        smb2_setup_request()      kfree_sensitive()           smb2_calc_signature()                                   crypto_shash_setkey() *UAF*Fix this by ensuring that we have a valid @ses->auth_key.response bychecking whether @ses->ses_status is SES_GOOD or SES_EXITING with@ses->ses_lock held.  After commit 24a9799aa8ef (\"smb: client: fix UAFin smb2_reconnect_server()\"), we made sure to call ->logoff() onlywhen @ses was known to be good (e.g. valid ->auth_key.response), soit's safe to access signing key when @ses->ses_status == SES_EXITING.","references":["https://git.kernel.org/stable/c/0e2b654a3848bf9da3b0d54c1ccf3f1b8c635591","https://git.kernel.org/stable/c/343d7fe6df9e247671440a932b6a73af4fa86d95","https://git.kernel.org/stable/c/39619c65ab4bbb3e78c818f537687653e112764d"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[">=6.7","<6.6.70","<6.12.2"]},
  {"id":"CVE-2024-53185","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix NULL ptr deref in crypto_aead_setkey()Neither SMB3.0 or SMB3.02 supports encryption negotiate context, sowhen SMB2_GLOBAL_CAP_ENCRYPTION flag is set in the negotiate response,the client uses AES-128-CCM as the default cipher.  See MS-SMB23.3.5.4.Commit b0abcd65ec54 (\"smb: client: fix UAF in async decryption\") addeda @server->cipher_type check to conditionally callsmb3_crypto_aead_allocate(), but that check would always be false as@server->cipher_type is unset for SMB3.02.Fix the following KASAN splat by setting @server->cipher_type forSMB3.02 as well.mount.cifs //srv/share /mnt -o vers=3.02,seal,...BUG: KASAN: null-ptr-deref in crypto_aead_setkey+0x2c/0x130Read of size 8 at addr 0000000000000020 by task mount.cifs/1095CPU: 1 UID: 0 PID: 1095 Comm: mount.cifs Not tainted 6.12.0 #1Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-3.fc4104/01/2014Call Trace: <TASK> dump_stack_lvl+0x5d/0x80 ? crypto_aead_setkey+0x2c/0x130 kasan_report+0xda/0x110 ? crypto_aead_setkey+0x2c/0x130 crypto_aead_setkey+0x2c/0x130 crypt_message+0x258/0xec0 [cifs] ? __asan_memset+0x23/0x50 ? __pfx_crypt_message+0x10/0x10 [cifs] ? mark_lock+0xb0/0x6a0 ? hlock_class+0x32/0xb0 ? mark_lock+0xb0/0x6a0 smb3_init_transform_rq+0x352/0x3f0 [cifs] ? lock_acquire.part.0+0xf4/0x2a0 smb_send_rqst+0x144/0x230 [cifs] ? __pfx_smb_send_rqst+0x10/0x10 [cifs] ? hlock_class+0x32/0xb0 ? smb2_setup_request+0x225/0x3a0 [cifs] ? __pfx_cifs_compound_last_callback+0x10/0x10 [cifs] compound_send_recv+0x59b/0x1140 [cifs] ? __pfx_compound_send_recv+0x10/0x10 [cifs] ? __create_object+0x5e/0x90 ? hlock_class+0x32/0xb0 ? do_raw_spin_unlock+0x9a/0xf0 cifs_send_recv+0x23/0x30 [cifs] SMB2_tcon+0x3ec/0xb30 [cifs] ? __pfx_SMB2_tcon+0x10/0x10 [cifs] ? lock_acquire.part.0+0xf4/0x2a0 ? __pfx_lock_release+0x10/0x10 ? do_raw_spin_trylock+0xc6/0x120 ? lock_acquire+0x3f/0x90 ? _get_xid+0x16/0xd0 [cifs] ? __pfx_SMB2_tcon+0x10/0x10 [cifs] ? cifs_get_smb_ses+0xcdd/0x10a0 [cifs] cifs_get_smb_ses+0xcdd/0x10a0 [cifs] ? __pfx_cifs_get_smb_ses+0x10/0x10 [cifs] ? cifs_get_tcp_session+0xaa0/0xca0 [cifs] cifs_mount_get_session+0x8a/0x210 [cifs] dfs_mount_share+0x1b0/0x11d0 [cifs] ? __pfx___lock_acquire+0x10/0x10 ? __pfx_dfs_mount_share+0x10/0x10 [cifs] ? lock_acquire.part.0+0xf4/0x2a0 ? find_held_lock+0x8a/0xa0 ? hlock_class+0x32/0xb0 ? lock_release+0x203/0x5d0 cifs_mount+0xb3/0x3d0 [cifs] ? do_raw_spin_trylock+0xc6/0x120 ? __pfx_cifs_mount+0x10/0x10 [cifs] ? lock_acquire+0x3f/0x90 ? find_nls+0x16/0xa0 ? smb3_update_mnt_flags+0x372/0x3b0 [cifs] cifs_smb3_do_mount+0x1e2/0xc80 [cifs] ? __pfx_vfs_parse_fs_string+0x10/0x10 ? __pfx_cifs_smb3_do_mount+0x10/0x10 [cifs] smb3_get_tree+0x1bf/0x330 [cifs] vfs_get_tree+0x4a/0x160 path_mount+0x3c1/0xfb0 ? kasan_quarantine_put+0xc7/0x1d0 ? __pfx_path_mount+0x10/0x10 ? kmem_cache_free+0x118/0x3e0 ? user_path_at+0x74/0xa0 __x64_sys_mount+0x1a6/0x1e0 ? __pfx___x64_sys_mount+0x10/0x10 ? mark_held_locks+0x1a/0x90 do_syscall_64+0xbb/0x1d0 entry_SYSCALL_64_after_hwframe+0x77/0x7f","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix NULL ptr deref in crypto_aead_setkey()Neither SMB3.0 or SMB3.02 supports encryption negotiate context, sowhen SMB2_GLOBAL_CAP_ENCRYPTION flag is set in the negotiate response,the client uses AES-128-CCM as the default cipher.  See MS-SMB23.3.5.4.Commit b0abcd65ec54 (\"smb: client: fix UAF in async decryption\") addeda @server->cipher_type check to conditionally callsmb3_crypto_aead_allocate(), but that check would always be false as@server->cipher_type is unset for SMB3.02.Fix the following KASAN splat by setting @server->cipher_type forSMB3.02 as well.mount.cifs //srv/share /mnt -o vers=3.02,seal,...BUG: KASAN: null-ptr-deref in crypto_aead_setkey+0x2c/0x130Read of size 8 at addr 0000000000000020 by task mount.cifs/1095CPU: 1 UID: 0 PID: 1095 Comm: mount.cifs Not tainted 6.12.0 #1Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-3.fc4104/01/2014Call Trace: <TASK> dump_stack_lvl+0x5d/0x80 ? crypto_aead_setkey+0x2c/0x130 kasan_report+0xda/0x110 ? crypto_aead_setkey+0x2c/0x130 crypto_aead_setkey+0x2c/0x130 crypt_message+0x258/0xec0 [cifs] ? __asan_memset+0x23/0x50 ? __pfx_crypt_message+0x10/0x10 [cifs] ? mark_lock+0xb0/0x6a0 ? hlock_class+0x32/0xb0 ? mark_lock+0xb0/0x6a0 smb3_init_transform_rq+0x352/0x3f0 [cifs] ? lock_acquire.part.0+0xf4/0x2a0 smb_send_rqst+0x144/0x230 [cifs] ? __pfx_smb_send_rqst+0x10/0x10 [cifs] ? hlock_class+0x32/0xb0 ? smb2_setup_request+0x225/0x3a0 [cifs] ? __pfx_cifs_compound_last_callback+0x10/0x10 [cifs] compound_send_recv+0x59b/0x1140 [cifs] ? __pfx_compound_send_recv+0x10/0x10 [cifs] ? __create_object+0x5e/0x90 ? hlock_class+0x32/0xb0 ? do_raw_spin_unlock+0x9a/0xf0 cifs_send_recv+0x23/0x30 [cifs] SMB2_tcon+0x3ec/0xb30 [cifs] ? __pfx_SMB2_tcon+0x10/0x10 [cifs] ? lock_acquire.part.0+0xf4/0x2a0 ? __pfx_lock_release+0x10/0x10 ? do_raw_spin_trylock+0xc6/0x120 ? lock_acquire+0x3f/0x90 ? _get_xid+0x16/0xd0 [cifs] ? __pfx_SMB2_tcon+0x10/0x10 [cifs] ? cifs_get_smb_ses+0xcdd/0x10a0 [cifs] cifs_get_smb_ses+0xcdd/0x10a0 [cifs] ? __pfx_cifs_get_smb_ses+0x10/0x10 [cifs] ? cifs_get_tcp_session+0xaa0/0xca0 [cifs] cifs_mount_get_session+0x8a/0x210 [cifs] dfs_mount_share+0x1b0/0x11d0 [cifs] ? __pfx___lock_acquire+0x10/0x10 ? __pfx_dfs_mount_share+0x10/0x10 [cifs] ? lock_acquire.part.0+0xf4/0x2a0 ? find_held_lock+0x8a/0xa0 ? hlock_class+0x32/0xb0 ? lock_release+0x203/0x5d0 cifs_mount+0xb3/0x3d0 [cifs] ? do_raw_spin_trylock+0xc6/0x120 ? __pfx_cifs_mount+0x10/0x10 [cifs] ? lock_acquire+0x3f/0x90 ? find_nls+0x16/0xa0 ? smb3_update_mnt_flags+0x372/0x3b0 [cifs] cifs_smb3_do_mount+0x1e2/0xc80 [cifs] ? __pfx_vfs_parse_fs_string+0x10/0x10 ? __pfx_cifs_smb3_do_mount+0x10/0x10 [cifs] smb3_get_tree+0x1bf/0x330 [cifs] vfs_get_tree+0x4a/0x160 path_mount+0x3c1/0xfb0 ? kasan_quarantine_put+0xc7/0x1d0 ? __pfx_path_mount+0x10/0x10 ? kmem_cache_free+0x118/0x3e0 ? user_path_at+0x74/0xa0 __x64_sys_mount+0x1a6/0x1e0 ? __pfx___x64_sys_mount+0x10/0x10 ? mark_held_locks+0x1a/0x90 do_syscall_64+0xbb/0x1d0 entry_SYSCALL_64_after_hwframe+0x77/0x7f","references":["https://git.kernel.org/stable/c/22127c1dc04364cda3da812161e70921e6c3c0af","https://git.kernel.org/stable/c/44c495818d9c4a741ab9e6bc9203ccc9f55f6f40","https://git.kernel.org/stable/c/46f8e25926817272ec8d5bfbd003569bdeb9a8c8"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[">=6.11.4","<6.11.11",">=6.6.57",">=6.12","<6.12.2","<6.6.64"]},
  {"id":"CVE-2024-53186","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix use-after-free in SMB request handlingA race condition exists between SMB request handling in`ksmbd_conn_handler_loop()` and the freeing of `ksmbd_conn` in theworkqueue handler `handle_ksmbd_work()`. This leads to a UAF.- KASAN: slab-use-after-free Read in handle_ksmbd_work- KASAN: slab-use-after-free in rtlock_slowlock_lockedThis race condition arises as follows:- `ksmbd_conn_handler_loop()` waits for `conn->r_count` to reach zero:  `wait_event(conn->r_count_q, atomic_read(&conn->r_count) == 0);`- Meanwhile, `handle_ksmbd_work()` decrements `conn->r_count` using  `atomic_dec_return(&conn->r_count)`, and if it reaches zero, calls  `ksmbd_conn_free()`, which frees `conn`.- However, after `handle_ksmbd_work()` decrements `conn->r_count`,  it may still access `conn->r_count_q` in the following line:  `waitqueue_active(&conn->r_count_q)` or `wake_up(&conn->r_count_q)`  This results in a UAF, as `conn` has already been freed.The discovery of this UAF can be referenced in the following PR forsyzkaller's support for SMB requests.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix use-after-free in SMB request handlingA race condition exists between SMB request handling in`ksmbd_conn_handler_loop()` and the freeing of `ksmbd_conn` in theworkqueue handler `handle_ksmbd_work()`. This leads to a UAF.- KASAN: slab-use-after-free Read in handle_ksmbd_work- KASAN: slab-use-after-free in rtlock_slowlock_lockedThis race condition arises as follows:- `ksmbd_conn_handler_loop()` waits for `conn->r_count` to reach zero:  `wait_event(conn->r_count_q, atomic_read(&conn->r_count) == 0);`- Meanwhile, `handle_ksmbd_work()` decrements `conn->r_count` using  `atomic_dec_return(&conn->r_count)`, and if it reaches zero, calls  `ksmbd_conn_free()`, which frees `conn`.- However, after `handle_ksmbd_work()` decrements `conn->r_count`,  it may still access `conn->r_count_q` in the following line:  `waitqueue_active(&conn->r_count_q)` or `wake_up(&conn->r_count_q)`  This results in a UAF, as `conn` has already been freed.The discovery of this UAF can be referenced in the following PR forsyzkaller's support for SMB requests.","references":["https://git.kernel.org/stable/c/96261adb998a3b513468b6ce17dbec76be5507d4","https://git.kernel.org/stable/c/9a8c5d89d327ff58e9b2517f8a6afb4181d32c6e","https://git.kernel.org/stable/c/a96f9eb7add30ba0fafcfe7b7aca090978196800"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<6.11.11",">=6.10.14",">=6.12","<6.11",">=6.11.3","<6.12.2","<6.6.64",">=6.6.55"]},
  {"id":"CVE-2024-54952","product":"smb","summary":"MikroTik RouterOS 6.40.5, the SMB service contains a memory corruption vulnerability. Remote, unauthenticated attackers can exploit this issue by sending specially crafted packets, triggering a null pointer dereference. This leads to a Remote Denial of Service (DoS), rendering the SMB service unavailable.","details":"MikroTik RouterOS 6.40.5, the SMB service contains a memory corruption vulnerability. Remote, unauthenticated attackers can exploit this issue by sending specially crafted packets, triggering a null pointer dereference. This leads to a Remote Denial of Service (DoS), rendering the SMB service unavailable.","references":["https://github.com/noobone123/RouterOS-issues/blob/main/README.md"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2024-56729","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: Initialize cfid->tcon before performing network opsAvoid leaking a tcon ref when a lease break races with opening thecached directory. Processing the leak break might take a reference tothe tcon in cached_dir_lease_break() and then fail to release the ref incached_dir_offload_close, since cfid->tcon is still NULL.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: Initialize cfid->tcon before performing network opsAvoid leaking a tcon ref when a lease break races with opening thecached directory. Processing the leak break might take a reference tothe tcon in cached_dir_lease_break() and then fail to release the ref incached_dir_offload_close, since cfid->tcon is still NULL.","references":["https://git.kernel.org/stable/c/1b9ab6b648f89441c8a13cb3fd8ca83ffebc5262","https://git.kernel.org/stable/c/4b216c8f9c7d84ef7de33ca60b97e08e03ef3292","https://git.kernel.org/stable/c/625e2357c8fcfae6e66dcc667dc656fe390bab15"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[">=6.1","<6.11.11",">=6.12","<6.12.2","<6.6.64",">=6.7"]},
  {"id":"CVE-2024-57895","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: set ATTR_CTIME flags when setting mtimeDavid reported that the new warning from setattr_copy_mgtime is cominglike the following.[  113.215316] ------------[ cut here ]------------[  113.215974] WARNING: CPU: 1 PID: 31 at fs/attr.c:300 setattr_copy+0x1ee/0x200[  113.219192] CPU: 1 UID: 0 PID: 31 Comm: kworker/1:1 Not tainted 6.13.0-rc1+ #234[  113.220127] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.2-3-gd478f380-rebuilt.opensuse.org 04/01/2014[  113.221530] Workqueue: ksmbd-io handle_ksmbd_work [ksmbd][  113.222220] RIP: 0010:setattr_copy+0x1ee/0x200[  113.222833] Code: 24 28 49 8b 44 24 30 48 89 53 58 89 43 6c 5b 41 5c 41 5d 41 5e 41 5f 5d c3 cc cc cc cc 48 89 df e8 77 d6 ff ff e9 cd fe ff ff <0f> 0b e9 be fe ff ff 66 0[  113.225110] RSP: 0018:ffffaf218010fb68 EFLAGS: 00010202[  113.225765] RAX: 0000000000000120 RBX: ffffa446815f8568 RCX: 0000000000000003[  113.226667] RDX: ffffaf218010fd38 RSI: ffffa446815f8568 RDI: ffffffff94eb03a0[  113.227531] RBP: ffffaf218010fb90 R08: 0000001a251e217d R09: 00000000675259fa[  113.228426] R10: 0000000002ba8a6d R11: ffffa4468196c7a8 R12: ffffaf218010fd38[  113.229304] R13: 0000000000000120 R14: ffffffff94eb03a0 R15: 0000000000000000[  113.230210] FS:  0000000000000000(0000) GS:ffffa44739d00000(0000) knlGS:0000000000000000[  113.231215] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033[  113.232055] CR2: 00007efe0053d27e CR3: 000000000331a000 CR4: 00000000000006b0[  113.232926] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000[  113.233812] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400[  113.234797] Call Trace:[  113.235116]  <TASK>[  113.235393]  ? __warn+0x73/0xd0[  113.235802]  ? setattr_copy+0x1ee/0x200[  113.236299]  ? report_bug+0xf3/0x1e0[  113.236757]  ? handle_bug+0x4d/0x90[  113.237202]  ? exc_invalid_op+0x13/0x60[  113.237689]  ? asm_exc_invalid_op+0x16/0x20[  113.238185]  ? setattr_copy+0x1ee/0x200[  113.238692]  btrfs_setattr+0x80/0x820 [btrfs][  113.239285]  ? get_stack_info_noinstr+0x12/0xf0[  113.239857]  ? __module_address+0x22/0xa0[  113.240368]  ? handle_ksmbd_work+0x6e/0x460 [ksmbd][  113.240993]  ? __module_text_address+0x9/0x50[  113.241545]  ? __module_address+0x22/0xa0[  113.242033]  ? unwind_next_frame+0x10e/0x920[  113.242600]  ? __pfx_stack_trace_consume_entry+0x10/0x10[  113.243268]  notify_change+0x2c2/0x4e0[  113.243746]  ? stack_depot_save_flags+0x27/0x730[  113.244339]  ? set_file_basic_info+0x130/0x2b0 [ksmbd][  113.244993]  set_file_basic_info+0x130/0x2b0 [ksmbd][  113.245613]  ? process_scheduled_works+0xbe/0x310[  113.246181]  ? worker_thread+0x100/0x240[  113.246696]  ? kthread+0xc8/0x100[  113.247126]  ? ret_from_fork+0x2b/0x40[  113.247606]  ? ret_from_fork_asm+0x1a/0x30[  113.248132]  smb2_set_info+0x63f/0xa70 [ksmbd]ksmbd is trying to set the atime and mtime via notify_change without alsosetting the ctime. so This patch add ATTR_CTIME flags when setting mtimeto avoid a warning.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: set ATTR_CTIME flags when setting mtimeDavid reported that the new warning from setattr_copy_mgtime is cominglike the following.[  113.215316] ------------[ cut here ]------------[  113.215974] WARNING: CPU: 1 PID: 31 at fs/attr.c:300 setattr_copy+0x1ee/0x200[  113.219192] CPU: 1 UID: 0 PID: 31 Comm: kworker/1:1 Not tainted 6.13.0-rc1+ #234[  113.220127] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.2-3-gd478f380-rebuilt.opensuse.org 04/01/2014[  113.221530] Workqueue: ksmbd-io handle_ksmbd_work [ksmbd][  113.222220] RIP: 0010:setattr_copy+0x1ee/0x200[  113.222833] Code: 24 28 49 8b 44 24 30 48 89 53 58 89 43 6c 5b 41 5c 41 5d 41 5e 41 5f 5d c3 cc cc cc cc 48 89 df e8 77 d6 ff ff e9 cd fe ff ff <0f> 0b e9 be fe ff ff 66 0[  113.225110] RSP: 0018:ffffaf218010fb68 EFLAGS: 00010202[  113.225765] RAX: 0000000000000120 RBX: ffffa446815f8568 RCX: 0000000000000003[  113.226667] RDX: ffffaf218010fd38 RSI: ffffa446815f8568 RDI: ffffffff94eb03a0[  113.227531] RBP: ffffaf218010fb90 R08: 0000001a251e217d R09: 00000000675259fa[  113.228426] R10: 0000000002ba8a6d R11: ffffa4468196c7a8 R12: ffffaf218010fd38[  113.229304] R13: 0000000000000120 R14: ffffffff94eb03a0 R15: 0000000000000000[  113.230210] FS:  0000000000000000(0000) GS:ffffa44739d00000(0000) knlGS:0000000000000000[  113.231215] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033[  113.232055] CR2: 00007efe0053d27e CR3: 000000000331a000 CR4: 00000000000006b0[  113.232926] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000[  113.233812] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400[  113.234797] Call Trace:[  113.235116]  <TASK>[  113.235393]  ? __warn+0x73/0xd0[  113.235802]  ? setattr_copy+0x1ee/0x200[  113.236299]  ? report_bug+0xf3/0x1e0[  113.236757]  ? handle_bug+0x4d/0x90[  113.237202]  ? exc_invalid_op+0x13/0x60[  113.237689]  ? asm_exc_invalid_op+0x16/0x20[  113.238185]  ? setattr_copy+0x1ee/0x200[  113.238692]  btrfs_setattr+0x80/0x820 [btrfs][  113.239285]  ? get_stack_info_noinstr+0x12/0xf0[  113.239857]  ? __module_address+0x22/0xa0[  113.240368]  ? handle_ksmbd_work+0x6e/0x460 [ksmbd][  113.240993]  ? __module_text_address+0x9/0x50[  113.241545]  ? __module_address+0x22/0xa0[  113.242033]  ? unwind_next_frame+0x10e/0x920[  113.242600]  ? __pfx_stack_trace_consume_entry+0x10/0x10[  113.243268]  notify_change+0x2c2/0x4e0[  113.243746]  ? stack_depot_save_flags+0x27/0x730[  113.244339]  ? set_file_basic_info+0x130/0x2b0 [ksmbd][  113.244993]  set_file_basic_info+0x130/0x2b0 [ksmbd][  113.245613]  ? process_scheduled_works+0xbe/0x310[  113.246181]  ? worker_thread+0x100/0x240[  113.246696]  ? kthread+0xc8/0x100[  113.247126]  ? ret_from_fork+0x2b/0x40[  113.247606]  ? ret_from_fork_asm+0x1a/0x30[  113.248132]  smb2_set_info+0x63f/0xa70 [ksmbd]ksmbd is trying to set the atime and mtime via notify_change without alsosetting the ctime. so This patch add ATTR_CTIME flags when setting mtimeto avoid a warning.","references":["https://git.kernel.org/stable/c/1d7ee876b8b96efc14e177a7fe8d45ac25d68849","https://git.kernel.org/stable/c/21e46a79bbe6c4e1aa73b3ed998130f2ff07b128","https://git.kernel.org/stable/c/52cefcff6a4a814f4f8e357422fcfb71fd2ebf75"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<6.6.70",">=6.7","<6.12.9"],[">=5.15"]]},
  {"id":"CVE-2024-57925","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix a missing return value check bugIn the smb2_send_interim_resp(), if ksmbd_alloc_work_struct()fails to allocate a node, it returns a NULL pointer to thein_work pointer. This can lead to an illegal memory write ofin_work->response_buf when allocate_interim_rsp_buf() attemptsto perform a kzalloc() on it.To address this issue, incorporating a check for the returnvalue of ksmbd_alloc_work_struct() ensures that the functionreturns immediately upon allocation failure, thereby preventingthe aforementioned illegal memory access.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix a missing return value check bugIn the smb2_send_interim_resp(), if ksmbd_alloc_work_struct()fails to allocate a node, it returns a NULL pointer to thein_work pointer. This can lead to an illegal memory write ofin_work->response_buf when allocate_interim_rsp_buf() attemptsto perform a kzalloc() on it.To address this issue, incorporating a check for the returnvalue of ksmbd_alloc_work_struct() ensures that the functionreturns immediately upon allocation failure, thereby preventingthe aforementioned illegal memory access.","references":["https://git.kernel.org/stable/c/271ae0edbfc942795c162e6cf20d2bc02bd7fde4","https://git.kernel.org/stable/c/2976e91a3e569cf2c92c9f71512c0ab1312fe965","https://git.kernel.org/stable/c/4c16e1cadcbcaf3c82d5fc310fbd34d0f5d0db7c"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[["<6.1.125",">=6.6","<6.12.10",">=6.7",">=6.1.71","<6.6.72"],["<5.16",">=5.15.145"]]},
  {"id":"CVE-2024-8260","product":"smb","summary":"A SMB force-authentication vulnerability exists in all versions of OPA for Windows prior to v0.68.0. The vulnerability exists because of improper input validation, allowing a user to pass an arbitrary SMB share instead of a Rego file as an argument to OPA CLI or to one of the OPA Go library's functions.","details":"A SMB force-authentication vulnerability exists in all versions of OPA for Windows prior to v0.68.0. The vulnerability exists because of improper input validation, allowing a user to pass an arbitrary SMB share instead of a Rego file as an argument to OPA CLI or to one of the OPA Go library's functions.","references":["https://www.tenable.com/security/research/tra-2024-36"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":"<0.68.0"},
  {"id":"CVE-2025-0620","product":"smb","summary":"A flaw was found in Samba. The smbd service daemon does not pick up group membership changes when re-authenticating an expired SMB session. This issue can expose file shares until clients disconnect and then connect again.","details":"A flaw was found in Samba. The smbd service daemon does not pick up group membership changes when re-authenticating an expired SMB session. This issue can expose file shares until clients disconnect and then connect again.","references":["https://access.redhat.com/security/cve/CVE-2025-0620","https://bugzilla.redhat.com/show_bug.cgi?id=2370453","https://www.samba.org/samba/security/CVE-2025-0620.html"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-1048","product":"smb","summary":"Sonos Era 300 Speaker libsmb2 Use-After-Free Remote Code Execution Vulnerability. This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of Sonos Era 300 speakers. Authentication is not required to exploit this vulnerability.The specific flaw exists within the processing of SMB data. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to execute code in the context of the anacapa user. Was ZDI-CAN-25535.","details":"Sonos Era 300 Speaker libsmb2 Use-After-Free Remote Code Execution Vulnerability. This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of Sonos Era 300 speakers. Authentication is not required to exploit this vulnerability.The specific flaw exists within the processing of SMB data. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to execute code in the context of the anacapa user. Was ZDI-CAN-25535.","references":["https://www.zerodayinitiative.com/advisories/ZDI-25-223/"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-1868","product":"smb","summary":"Vulnerability of unauthorized exposure of confidential information affecting Advanced IP Scanner and Advanced Port Scanner. It occurs when these applications initiate a network scan, inadvertently sending the NTLM hash of the user performing the scan. This vulnerability can be exploited by intercepting network traffic to a legitimate server or by setting up a fake server, in both local and remote scenarios. This exposure is relevant for both HTTP/HTTPS and SMB protocols.","details":"Vulnerability of unauthorized exposure of confidential information affecting Advanced IP Scanner and Advanced Port Scanner. It occurs when these applications initiate a network scan, inadvertently sending the NTLM hash of the user performing the scan. This vulnerability can be exploited by intercepting network traffic to a legitimate server or by setting up a fake server, in both local and remote scenarios. This exposure is relevant for both HTTP/HTTPS and SMB protocols.","references":["https://www.incibe.es/en/incibe-cert/notices/aviso/information-display-multiple-products-famatech-corp"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-1887","product":"smb","summary":"SMB forced authentication vulnerability in versions prior to 2025.35.000 of Sage 200 Spain. This vulnerability allows an authenticated attacker with administrator privileges to obtain NTLMv2-SSP Hash by changing any of the paths to a UNC path pointing to a server controlled by the attacker.","details":"SMB forced authentication vulnerability in versions prior to 2025.35.000 of Sage 200 Spain. This vulnerability allows an authenticated attacker with administrator privileges to obtain NTLMv2-SSP Hash by changing any of the paths to a UNC path pointing to a server controlled by the attacker.","references":["https://www.incibe.es/en/incibe-cert/notices/aviso/multiple-vulnerabilities-sage-200-spain"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-21673","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix double free of TCP_Server_Info::hostnameWhen shutting down the server in cifs_put_tcp_session(), cifsd threadmight be reconnecting to multiple DFS targets before it realizes itshould exit the loop, so @server->hostname can't be freed as long ascifsd thread isn't done.  Otherwise the following can happen:  RIP: 0010:__slab_free+0x223/0x3c0  Code: 5e 41 5f c3 cc cc cc cc 4c 89 de 4c 89 cf 44 89 44 24 08 4c 89  1c 24 e8 fb cf 8e 00 44 8b 44 24 08 4c 8b 1c 24 e9 5f fe ff ff <0f>  0b 41 f7 45 08 00 0d 21 00 0f 85 2d ff ff ff e9 1f ff ff ff 80  RSP: 0018:ffffb26180dbfd08 EFLAGS: 00010246  RAX: ffff8ea34728e510 RBX: ffff8ea34728e500 RCX: 0000000000800068  RDX: 0000000000800068 RSI: 0000000000000000 RDI: ffff8ea340042400  RBP: ffffe112041ca380 R08: 0000000000000001 R09: 0000000000000000  R10: 6170732e31303000 R11: 70726f632e786563 R12: ffff8ea34728e500  R13: ffff8ea340042400 R14: ffff8ea34728e500 R15: 0000000000800068  FS: 0000000000000000(0000) GS:ffff8ea66fd80000(0000)  000000  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033  CR2: 00007ffc25376080 CR3: 000000012a2ba001 CR4:  PKRU: 55555554  Call Trace:   <TASK>   ? show_trace_log_lvl+0x1c4/0x2df   ? show_trace_log_lvl+0x1c4/0x2df   ? __reconnect_target_unlocked+0x3e/0x160 [cifs]   ? __die_body.cold+0x8/0xd   ? die+0x2b/0x50   ? do_trap+0xce/0x120   ? __slab_free+0x223/0x3c0   ? do_error_trap+0x65/0x80   ? __slab_free+0x223/0x3c0   ? exc_invalid_op+0x4e/0x70   ? __slab_free+0x223/0x3c0   ? asm_exc_invalid_op+0x16/0x20   ? __slab_free+0x223/0x3c0   ? extract_hostname+0x5c/0xa0 [cifs]   ? extract_hostname+0x5c/0xa0 [cifs]   ? __kmalloc+0x4b/0x140   __reconnect_target_unlocked+0x3e/0x160 [cifs]   reconnect_dfs_server+0x145/0x430 [cifs]   cifs_handle_standard+0x1ad/0x1d0 [cifs]   cifs_demultiplex_thread+0x592/0x730 [cifs]   ? __pfx_cifs_demultiplex_thread+0x10/0x10 [cifs]   kthread+0xdd/0x100   ? __pfx_kthread+0x10/0x10   ret_from_fork+0x29/0x50   </TASK>","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix double free of TCP_Server_Info::hostnameWhen shutting down the server in cifs_put_tcp_session(), cifsd threadmight be reconnecting to multiple DFS targets before it realizes itshould exit the loop, so @server->hostname can't be freed as long ascifsd thread isn't done.  Otherwise the following can happen:  RIP: 0010:__slab_free+0x223/0x3c0  Code: 5e 41 5f c3 cc cc cc cc 4c 89 de 4c 89 cf 44 89 44 24 08 4c 89  1c 24 e8 fb cf 8e 00 44 8b 44 24 08 4c 8b 1c 24 e9 5f fe ff ff <0f>  0b 41 f7 45 08 00 0d 21 00 0f 85 2d ff ff ff e9 1f ff ff ff 80  RSP: 0018:ffffb26180dbfd08 EFLAGS: 00010246  RAX: ffff8ea34728e510 RBX: ffff8ea34728e500 RCX: 0000000000800068  RDX: 0000000000800068 RSI: 0000000000000000 RDI: ffff8ea340042400  RBP: ffffe112041ca380 R08: 0000000000000001 R09: 0000000000000000  R10: 6170732e31303000 R11: 70726f632e786563 R12: ffff8ea34728e500  R13: ffff8ea340042400 R14: ffff8ea34728e500 R15: 0000000000800068  FS: 0000000000000000(0000) GS:ffff8ea66fd80000(0000)  000000  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033  CR2: 00007ffc25376080 CR3: 000000012a2ba001 CR4:  PKRU: 55555554  Call Trace:   <TASK>   ? show_trace_log_lvl+0x1c4/0x2df   ? show_trace_log_lvl+0x1c4/0x2df   ? __reconnect_target_unlocked+0x3e/0x160 [cifs]   ? __die_body.cold+0x8/0xd   ? die+0x2b/0x50   ? do_trap+0xce/0x120   ? __slab_free+0x223/0x3c0   ? do_error_trap+0x65/0x80   ? __slab_free+0x223/0x3c0   ? exc_invalid_op+0x4e/0x70   ? __slab_free+0x223/0x3c0   ? asm_exc_invalid_op+0x16/0x20   ? __slab_free+0x223/0x3c0   ? extract_hostname+0x5c/0xa0 [cifs]   ? extract_hostname+0x5c/0xa0 [cifs]   ? __kmalloc+0x4b/0x140   __reconnect_target_unlocked+0x3e/0x160 [cifs]   reconnect_dfs_server+0x145/0x430 [cifs]   cifs_handle_standard+0x1ad/0x1d0 [cifs]   cifs_demultiplex_thread+0x592/0x730 [cifs]   ? __pfx_cifs_demultiplex_thread+0x10/0x10 [cifs]   kthread+0xdd/0x100   ? __pfx_kthread+0x10/0x10   ret_from_fork+0x29/0x50   </TASK>","references":["https://git.kernel.org/stable/c/1ea68070338518a1d31ce71e6abfe1b30001b27a","https://git.kernel.org/stable/c/a2be5f2ba34d0c6d5ef2624b24e3d852561fcd6a","https://git.kernel.org/stable/c/fa2f9906a7b333ba757a7dbae0713d8a5396186e"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[[">=5.14.19",">=5.15.3","<5.15"],[">=6.7","<6.12.11","<6.6.74"]]},
  {"id":"CVE-2025-21676","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:net: fec: handle page_pool_dev_alloc_pages errorThe fec_enet_update_cbd function calls page_pool_dev_alloc_pages but didnot handle the case when it returned NULL. There was a WARN_ON(!new_page)but it would still proceed to use the NULL pointer and then crash.This case does seem somewhat rare but when the system is under memorypressure it can happen. One case where I can duplicate this with somefrequency is when writing over a smbd share to a SATA HDD attached to animx6q.Setting /proc/sys/vm/min_free_kbytes to higher values also seems to solvethe problem for my test case. But it still seems wrong that the fec driverignores the memory allocation error and can crash.This commit handles the allocation error by dropping the current packet.","details":"In the Linux kernel, the following vulnerability has been resolved:net: fec: handle page_pool_dev_alloc_pages errorThe fec_enet_update_cbd function calls page_pool_dev_alloc_pages but didnot handle the case when it returned NULL. There was a WARN_ON(!new_page)but it would still proceed to use the NULL pointer and then crash.This case does seem somewhat rare but when the system is under memorypressure it can happen. One case where I can duplicate this with somefrequency is when writing over a smbd share to a SATA HDD attached to animx6q.Setting /proc/sys/vm/min_free_kbytes to higher values also seems to solvethe problem for my test case. But it still seems wrong that the fec driverignores the memory allocation error and can crash.This commit handles the allocation error by dropping the current packet.","references":["https://git.kernel.org/stable/c/001ba0902046cb6c352494df610718c0763e77a5","https://git.kernel.org/stable/c/1425cb829556398f594658512d49292f988a2ab0","https://git.kernel.org/stable/c/8a0097db0544b658c159ac787319737712063a23"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.12.11",">=6.1",">=6.7","<6.6.74"]},
  {"id":"CVE-2025-21725","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix oops due to unset link speedIt isn't guaranteed that NETWORK_INTERFACE_INFO::LinkSpeed will alwaysbe set by the server, so the client must handle any values and thenprevent oopses like below from happening:Oops: divide error: 0000 [#1] PREEMPT SMP KASAN NOPTICPU: 0 UID: 0 PID: 1323 Comm: cat Not tainted 6.13.0-rc7 #2Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-3.fc4104/01/2014RIP: 0010:cifs_debug_data_proc_show+0xa45/0x1460 [cifs] Code: 00 00 4889 df e8 3b cd 1b c1 41 f6 44 24 2c 04 0f 84 50 01 00 00 48 89 ef e8e7 d0 1b c1 49 8b 44 24 18 31 d2 49 8d 7c 24 28 <48> f7 74 24 18 48 89c3 e8 6e cf 1b c1 41 8b 6c 24 28 49 8d 7c 24RSP: 0018:ffffc90001817be0 EFLAGS: 00010246RAX: 0000000000000000 RBX: ffff88811230022c RCX: ffffffffc041bd99RDX: 0000000000000000 RSI: 0000000000000567 RDI: ffff888112300228RBP: ffff888112300218 R08: fffff52000302f5f R09: ffffed1022fa58acR10: ffff888117d2c566 R11: 00000000fffffffe R12: ffff888112300200R13: 000000012a15343f R14: 0000000000000001 R15: ffff888113f2db58FS: 00007fe27119e740(0000) GS:ffff888148600000(0000)knlGS:0000000000000000CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033CR2: 00007fe2633c5000 CR3: 0000000124da0000 CR4: 0000000000750ef0PKRU: 55555554Call Trace: <TASK> ? __die_body.cold+0x19/0x27 ? die+0x2e/0x50 ? do_trap+0x159/0x1b0 ? cifs_debug_data_proc_show+0xa45/0x1460 [cifs] ? do_error_trap+0x90/0x130 ? cifs_debug_data_proc_show+0xa45/0x1460 [cifs] ? exc_divide_error+0x39/0x50 ? cifs_debug_data_proc_show+0xa45/0x1460 [cifs] ? asm_exc_divide_error+0x1a/0x20 ? cifs_debug_data_proc_show+0xa39/0x1460 [cifs] ? cifs_debug_data_proc_show+0xa45/0x1460 [cifs] ? seq_read_iter+0x42e/0x790 seq_read_iter+0x19a/0x790 proc_reg_read_iter+0xbe/0x110 ? __pfx_proc_reg_read_iter+0x10/0x10 vfs_read+0x469/0x570 ? do_user_addr_fault+0x398/0x760 ? __pfx_vfs_read+0x10/0x10 ? find_held_lock+0x8a/0xa0 ? __pfx_lock_release+0x10/0x10 ksys_read+0xd3/0x170 ? __pfx_ksys_read+0x10/0x10 ? __rcu_read_unlock+0x50/0x270 ? mark_held_locks+0x1a/0x90 do_syscall_64+0xbb/0x1d0 entry_SYSCALL_64_after_hwframe+0x77/0x7fRIP: 0033:0x7fe271288911Code: 00 48 8b 15 01 25 10 00 f7 d8 64 89 02 b8 ff ff ff ff eb bd e820 ad 01 00 f3 0f 1e fa 80 3d b5 a7 10 00 00 74 13 31 c0 0f 05 <48> 3d00 f0 ff ff 77 4f c3 66 0f 1f 44 00 00 55 48 89 e5 48 83 ecRSP: 002b:00007ffe87c079d8 EFLAGS: 00000246 ORIG_RAX: 0000000000000000RAX: ffffffffffffffda RBX: 0000000000040000 RCX: 00007fe271288911RDX: 0000000000040000 RSI: 00007fe2633c6000 RDI: 0000000000000003RBP: 00007ffe87c07a00 R08: 0000000000000000 R09: 00007fe2713e6380R10: 0000000000000022 R11: 0000000000000246 R12: 0000000000040000R13: 00007fe2633c6000 R14: 0000000000000003 R15: 0000000000000000 </TASK>Fix this by setting cifs_server_iface::speed to a sane value (1Gbps)by default when link speed is unset.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix oops due to unset link speedIt isn't guaranteed that NETWORK_INTERFACE_INFO::LinkSpeed will alwaysbe set by the server, so the client must handle any values and thenprevent oopses like below from happening:Oops: divide error: 0000 [#1] PREEMPT SMP KASAN NOPTICPU: 0 UID: 0 PID: 1323 Comm: cat Not tainted 6.13.0-rc7 #2Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-3.fc4104/01/2014RIP: 0010:cifs_debug_data_proc_show+0xa45/0x1460 [cifs] Code: 00 00 4889 df e8 3b cd 1b c1 41 f6 44 24 2c 04 0f 84 50 01 00 00 48 89 ef e8e7 d0 1b c1 49 8b 44 24 18 31 d2 49 8d 7c 24 28 <48> f7 74 24 18 48 89c3 e8 6e cf 1b c1 41 8b 6c 24 28 49 8d 7c 24RSP: 0018:ffffc90001817be0 EFLAGS: 00010246RAX: 0000000000000000 RBX: ffff88811230022c RCX: ffffffffc041bd99RDX: 0000000000000000 RSI: 0000000000000567 RDI: ffff888112300228RBP: ffff888112300218 R08: fffff52000302f5f R09: ffffed1022fa58acR10: ffff888117d2c566 R11: 00000000fffffffe R12: ffff888112300200R13: 000000012a15343f R14: 0000000000000001 R15: ffff888113f2db58FS: 00007fe27119e740(0000) GS:ffff888148600000(0000)knlGS:0000000000000000CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033CR2: 00007fe2633c5000 CR3: 0000000124da0000 CR4: 0000000000750ef0PKRU: 55555554Call Trace: <TASK> ? __die_body.cold+0x19/0x27 ? die+0x2e/0x50 ? do_trap+0x159/0x1b0 ? cifs_debug_data_proc_show+0xa45/0x1460 [cifs] ? do_error_trap+0x90/0x130 ? cifs_debug_data_proc_show+0xa45/0x1460 [cifs] ? exc_divide_error+0x39/0x50 ? cifs_debug_data_proc_show+0xa45/0x1460 [cifs] ? asm_exc_divide_error+0x1a/0x20 ? cifs_debug_data_proc_show+0xa39/0x1460 [cifs] ? cifs_debug_data_proc_show+0xa45/0x1460 [cifs] ? seq_read_iter+0x42e/0x790 seq_read_iter+0x19a/0x790 proc_reg_read_iter+0xbe/0x110 ? __pfx_proc_reg_read_iter+0x10/0x10 vfs_read+0x469/0x570 ? do_user_addr_fault+0x398/0x760 ? __pfx_vfs_read+0x10/0x10 ? find_held_lock+0x8a/0xa0 ? __pfx_lock_release+0x10/0x10 ksys_read+0xd3/0x170 ? __pfx_ksys_read+0x10/0x10 ? __rcu_read_unlock+0x50/0x270 ? mark_held_locks+0x1a/0x90 do_syscall_64+0xbb/0x1d0 entry_SYSCALL_64_after_hwframe+0x77/0x7fRIP: 0033:0x7fe271288911Code: 00 48 8b 15 01 25 10 00 f7 d8 64 89 02 b8 ff ff ff ff eb bd e820 ad 01 00 f3 0f 1e fa 80 3d b5 a7 10 00 00 74 13 31 c0 0f 05 <48> 3d00 f0 ff ff 77 4f c3 66 0f 1f 44 00 00 55 48 89 e5 48 83 ecRSP: 002b:00007ffe87c079d8 EFLAGS: 00000246 ORIG_RAX: 0000000000000000RAX: ffffffffffffffda RBX: 0000000000040000 RCX: 00007fe271288911RDX: 0000000000040000 RSI: 00007fe2633c6000 RDI: 0000000000000003RBP: 00007ffe87c07a00 R08: 0000000000000000 R09: 00007fe2713e6380R10: 0000000000000022 R11: 0000000000000246 R12: 0000000000040000R13: 00007fe2633c6000 R14: 0000000000000003 R15: 0000000000000000 </TASK>Fix this by setting cifs_server_iface::speed to a sane value (1Gbps)by default when link speed is unset.","references":["https://git.kernel.org/stable/c/208e102a2fca44e40a6c3f7b9e2609cfd17a15aa","https://git.kernel.org/stable/c/3f901c35e1a1b3ed1b528a17ffdb941aa0294458","https://git.kernel.org/stable/c/699179dfc8d7da457b152ca5d18ae45f9ed9beaa"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-21844","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: Add check for next_buffer in receive_encrypted_standard()Add check for the return value of cifs_buf_get() and cifs_small_buf_get()in receive_encrypted_standard() to prevent null pointer dereference.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: Add check for next_buffer in receive_encrypted_standard()Add check for the return value of cifs_buf_get() and cifs_small_buf_get()in receive_encrypted_standard() to prevent null pointer dereference.","references":["https://git.kernel.org/stable/c/24e8e4523d3071bc5143b0db9127d511489f7b3b","https://git.kernel.org/stable/c/554736b583f529ee159aa95af9a0cbc12b5ffc96","https://git.kernel.org/stable/c/860ca5e50f73c2a1cef7eefc9d39d04e275417f7"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<6.13.5",">=6.1.69",">=6.6.8","<6.6.80","<6.1.130","<6.12.17",">=6.7",">=6.13"]},
  {"id":"CVE-2025-21944","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix bug on trap in smb2_lockIf lock count is greater than 1, flags could be old value.It should be checked with flags of smb_lock, not flags.It will cause bug-on trap from locks_free_lock in error handlingroutine.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix bug on trap in smb2_lockIf lock count is greater than 1, flags could be old value.It should be checked with flags of smb_lock, not flags.It will cause bug-on trap from locks_free_lock in error handlingroutine.","references":["https://git.kernel.org/stable/c/11e0e74e14f1832a95092f2c98ed3b99f57797ee","https://git.kernel.org/stable/c/2b70e3ac79eacbdf32571f7af48dd81cdd957ca8","https://git.kernel.org/stable/c/8994f0ce8259f812b4f4a681d8298c6ff682efaa"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-21945","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix use-after-free in smb2_lockIf smb_lock->zero_len has value, ->llist of smb_lock is not delete andflock is old one. It will cause use-after-free on error handlingroutine.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix use-after-free in smb2_lockIf smb_lock->zero_len has value, ->llist of smb_lock is not delete andflock is old one. It will cause use-after-free on error handlingroutine.","references":["https://git.kernel.org/stable/c/410ce35a2ed6d0e114132bba29af49b69880c8c7","https://git.kernel.org/stable/c/636e021646cf9b52ddfea7c809b018e91f2188cb","https://git.kernel.org/stable/c/84d2d1641b71dec326e8736a749b7ee76a9599fc"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":[[">=6.13","<6.6.83",">=6.7","<6.12.19","<6.13.7",">=6.2","<6.1.131"],[">=5.15"]]},
  {"id":"CVE-2025-21946","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix out-of-bounds in parse_sec_desc()If osidoffset, gsidoffset and dacloffset could be greater than smb_ntsdstruct size. If it is smaller, It could cause slab-out-of-bounds.And when validating sid, It need to check it included subauth array size.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix out-of-bounds in parse_sec_desc()If osidoffset, gsidoffset and dacloffset could be greater than smb_ntsdstruct size. If it is smaller, It could cause slab-out-of-bounds.And when validating sid, It need to check it included subauth array size.","references":["https://git.kernel.org/stable/c/159d059cbcb0e6d0e7a7b34af3862ba09a6b22d1","https://git.kernel.org/stable/c/6a9831180d0b23b5c97e2bd841aefc8f82900172","https://git.kernel.org/stable/c/c1569dbbe2d43041be9f3fef7ca08bec3b66ad1b"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-21994","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix incorrect validation for num_aces field of smb_aclparse_dcal() validate num_aces to allocate posix_ace_state_array.if (num_aces > ULONG_MAX / sizeof(struct smb_ace *))It is an incorrect validation that we can create an array of size ULONG_MAX.smb_acl has ->size field to calculate actual number of aces in request buffersize. Use this to check invalid num_aces.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix incorrect validation for num_aces field of smb_aclparse_dcal() validate num_aces to allocate posix_ace_state_array.if (num_aces > ULONG_MAX / sizeof(struct smb_ace *))It is an incorrect validation that we can create an array of size ULONG_MAX.smb_acl has ->size field to calculate actual number of aces in request buffersize. Use this to check invalid num_aces.","references":["https://git.kernel.org/stable/c/1b8b67f3c5e5169535e26efedd3e422172e2db64","https://git.kernel.org/stable/c/9c4e202abff45f8eac17989e549fc7a75095f675","https://git.kernel.org/stable/c/a4cb17797a5d241f1e509cb5b46ed95a80c2f5fd"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-22037","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix null pointer dereference in alloc_preauth_hash()The Client send malformed smb2 negotiate request. ksmbd return errorresponse. Subsequently, the client can send smb2 session setup eventhought conn->preauth_info is not allocated.This patch add KSMBD_SESS_NEED_SETUP status of connection to ignoresession setup request if smb2 negotiate phase is not complete.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix null pointer dereference in alloc_preauth_hash()The Client send malformed smb2 negotiate request. ksmbd return errorresponse. Subsequently, the client can send smb2 session setup eventhought conn->preauth_info is not allocated.This patch add KSMBD_SESS_NEED_SETUP status of connection to ignoresession setup request if smb2 negotiate phase is not complete.","references":["https://git.kernel.org/stable/c/8f216b33a5e1b3489c073b1ea1b3d7cb63c8dc4d","https://git.kernel.org/stable/c/b8eb243e670ecf30e91524dd12f7260dac07d335","https://git.kernel.org/stable/c/c8b5b7c5da7d0c31c9b7190b4a7bba5281fc4780"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[">=6.14","<6.14.2","<6.13.11","<6.12.23",">=6.13"]},
  {"id":"CVE-2025-22039","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix overflow in dacloffset bounds checkThe dacloffset field was originally typed as int and used in anunchecked addition, which could overflow and bypass the existingbounds check in both smb_check_perm_dacl() and smb_inherit_dacl().This could result in out-of-bounds memory access and a kernel crashwhen dereferencing the DACL pointer.This patch converts dacloffset to unsigned int and usescheck_add_overflow() to validate access to the DACL.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix overflow in dacloffset bounds checkThe dacloffset field was originally typed as int and used in anunchecked addition, which could overflow and bypass the existingbounds check in both smb_check_perm_dacl() and smb_inherit_dacl().This could result in out-of-bounds memory access and a kernel crashwhen dereferencing the DACL pointer.This patch converts dacloffset to unsigned int and usescheck_add_overflow() to validate access to the DACL.","references":["https://git.kernel.org/stable/c/443b373a4df5a2cb9f7b8c4658b2afedeb16397f","https://git.kernel.org/stable/c/6a9cd9ff0fa2bcc30b2bfb8bdb161eb20e44b9dc","https://git.kernel.org/stable/c/6b8d379048b168a0dff5ab1acb975b933f368514"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-27456","product":"smb","summary":"The SMB server's login mechanism does not implement sufficient measures to prevent multiple failed authentication attempts within a short time frame, making it susceptible to brute-force attacks.","details":"The SMB server's login mechanism does not implement sufficient measures to prevent multiple failed authentication attempts within a short time frame, making it susceptible to brute-force attacks.","references":["https://sick.com/psirt","https://sick.com/psirt","https://www.cisa.gov/resources-tools/resources/ics-recommended-practices"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-29956","product":"smb","summary":"Buffer over-read in Windows SMB allows an authorized attacker to disclose information over a network.","details":"Buffer over-read in Windows SMB allows an authorized attacker to disclose information over a network.","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-29956"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":["<10.0.14393.8066","<10.0.22631.5335","<10.0.26100.4061","<10.0.25398.1611","<10.0.20348.3692","<10.0.10240.21014","<10.0.22621.5335","<10.0.19045.5854","<10.0.17763.7314","<10.0.19044.5854"]},
  {"id":"CVE-2025-30444","product":"smb","summary":"A race condition was addressed with improved locking. This issue is fixed in macOS Ventura 13.7.5, macOS Sequoia 15.4, macOS Sonoma 14.7.5. Mounting a maliciously crafted SMB network share may lead to system termination.","details":"A race condition was addressed with improved locking. This issue is fixed in macOS Ventura 13.7.5, macOS Sequoia 15.4, macOS Sonoma 14.7.5. Mounting a maliciously crafted SMB network share may lead to system termination.","references":["https://support.apple.com/en-us/122373","https://support.apple.com/en-us/122374","https://support.apple.com/en-us/122375"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":[[">=15.0","<15.4"],["<14.7.5",">=14.0"],["<13.7.5",">=13.0"]]},
  {"id":"CVE-2025-31477","product":"smb","summary":"The Tauri shell plugin allows access to the system shell. Prior to 2.2.1, the Tauri shell plugin exposes functionality to execute code and open programs on the system. The open endpoint of this plugin is designed to allow open functionality with the system opener (e.g. xdg-open on Linux). This was meant to be restricted to a reasonable number of protocols like https or mailto by default. This default restriction was not functional due to improper validation of the allowed protocols, allowing for potentially dangerous protocols like file://, smb://, or nfs:// and others to be opened by the system registered protocol handler. By passing untrusted user input to the open endpoint these potentially dangerous protocols can be abused to gain remote code execution on the system. This either requires direct exposure of the endpoint to application users or code execution in the frontend of a Tauri application. This vulnerability is fixed in 2.2.1.","details":"The Tauri shell plugin allows access to the system shell. Prior to 2.2.1, the Tauri shell plugin exposes functionality to execute code and open programs on the system. The open endpoint of this plugin is designed to allow open functionality with the system opener (e.g. xdg-open on Linux). This was meant to be restricted to a reasonable number of protocols like https or mailto by default. This default restriction was not functional due to improper validation of the allowed protocols, allowing for potentially dangerous protocols like file://, smb://, or nfs:// and others to be opened by the system registered protocol handler. By passing untrusted user input to the open endpoint these potentially dangerous protocols can be abused to gain remote code execution on the system. This either requires direct exposure of the endpoint to application users or code execution in the frontend of a Tauri application. This vulnerability is fixed in 2.2.1.","references":["https://github.com/tauri-apps/plugins-workspace/commit/9cf0390a52497e273db1a1b613a0e26827aa327c","https://github.com/tauri-apps/plugins-workspace/security/advisories/GHSA-c9pr-q8gx-3mgp","https://github.com/tauri-apps/plugins-workspace/security/advisories/GHSA-c9pr-q8gx-3mgp"],"severity":"CRITICAL","match_type":"version_range","confidence":"high","version_match":"<2.2.1"},
  {"id":"CVE-2025-32103","product":"smb","summary":"CrushFTP 9.x and 10.x through 10.8.4 and 11.x through 11.3.1 allows directory traversal via the /WebInterface/function/ URI to read files accessible by SMB at UNC share pathnames, bypassing SecurityManager restrictions.","details":"CrushFTP 9.x and 10.x through 10.8.4 and 11.x through 11.3.1 allows directory traversal via the /WebInterface/function/ URI to read files accessible by SMB at UNC share pathnames, bypassing SecurityManager restrictions.","references":["https://packetstorm.news/files/id/190460/","https://seclists.org/fulldisclosure/2025/Apr/17","https://www.crushftp.com/"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<=11.3.1"],[">=9.0.0"]]},
  {"id":"CVE-2025-32718","product":"smb","summary":"Integer overflow or wraparound in Windows SMB allows an authorized attacker to elevate privileges locally.","details":"Integer overflow or wraparound in Windows SMB allows an authorized attacker to elevate privileges locally.","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-32718"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<10.0.17763.7434","<10.0.25398.1665","<10.0.26100.4270","<10.0.14393.8148","<10.0.10240.21034","<10.0.22631.5472","<10.0.22621.5472","<10.0.19045.5965","<10.0.20348.3745","<10.0.19044.5965"]},
  {"id":"CVE-2025-33073","product":"smb","summary":"Improper access control in Windows SMB allows an authorized attacker to elevate privileges over a network.","details":"Improper access control in Windows SMB allows an authorized attacker to elevate privileges over a network.","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-33073"],"severity":"HIGH","match_type":"version_range","confidence":"high","version_match":["<10.0.17763.7434","<10.0.25398.1665","<10.0.26100.4270","<10.0.14393.8148","<10.0.10240.21034","<10.0.22631.5472","<10.0.22621.5472","<10.0.19045.5965","<10.0.20348.3745","<10.0.19044.5965"]},
  {"id":"CVE-2025-3522","product":"smb","summary":"Thunderbird processes the X-Mozilla-External-Attachment-URL header to handle attachments which can be hosted externally. When an email is opened, Thunderbird accesses the specified URL to  determine file size, and navigates to it when the user clicks the attachment. Because the URL is not validated or sanitized, it can reference internal resources like chrome:// or SMB share file:// links, potentially leading to hashed Windows credential leakage and opening the door to more serious security issues. This vulnerability affects Thunderbird < 137.0.2 and Thunderbird < 128.9.2.","details":"Thunderbird processes the X-Mozilla-External-Attachment-URL header to handle attachments which can be hosted externally. When an email is opened, Thunderbird accesses the specified URL to  determine file size, and navigates to it when the user clicks the attachment. Because the URL is not validated or sanitized, it can reference internal resources like chrome:// or SMB share file:// links, potentially leading to hashed Windows credential leakage and opening the door to more serious security issues. This vulnerability affects Thunderbird < 137.0.2 and Thunderbird < 128.9.2.","references":["https://bugzilla.mozilla.org/show_bug.cgi?id=1955372","https://www.mozilla.org/security/advisories/mfsa2025-26/","https://www.mozilla.org/security/advisories/mfsa2025-27/"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<137.0.2"],["<128.9.2"],[">=129.0"]]},
  {"id":"CVE-2025-37750","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix UAF in decryption with multichannelAfter commit f7025d861694 (\"smb: client: allocate crypto only forprimary server\") and commit b0abcd65ec54 (\"smb: client: fix UAF inasync decryption\"), the channels started reusing AEAD TFM from primarychannel to perform synchronous decryption, but that can't done asthere could be multiple cifsd threads (one per channel) simultaneouslyaccessing it to perform decryption.This fixes the following KASAN splat when running fstest generic/249with 'vers=3.1.1,multichannel,max_channels=4,seal' against WindowsServer 2022:BUG: KASAN: slab-use-after-free in gf128mul_4k_lle+0xba/0x110Read of size 8 at addr ffff8881046c18a0 by task cifsd/986CPU: 3 UID: 0 PID: 986 Comm: cifsd Not tainted 6.15.0-rc1 #1PREEMPT(voluntary)Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-3.fc4104/01/2014Call Trace: <TASK> dump_stack_lvl+0x5d/0x80 print_report+0x156/0x528 ? gf128mul_4k_lle+0xba/0x110 ? __virt_addr_valid+0x145/0x300 ? __phys_addr+0x46/0x90 ? gf128mul_4k_lle+0xba/0x110 kasan_report+0xdf/0x1a0 ? gf128mul_4k_lle+0xba/0x110 gf128mul_4k_lle+0xba/0x110 ghash_update+0x189/0x210 shash_ahash_update+0x295/0x370 ? __pfx_shash_ahash_update+0x10/0x10 ? __pfx_shash_ahash_update+0x10/0x10 ? __pfx_extract_iter_to_sg+0x10/0x10 ? ___kmalloc_large_node+0x10e/0x180 ? __asan_memset+0x23/0x50 crypto_ahash_update+0x3c/0xc0 gcm_hash_assoc_remain_continue+0x93/0xc0 crypt_message+0xe09/0xec0 [cifs] ? __pfx_crypt_message+0x10/0x10 [cifs] ? _raw_spin_unlock+0x23/0x40 ? __pfx_cifs_readv_from_socket+0x10/0x10 [cifs] decrypt_raw_data+0x229/0x380 [cifs] ? __pfx_decrypt_raw_data+0x10/0x10 [cifs] ? __pfx_cifs_read_iter_from_socket+0x10/0x10 [cifs] smb3_receive_transform+0x837/0xc80 [cifs] ? __pfx_smb3_receive_transform+0x10/0x10 [cifs] ? __pfx___might_resched+0x10/0x10 ? __pfx_smb3_is_transform_hdr+0x10/0x10 [cifs] cifs_demultiplex_thread+0x692/0x1570 [cifs] ? __pfx_cifs_demultiplex_thread+0x10/0x10 [cifs] ? rcu_is_watching+0x20/0x50 ? rcu_lockdep_current_cpu_online+0x62/0xb0 ? find_held_lock+0x32/0x90 ? kvm_sched_clock_read+0x11/0x20 ? local_clock_noinstr+0xd/0xd0 ? trace_irq_enable.constprop.0+0xa8/0xe0 ? __pfx_cifs_demultiplex_thread+0x10/0x10 [cifs] kthread+0x1fe/0x380 ? kthread+0x10f/0x380 ? __pfx_kthread+0x10/0x10 ? local_clock_noinstr+0xd/0xd0 ? ret_from_fork+0x1b/0x60 ? local_clock+0x15/0x30 ? lock_release+0x29b/0x390 ? rcu_is_watching+0x20/0x50 ? __pfx_kthread+0x10/0x10 ret_from_fork+0x31/0x60 ? __pfx_kthread+0x10/0x10 ret_from_fork_asm+0x1a/0x30 </TASK>","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix UAF in decryption with multichannelAfter commit f7025d861694 (\"smb: client: allocate crypto only forprimary server\") and commit b0abcd65ec54 (\"smb: client: fix UAF inasync decryption\"), the channels started reusing AEAD TFM from primarychannel to perform synchronous decryption, but that can't done asthere could be multiple cifsd threads (one per channel) simultaneouslyaccessing it to perform decryption.This fixes the following KASAN splat when running fstest generic/249with 'vers=3.1.1,multichannel,max_channels=4,seal' against WindowsServer 2022:BUG: KASAN: slab-use-after-free in gf128mul_4k_lle+0xba/0x110Read of size 8 at addr ffff8881046c18a0 by task cifsd/986CPU: 3 UID: 0 PID: 986 Comm: cifsd Not tainted 6.15.0-rc1 #1PREEMPT(voluntary)Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-3.fc4104/01/2014Call Trace: <TASK> dump_stack_lvl+0x5d/0x80 print_report+0x156/0x528 ? gf128mul_4k_lle+0xba/0x110 ? __virt_addr_valid+0x145/0x300 ? __phys_addr+0x46/0x90 ? gf128mul_4k_lle+0xba/0x110 kasan_report+0xdf/0x1a0 ? gf128mul_4k_lle+0xba/0x110 gf128mul_4k_lle+0xba/0x110 ghash_update+0x189/0x210 shash_ahash_update+0x295/0x370 ? __pfx_shash_ahash_update+0x10/0x10 ? __pfx_shash_ahash_update+0x10/0x10 ? __pfx_extract_iter_to_sg+0x10/0x10 ? ___kmalloc_large_node+0x10e/0x180 ? __asan_memset+0x23/0x50 crypto_ahash_update+0x3c/0xc0 gcm_hash_assoc_remain_continue+0x93/0xc0 crypt_message+0xe09/0xec0 [cifs] ? __pfx_crypt_message+0x10/0x10 [cifs] ? _raw_spin_unlock+0x23/0x40 ? __pfx_cifs_readv_from_socket+0x10/0x10 [cifs] decrypt_raw_data+0x229/0x380 [cifs] ? __pfx_decrypt_raw_data+0x10/0x10 [cifs] ? __pfx_cifs_read_iter_from_socket+0x10/0x10 [cifs] smb3_receive_transform+0x837/0xc80 [cifs] ? __pfx_smb3_receive_transform+0x10/0x10 [cifs] ? __pfx___might_resched+0x10/0x10 ? __pfx_smb3_is_transform_hdr+0x10/0x10 [cifs] cifs_demultiplex_thread+0x692/0x1570 [cifs] ? __pfx_cifs_demultiplex_thread+0x10/0x10 [cifs] ? rcu_is_watching+0x20/0x50 ? rcu_lockdep_current_cpu_online+0x62/0xb0 ? find_held_lock+0x32/0x90 ? kvm_sched_clock_read+0x11/0x20 ? local_clock_noinstr+0xd/0xd0 ? trace_irq_enable.constprop.0+0xa8/0xe0 ? __pfx_cifs_demultiplex_thread+0x10/0x10 [cifs] kthread+0x1fe/0x380 ? kthread+0x10f/0x380 ? __pfx_kthread+0x10/0x10 ? local_clock_noinstr+0xd/0xd0 ? ret_from_fork+0x1b/0x60 ? local_clock+0x15/0x30 ? lock_release+0x29b/0x390 ? rcu_is_watching+0x20/0x50 ? __pfx_kthread+0x10/0x10 ret_from_fork+0x31/0x60 ? __pfx_kthread+0x10/0x10 ret_from_fork_asm+0x1a/0x30 </TASK>","references":["https://git.kernel.org/stable/c/9502dd5c7029902f4a425bf959917a5a9e7c0e50","https://git.kernel.org/stable/c/950557922c1298464749c216d8763e97faf5d0a6","https://git.kernel.org/stable/c/aa5a1e4b882964eb79d5b5d1d1e8a1a5efbb1d15"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-37776","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix use-after-free in smb_break_all_levII_oplock()There is a room in smb_break_all_levII_oplock that can cause racy issueswhen unlocking in the middle of the loop. This patch use read lockto protect whole loop.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix use-after-free in smb_break_all_levII_oplock()There is a room in smb_break_all_levII_oplock that can cause racy issueswhen unlocking in the middle of the loop. This patch use read lockto protect whole loop.","references":["https://git.kernel.org/stable/c/18b4fac5ef17f77fed9417d22210ceafd6525fc7","https://git.kernel.org/stable/c/296cb5457cc6f4a754c4ae29855f8a253d52bcc6","https://git.kernel.org/stable/c/d54ab1520d43e95f9b2e22d7a05fc9614192e5a5"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-37778","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: Fix dangling pointer in krb_authenticatekrb_authenticate frees sess->user and does not set the pointerto NULL. It calls ksmbd_krb5_authenticate to reinitialisesess->user but that function may return without doing so. Ifthat happens then smb2_sess_setup, which calls krb_authenticate,will be accessing free'd memory when it later uses sess->user.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: Fix dangling pointer in krb_authenticatekrb_authenticate frees sess->user and does not set the pointerto NULL. It calls ksmbd_krb5_authenticate to reinitialisesess->user but that function may return without doing so. Ifthat happens then smb2_sess_setup, which calls krb_authenticate,will be accessing free'd memory when it later uses sess->user.","references":["https://git.kernel.org/stable/c/1db2451de23e98bc864c6a6e52aa0d82c91cb325","https://git.kernel.org/stable/c/1e440d5b25b7efccb3defe542a73c51005799a5f","https://git.kernel.org/stable/c/6e30c0e10210c714f3d4453dc258d4abcc70364e"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-37899","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix use-after-free in session logoffThe sess->user object can currently be in use by another thread, forexample if another connection has sent a session setup request tobind to the session being free'd. The handler for that connection couldbe in the smb2_sess_setup function which makes use of sess->user.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: fix use-after-free in session logoffThe sess->user object can currently be in use by another thread, forexample if another connection has sent a session setup request tobind to the session being free'd. The handler for that connection couldbe in the smb2_sess_setup function which makes use of sess->user.","references":["https://git.kernel.org/stable/c/02d16046cd11a5c037b28c12ffb818c56dd3ef43","https://git.kernel.org/stable/c/2fc9feff45d92a92cd5f96487655d5be23fb7e2b","https://git.kernel.org/stable/c/d5ec1d79509b3ee01de02c236f096bc050221b7f"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-37954","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: Avoid race in open_cached_dir with lease breaksA pre-existing valid cfid returned from find_or_create_cached_dir mightrace with a lease break, meaning open_cached_dir doesn't consider itvalid, and thinks it's newly-constructed. This leaks a dentry referenceif the allocation occurs before the queued lease break work runs.Avoid the race by extending holding the cfid_list_lock acrossfind_or_create_cached_dir and when the result is checked.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: Avoid race in open_cached_dir with lease breaksA pre-existing valid cfid returned from find_or_create_cached_dir mightrace with a lease break, meaning open_cached_dir doesn't consider itvalid, and thinks it's newly-constructed. This leaks a dentry referenceif the allocation occurs before the queued lease break work runs.Avoid the race by extending holding the cfid_list_lock acrossfind_or_create_cached_dir and when the result is checked.","references":["https://git.kernel.org/stable/c/2407265dc32bc8cc45b62a612c2a214ba9038e8b","https://git.kernel.org/stable/c/2ed98e89ebc2e1bc73534dc3c18cb7843a889ff9","https://git.kernel.org/stable/c/3ca02e63edccb78ef3659bebc68579c7224a6ca2"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-38051","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: Fix use-after-free in cifs_fill_direntThere is a race condition in the readdir concurrency process, which mayaccess the rsp buffer after it has been released, triggering thefollowing KASAN warning. ================================================================== BUG: KASAN: slab-use-after-free in cifs_fill_dirent+0xb03/0xb60 [cifs] Read of size 4 at addr ffff8880099b819c by task a.out/342975 CPU: 2 UID: 0 PID: 342975 Comm: a.out Not tainted 6.15.0-rc6+ #240 PREEMPT(full) Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.1-2.fc37 04/01/2014 Call Trace:  <TASK>  dump_stack_lvl+0x53/0x70  print_report+0xce/0x640  kasan_report+0xb8/0xf0  cifs_fill_dirent+0xb03/0xb60 [cifs]  cifs_readdir+0x12cb/0x3190 [cifs]  iterate_dir+0x1a1/0x520  __x64_sys_getdents+0x134/0x220  do_syscall_64+0x4b/0x110  entry_SYSCALL_64_after_hwframe+0x76/0x7e RIP: 0033:0x7f996f64b9f9 Code: ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff  0d f7 c3 0c 00 f7 d8 64 89 8 RSP: 002b:00007f996f53de78 EFLAGS: 00000207 ORIG_RAX: 000000000000004e RAX: ffffffffffffffda RBX: 00007f996f53ecdc RCX: 00007f996f64b9f9 RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000003 RBP: 00007f996f53dea0 R08: 0000000000000000 R09: 0000000000000000 R10: 0000000000000000 R11: 0000000000000207 R12: ffffffffffffff88 R13: 0000000000000000 R14: 00007ffc8cd9a500 R15: 00007f996f51e000  </TASK> Allocated by task 408:  kasan_save_stack+0x20/0x40  kasan_save_track+0x14/0x30  __kasan_slab_alloc+0x6e/0x70  kmem_cache_alloc_noprof+0x117/0x3d0  mempool_alloc_noprof+0xf2/0x2c0  cifs_buf_get+0x36/0x80 [cifs]  allocate_buffers+0x1d2/0x330 [cifs]  cifs_demultiplex_thread+0x22b/0x2690 [cifs]  kthread+0x394/0x720  ret_from_fork+0x34/0x70  ret_from_fork_asm+0x1a/0x30 Freed by task 342979:  kasan_save_stack+0x20/0x40  kasan_save_track+0x14/0x30  kasan_save_free_info+0x3b/0x60  __kasan_slab_free+0x37/0x50  kmem_cache_free+0x2b8/0x500  cifs_buf_release+0x3c/0x70 [cifs]  cifs_readdir+0x1c97/0x3190 [cifs]  iterate_dir+0x1a1/0x520  __x64_sys_getdents64+0x134/0x220  do_syscall_64+0x4b/0x110  entry_SYSCALL_64_after_hwframe+0x76/0x7e The buggy address belongs to the object at ffff8880099b8000  which belongs to the cache cifs_request of size 16588 The buggy address is located 412 bytes inside of  freed 16588-byte region [ffff8880099b8000, ffff8880099bc0cc) The buggy address belongs to the physical page: page: refcount:0 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x99b8 head: order:3 mapcount:0 entire_mapcount:0 nr_pages_mapped:0 pincount:0 anon flags: 0x80000000000040(head|node=0|zone=1) page_type: f5(slab) raw: 0080000000000040 ffff888001e03400 0000000000000000 dead000000000001 raw: 0000000000000000 0000000000010001 00000000f5000000 0000000000000000 head: 0080000000000040 ffff888001e03400 0000000000000000 dead000000000001 head: 0000000000000000 0000000000010001 00000000f5000000 0000000000000000 head: 0080000000000003 ffffea0000266e01 00000000ffffffff 00000000ffffffff head: ffffffffffffffff 0000000000000000 00000000ffffffff 0000000000000008 page dumped because: kasan: bad access detected Memory state around the buggy address:  ffff8880099b8080: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb  ffff8880099b8100: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb >ffff8880099b8180: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb                             ^  ffff8880099b8200: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb  ffff8880099b8280: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb ==================================================================POC is available in the link [1].The problem triggering process is as follows:Process 1                       Process 2--------------------------------------truncated---","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: Fix use-after-free in cifs_fill_direntThere is a race condition in the readdir concurrency process, which mayaccess the rsp buffer after it has been released, triggering thefollowing KASAN warning. ================================================================== BUG: KASAN: slab-use-after-free in cifs_fill_dirent+0xb03/0xb60 [cifs] Read of size 4 at addr ffff8880099b819c by task a.out/342975 CPU: 2 UID: 0 PID: 342975 Comm: a.out Not tainted 6.15.0-rc6+ #240 PREEMPT(full) Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.1-2.fc37 04/01/2014 Call Trace:  <TASK>  dump_stack_lvl+0x53/0x70  print_report+0xce/0x640  kasan_report+0xb8/0xf0  cifs_fill_dirent+0xb03/0xb60 [cifs]  cifs_readdir+0x12cb/0x3190 [cifs]  iterate_dir+0x1a1/0x520  __x64_sys_getdents+0x134/0x220  do_syscall_64+0x4b/0x110  entry_SYSCALL_64_after_hwframe+0x76/0x7e RIP: 0033:0x7f996f64b9f9 Code: ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff  0d f7 c3 0c 00 f7 d8 64 89 8 RSP: 002b:00007f996f53de78 EFLAGS: 00000207 ORIG_RAX: 000000000000004e RAX: ffffffffffffffda RBX: 00007f996f53ecdc RCX: 00007f996f64b9f9 RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000003 RBP: 00007f996f53dea0 R08: 0000000000000000 R09: 0000000000000000 R10: 0000000000000000 R11: 0000000000000207 R12: ffffffffffffff88 R13: 0000000000000000 R14: 00007ffc8cd9a500 R15: 00007f996f51e000  </TASK> Allocated by task 408:  kasan_save_stack+0x20/0x40  kasan_save_track+0x14/0x30  __kasan_slab_alloc+0x6e/0x70  kmem_cache_alloc_noprof+0x117/0x3d0  mempool_alloc_noprof+0xf2/0x2c0  cifs_buf_get+0x36/0x80 [cifs]  allocate_buffers+0x1d2/0x330 [cifs]  cifs_demultiplex_thread+0x22b/0x2690 [cifs]  kthread+0x394/0x720  ret_from_fork+0x34/0x70  ret_from_fork_asm+0x1a/0x30 Freed by task 342979:  kasan_save_stack+0x20/0x40  kasan_save_track+0x14/0x30  kasan_save_free_info+0x3b/0x60  __kasan_slab_free+0x37/0x50  kmem_cache_free+0x2b8/0x500  cifs_buf_release+0x3c/0x70 [cifs]  cifs_readdir+0x1c97/0x3190 [cifs]  iterate_dir+0x1a1/0x520  __x64_sys_getdents64+0x134/0x220  do_syscall_64+0x4b/0x110  entry_SYSCALL_64_after_hwframe+0x76/0x7e The buggy address belongs to the object at ffff8880099b8000  which belongs to the cache cifs_request of size 16588 The buggy address is located 412 bytes inside of  freed 16588-byte region [ffff8880099b8000, ffff8880099bc0cc) The buggy address belongs to the physical page: page: refcount:0 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x99b8 head: order:3 mapcount:0 entire_mapcount:0 nr_pages_mapped:0 pincount:0 anon flags: 0x80000000000040(head|node=0|zone=1) page_type: f5(slab) raw: 0080000000000040 ffff888001e03400 0000000000000000 dead000000000001 raw: 0000000000000000 0000000000010001 00000000f5000000 0000000000000000 head: 0080000000000040 ffff888001e03400 0000000000000000 dead000000000001 head: 0000000000000000 0000000000010001 00000000f5000000 0000000000000000 head: 0080000000000003 ffffea0000266e01 00000000ffffffff 00000000ffffffff head: ffffffffffffffff 0000000000000000 00000000ffffffff 0000000000000008 page dumped because: kasan: bad access detected Memory state around the buggy address:  ffff8880099b8080: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb  ffff8880099b8100: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb >ffff8880099b8180: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb                             ^  ffff8880099b8200: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb  ffff8880099b8280: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb ==================================================================POC is available in the link [1].The problem triggering process is as follows:Process 1                       Process 2--------------------------------------truncated---","references":["https://git.kernel.org/stable/c/1b197931fbc821bc7e9e91bf619400db563e3338","https://git.kernel.org/stable/c/73cadde98f67f76c5eba00ac0b72c453383cec8b","https://git.kernel.org/stable/c/9bea368648ac46f8593a780760362e40291d22a9"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-38179","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix max_sge overflow in smb_extract_folioq_to_rdma()This fixes the following problem:[  749.901015] [   T8673] run fstests cifs/001 at 2025-06-17 09:40:30[  750.346409] [   T9870] ==================================================================[  750.346814] [   T9870] BUG: KASAN: slab-out-of-bounds in smb_set_sge+0x2cc/0x3b0 [cifs][  750.347330] [   T9870] Write of size 8 at addr ffff888011082890 by task xfs_io/9870[  750.347705] [   T9870][  750.348077] [   T9870] CPU: 0 UID: 0 PID: 9870 Comm: xfs_io Kdump: loaded Not tainted 6.16.0-rc2-metze.02+ #1 PREEMPT(voluntary)[  750.348082] [   T9870] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS VirtualBox 12/01/2006[  750.348085] [   T9870] Call Trace:[  750.348086] [   T9870]  <TASK>[  750.348088] [   T9870]  dump_stack_lvl+0x76/0xa0[  750.348106] [   T9870]  print_report+0xd1/0x640[  750.348116] [   T9870]  ? __pfx__raw_spin_lock_irqsave+0x10/0x10[  750.348120] [   T9870]  ? kasan_complete_mode_report_info+0x26/0x210[  750.348124] [   T9870]  kasan_report+0xe7/0x130[  750.348128] [   T9870]  ? smb_set_sge+0x2cc/0x3b0 [cifs][  750.348262] [   T9870]  ? smb_set_sge+0x2cc/0x3b0 [cifs][  750.348377] [   T9870]  __asan_report_store8_noabort+0x17/0x30[  750.348381] [   T9870]  smb_set_sge+0x2cc/0x3b0 [cifs][  750.348496] [   T9870]  smbd_post_send_iter+0x1990/0x3070 [cifs][  750.348625] [   T9870]  ? __pfx_smbd_post_send_iter+0x10/0x10 [cifs][  750.348741] [   T9870]  ? update_stack_state+0x2a0/0x670[  750.348749] [   T9870]  ? cifs_flush+0x153/0x320 [cifs][  750.348870] [   T9870]  ? cifs_flush+0x153/0x320 [cifs][  750.348990] [   T9870]  ? update_stack_state+0x2a0/0x670[  750.348995] [   T9870]  smbd_send+0x58c/0x9c0 [cifs][  750.349117] [   T9870]  ? __pfx_smbd_send+0x10/0x10 [cifs][  750.349231] [   T9870]  ? unwind_get_return_address+0x65/0xb0[  750.349235] [   T9870]  ? __pfx_stack_trace_consume_entry+0x10/0x10[  750.349242] [   T9870]  ? arch_stack_walk+0xa7/0x100[  750.349250] [   T9870]  ? stack_trace_save+0x92/0xd0[  750.349254] [   T9870]  __smb_send_rqst+0x931/0xec0 [cifs][  750.349374] [   T9870]  ? kernel_text_address+0x173/0x190[  750.349379] [   T9870]  ? kasan_save_stack+0x39/0x70[  750.349382] [   T9870]  ? kasan_save_track+0x18/0x70[  750.349385] [   T9870]  ? __kasan_slab_alloc+0x9d/0xa0[  750.349389] [   T9870]  ? __pfx___smb_send_rqst+0x10/0x10 [cifs][  750.349508] [   T9870]  ? smb2_mid_entry_alloc+0xb4/0x7e0 [cifs][  750.349626] [   T9870]  ? cifs_call_async+0x277/0xb00 [cifs][  750.349746] [   T9870]  ? cifs_issue_write+0x256/0x610 [cifs][  750.349867] [   T9870]  ? netfs_do_issue_write+0xc2/0x340 [netfs][  750.349900] [   T9870]  ? netfs_advance_write+0x45b/0x1270 [netfs][  750.349929] [   T9870]  ? netfs_write_folio+0xd6c/0x1be0 [netfs][  750.349958] [   T9870]  ? netfs_writepages+0x2e9/0xa80 [netfs][  750.349987] [   T9870]  ? do_writepages+0x21f/0x590[  750.349993] [   T9870]  ? filemap_fdatawrite_wbc+0xe1/0x140[  750.349997] [   T9870]  ? entry_SYSCALL_64_after_hwframe+0x76/0x7e[  750.350002] [   T9870]  smb_send_rqst+0x22e/0x2f0 [cifs][  750.350131] [   T9870]  ? __pfx_smb_send_rqst+0x10/0x10 [cifs][  750.350255] [   T9870]  ? local_clock_noinstr+0xe/0xd0[  750.350261] [   T9870]  ? kasan_save_alloc_info+0x37/0x60[  750.350268] [   T9870]  ? __kasan_check_write+0x14/0x30[  750.350271] [   T9870]  ? _raw_spin_lock+0x81/0xf0[  750.350275] [   T9870]  ? __pfx__raw_spin_lock+0x10/0x10[  750.350278] [   T9870]  ? smb2_setup_async_request+0x293/0x580 [cifs][  750.350398] [   T9870]  cifs_call_async+0x477/0xb00 [cifs][  750.350518] [   T9870]  ? __pfx_smb2_writev_callback+0x10/0x10 [cifs][  750.350636] [   T9870]  ? __pfx_cifs_call_async+0x10/0x10 [cifs][  750.350756] [   T9870]  ? __pfx__raw_spin_lock+0x10/0x10[  750.350760] [   T9870]  ? __kasan_check_write+0x14/0x30[  750.350763] [   T98---truncated---","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix max_sge overflow in smb_extract_folioq_to_rdma()This fixes the following problem:[  749.901015] [   T8673] run fstests cifs/001 at 2025-06-17 09:40:30[  750.346409] [   T9870] ==================================================================[  750.346814] [   T9870] BUG: KASAN: slab-out-of-bounds in smb_set_sge+0x2cc/0x3b0 [cifs][  750.347330] [   T9870] Write of size 8 at addr ffff888011082890 by task xfs_io/9870[  750.347705] [   T9870][  750.348077] [   T9870] CPU: 0 UID: 0 PID: 9870 Comm: xfs_io Kdump: loaded Not tainted 6.16.0-rc2-metze.02+ #1 PREEMPT(voluntary)[  750.348082] [   T9870] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS VirtualBox 12/01/2006[  750.348085] [   T9870] Call Trace:[  750.348086] [   T9870]  <TASK>[  750.348088] [   T9870]  dump_stack_lvl+0x76/0xa0[  750.348106] [   T9870]  print_report+0xd1/0x640[  750.348116] [   T9870]  ? __pfx__raw_spin_lock_irqsave+0x10/0x10[  750.348120] [   T9870]  ? kasan_complete_mode_report_info+0x26/0x210[  750.348124] [   T9870]  kasan_report+0xe7/0x130[  750.348128] [   T9870]  ? smb_set_sge+0x2cc/0x3b0 [cifs][  750.348262] [   T9870]  ? smb_set_sge+0x2cc/0x3b0 [cifs][  750.348377] [   T9870]  __asan_report_store8_noabort+0x17/0x30[  750.348381] [   T9870]  smb_set_sge+0x2cc/0x3b0 [cifs][  750.348496] [   T9870]  smbd_post_send_iter+0x1990/0x3070 [cifs][  750.348625] [   T9870]  ? __pfx_smbd_post_send_iter+0x10/0x10 [cifs][  750.348741] [   T9870]  ? update_stack_state+0x2a0/0x670[  750.348749] [   T9870]  ? cifs_flush+0x153/0x320 [cifs][  750.348870] [   T9870]  ? cifs_flush+0x153/0x320 [cifs][  750.348990] [   T9870]  ? update_stack_state+0x2a0/0x670[  750.348995] [   T9870]  smbd_send+0x58c/0x9c0 [cifs][  750.349117] [   T9870]  ? __pfx_smbd_send+0x10/0x10 [cifs][  750.349231] [   T9870]  ? unwind_get_return_address+0x65/0xb0[  750.349235] [   T9870]  ? __pfx_stack_trace_consume_entry+0x10/0x10[  750.349242] [   T9870]  ? arch_stack_walk+0xa7/0x100[  750.349250] [   T9870]  ? stack_trace_save+0x92/0xd0[  750.349254] [   T9870]  __smb_send_rqst+0x931/0xec0 [cifs][  750.349374] [   T9870]  ? kernel_text_address+0x173/0x190[  750.349379] [   T9870]  ? kasan_save_stack+0x39/0x70[  750.349382] [   T9870]  ? kasan_save_track+0x18/0x70[  750.349385] [   T9870]  ? __kasan_slab_alloc+0x9d/0xa0[  750.349389] [   T9870]  ? __pfx___smb_send_rqst+0x10/0x10 [cifs][  750.349508] [   T9870]  ? smb2_mid_entry_alloc+0xb4/0x7e0 [cifs][  750.349626] [   T9870]  ? cifs_call_async+0x277/0xb00 [cifs][  750.349746] [   T9870]  ? cifs_issue_write+0x256/0x610 [cifs][  750.349867] [   T9870]  ? netfs_do_issue_write+0xc2/0x340 [netfs][  750.349900] [   T9870]  ? netfs_advance_write+0x45b/0x1270 [netfs][  750.349929] [   T9870]  ? netfs_write_folio+0xd6c/0x1be0 [netfs][  750.349958] [   T9870]  ? netfs_writepages+0x2e9/0xa80 [netfs][  750.349987] [   T9870]  ? do_writepages+0x21f/0x590[  750.349993] [   T9870]  ? filemap_fdatawrite_wbc+0xe1/0x140[  750.349997] [   T9870]  ? entry_SYSCALL_64_after_hwframe+0x76/0x7e[  750.350002] [   T9870]  smb_send_rqst+0x22e/0x2f0 [cifs][  750.350131] [   T9870]  ? __pfx_smb_send_rqst+0x10/0x10 [cifs][  750.350255] [   T9870]  ? local_clock_noinstr+0xe/0xd0[  750.350261] [   T9870]  ? kasan_save_alloc_info+0x37/0x60[  750.350268] [   T9870]  ? __kasan_check_write+0x14/0x30[  750.350271] [   T9870]  ? _raw_spin_lock+0x81/0xf0[  750.350275] [   T9870]  ? __pfx__raw_spin_lock+0x10/0x10[  750.350278] [   T9870]  ? smb2_setup_async_request+0x293/0x580 [cifs][  750.350398] [   T9870]  cifs_call_async+0x477/0xb00 [cifs][  750.350518] [   T9870]  ? __pfx_smb2_writev_callback+0x10/0x10 [cifs][  750.350636] [   T9870]  ? __pfx_cifs_call_async+0x10/0x10 [cifs][  750.350756] [   T9870]  ? __pfx__raw_spin_lock+0x10/0x10[  750.350760] [   T9870]  ? __kasan_check_write+0x14/0x30[  750.350763] [   T98---truncated---","references":["https://git.kernel.org/stable/c/8ae7814589d7bd850294ac14ec4c1725dafd42ca","https://git.kernel.org/stable/c/a379a8a2a0032e12e7ef397197c9c2ad011588d6","https://git.kernel.org/stable/c/e0ba9b2f188166550296005e64b15e80db82ad8a"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-38208","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: add NULL check in automount_fullpathpage is checked for null in __build_path_from_dentry_optional_prefixwhen tcon->origin_fullpath is not set. However, the check is missing whenit is set.Add a check to prevent a potential NULL pointer dereference.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: add NULL check in automount_fullpathpage is checked for null in __build_path_from_dentry_optional_prefixwhen tcon->origin_fullpath is not set. However, the check is missing whenit is set.Add a check to prevent a potential NULL pointer dereference.","references":["https://git.kernel.org/stable/c/37166d63e42c34846a16001950ecec96229a8d17","https://git.kernel.org/stable/c/a9e916fa5c7d0ec2256aa44aa24ddd92f529ce35","https://git.kernel.org/stable/c/cce8e71ca1f7ad9045707f0d22490c1e9ed1df6c"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-38244","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential deadlock when reconnecting channelsFix cifs_signal_cifsd_for_reconnect() to take the correct lock orderand prevent the following deadlock from happening======================================================WARNING: possible circular locking dependency detected6.16.0-rc3-build2+ #1301 Tainted: G S      W------------------------------------------------------cifsd/6055 is trying to acquire lock:ffff88810ad56038 (&tcp_ses->srv_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0x134/0x200but task is already holding lock:ffff888119c64330 (&ret_buf->chan_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0xcf/0x200which lock already depends on the new lock.the existing dependency chain (in reverse order) is:-> #2 (&ret_buf->chan_lock){+.+.}-{3:3}:       validate_chain+0x1cf/0x270       __lock_acquire+0x60e/0x780       lock_acquire.part.0+0xb4/0x1f0       _raw_spin_lock+0x2f/0x40       cifs_setup_session+0x81/0x4b0       cifs_get_smb_ses+0x771/0x900       cifs_mount_get_session+0x7e/0x170       cifs_mount+0x92/0x2d0       cifs_smb3_do_mount+0x161/0x460       smb3_get_tree+0x55/0x90       vfs_get_tree+0x46/0x180       do_new_mount+0x1b0/0x2e0       path_mount+0x6ee/0x740       do_mount+0x98/0xe0       __do_sys_mount+0x148/0x180       do_syscall_64+0xa4/0x260       entry_SYSCALL_64_after_hwframe+0x76/0x7e-> #1 (&ret_buf->ses_lock){+.+.}-{3:3}:       validate_chain+0x1cf/0x270       __lock_acquire+0x60e/0x780       lock_acquire.part.0+0xb4/0x1f0       _raw_spin_lock+0x2f/0x40       cifs_match_super+0x101/0x320       sget+0xab/0x270       cifs_smb3_do_mount+0x1e0/0x460       smb3_get_tree+0x55/0x90       vfs_get_tree+0x46/0x180       do_new_mount+0x1b0/0x2e0       path_mount+0x6ee/0x740       do_mount+0x98/0xe0       __do_sys_mount+0x148/0x180       do_syscall_64+0xa4/0x260       entry_SYSCALL_64_after_hwframe+0x76/0x7e-> #0 (&tcp_ses->srv_lock){+.+.}-{3:3}:       check_noncircular+0x95/0xc0       check_prev_add+0x115/0x2f0       validate_chain+0x1cf/0x270       __lock_acquire+0x60e/0x780       lock_acquire.part.0+0xb4/0x1f0       _raw_spin_lock+0x2f/0x40       cifs_signal_cifsd_for_reconnect+0x134/0x200       __cifs_reconnect+0x8f/0x500       cifs_handle_standard+0x112/0x280       cifs_demultiplex_thread+0x64d/0xbc0       kthread+0x2f7/0x310       ret_from_fork+0x2a/0x230       ret_from_fork_asm+0x1a/0x30other info that might help us debug this:Chain exists of:  &tcp_ses->srv_lock --> &ret_buf->ses_lock --> &ret_buf->chan_lock Possible unsafe locking scenario:       CPU0                    CPU1       ----                    ----  lock(&ret_buf->chan_lock);                               lock(&ret_buf->ses_lock);                               lock(&ret_buf->chan_lock);  lock(&tcp_ses->srv_lock); *** DEADLOCK ***3 locks held by cifsd/6055: #0: ffffffff857de398 (&cifs_tcp_ses_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0x7b/0x200 #1: ffff888119c64060 (&ret_buf->ses_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0x9c/0x200 #2: ffff888119c64330 (&ret_buf->chan_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0xcf/0x200","details":"In the Linux kernel, the following vulnerability has been resolved:smb: client: fix potential deadlock when reconnecting channelsFix cifs_signal_cifsd_for_reconnect() to take the correct lock orderand prevent the following deadlock from happening======================================================WARNING: possible circular locking dependency detected6.16.0-rc3-build2+ #1301 Tainted: G S      W------------------------------------------------------cifsd/6055 is trying to acquire lock:ffff88810ad56038 (&tcp_ses->srv_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0x134/0x200but task is already holding lock:ffff888119c64330 (&ret_buf->chan_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0xcf/0x200which lock already depends on the new lock.the existing dependency chain (in reverse order) is:-> #2 (&ret_buf->chan_lock){+.+.}-{3:3}:       validate_chain+0x1cf/0x270       __lock_acquire+0x60e/0x780       lock_acquire.part.0+0xb4/0x1f0       _raw_spin_lock+0x2f/0x40       cifs_setup_session+0x81/0x4b0       cifs_get_smb_ses+0x771/0x900       cifs_mount_get_session+0x7e/0x170       cifs_mount+0x92/0x2d0       cifs_smb3_do_mount+0x161/0x460       smb3_get_tree+0x55/0x90       vfs_get_tree+0x46/0x180       do_new_mount+0x1b0/0x2e0       path_mount+0x6ee/0x740       do_mount+0x98/0xe0       __do_sys_mount+0x148/0x180       do_syscall_64+0xa4/0x260       entry_SYSCALL_64_after_hwframe+0x76/0x7e-> #1 (&ret_buf->ses_lock){+.+.}-{3:3}:       validate_chain+0x1cf/0x270       __lock_acquire+0x60e/0x780       lock_acquire.part.0+0xb4/0x1f0       _raw_spin_lock+0x2f/0x40       cifs_match_super+0x101/0x320       sget+0xab/0x270       cifs_smb3_do_mount+0x1e0/0x460       smb3_get_tree+0x55/0x90       vfs_get_tree+0x46/0x180       do_new_mount+0x1b0/0x2e0       path_mount+0x6ee/0x740       do_mount+0x98/0xe0       __do_sys_mount+0x148/0x180       do_syscall_64+0xa4/0x260       entry_SYSCALL_64_after_hwframe+0x76/0x7e-> #0 (&tcp_ses->srv_lock){+.+.}-{3:3}:       check_noncircular+0x95/0xc0       check_prev_add+0x115/0x2f0       validate_chain+0x1cf/0x270       __lock_acquire+0x60e/0x780       lock_acquire.part.0+0xb4/0x1f0       _raw_spin_lock+0x2f/0x40       cifs_signal_cifsd_for_reconnect+0x134/0x200       __cifs_reconnect+0x8f/0x500       cifs_handle_standard+0x112/0x280       cifs_demultiplex_thread+0x64d/0xbc0       kthread+0x2f7/0x310       ret_from_fork+0x2a/0x230       ret_from_fork_asm+0x1a/0x30other info that might help us debug this:Chain exists of:  &tcp_ses->srv_lock --> &ret_buf->ses_lock --> &ret_buf->chan_lock Possible unsafe locking scenario:       CPU0                    CPU1       ----                    ----  lock(&ret_buf->chan_lock);                               lock(&ret_buf->ses_lock);                               lock(&ret_buf->chan_lock);  lock(&tcp_ses->srv_lock); *** DEADLOCK ***3 locks held by cifsd/6055: #0: ffffffff857de398 (&cifs_tcp_ses_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0x7b/0x200 #1: ffff888119c64060 (&ret_buf->ses_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0x9c/0x200 #2: ffff888119c64330 (&ret_buf->chan_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0xcf/0x200","references":["https://git.kernel.org/stable/c/711741f94ac3cf9f4e3aa73aa171e76d188c0819","https://git.kernel.org/stable/c/7f3ead8ebc0ef65b6c89a13912b4e80218425629","https://git.kernel.org/stable/c/c82c7041258d96e3286f6790ab700e4edd3cc9e3"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-38321","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:smb: Log an error when close_all_cached_dirs failsUnder low-memory conditions, close_all_cached_dirs() can't move thedentries to a separate list to dput() them once the locks are dropped.This will result in a \"Dentry still in use\" error, so add an errormessage that makes it clear this is what happened:[  495.281119] CIFS: VFS: \\\\otters.example.com\\share Out of memory while dropping dentries[  495.281595] ------------[ cut here ]------------[  495.281887] BUG: Dentry ffff888115531138{i=78,n=/}  still in use (2) [unmount of cifs cifs][  495.282391] WARNING: CPU: 1 PID: 2329 at fs/dcache.c:1536 umount_check+0xc8/0xf0Also, bail out of looping through all tcons as soon as a singleallocation fails, since we're already in trouble, and kmalloc() attemptsfor subseqeuent tcons are likely to fail just like the first one did.","details":"In the Linux kernel, the following vulnerability has been resolved:smb: Log an error when close_all_cached_dirs failsUnder low-memory conditions, close_all_cached_dirs() can't move thedentries to a separate list to dput() them once the locks are dropped.This will result in a \"Dentry still in use\" error, so add an errormessage that makes it clear this is what happened:[  495.281119] CIFS: VFS: \\\\otters.example.com\\share Out of memory while dropping dentries[  495.281595] ------------[ cut here ]------------[  495.281887] BUG: Dentry ffff888115531138{i=78,n=/}  still in use (2) [unmount of cifs cifs][  495.282391] WARNING: CPU: 1 PID: 2329 at fs/dcache.c:1536 umount_check+0xc8/0xf0Also, bail out of looping through all tcons as soon as a singleallocation fails, since we're already in trouble, and kmalloc() attemptsfor subseqeuent tcons are likely to fail just like the first one did.","references":["https://git.kernel.org/stable/c/43f26094d6702e494e800532c3f1606e7a68eb30","https://git.kernel.org/stable/c/4479db143390bdcadc1561292aab579cdfa9f6c6","https://git.kernel.org/stable/c/a2182743a8b4969481f64aec4908ff162e8a206c"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-38325","product":"smb","summary":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: add free_transport ops in ksmbd connectionfree_transport function for tcp connection can be called from smbdirect.It will cause kernel oops. This patch add free_transport ops in ksmbdconnection, and add each free_transports for tcp and smbdirect.","details":"In the Linux kernel, the following vulnerability has been resolved:ksmbd: add free_transport ops in ksmbd connectionfree_transport function for tcp connection can be called from smbdirect.It will cause kernel oops. This patch add free_transport ops in ksmbdconnection, and add each free_transports for tcp and smbdirect.","references":["https://git.kernel.org/stable/c/3890da762a66191c440b0bd6e3ee45501edbb0c1","https://git.kernel.org/stable/c/3f3aae77280aad9f5acc6709c596148966f765c7","https://git.kernel.org/stable/c/a89f5fae998bdc4d0505306f93844c9ae059d50c"],"severity":"UNKNOWN","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-44043","product":"smb","summary":"Keyoti SearchUnit prior to 9.0.0. is vulnerable to Server-Side Request Forgery (SSRF) in /Keyoti_SearchEngine_Web_Common/SearchService.svc/GetResults and /Keyoti_SearchEngine_Web_Common/SearchService.svc/GetLocationAndContentCategories. An attacker can specify their own SMB server as the indexDirectory value when making POST requests to the affected components. In doing so an attacker can get the SearchUnit server to read and write configuration and log files from/to the attackers server.","details":"Keyoti SearchUnit prior to 9.0.0. is vulnerable to Server-Side Request Forgery (SSRF) in /Keyoti_SearchEngine_Web_Common/SearchService.svc/GetResults and /Keyoti_SearchEngine_Web_Common/SearchService.svc/GetLocationAndContentCategories. An attacker can specify their own SMB server as the indexDirectory value when making POST requests to the affected components. In doing so an attacker can get the SearchUnit server to read and write configuration and log files from/to the attackers server.","references":["https://keyoti.com/products/search/dotNetWeb/HtmlHelp9/?topic=UserGuide/Release%20Notes.htm","https://www.sprocketsecurity.com/blog/cve-alert-cve-2025-44043-cve-2025-44044-the-search-bar-hacks-arent-dead-yet"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-48802","product":"smb","summary":"Improper certificate validation in Windows SMB allows an authorized attacker to perform spoofing over a network.","details":"Improper certificate validation in Windows SMB allows an authorized attacker to perform spoofing over a network.","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-48802"],"severity":"MEDIUM","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-52488","product":"smb","summary":"DNN (formerly DotNetNuke) is an open-source web content management platform (CMS) in the Microsoft ecosystem. In versions 6.0.0 to before 10.0.1, DNN.PLATFORM allows a specially crafted series of malicious interaction to potentially expose NTLM hashes to a third party SMB server. This issue has been patched in version 10.0.1.","details":"DNN (formerly DotNetNuke) is an open-source web content management platform (CMS) in the Microsoft ecosystem. In versions 6.0.0 to before 10.0.1, DNN.PLATFORM allows a specially crafted series of malicious interaction to potentially expose NTLM hashes to a third party SMB server. This issue has been patched in version 10.0.1.","references":["https://github.com/dnnsoftware/Dnn.Platform/security/advisories/GHSA-mgfv-2362-jq96"],"severity":"HIGH","match_type":"product_only","confidence":"low"},
  {"id":"CVE-2025-5986","product":"smb","summary":"A crafted HTML email using mailbox:/// links can trigger automatic, unsolicited downloads of .pdf files to the user's desktop or home directory without prompting, even if auto-saving is disabled. This behavior can be abused to fill the disk with garbage data (e.g. using /dev/urandom on Linux) or to leak Windows credentials via SMB links when the email is viewed in HTML mode. While user interaction is required to download the .pdf file, visual obfuscation can conceal the download trigger. Viewing the email in HTML mode is enough to load external content. This vulnerability affects Thunderbird < 128.11.1 and Thunderbird < 139.0.2.","details":"A crafted HTML email using mailbox:/// links can trigger automatic, unsolicited downloads of .pdf files to the user's desktop or home directory without prompting, even if auto-saving is disabled. This behavior can be abused to fill the disk with garbage data (e.g. using /dev/urandom on Linux) or to leak Windows credentials via SMB links when the email is viewed in HTML mode. While user interaction is required to download the .pdf file, visual obfuscation can conceal the download trigger. Viewing the email in HTML mode is enough to load external content. This vulnerability affects Thunderbird < 128.11.1 and Thunderbird < 139.0.2.","references":["https://bugzilla.mozilla.org/buglist.cgi?bug_id=1958580%2C1968012","https://www.mozilla.org/security/advisories/mfsa2025-49/","https://www.mozilla.org/security/advisories/mfsa2025-50/"],"severity":"MEDIUM","match_type":"version_range","confidence":"high","version_match":[["<139.0.2"],[">=135.0"],["<128.11.1"]]}
]
